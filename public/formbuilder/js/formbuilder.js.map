{"version":3,"sources":["node_modules/browserify/node_modules/browser-pack/_prelude.js","js/app.js","js/app_modules/actions/errors.js","js/app_modules/actions/input-duplicator.js","js/app_modules/actions/jumps.js","js/app_modules/actions/parse/index.js","js/app_modules/actions/parse/methods/getBranchInputsHTML.js","js/app_modules/actions/parse/methods/getGroupInputsHTML.js","js/app_modules/actions/parse/methods/initFormbuilder.js","js/app_modules/actions/parse/methods/renderChildForms.js","js/app_modules/actions/parse/methods/renderInputs.js","js/app_modules/actions/parse/methods/renderProject.js","js/app_modules/actions/possible-answers-pager.js","js/app_modules/actions/possible-answers.js","js/app_modules/actions/save/index.js","js/app_modules/actions/save/module.doCleaningBeforeSaving.js","js/app_modules/actions/save/module.saveAdvancedProperties.js","js/app_modules/actions/save/module.saveAllInputProperties.js","js/app_modules/actions/save/module.saveJumps.js","js/app_modules/actions/save/module.savePossibleAnswers.js","js/app_modules/actions/save/module.saveProperties.js","js/app_modules/actions/save/module.saveUniqueness.js","js/app_modules/actions/undo.js","js/app_modules/actions/validation.js","js/app_modules/config/consts.js","js/app_modules/config/extend-natives.js","js/app_modules/config/formbuilder.js","js/app_modules/config/init.js","js/app_modules/config/messages.js","js/app_modules/config/toast.js","js/app_modules/factory/form-factory.js","js/app_modules/factory/input-factory.js","js/app_modules/factory/input-multiple-answers-prototype.js","js/app_modules/factory/input-properties.js","js/app_modules/factory/input-prototype.js","js/app_modules/helpers/import-form-validation.js","js/app_modules/helpers/ui.js","js/app_modules/helpers/utils.js","js/app_modules/inputs/audio.js","js/app_modules/inputs/barcode.js","js/app_modules/inputs/branch.js","js/app_modules/inputs/checkbox.js","js/app_modules/inputs/date.js","js/app_modules/inputs/dropdown.js","js/app_modules/inputs/group.js","js/app_modules/inputs/integer.js","js/app_modules/inputs/location.js","js/app_modules/inputs/phone.js","js/app_modules/inputs/photo.js","js/app_modules/inputs/radio.js","js/app_modules/inputs/readme.js","js/app_modules/inputs/search.js","js/app_modules/inputs/text.js","js/app_modules/inputs/textarea.js","js/app_modules/inputs/time.js","js/app_modules/inputs/video.js","js/app_modules/loaders/load-child-form-containers.js","js/app_modules/loaders/load-components.js","js/app_modules/loaders/load-containers.js","js/app_modules/loaders/load-input-properties-views.js","js/app_modules/loaders/load-partials.js","js/app_modules/loaders/load-project.js","js/app_modules/template/index.js","js/app_modules/template/methods/createBasicPropertiesHTML.js","js/app_modules/template/methods/createInputPropertiesHTML.js","js/app_modules/template/methods/createInputToolHTML.js","js/app_modules/template/methods/getAdvancedTabBtnHTML.js","js/app_modules/template/methods/getInputPropertiesPanelHTML.js","js/app_modules/template/methods/getJumpTabBtnHTML.js","js/app_modules/template/methods/getJumpsListHTML.js","js/app_modules/template/methods/getPossibleAnswersHTML.js","js/app_modules/template/methods/getPossibleAnswersList.js","js/app_modules/template/methods/getPossibleAnswersPage.js","js/app_modules/template/methods/getUniquenessHTML.js","js/app_modules/template/methods/prepareAdvancedInputPropertiesHTML.js","js/app_modules/template/methods/replaceCommonAdvancedProperties.js","js/app_modules/ui-handlers/branch-sortable.js","js/app_modules/ui-handlers/draggable.js","js/app_modules/ui-handlers/event-handler-callbacks/confirm-import-possible-answers-callback.js","js/app_modules/ui-handlers/event-handler-callbacks/delete-all-questions-click-callback.js","js/app_modules/ui-handlers/event-handler-callbacks/delete-form-click-callback.js","js/app_modules/ui-handlers/event-handler-callbacks/export-form-click-callback.js","js/app_modules/ui-handlers/event-handler-callbacks/form-tab-click-callback.js","js/app_modules/ui-handlers/event-handler-callbacks/import-form-click-callback.js","js/app_modules/ui-handlers/event-handler-callbacks/input-collection-branch-sortable-mousedown-callback.js","js/app_modules/ui-handlers/event-handler-callbacks/input-collection-group-sortable-mousedown-callback.js","js/app_modules/ui-handlers/event-handler-callbacks/input-collection-nested-group-sortable-mousedown-callback.js","js/app_modules/ui-handlers/event-handler-callbacks/input-collection-sortable-mousedown-callback.js","js/app_modules/ui-handlers/event-handler-callbacks/input-properties-advanced-tab-click-callback.js","js/app_modules/ui-handlers/event-handler-callbacks/input-properties-change-callback.js","js/app_modules/ui-handlers/event-handler-callbacks/input-properties-click-callback.js","js/app_modules/ui-handlers/event-handler-callbacks/input-properties-focus-callback.js","js/app_modules/ui-handlers/event-handler-callbacks/input-properties-keyup-callback.js","js/app_modules/ui-handlers/event-handler-callbacks/input-properties-title-checkbox-callback.js","js/app_modules/ui-handlers/event-handler-callbacks/modal-form-callback.js","js/app_modules/ui-handlers/event-handler-callbacks/modal-regex-callback.js","js/app_modules/ui-handlers/event-handler-callbacks/print-as-pdf-click-callback.js","js/app_modules/ui-handlers/event-handler-callbacks/save-project-click-callback.js","js/app_modules/ui-handlers/group-sortable.js","js/app_modules/ui-handlers/possible-answers-sortable.js","js/app_modules/ui-handlers/sortable.js"],"names":[],"mappings":"AAAA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7TA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvcA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3OA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtnBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9zBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5RA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClqBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC34BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3cA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5LA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"formbuilder.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","'use strict';\n//modules are required using absolute paths in browserify: https://goo.gl/UkccGz\nvar init = require('config/init');\nvar extend_natives = require('config/extend-natives');\nvar load_components = require('loaders/load-components');\nvar load_project = require('loaders/load-project');\n\n//load project first\n$.when(\n    load_project()\n).then(function () {\n    //load partial views for index.html, extend natives, then init app\n    $.when(\n        load_components(),\n        extend_natives())\n       .then(init);\n});\n\n/*\n Set middle and right panel to the same height of the inputs-collection panel\n Maybe there is a pure css solution (flexbox), but middle column needs to be scrollable though when I add inputs\n For the time being this will do\n */\n//var inputs_collection_height = $('.inputs-tools').height();\n//$('.main .panel-body').height(inputs_collection_height);\n\n","/* global $*/\n'use strict';\nvar consts = require('config/consts');\nvar messages = require('config/messages');\nvar formbuilder = require('config/formbuilder');\n\n\nvar errors = {\n\n    //hide all properties errors for the current selected input\n    hidePropertiesErrors: function (the_properties_panel) {\n\n        var properties_panel = the_properties_panel;\n\n        //remove inline errors\n        properties_panel.find('div.input-properties__form__question').removeClass('has-error has-feedback');\n        properties_panel.find('div.input-properties__form__question > i').addClass('hidden');\n        properties_panel.find('div.input-properties__form__question span.input-properties__form__error').text('');\n\n        //remove visual errors from tabs\n        properties_panel.find('.input-properties__tabs .nav-tabs i').addClass('invisible');\n        properties_panel.find('.input-properties__tabs .nav-tabs i').parent().removeClass('validation-error');\n    },\n\n    hidePossibleAnswersErrors: function (the_input) {\n\n        //todo this function is called 3 times whne validating on keyup, look inot it when there is time\n        var input = the_input;\n        var possible_answer_list = input.dom.properties_panel.find('.input-properties__form__possible-answers__list');\n\n        $(possible_answer_list).each(function (index, possible_answer) {\n\n            //highlight wrong input and show error message\n            $(possible_answer).find('.input-properties__form__possible-answers__list__possible_answer_item')\n                .removeClass('has-error has-feedback');\n\n            $(possible_answer).find('.input-properties__form__error')\n                .addClass('hidden')\n                .text('');//set error description\n\n        });\n        //remove visual errors from tabs (if the input is valid, there might be some cuncurrency conditions)\n        if (input.dom.is_valid) {\n            input.dom.properties_panel.find('.input-properties__tabs .nav-tabs i').addClass('invisible');\n            input.dom.properties_panel.find('.input-properties__tabs .nav-tabs i').parent().removeClass('validation-error');\n        }\n    },\n\n    hideTabButtonsErrors: function () {\n        //todo maybe this is not needed\n    },\n\n    hideAdvancedPropertiesErrors: function (input, the_properties) {\n\n        var i;\n        var properties = the_properties;\n        var iLength = properties.length;\n        var wrapper = formbuilder.dom\n            .input_properties_forms_wrapper\n            .find('form[data-input-ref=\"' + input.ref + '\"]')\n            .find('.input-properties__form__advanced-properties');\n\n\n        for (i = 0; i < iLength; i++) {\n            wrapper\n                .find('div.input-properties__form__advanced-properties__' + properties[i])\n                .removeClass('has-error has-feedback');\n\n            wrapper\n                .find('div.input-properties__form__advanced-properties__' + properties[i] + ' i')\n                .addClass('hidden');\n\n            wrapper\n                .find('div.input-properties__form__advanced-properties__' + properties[i] + ' span.input-properties__form__error')\n                .addClass('hidden')\n                .text('');\n        }\n    },\n\n    //hide inline errors from jumps (red ouline and error message)\n    hideJumpsErrors: function (the_jumps_list) {\n\n        var jump_list = the_jumps_list;\n        var jump_properties = ['when', 'answer', 'goto'];\n\n        $(jump_list).each(function (index, jump) {\n            $(jump_properties).each(function (index, prop) {\n                $(jump)\n                    .find('.input-properties__form__jumps__logic--' + prop)\n                    .removeClass('has-error')\n                    .find('.input-properties__form__error')\n                    .addClass('hidden')\n                    .text('');\n            });\n        });\n    },\n\n    showQuestionTextErrors: function (the_properties_panel, the_error_message) {\n\n        var properties_panel = the_properties_panel;\n        var error = the_error_message;\n\n        //highlight wrong input and show error message\n        properties_panel.find('div.input-properties__form__question')\n            .addClass('has-error has-feedback');\n        properties_panel.find('div.input-properties__form__question i')\n            .removeClass('hidden')\n            .hide()\n            .fadeIn(consts.ANIMATION_FAST);\n        properties_panel.find('div.input-properties__form__question span.input-properties__form__error')\n            .removeClass('hidden')\n            .text(error)//set error description\n            .hide()\n            .fadeIn(consts.ANIMATION_FAST);\n\n        //show '!' on affected tab, in this case the basic properties tab (first)\n        properties_panel.find('.input-properties__tabs .nav-tabs i:first')\n            .removeClass('invisible')\n            .fadeIn(consts.ANIMATION_FAST);\n\n        //set properties tab text to red\n        properties_panel.find('.input-properties__tabs .nav-tabs i:first')\n            .parent()\n            .addClass('validation-error');\n\n\n    },\n\n    showFormNameErrors: function (the_modal, the_error_message) {\n\n        var modal = the_modal;\n        var error = the_error_message;\n\n        modal.find('.modal-body .input-properties__form__error')\n            .removeClass('hidden')\n            .text(error)//set error description\n            .hide()\n            .fadeIn(300);\n    },\n\n    hideFormNameErrors: function (the_modal) {\n\n        var modal = the_modal;\n        modal.find('.modal-body .input-properties__form__error')\n            .addClass('hidden')\n            .text('');\n    },\n\n    showPossibleAnswerErrors: function (the_possible_answer, the_error_message) {\n\n        var possible_answer = the_possible_answer;\n        var properties_panel = possible_answer.parents().eq(9);\n        var error = the_error_message;\n\n        //highlight wrong input and show error message\n        possible_answer.find('.input-properties__form__possible-answers__list__possible_answer_item')\n            .addClass('has-error has-feedback');\n\n        possible_answer.find('.input-properties__form__error')\n            .removeClass('hidden')\n            .text(error)//set error description\n            .hide()\n            .fadeIn(300);\n\n\n        //show '!' on affected tab, in this case the basic properties tab (first)\n        properties_panel.find('.input-properties__tabs .nav-tabs i:first')\n            .removeClass('invisible')\n            .hide()\n            .fadeIn(300);\n\n        //set properties tab text to red\n        properties_panel.find('.input-properties__tabs .nav-tabs i:first')\n            .parent()\n            .addClass('validation-error');\n\n    },\n\n    showSingleAdvancedPropertyError: function (the_wrapper, the_property, the_error) {\n\n        var prop = the_property;\n        var error = the_error;\n        var wrapper = the_wrapper;\n\n        wrapper\n            .find('div.input-properties__form__advanced-properties__' + prop).addClass('has-error has-feedback');\n\n        wrapper\n            .find('div.input-properties__form__advanced-properties__' + prop + ' i')\n            .removeClass('hidden')\n            .hide()\n            .fadeIn(300);\n\n        wrapper\n            .find('div.input-properties__form__advanced-properties__' + prop + ' span.input-properties__form__error')\n            .removeClass('hidden')\n            .text(error)\n            .hide()\n            .fadeIn(300);\n\n        //show '!' on affected tab, in this case the advanced properties tab\n        wrapper.parent().parent().find('.nav-tabs').find('i.advanced-error')\n            .removeClass('invisible')\n            .hide()\n            .fadeIn(300);\n\n        //set properties tab text to red\n        wrapper.parent().parent().find('.nav-tabs').find('i.advanced-error')\n            .parent()\n            .addClass('validation-error');\n    },\n\n    showSingleJumpErrors: function (the_jump_item_wrapper, the_properties) {\n\n        var jump_properties = the_properties;\n        var wrapper = the_jump_item_wrapper;\n        var ui = require('helpers/ui');\n\n        //jump condition was not selected\n        if (jump_properties.when === undefined) {\n            wrapper\n                .find('.input-properties__form__jumps__logic--when')\n                .addClass('has-error')\n                .find('.input-properties__form__error')\n                .removeClass('hidden')\n                .text(messages.error.JUMP_CONDITION_NOT_SELECTED);\n        }\n\n        //jump answer not selected\n        if (jump_properties.answer_ref === undefined) {\n            wrapper\n                .find('.input-properties__form__jumps__logic--answer')\n                .addClass('has-error ')\n                .find('.input-properties__form__error')\n                .removeClass('hidden')\n                .text(messages.error.JUMP_ANSWER_NOT_SELECTED);\n        }\n\n        //jump destination not selected\n        if (jump_properties.to === undefined) {\n            wrapper\n                .find('.input-properties__form__jumps__logic--goto')\n                .addClass('has-error ')\n                .find('.input-properties__form__error')\n                .removeClass('hidden')\n                .text(messages.error.JUMP_DESTINATION_NOT_SELECTED);\n        }\n\n        //jump destination not valid (after dragging)\n        if (!jump_properties.has_valid_destination) {\n            wrapper\n                .find('.input-properties__form__jumps__logic--goto')\n                .addClass('has-error')\n                .find('.input-properties__form__error')\n                .removeClass('hidden')\n                .text(messages.error.JUMP_DESTINATION_NOT_SELECTED);\n        }\n\n        console.log(wrapper.parents().eq(5));\n\n        ui.input_properties_panel.showJumpTabError(wrapper);\n    },\n\n    showBranchInputsErrors: function (the_properties_panel, the_error_message) {\n\n        var properties_panel = the_properties_panel;\n        var error = the_error_message;\n        var branch_input_ref = formbuilder.branch.current_input_ref;\n        var ui = require('helpers/ui');\n\n\n        //show error message\n        properties_panel.find('.input-properties__form__error--branch-error')\n            .removeClass('invisible')\n            .text(error);\n        //.hide()\n        //  .fadeIn(300);\n\n        //toggle icon to warning\n        ui.inputs_collection.showInputInvalidIcon(branch_input_ref);\n    },\n\n    showGroupInputsErrors: function (the_properties_panel, the_error_message) {\n\n        var properties_panel = the_properties_panel;\n        var error = the_error_message;\n        var branch_input_ref = formbuilder.branch.current_input_ref;\n        var ui = require('helpers/ui');\n\n\n        //show error message\n        properties_panel.find('.input-properties__form__error--group-error')\n            .removeClass('invisible')\n            .text(error);\n        // .hide()\n        //.fadeIn(300);\n\n        //toggle icon to warning\n        ui.inputs_collection.showInputInvalidIcon(branch_input_ref);\n    },\n\n    hideBranchInputsErrors: function (the_properties_panel) {\n        //show error message\n        the_properties_panel.find('.input-properties__form__error--branch-error')\n            .addClass('invisible')\n            .text('&nbsp;');\n    },\n\n    hideGroupInputsErrors: function (the_properties_panel) {\n        //show error message\n        the_properties_panel.find('.input-properties__form__error--group-error')\n            .addClass('invisible')\n            .text('&nbsp;');\n    }\n};\n\nmodule.exports = errors;\n","/* global CircularJSON*/\n'use strict';\nvar formbuilder = require('config/formbuilder');\nvar utils = require('helpers/utils');\nvar consts = require('config/consts');\nvar template = require('template');\nvar input_factory = require('factory/input-factory');\n\nvar copy = {\n\n    pushInput: function (input) {\n\n        var branch_inputs;\n        var group_inputs;\n\n        //remove jumps (they would be invalid when copied, so not worthy)\n        input.jumps = [];\n\n        //also, do not copy the title, set it as false (as we might go over the 3 title limits)\n        input.is_title = false;\n\n        //add input to collection as the last one\n        if (formbuilder.is_editing_branch && formbuilder.is_editing_group) {\n\n            var branch_index = utils.getInputCurrentIndexByRef(formbuilder.current_input_ref);\n            var nested_group_index = utils.getBranchInputCurrentIndexByRef(branch_index, formbuilder.group.active_group_ref);\n\n            //push nested group input\n            formbuilder.project_definition.data.project\n                .forms[formbuilder.current_form_index]\n                .inputs[branch_index]\n                .branch[nested_group_index]\n                .group.push(input);\n        }\n        else {\n\n            if (!formbuilder.is_editing_branch && !formbuilder.is_editing_group) {\n                //push top level input\n                formbuilder.project_definition.data.project.forms[formbuilder.current_form_index].inputs.push(input);\n            }\n\n            if (formbuilder.is_editing_branch) {\n                branch_inputs = utils.getInputObjectByRef(formbuilder.branch.active_branch_ref).branch;\n                //push branch input\n                branch_inputs.push(input);\n            }\n\n            if (formbuilder.is_editing_group) {\n                group_inputs = utils.getInputObjectByRef(formbuilder.group.active_group_ref).group;\n                //push group input\n                group_inputs.push(input);\n            }\n        }\n    },\n\n    appendInputToDom: function (input) {\n\n        var self = this;\n        var input_html = self.createInputHTML(input);\n        var active_branch_sortable;\n        var active_group_sortable;\n\n        if (formbuilder.is_editing_branch && formbuilder.is_editing_group) {\n\n            //console.log('active group ref = ' + formbuilder.group.active_group_ref);\n            //console.log('active branch ref = ' + formbuilder.branch.active_branch_ref);\n\n            //todo\n            //get active group sortable\n            active_group_sortable = formbuilder.dom.inputs_collection_sortable\n                .find('div.input[data-input-ref=\"' + formbuilder.group.active_group_ref + '\"]')\n                .find('.group-sortable');\n\n            //append markup to group sortable\n            active_group_sortable.append(input_html.collection);\n        }\n        else {\n            if (!formbuilder.is_editing_branch && !formbuilder.is_editing_group) {\n                //append to top level sortable\n                formbuilder.dom.inputs_collection_sortable.append(input_html.collection);\n            }\n\n            if (formbuilder.is_editing_branch) {\n\n                //get active branch sortable\n                active_branch_sortable = formbuilder.dom.inputs_collection_sortable\n                    .find('div.input[data-input-ref=\"' + formbuilder.branch.active_branch_ref + '\"]')\n                    .find('.branch-sortable');\n\n                //append markup to bracnh sortable\n                active_branch_sortable.append(input_html.collection);\n            }\n\n            if (formbuilder.is_editing_group) {\n\n                //get active group sortable\n                active_group_sortable = formbuilder.dom.inputs_collection_sortable\n                    .find('div.input[data-input-ref=\"' + formbuilder.group.active_group_ref + '\"]')\n                    .find('.group-sortable');\n\n                //append markup to group sortable\n                active_group_sortable.append(input_html.collection);\n            }\n        }\n\n        //append panels\n        formbuilder.dom.input_properties_forms_wrapper.append(input_html.panels);\n    },\n\n    createInputHTML: function (input) {\n\n        var parse = require('actions/parse');\n        var input_factory = require('factory/input-factory');\n        var form_index = formbuilder.current_form_index;\n        var inputs = formbuilder.project_definition.data.project.forms[form_index].inputs;\n        //create html element for input collection (middle column)\n        var input_collection_html = input_factory.createInputToolHTML(input);\n        var properties_panel_html;\n        var input_properties_panel_html = '';\n\n\n        //if it is a branch, loop all the branch inputs (there must be at least a branch input)\n        if (input.type === consts.BRANCH_TYPE) {\n            //todo check the secons arg of getBranchInputsHTML, I had to pass `inputs.length - 1`\n            var branch_inputs_html = parse.getBranchInputsHTML(input, inputs.length - 1);\n            input_collection_html = input_collection_html.replace('{{branch-content}}', branch_inputs_html.collection);\n            //todo check where the string replacement happens\n            input_properties_panel_html += branch_inputs_html.panels;\n        }\n\n        //if it is a group, loop all the group inputs (there must be at least a group input)\n        if (input.type === consts.GROUP_TYPE) {\n\n            var group_inputs_html = parse.getGroupInputsHTML(input, inputs.length - 1, null);\n            input_collection_html = input_collection_html.replace('{{group-content}}', group_inputs_html.collection);\n            //todo check where the string replacement happens\n            input_properties_panel_html += group_inputs_html.panels;\n        }\n\n\n        //create properties panel for current input\n        properties_panel_html = template.getInputPropertiesPanelHTML(input);\n\n        /* Add the group or branch inputs panels markup (if any)\n         The panels are not attached in the right order in the dom but it does not matter,\n         as only one is shown at a time\n         */\n        input_properties_panel_html += properties_panel_html;\n\n        return {\n            collection: input_collection_html,\n            panels: input_properties_panel_html\n        };\n    },\n\n    createPossibleAnswersCopy: function (possible_answers) {\n\n        var possible_answers_copy = [];\n\n        $.each(possible_answers, function (index, possible_answer) {\n            possible_answers_copy[index] = {};\n            possible_answers_copy[index].answer = possible_answer.answer;\n            possible_answers_copy[index].answer_ref = utils.generateUniqID();\n        });\n\n        return possible_answers_copy;\n    },\n\n    createInputCopy: function (input) {\n\n        var input_factory = require('factory/input-factory');\n        var self = this;\n        var input_copied_ref = utils.generateInputCopyRef();\n        var input_copied = input_factory.createInput(input.type, input_copied_ref);\n        var ref_map =[];\n\n        //set input copy properties to original input properties\n        // (only the one saved in the project definition, leave the others intact,\n        // and DO NOT copy the ref!)\n        for (var property in input_copied) {\n            if (input.hasOwnProperty(property) && property !== 'ref') {\n\n                /* Important: branch/group is an array, so perform deep copy\n                 * using JSON.parse(JSON.stringify(obj));\n                 *\n                 * This is because array.slice does not perform a deep copy on anything nested, just on a plain array\n                 * and $.extend(true, [], oldArray) was not working\n                 * */\n                switch (property) {\n                    case consts.BRANCH_TYPE:\n                        input_copied.branch = CircularJSON.parse(CircularJSON.stringify(input.branch));\n                        break;\n                    case consts.GROUP_TYPE:\n                        input_copied.group = CircularJSON.parse(CircularJSON.stringify(input.group));\n                        break;\n                    default:\n                        input_copied[property] = input[property];\n                }\n            }\n        }\n\n        //branch\n        ref_map = self.createBranchCopy(input_copied.ref, input_copied.branch, input);\n\n        //a top level group:\n        self.createGroupCopy(input_copied.ref, input_copied.group, input);\n\n        //override possible answers \"answer_ref\" on copied top level input (on multiple answers type only)\n        if ($.inArray(input_copied.type, consts.MULTIPLE_ANSWER_TYPES) !== -1) {\n            input_copied.possible_answers = self.createPossibleAnswersCopy(input_copied.possible_answers);\n\n            //todo check what the default property is set to, whether null or empty string\n            if (!(input.default === '' || input.default === null)) {\n                //there is a default value to remap!\n                input_copied.default = self.getDefaultValueFromInputCopy(input, input_copied);\n            }\n        }\n\n        //clear jumps for top level input (when not a branch!)\n        if(input_copied.type === consts.BRANCH_TYPE) {\n            //update jumps for all the branch inputs\n            self.updateBranchJumps(input_copied.branch, ref_map);\n        }\n        else {\n            input_copied.jumps = [];\n        }\n\n        return input_copied;\n    },\n\n    updateBranchJumps: function(branch, ref_map) {\n\n        //to store the new jumps\n        var updated_jumps;\n        var self = this;\n\n        $(branch).each(function (branch_index, branch_input) {\n\n            updated_jumps =[];\n\n            if(branch_input.jumps.length > 0) {\n\n                $(branch_input.jumps).each(function(ji, jump){\n\n                    if ($.inArray(branch_input.type, consts.MULTIPLE_ANSWER_TYPES) !== -1) {\n                        //update the jump references\n                        updated_jumps.push({\n                            when: jump.when,\n                            to: self.getJumpToValueFromRefMap(ref_map, jump.to),\n                            answer_ref: ref_map[branch_index].answer_refs[jump.answer_ref]\n                        });\n                    }\n                    else {\n                        //update the jump references\n                        updated_jumps.push({\n                            when: jump.when,\n                            to: self.getJumpToValueFromRefMap(ref_map, jump.to),\n                            answer_ref: null\n                        });\n                    }\n                });\n            }\n            //replace jumps with updated ones\n            branch_input.jumps = updated_jumps;\n        });\n    },\n\n    createGroupCopy: function (ref, group, input){\n\n        var group_copy =[];\n\n        $(group).each(function (group_input_index, group_input) {\n\n            var  group_answer_ref_map = {};\n\n            group_copy[group_input_index] = group_input;\n            group_copy[group_input_index].ref = utils.generateBranchGroupInputRef(ref);\n\n            //override any \"answer_ref\"\n            if ($.inArray(group_input.type, consts.MULTIPLE_ANSWER_TYPES) !== -1) {\n\n                var group_input_possible_answers_copy = [];\n\n                $.each(group_input.possible_answers, function (index, possible_answer) {\n\n                    var new_answer_ref = utils.generateUniqID();\n\n                    group_input_possible_answers_copy[index] = {};\n                    group_input_possible_answers_copy[index].answer = possible_answer.answer;\n                    group_input_possible_answers_copy[index].answer_ref = new_answer_ref;\n\n                    group_answer_ref_map[possible_answer.answer_ref] = new_answer_ref;\n                });\n\n                //override possible answers for this branch input\n                group_input.possible_answers = group_input_possible_answers_copy;\n\n                //remap default value to new answer_ref\n                if (!(group_input.default === '' || group_input.default === null)) {\n                    //there is a default value to remap!\n                    if ($.inArray(group_input.type, consts.MULTIPLE_ANSWER_TYPES) !== -1) {\n                        group_input.default = group_answer_ref_map[input.group[group_input_index].default];\n                    }\n                    else {\n                        //do nothing\n                    }\n                }\n            }\n        });\n    },\n\n    createBranchCopy: function(ref, branch, input){\n\n        var branch_copy =[];\n        var branch_input_possible_answers_copy;\n        var ref_map = [];\n        var branch_input_jumps_copy;\n        var answer_ref_map;\n        var new_answer_refs;\n        var nested_group_copy = [];\n        var nested_group_input_possible_answers_copy;\n\n        $(branch).each(function (branch_index, branch_input) {\n\n            branch_copy[branch_index] = branch_input;\n            branch_copy[branch_index].ref = utils.generateBranchGroupInputRef(ref);\n\n            ref_map[branch_index] = {\n                jumps: branch_input.jumps,\n                answer_refs: {}\n            };\n\n            //map old - new input ref\n            ref_map[branch_index].old_ref = input.branch[branch_index].ref;\n            ref_map[branch_index].new_ref = branch_copy[branch_index].ref;\n\n            //override any \"answer_ref\" and update jumps\n            //todo all the jumps, there is the jump always as well!!!!!\n            if ($.inArray(branch_input.type, consts.MULTIPLE_ANSWER_TYPES) !== -1) {\n\n                branch_input_possible_answers_copy = [];\n                branch_input_jumps_copy = [];\n                answer_ref_map = {};\n\n                $.each(branch_input.possible_answers, function (index, possible_answer) {\n\n                    //build a map to update jumps references\n                    var new_answer_ref = utils.generateUniqID();\n                    answer_ref_map[possible_answer.answer_ref] = new_answer_ref;\n\n                    //override\n                    branch_input_possible_answers_copy[index] = {};\n                    branch_input_possible_answers_copy[index].answer = possible_answer.answer;\n                    branch_input_possible_answers_copy[index].answer_ref = new_answer_ref\n                });\n\n                //override possible answers for this branch input\n                branch_input.possible_answers = branch_input_possible_answers_copy;\n\n                new_answer_refs = answer_ref_map;\n            }\n            else {\n                new_answer_refs = null;\n            }\n\n            //add answer_refs map to jumps map\n            ref_map[branch_index].answer_refs = new_answer_refs;\n\n            //remap default value to new answer_ref\n            if (!(branch_input.default === '' || branch_input.default === null)) {\n                //there is a default value to remap!\n                if ($.inArray(branch_input.type, consts.MULTIPLE_ANSWER_TYPES) !== -1) {\n                    branch_input.default = new_answer_refs[branch_input.default];\n                }\n            }\n\n            //a group within a branch:\n\n            $(branch_input.group).each(function (nested_group_input_index, nested_group_input) {\n\n                var  group_input_answer_ref_map = {};\n\n                nested_group_copy[nested_group_input_index] = nested_group_input;\n                nested_group_copy[nested_group_input_index].ref = utils.generateBranchGroupInputRef(branch[branch_index].ref);\n\n                if ($.inArray(nested_group_input.type, consts.MULTIPLE_ANSWER_TYPES) !== -1) {\n\n                    nested_group_input_possible_answers_copy = [];\n\n                    $.each(nested_group_input.possible_answers, function (index, possible_answer) {\n\n                        var new_answer_ref = utils.generateUniqID();\n\n                        //override\n                        nested_group_input_possible_answers_copy[index] = {};\n                        nested_group_input_possible_answers_copy[index].answer = possible_answer.answer;\n                        nested_group_input_possible_answers_copy[index].answer_ref = new_answer_ref;\n\n                        group_input_answer_ref_map[possible_answer.answer_ref] = new_answer_ref;\n                    });\n\n                    //override possible answers for this branch input\n                    nested_group_input.possible_answers = nested_group_input_possible_answers_copy;\n\n                    //remap default value to new answer_ref\n                    if (!(nested_group_input.default === '' || nested_group_input.default === null)) {\n                        //there is a default value to remap!\n                        if ($.inArray(nested_group_input.type, consts.MULTIPLE_ANSWER_TYPES) !== -1) {\n                            nested_group_input.default = group_input_answer_ref_map[branch_input.group[nested_group_input_index].default];\n                        }\n                    }\n                }\n            });\n        });\n\n        return ref_map;\n    },\n\n    getDefaultValueFromInputCopy: function (original, copy) {\n\n        var original_default_answer_ref_index = -1;\n\n        $(original.possible_answers).each(function (index, possible_answer) {\n            if (possible_answer.answer_ref === original.default) {\n                original_default_answer_ref_index = index;\n            }\n        });\n\n        return copy.possible_answers[original_default_answer_ref_index].answer_ref;\n\n    },\n\n    getJumpToValueFromRefMap: function(ref_map, to){\n\n        var jump_to = null;\n\n        //if to id \"END\", just return it\n        if(to === consts.JUMP_TO_END_OF_FORM_REF) {\n            jump_to = consts.JUMP_TO_END_OF_FORM_REF;\n        }\n        else {\n            //otherwise return the new ref\n            $(ref_map).each(function (index, map) {\n                if (map.old_ref === to) {\n                    jump_to = map.new_ref;\n                    return false;\n                }\n            });\n        }\n\n        return jump_to\n    }\n};\n\nmodule.exports = copy;\n","/* global $*/\n'use strict';\nvar consts = require('config/consts');\nvar messages = require('config/messages');\nvar validation = require('actions/validation');\nvar formbuilder = require('config/formbuilder');\nvar utils = require('helpers/utils');\n\nvar jumps = {\n\n    addJump: function (the_input) {\n\n        var input = the_input;\n        var jumps_list_wrapper = formbuilder.dom.input_properties_forms_wrapper\n            .find('form[data-input-ref=\"' + input.ref + '\"]')\n            .find('.input-properties__form__jumps .input-properties__form__jumps__list');\n        var html = '';\n        var jump_index = input.jumps.length;\n\n        //if the number of jumps is already equal to the number of possible answers, do not add jump\n        //Do this check only for multiple answers inputs, as single answer inputs do have zero possible_answers at all times.\n        if (consts.MULTIPLE_ANSWER_TYPES.indexOf(input.type) > -1) {\n            if (input.jumps.length >= input.possible_answers.length) {\n                return;\n            }\n        }\n\n        //if jumps, remove 'no jumps set' item\n        jumps_list_wrapper.parent().find('.input-properties__form__jumps__no-jumps-message').addClass('hidden');\n\n        if (consts.MULTIPLE_ANSWER_TYPES.indexOf(input.type) === -1) {\n            //append a jump with condition disabled and set to 'always' jump\n            //we do this because on EC5 when the question is an open answer, a jump will always jump no matter the answer given\n            // jumps_list_wrapper.append();\n\n            html += formbuilder.dom.partials.jump_list_item_always_jump;\n        }\n        else {\n            //jumps get full functionality with multiple answers input types\n            html += formbuilder.dom.partials.jump_list_item;\n        }\n\n        html = html.replace(/{{input-ref-logic-when}}/g, jump_index + '-' + input.ref + '-logic-when');\n        html = html.replace(/{{input-ref-logic-answer}}/g, jump_index + '-' + input.ref + '-logic-answer');\n        html = html.replace(/{{input-ref-logic-goto}}/g, jump_index + '-' + input.ref + '-logic-goto');\n\n        jumps_list_wrapper.append(html);\n\n        //add empty jump to input\n        input.jumps.push({});\n\n        //show jump icon in input tool\n        //todo\n        formbuilder.dom.inputs_collection.find('.input[data-input-ref=\"' + input.ref + '\"]');\n        formbuilder.dom.inputs_collection.find('.input[data-input-ref=\"' + input.ref + '\"] .input-inner');\n        formbuilder.dom.inputs_collection.find('.input[data-input-ref=\"' + input.ref + '\"] .input-inner .jump-state').removeClass('invisible');\n\n    },\n\n    removeJump: function (the_current_input, the_remove_btn) {\n\n        var input = the_current_input;\n        var jump_item = the_remove_btn.parent();\n        var jump_list = jump_item.parent();\n        // jump index starts from 1, as index 0 is 'no jumps yet' placeholder, wrapped in a <li> tag\n        var jump_index = jump_item.index();\n\n        //remove selected from dom\n        jump_item.remove();\n\n        //remove from memory\n        input.jumps.splice((jump_index - 1), 1);\n\n        //if no jumps, show message\n        if (jump_list.find('li').length === 0) {\n            //if no jumps yet, remove 'no jumps set' item\n            jump_list.parent().find('.input-properties__form__jumps__no-jumps-message').removeClass('hidden');\n\n            //hide jumps icon from input tool\n            //todo\n            formbuilder.dom.inputs_collection.find('.input[data-input-ref=\"' + input.ref + '\"] .input-inner .jump-state').addClass('invisible');\n        }\n    },\n\n    listJumpPossibleAnswers: function (the_select, the_input) {\n\n        var focused_select = the_select;\n        var input = the_input;\n        var html = '';\n\n        //trigger a save in case the user typed in a possibile answer and switched directly to the jump tab\n        input.savePossibleAnswers();\n\n        focused_select.empty();\n        $(input.possible_answers).each(function (index, possible_answer) {\n            html += '<option value=\"';\n            html += possible_answer.answer_ref + '\">';\n            html += possible_answer.answer.trunc(50);\n            html += '</option>';\n        });\n        focused_select.append(html);\n    },\n\n    //list jump consitions (is, is not etc...)\n    listJumpConditions: function (the_select) {\n\n        var focused_select = the_select;\n        var possible_conditions = consts.JUMP_CONDITIONS;\n        var html = '';\n\n        focused_select.empty();\n        $(possible_conditions).each(function (i) {\n\n            html += '<option value=\"';\n            html += this.key + '\">';\n            html += this.text;\n            html += '</option>';\n        });\n        focused_select.append(html);\n    },\n\n    //dynamically show a list of possible destination for a jump\n    listJumpDestinations: function (the_select, the_jump_destinations) {\n\n        var focused_select = the_select;\n        var jump_destinations = the_jump_destinations;\n\n        /*\n         jumps can go only forward, possible jumps destinations are index of current input +1,\n         as it not possible to jump to an adjacent input\n         */\n        focused_select.empty();\n        $(jump_destinations).each(function (index, destination) {\n\n            var question;\n            var purifiedReadme = '';\n\n            if (destination.question === '') {\n                if (destination.type === consts.BRANCH_TYPE) {\n                    question = messages.error.NO_BRANCH_HEADER_YET;\n                }\n                else {\n                    question = messages.error.NO_QUESTION_TEXT_YET;\n                }\n            }\n            else {\n                if (destination.type === consts.README_TYPE) {\n                    //strip all tags for preview within select\n                    purifiedReadme = utils.decodeHtml(destination.question);\n                    purifiedReadme = utils.stripTags(purifiedReadme);\n                    question = purifiedReadme.trunc(50);\n                }\n                else {\n                    question = destination.question.trunc(50);\n                }\n            }\n            focused_select.append('<option value=\"' + destination.ref + '\">' + question + ' </option>');\n        });\n    },\n\n    ////if any jump, refresh the jumps selected destination label as it might have changed\n    refreshInputJumpsDom: function (input, inputs) {\n\n        var selected_destinations = formbuilder.dom.input_properties_forms_wrapper\n            .find('form[data-input-ref=\"' + input.ref + '\"]')\n            .find('.input-properties__form__jumps__logic--goto select option:selected');\n        var purifiedReadme = '';\n\n        var available_destinations = utils.getJumpAvailableDestinations(input, inputs);\n\n        //loop each jump\n        $(input.jumps).each(function (jumpIndex, jump) {\n\n            //find the destination \"question\" and update the text shown in the dropdown \"go to\"\n            $(available_destinations).each(function (destinationIndex, destination) {\n\n                if (jump.to === destination.ref) {\n                    if (destination.type === consts.README_TYPE) {\n                        //strip all tags for preview within select\n                        purifiedReadme = utils.decodeHtml(destination.question);\n                        purifiedReadme = utils.stripTags(purifiedReadme);\n                        $(selected_destinations[jumpIndex]).text(purifiedReadme.trunc(50));\n                    }\n                    else {\n                        $(selected_destinations[jumpIndex]).text(destination.question);\n                    }\n                    return false;\n                }\n            });\n        });\n    }\n};\n\nmodule.exports = jumps;\n","'use strict';\nvar consts = require('config/consts');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar formbuilder = require('config/formbuilder');\nvar input_factory = require('factory/input-factory');\nvar Input = require('factory/input-prototype');\nvar form_factory = require('factory/form-factory');\nvar template = require('template');\nvar validation = require('actions/validation');\nvar methods = {\n    getBranchInputsHTML: require('actions/parse/methods/getBranchInputsHTML'),\n    getGroupInputsHTML: require('actions/parse/methods/getGroupInputsHTML'),\n    renderInputs: require('actions/parse/methods/renderInputs'),\n    renderProject: require('actions/parse/methods/renderProject'),\n    renderChildForms: require('actions/parse/methods/renderChildForms'),\n    initFormbuilder: require('actions/parse/methods/initFormbuilder')\n};\n\nvar parse = {\n\n    action: '',\n\n    renderInputs: function (the_inputs) {\n        return methods.renderInputs(the_inputs);\n    },\n\n    getBranchInputsHTML: function (the_input, the_index) {\n        return methods.getBranchInputsHTML(the_input, the_index);\n    },\n    //branch index is set when it is a nested group only\n    getGroupInputsHTML: function (the_input, the_index, the_branch_index) {\n        return methods.getGroupInputsHTML(the_input, the_index, the_branch_index);\n    },\n\n    renderProject: function (project_definition, action) {\n        return methods.renderProject(project_definition, action);\n    },\n\n    initFormbuilder: function () {\n        return methods.initFormbuilder();\n    },\n\n    //render children forms recursively\n    renderChildForm: function (the_child_forms) {\n        return methods.renderChildForms(the_child_forms);\n    }\n};\n\nmodule.exports = parse;\n\n","'use strict';\nvar ui = require('helpers/ui');\nvar formbuilder = require('config/formbuilder');\nvar template = require('template');\nvar consts = require('config/consts');\n\nvar getBranchInputsHTML = function (the_input, the_index) {\n\n    var input_factory = require('factory/input-factory');\n    var self = this;\n    var input = the_input;\n    var index = the_index;\n    var branch_properties;\n    var html;\n    var branch_sortable_html = ui.inputs_collection.getEmptyCollectionSortableHTML(consts.BRANCH_TYPE);\n    var branch_input_collection_html = '';\n    var branch_properties_panel_html = '';\n    var properties_panel_html = '';\n\n    formbuilder.current_input_ref = input.ref;\n\n    //if no branch inputs, show \"no branch inputs message\"\n\n    $.each(input.branch, function (branch_index, branch_input) {\n\n        //create html branch element for input collection (middle column)\n        html = input_factory.createInputToolHTML(branch_input);\n        branch_input_collection_html += html;\n\n        //copy input properties from stored branch input\n        branch_properties = JSON.parse(JSON.stringify(branch_input));\n\n        //generate new branch input with attached prototype\n        branch_input = input_factory.createInput(branch_properties.type, branch_properties.ref);\n\n        //set branch input properties to stored properties (only the one saved in the project definition, leave the others intact)\n        for (var property in branch_input) {\n            if (branch_properties.hasOwnProperty(property)) {\n                branch_input[property] = branch_properties[property];\n            }\n        }\n        //set branch input as valid, as by default it is generated as invalid\n        branch_input.dom.is_valid = true;\n\n        //override 'global' branch input obj literal with newly created\n        formbuilder.project_definition.data.project.forms[formbuilder.current_form_index].inputs[index].branch[branch_index] = branch_input;\n\n        //if it is a group, loop all the nesyed group inputs (there must be at least a group input)\n        if (branch_input.type === consts.GROUP_TYPE) {\n\n            formbuilder.is_editing_group = true;\n\n            //pass in branch_index as this is a nested group\n            var nested_group_inputs_html = self.getGroupInputsHTML(branch_input, index, branch_index);\n            branch_input_collection_html = branch_input_collection_html.replace('{{group-content}}', nested_group_inputs_html.collection);\n            branch_properties_panel_html += nested_group_inputs_html.panels;\n\n            formbuilder.is_editing_group = false;\n        }\n\n        //per each branch input with possible answers keep track of pagination\n        if (consts.MULTIPLE_ANSWER_TYPES.indexOf(branch_input.type) > -1) {\n            //we have possible answers\n            formbuilder.possible_answers_pagination[branch_input.ref] = {};\n            formbuilder.possible_answers_pagination[branch_input.ref].page = 1;\n        }\n\n        //get properties panel for branch input\n        properties_panel_html = template.getInputPropertiesPanelHTML(branch_input);\n        branch_properties_panel_html += properties_panel_html;\n\n    });\n\n    branch_sortable_html = branch_sortable_html.replace('{{branch-inputs}}', branch_input_collection_html);\n\n    return {\n        collection: branch_sortable_html,\n        panels: branch_properties_panel_html\n    };\n};\n\nmodule.exports = getBranchInputsHTML;\n","'use strict';\nvar ui = require('helpers/ui');\nvar formbuilder = require('config/formbuilder');\nvar template = require('template');\nvar consts = require('config/consts');\n\nvar getGroupsInputsHTML = function (the_input, the_index, the_branch_index) {\n\n    var input_factory = require('factory/input-factory');\n    var input = the_input;\n    var index = the_index;\n    var branch_index = the_branch_index;\n    var group_properties;\n    var html;\n    var group_sortable_html = ui.inputs_collection.getEmptyCollectionSortableHTML(consts.GROUP_TYPE);\n    var group_input_collection_html = '';\n    var properties_panel_html = '';\n    var group_properties_panel_html = '';\n\n    formbuilder.current_input_ref = input.ref;\n\n    $.each(input.group, function (group_index, group_input) {\n\n        //create html group element for input collection (middle column)\n        html = input_factory.createInputToolHTML(group_input);\n        group_input_collection_html += html;\n\n        //copy input properties from stored group input\n        group_properties = JSON.parse(JSON.stringify(group_input));\n\n        //generate new group input with attached prototype\n        group_input = input_factory.createInput(group_properties.type, group_properties.ref);\n\n        //set group input properties to stored properties (only the one saved in the project definition, leave the others intact)\n        for (var property in group_input) {\n            if (group_properties.hasOwnProperty(property)) {\n                group_input[property] = group_properties[property];\n            }\n        }\n\n        //set group input as valid, as by default it is generated as invalid\n        group_input.dom.is_valid = true;\n\n        //override 'global' group input obj literal with newly created\n        if (branch_index === null) {\n            //this is a first level group\n            formbuilder.project_definition.data.project.forms[formbuilder.current_form_index].inputs[index].group[group_index] = group_input;\n        }\n        else {\n            //this is a nested group\n            formbuilder.project_definition.data.project\n                .forms[formbuilder.current_form_index]\n                .inputs[index]\n                .branch[branch_index]\n                .group[group_index] = group_input;\n        }\n\n        //per each group input with possible answers keep track of pagination\n        if (consts.MULTIPLE_ANSWER_TYPES.indexOf(group_input.type) > -1) {\n            //we have possible answers\n            formbuilder.possible_answers_pagination[group_input.ref] = {};\n            formbuilder.possible_answers_pagination[group_input.ref].page = 1;\n        }\n\n        properties_panel_html = template.getInputPropertiesPanelHTML(group_input);\n        group_properties_panel_html += properties_panel_html;\n    });\n\n    group_sortable_html = group_sortable_html.replace('{{group-inputs}}', group_input_collection_html);\n\n    return {\n        collection: group_sortable_html,\n        panels: group_properties_panel_html\n    };\n};\n\nmodule.exports = getGroupsInputsHTML;\n","'use strict';\nvar consts = require('config/consts');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar formbuilder = require('config/formbuilder');\nvar input_factory = require('factory/input-factory');\nvar form_factory = require('factory/form-factory');\nvar Input = require('factory/input-prototype');\nvar template = require('template');\nvar validation = require('actions/validation');\nvar input_collection_branch_sortable_mousedown_callback = require('ui-handlers/event-handler-callbacks/input-collection-branch-sortable-mousedown-callback');\n\nvar initFormbuilder = function () {\n\n    var self = this;\n    var project;\n    var forms;\n    var state;\n    // var project_definition;\n    var active_branch;\n    var active_branch_input;\n    var active_nested_group;\n\n\n    //drop any reference to input ref, as we start with no input selected\n    formbuilder.current_input_ref = undefined;\n    formbuilder.is_editing_branch = false;\n    formbuilder.is_editing_group = false;\n\n    //re-enable branch input tool in left sidebar\n    formbuilder.dom.inputs_tools_draggable.filter('.input-branch').show();\n    //re-enable group input tool in left sidebar\n    formbuilder.dom.inputs_tools_draggable.filter('.input-group').show();\n\n    if(utils.getSearchInputsTotal() >= consts.LIMITS.search_inputs_max) {\n        ui.input_tools.hideSearchInput();\n    }\n    else {\n        ui.input_tools.showSearchInput();\n    }\n\n    //disable save project button, as there is no point saving a project with no changes\n    //it will be re-enable as soon the user make a change\n    formbuilder.dom.save_project_btn.off('click');\n\n    //when undoing\n    if (formbuilder.render_action === consts.RENDER_ACTION_UNDO) {\n\n        //get current project definition as we have all the methods attached to inputs (it is the previous state just rendered on screen)\n        //project_definition = formbuilder.project_definition;\n        state = formbuilder.previous_state;\n        project = formbuilder.project_definition.data.project;\n        forms = project.forms.slice();\n\n        //let's set all inputs as disabled to start with\n        formbuilder.current_input_ref = undefined;\n\n        //run validation on each form\n        $(forms).each(function (index, form) {\n\n            //set form dom references (for the validation and dom changes)\n            form_factory.updateFormbuilderDomReferences(form.ref);\n\n            //set formbuilder stet for validation\n            formbuilder.current_form_index = index;\n            formbuilder.current_form_ref = form.ref;\n\n            //todo check this for branches, groups and nested groups\n            $(form.inputs).each(function (index, input) {\n\n                //check if we have an active input after undoing\n                if (input.ref === state.active_input_ref) {\n                    formbuilder.current_input_ref = state.active_input_ref;\n                }\n\n                if (!input.dom.is_valid) {\n                    //run a validation after the dom is created looping all the inputs which are set as false, and set dom accordingly\n                    validation.performValidation(input, false);\n                }\n            });\n\n            if (validation.areFormInputsValid(index)) {\n                //set valid icon on form\n                ui.forms_tabs.showFormValidIcon(index);\n            }\n            else {\n                //set invalid icon on form\n                ui.forms_tabs.showFormInvalidIcon(index);\n            }\n        });\n\n        //set formbuilder interface to previous state\n        formbuilder.current_form_index = state.active_form_index;\n        formbuilder.current_form_ref = state.active_form_ref;\n        form_factory.updateFormbuilderDomReferences(formbuilder.current_form_ref);\n        formbuilder.is_editing_branch = state.was_editing_branch;\n        formbuilder.is_editing_group = state.was_editing_group;\n\n        if (formbuilder.is_editing_branch && formbuilder.is_editing_group) {\n            //todo re-enable the nested group that was being edited\n\n\n            console.log(formbuilder);\n\n            active_branch = utils.getInputObjectByRef(state.active_branch_ref);\n            active_nested_group = utils.getNestedGroupObjectByRef(active_branch, state.active_group_ref);\n            active_branch.enterBranchSortable();\n\n            formbuilder.current_input_ref = state.active_branch_ref;//the branch that was active when undoing\n            formbuilder.branch.current_input_ref = state.active_group_ref;//the nested group that was active when undoing\n            formbuilder.group.active_group_ref = state.active_group_ref;//the nested group that was active when undoing\n\n            active_nested_group.enterGroupSortable(true);\n\n        }\n        else {\n            if (formbuilder.is_editing_branch) {\n                //re-enable the branch that was being edited\n                active_branch = utils.getInputObjectByRef(state.active_branch_ref);\n                active_branch.enterBranchSortable();\n\n                //set the active branch input if there was one selected\n                if (state.active_branch_input_ref) {\n                    //trigger a synthetic click on the branch sortable (dom)\n                    //active_branch_input = utils.getBranchInputObjectByRef(state.active_branch_input_ref);\n                    $('.input[data-input-ref=\"' + state.active_branch_input_ref + '\"]').trigger('mousedown');\n                }\n\n                //switch to previously active properties tab\n                formbuilder.dom.input_properties_forms_wrapper\n                    .find('.nav-tabs .nav-tabs__tab-btn-item a[href=\"' + state.active_properties_tab + '\"]').tab('show');\n            }\n\n            if (formbuilder.is_editing_group) {\n                //re-enable the branch that was being edited\n                var active_group = utils.getInputObjectByRef(state.active_group_ref);\n                active_group.enterGroupSortable();\n\n                if (state.active_group_input_ref) {\n                    //trigger a synthetic click on the branch sortable (dom)\n                    //active_branch_input = utils.getBranchInputObjectByRef(state.active_branch_input_ref);\n                    $('.input[data-input-ref=\"' + state.active_group_input_ref + '\"]').trigger('mousedown');\n                }\n\n                //switch to previously active properties tab\n                formbuilder.dom.input_properties_forms_wrapper\n                    .find('.nav-tabs .nav-tabs__tab-btn-item a[href=\"' + state.active_properties_tab + '\"]').tab('show');\n\n            }\n        }\n\n        //if the user was editing main forms, rebind events\n        if (!formbuilder.is_editing_branch && !formbuilder.is_editing_group) {\n\n            /* do this as we might have had an active branch when clicking undo ***************/\n            //enable form tab buttons\n            ui.forms_tabs.toggleFormTabsButtons({enable: true});\n            //set draggable to work with main sortable\n            formbuilder.dom.inputs_tools_draggable.draggable('option', 'connectToSortable', '.sortable');\n            /**********************************************************************************/\n\n            form_factory.unbindFormPanelsEvents();\n            form_factory.updateFormbuilderDomReferences(formbuilder.project_definition.data.project.forms[formbuilder.current_form_index].ref);\n            form_factory.bindFormPanelsEvents();\n\n            //switch to previously active form\n            formbuilder.dom.forms_tabs.find('a[data-form-index=' + state.active_form_index + ']').tab('show');\n\n            //activate previous input from dom collection (middle column), if one was active in the previous state\n            if (formbuilder.current_input_ref) {\n                formbuilder.dom.inputs_collection_sortable\n                    .find('div.input[data-input-ref=\"' + formbuilder.current_input_ref + '\"]').addClass('active');\n\n                //show active input properties panel\n                formbuilder.dom.input_properties_forms_wrapper.find('form[data-input-ref=\"' + formbuilder.current_input_ref + '\"]').removeClass('hidden');\n\n                //switch to previously active properties tab\n                formbuilder.dom.input_properties_forms_wrapper\n                    .find('.nav-tabs .nav-tabs__tab-btn-item a[href=\"' + state.active_properties_tab + '\"]').tab('show');\n\n                //hide message no input was selected\n                formbuilder.dom\n                    .input_properties_forms_wrapper\n                    .find('.input-properties__no-input-selected')\n                    .hide();\n            }\n        }\n        self.deferred.resolve();\n    }\n\n    if (formbuilder.render_action === consts.RENDER_ACTION_DO) {\n        //we are rendering an existing project, so switch dom references to top level form which is shown by default\n        formbuilder.current_form_index = 0;\n        formbuilder.current_form_ref = formbuilder.project_definition.data.project.forms[0].ref;\n        //form_factory.unbindFormPanelsEvents();\n        form_factory.updateFormbuilderDomReferences(formbuilder.project_definition.data.project.forms[0].ref);\n\n        //hide add child form button if the form total is MAX_NUMBER_OF_NESTED_CHILD_FORMS\n        if (formbuilder.project_definition.data.project.forms.length === consts.MAX_NUMBER_OF_NESTED_CHILD_FORMS) {\n            formbuilder.dom.forms_tabs.find('.main__tabs_add-form').parent().hide();\n        }\n\n        self.deferred.resolve();\n    }\n};\n\nmodule.exports = initFormbuilder;\n\n\n","'use strict';\nvar consts = require('config/consts');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar formbuilder = require('config/formbuilder');\nvar input_factory = require('factory/input-factory');\nvar Input = require('factory/input-prototype');\nvar form_factory = require('factory/form-factory');\nvar template = require('template');\n\nvar renderChildForms = function (the_child_forms) {\n\n    var child_forms = the_child_forms;\n    var child_form = child_forms.shift();\n    var child_inputs;\n    var self = this;\n\n    formbuilder.current_form_index++;\n\n    //render child form\n    $.when(form_factory.createChildForm(child_form.name, child_form.ref, formbuilder.current_form_index, false)).then(function () {\n\n        //append inputs and their properties panels\n        child_inputs = self.renderInputs(child_form.inputs);\n        //replace object literal inputs with newly generated ones via factory (i.e. using new) so they get the prototype\n        formbuilder.project_definition.data.project.forms[formbuilder.current_form_index].inputs = child_inputs.slice();\n\n        //remove no questions message\n        formbuilder.dom.inputs_collection.find('.input-properties__no-questions-message').addClass('hidden');\n\n        //hide properties panel buttons as no input is selected\n        formbuilder.dom.input_properties_buttons.fadeOut();\n\n        //render next child form recursively\n        if (child_forms.length > 0) {\n            self.renderChildForms(child_forms);\n        }\n        else {\n            self.initFormbuilder();\n        }\n    });\n\n};\n\nmodule.exports = renderChildForms;\n","'use strict';\nvar consts = require('config/consts');\nvar formbuilder = require('config/formbuilder');\nvar template = require('template');\n\nvar renderInputs = function (the_inputs) {\n\n    var self = this;\n    var inputs = the_inputs;\n    var html;\n    var properties;\n    var properties_panel_html;\n    var generated_inputs = [];\n    var input_collection_html = '';\n    var input_properties_panel_html = '';\n\n\n    $.each(inputs, function (index, input) {\n\n        var input_factory = require('factory/input-factory');\n\n        ///**\n        // * Loop all jumps to remove any \"has_valid_destination\" property\n        // * this was caused by a bug so a few projects have it.\n        // * Instead of hacking the db, we sanitise that here\n        // * so the next time they save the project is ok\n        // */\n        //$(input.jumps).each(function(jumpIndex, jump){\n        //    delete jump.has_valid_destination;\n        //});\n\n        //create html element for input collection (middle column)\n        html = input_factory.createInputToolHTML(input);\n        input_collection_html += html;\n\n        //copy input properties from stored input\n        properties = JSON.parse(JSON.stringify(input));\n\n        //generate new input with attached prototype\n        input = input_factory.createInput(properties.type, properties.ref);\n\n        //on load (when loading an existing project)\n        if (formbuilder.render_action === consts.RENDER_ACTION_DO) {\n            console.log('render on load');\n            //set input as valid, as it is generated as invalid by default\n            input.dom.is_valid = true;\n        }\n\n        //set input properties to stored input properties (only the one saved in the project definition, leave the others intact)\n        for (var property in input) {\n            if (properties.hasOwnProperty(property)) {\n                input[property] = properties[property];\n            }\n        }\n\n        //override 'global' input obj literal with newly created\n        formbuilder.project_definition.data.project.forms[formbuilder.current_form_index].inputs[index] = input;\n\n        //if it is a branch, loop all the branch inputs (there must be at least a branch input)\n        if (input.type === consts.BRANCH_TYPE) {\n\n            //set edit branch to true when rendering from a saved project,\n            //because we are re-using functions that expects this flag to be true\n            formbuilder.is_editing_branch = true;\n            formbuilder.branch.active_branch_header = input.question;\n            formbuilder.branch.active_branch_ref = input.ref;\n\n            var branch_inputs_html = self.getBranchInputsHTML(input, index);\n            input_collection_html = input_collection_html.replace('{{branch-content}}', branch_inputs_html.collection);\n            input_properties_panel_html += branch_inputs_html.panels;\n\n            //reset edit branch flag\n            formbuilder.is_editing_branch = false;\n            formbuilder.branch.active_branch_ref = null;\n            formbuilder.branch.active_branch_ref = null;\n        }\n\n        //if it is a group, loop all the group inputs (there must be at least a group input)\n        if (input.type === consts.GROUP_TYPE) {\n\n            formbuilder.is_editing_group = true;\n            //todo should I set active group header and active group ref?\n            //todo maybe because I do nit have jumps in groups?\n\n            var group_inputs_html = self.getGroupInputsHTML(input, index, null);\n            input_collection_html = input_collection_html.replace('{{group-content}}', group_inputs_html.collection);\n            input_properties_panel_html += group_inputs_html.panels;\n\n            formbuilder.is_editing_group = false;\n        }\n\n        //per each input with possible answers keep track of pagination\n        if (consts.MULTIPLE_ANSWER_TYPES.indexOf(input.type) > -1) {\n            //we have possible answers\n            formbuilder.possible_answers_pagination[input.ref] = {};\n            formbuilder.possible_answers_pagination[input.ref].page = 1;\n        }\n        //create properties panel for current input\n        properties_panel_html = template.getInputPropertiesPanelHTML(input);\n        input_properties_panel_html += properties_panel_html;\n\n        //hide panels as by default no inputs are selected\n        formbuilder.dom.input_properties.find('.panel-body form').hide();\n\n        //save newly generated input\n        generated_inputs.push(input);\n    });\n\n    formbuilder.dom.inputs_collection_sortable.append(input_collection_html);\n    formbuilder.dom.input_properties_forms_wrapper.append(input_properties_panel_html);\n\n    return generated_inputs;\n};\n\nmodule.exports = renderInputs;\n","'use strict';\nvar consts = require('config/consts');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar formbuilder = require('config/formbuilder');\nvar input_factory = require('factory/input-factory');\nvar form_factory = require('factory/form-factory');\nvar Input = require('factory/input-prototype');\nvar template = require('template');\nvar validation = require('actions/validation');\n\nvar renderProject = function (project_definition) {\n\n    var self = this;\n    var forms = project_definition.data.project.forms.slice();//need a deep copy\n    var inputs;\n\n    self.deferred = new $.Deferred();\n\n    //if undoing, reset formbuilder on top parent form\n    if (formbuilder.render_action === consts.RENDER_ACTION_UNDO) {\n        console.log('resetting references to top parent form');\n        form_factory.updateFormbuilderDomReferences(forms[0].ref);\n    }\n\n    //render top parent form by default as the formbuilder loads.\n    formbuilder.current_form_index = 0;\n    inputs = self.renderInputs(forms[0].inputs);\n\n    //remove no questions message (if any inputs)\n    if (inputs.length > 0) {\n        formbuilder.dom.inputs_collection.find('.input-properties__no-questions-message').addClass('hidden');\n    }\n\n    //show no title warning (if no title set for the first form and we have inputs)\n    if (utils.getTitleCount(inputs) === 0 && inputs.length > 0) {\n        ui.inputs_collection.toggleTitleWarning(0, false);\n    }\n\n    //toggle form icon to a green chck if the top parent form is valid\n    if (validation.areFormInputsValid(0)) {\n        ui.forms_tabs.showFormValidIcon(0);\n\n        //enable download form button\n        formbuilder.dom.inputs_collection\n            .find('.inputs-collection__export-form').removeClass('disabled');\n\n        //enable print as pdf form button\n        formbuilder.dom.inputs_collection\n            .find('.inputs-collection__print-as-pdf').removeClass('disabled');\n    }\n\n    //if no inputs, disable download form button\n    if (inputs.length === 0) {\n        formbuilder.dom.inputs_collection\n            .find('.inputs-collection__export-form').addClass('disabled');\n\n        //disable print as pdf\n        formbuilder.dom.inputs_collection\n            .find('.inputs-collection__print-as-pdf').addClass('disabled');\n    }\n    else {\n        formbuilder.dom.inputs_collection\n            .find('.inputs-collection__export-form').removeClass('disabled');\n\n        //enable print as pdf form button\n        formbuilder.dom.inputs_collection\n            .find('.inputs-collection__print-as-pdf').removeClass('disabled');\n    }\n\n    //replace object literal inputs with newly generated ones via factory (i.e. using new) so they get the prototype\n    formbuilder.project_definition.data.project.forms[0].inputs = inputs.slice();\n\n    //remove first form as it is already rendered\n    forms.shift();\n\n    //render child forms recursively (if any)\n    if (forms.length > 0) {\n        self.renderChildForms(forms);\n    }\n    else {\n        self.initFormbuilder();\n    }\n\n    return self.deferred.promise();\n};\n\nmodule.exports = renderProject;\n","/* global $, toastr, Papa*/\n'use strict';\nvar formbuilder = require('config/formbuilder');\nvar toast = require('config/toast');\nvar consts = require('config/consts');\nvar messages = require('config/messages');\nvar getPossibleAnswerPage = require('template/methods/getPossibleAnswersPage');\n\nvar possible_answers_pager = {\n\n    init: function (input) {\n\n        var self = this;\n        var pager = formbuilder.dom.input_properties\n            .find('.panel-body form[data-input-ref=\"' + input.ref + '\"]')\n            .find('.possible-answers__list_pager');\n        var page = formbuilder.possible_answers_pagination[input.ref].page;\n        var total = Math.ceil(input.possible_answers.length / consts.LIMITS.possible_answers_per_page);\n\n        pager.removeClass('hidden');\n        pager.find('.possible-answers__list_pager__current')\n            .html(page);\n        pager.find('.possible-answers__list_pager__total')\n            .html(total);\n\n        //attach handlers to pagination buttons\n        var prev_btn = pager.find('.possible-answers__list_pager__prev');\n        var next_btn = pager.find('.possible-answers__list_pager__next');\n\n        //when the pager is shown, set min-height on parent container\n        formbuilder.dom.input_properties\n            .find('.panel-body form[data-input-ref=\"' + input.ref + '\"]')\n            .find('.input-properties__form__possible-answers__list')\n            .parent().css('min-height', '325px');\n\n        var was_clicked = false;\n        next_btn.off().on('click', function () {\n\n            console.log('next button clicked');\n            var next_page;\n\n            //validate answers currently in the dom\n            //if any error, warn user instead of changing page\n            //so the user has the chance to fix them\n            if (!self.areValidPossibleAnswersInDOM(input)) {\n                //show error\n                toast.showError(messages.error.POSSIBLE_ANSWERS_INVALID);\n                return false;\n            }\n\n            if (!was_clicked) {\n                was_clicked = true;\n\n                //save possible answers currently on the dom\n                input.savePossibleAnswers();\n\n                if (formbuilder.possible_answers_pagination[input.ref].page < total) {\n                    //show next possible answers page in dom\n                    next_page = formbuilder.possible_answers_pagination[input.ref].page + 1;\n                    formbuilder.possible_answers_pagination[input.ref].page = next_page;\n\n                    getPossibleAnswerPage(input, next_page);\n\n                    //update dom with current page\n                    pager.find('.possible-answers__list_pager__current')\n                        .html(next_page);\n\n                    //restore button functionality\n                    window.setTimeout(function () {\n                        was_clicked = false;\n                    }, consts.ANIMATION_SLOW)\n                }\n                else {\n                    was_clicked = false;\n                }\n            }\n        });\n\n        prev_btn.off().on('click', function () {\n            console.log('prev button clicked');\n            //show next possible answers page in dom\n            var prev_page;\n\n            if (!self.areValidPossibleAnswersInDOM(input)) {\n                //show error\n                toast.showError(messages.error.POSSIBLE_ANSWERS_INVALID);\n                return false;\n            }\n\n            if (!was_clicked) {\n                was_clicked = true;\n\n                //save possible answers currently on the dom\n                input.savePossibleAnswers();\n\n                if (formbuilder.possible_answers_pagination[input.ref].page > 1) {\n                    prev_page = formbuilder.possible_answers_pagination[input.ref].page - 1;\n                    formbuilder.possible_answers_pagination[input.ref].page = prev_page;\n\n                    getPossibleAnswerPage(input, prev_page);\n\n                    //update dom with current page\n                    pager.find('.possible-answers__list_pager__current')\n                        .html(prev_page);\n\n                    //restore button functionality\n                    window.setTimeout(function () {\n                        was_clicked = false\n                    }, consts.ANIMATION_SLOW);\n                }\n            }\n            else {\n                was_clicked = false;\n            }\n        });\n    },\n\n    //hide pager and restore possible answers container height\n    tearDown: function (input) {\n\n        var pager = formbuilder.dom.input_properties\n            .find('.panel-body form[data-input-ref=\"' + input.ref + '\"]')\n            .find('.possible-answers__list_pager');\n\n        //restore height\n        formbuilder.dom.input_properties\n            .find('.panel-body form[data-input-ref=\"' + input.ref + '\"]')\n            .find('.input-properties__form__possible-answers__list')\n            .parent().css('min-height', 'auto');\n\n        pager.addClass('hidden');\n\n        formbuilder.possible_answers_pagination[input.ref].page = 1;\n    },\n\n    areValidPossibleAnswersInDOM: function (input) {\n        var are_possible_answers_valid = true;\n        var properties_panel = formbuilder.dom.input_properties_forms_wrapper.find('form[data-input-ref=\"' + input.ref + '\"]');\n        var possible_answers = properties_panel.find('.input-properties__form__possible-answers div ul.input-properties__form__possible-answers__list li');\n\n        possible_answers.each(function (index, possible_answer) {\n\n            var current_input = $(possible_answer).find('div input');\n            var answer = current_input.val();\n\n            //strip html tags (angle brackets)\n            answer = answer.replace(/[<>]/ig, '');\n\n            if (answer === '') {\n                are_possible_answers_valid = false;\n                return false;\n            }\n\n        });\n\n        return are_possible_answers_valid;\n    },\n\n    recalculatePagination: function (input) {\n\n        //get current page and total of possibe answers\n        var page = formbuilder.possible_answers_pagination[input.ref].page;\n        var total = Math.ceil(input.possible_answers.length / consts.LIMITS.possible_answers_per_page);\n\n        var pager = formbuilder.dom.input_properties\n            .find('.panel-body form[data-input-ref=\"' + input.ref + '\"]')\n            .find('.possible-answers__list_pager');\n\n        pager.find('.possible-answers__list_pager__current')\n            .html(page);\n        pager.find('.possible-answers__list_pager__total')\n            .html(total);\n\n        //hide pager if not needed\n        if (input.possible_answers.length <= consts.LIMITS.possible_answers_per_page) {\n            pager.addClass('hidden');\n        }\n    },\n\n    recalculatePossibleAnswersDOM: function (input) {\n\n        var self = this;\n        var possible_answers_list = input.dom.properties_panel\n            .find('.input-properties__form__possible-answers div ul.input-properties__form__possible-answers__list');\n        var possible_answers = possible_answers_list.find('li');\n        var lookup_index;\n        var possible_answer_to_append;\n        var list_item;\n        var prev_page;\n        var current_page = formbuilder.possible_answers_pagination[input.ref].page;\n\n        /*add one answer to the bottom to fill the page (if any)\n        here we are checking the possible answers currently on the dom\n        this is the case where the user remove the 100th answer from the dom and we have more answers\n        to show\n        * */\n        if (possible_answers.length === (consts.LIMITS.possible_answers_per_page - 1)) {\n\n            if (input.possible_answers.length > possible_answers.length) {\n\n                //append answer to the bottom of current page\n                lookup_index = (consts.LIMITS.possible_answers_per_page * current_page) - 1;\n                possible_answer_to_append = input.possible_answers[lookup_index];\n\n                //build markup\n                list_item = formbuilder.dom.partials.possible_answer_list_item;\n                list_item = list_item.replace('{{answer}}', possible_answer_to_append.answer);\n                list_item = list_item.replace('{{answer-ref}}', possible_answer_to_append.answer_ref);\n\n                //append to dom\n                possible_answers_list.append(list_item);\n\n                //update pagination\n                self.recalculatePagination(input);\n            }\n        }\n\n        /*\n        if the possible answers in the dom is 0, it means the user removed all the answers\n        from the dom, therefore we have to\n        * */\n        if (possible_answers.length === 0) {\n\n            //go to previous page\n            formbuilder.possible_answers_pagination[input.ref].page--;\n            prev_page = formbuilder.possible_answers_pagination[input.ref].page;\n            getPossibleAnswerPage(input, prev_page);\n\n            //update pagination buttons\n            self.recalculatePagination(input);\n        }\n    }\n};\n\nmodule.exports = possible_answers_pager;\n","/* global $, toastr, Papa*/\n'use strict';\nvar formbuilder = require('config/formbuilder');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar consts = require('config/consts');\nvar validation = require('actions/validation');\nvar import_form_validation = require('helpers/import-form-validation');\nvar messages = require('config/messages');\nvar toast = require('config/toast');\nvar confirm_import_callback = require('ui-handlers/event-handler-callbacks/confirm-import-possible-answers-callback');\nvar getPossibleAnswerPage = require('template/methods/getPossibleAnswersPage');\nvar possible_answers_pager = require('actions/possible-answers-pager');\nvar save_project_click_callback = require('ui-handlers/event-handler-callbacks/save-project-click-callback');\nvar getPossibleAnswersList = require('template/methods/getPossibleAnswersList');\nvar undo = require('actions/undo');\n\nvar possible_answers = {\n\n    addPossibleAnswer: function (the_input) {\n\n        var input = the_input;\n        var possible_answers_list;\n        var answer_ref;\n        var list_item = formbuilder.dom.partials.possible_answer_list_item;\n        var properties_panel = formbuilder.dom.input_properties_forms_wrapper.find('form[data-input-ref=\"' + input.ref + '\"]');\n        var possible_answers;\n        var areAllPOssibleAnswersValidinDom = true;\n\n        possible_answers_list = properties_panel\n            .find('.input-properties__form__possible-answers div ul.input-properties__form__possible-answers__list');\n\n        //Validate answers currently in dom\n        possible_answers = possible_answers_list.find('li div input');\n        possible_answers.each(function (index, possible_answer) {\n            if (!validation.isPossibleAnswerValid($(possible_answer).val()).is_valid) {\n                areAllPOssibleAnswersValidinDom = false;\n                return false;\n            }\n        });\n\n        //warn user if there is any error to fix, and exit\n        if (!areAllPOssibleAnswersValidinDom) {\n            toast.showError(messages.error.POSSIBLE_ANSWER_EMPTY);\n            return;\n        }\n\n        //when there is more than 1 possible answers, enable all remove buttons\n        possible_answers_list.find('li div span button').prop('disabled', false);\n\n        //prepare dom for possible answer list item\n        //generate uniqid here and append it to the dom to be used later\n        answer_ref = utils.generateUniqID();\n\n        list_item = list_item.replace('{{answer}}', consts.POSSIBILE_ANSWER_PLACEHOLDER);\n        list_item = list_item.replace('{{answer-ref}}', answer_ref);\n\n        //load html snippet based on input type\n\n        //do we have pagination?\n        if (input.possible_answers.length >= consts.LIMITS.possible_answers_per_page) {\n\n            //ok, so go to last possible answers page\n            //todo check user is not there already\n            var last_page = Math.ceil((input.possible_answers.length + 1) / (consts.LIMITS.possible_answers_per_page));\n\n            //save answers currently in the dom\n            input.savePossibleAnswers();\n\n            //update global flag to keep track of pagination\n            formbuilder.possible_answers_pagination[input.ref].page = last_page;\n            getPossibleAnswerPage(input, last_page);\n\n            //Get updated list\n            possible_answers = properties_panel\n                .find('.input-properties__form__possible-answers div ul.input-properties__form__possible-answers__list li');\n\n            //Append answer to current list if there is any room,\n            //otherwise create new page\n            if (possible_answers.length > (consts.LIMITS.possible_answers_per_page - 1)) {\n                //go to a brand new page\n                getPossibleAnswerPage(input, (last_page + 1));\n                possible_answers = properties_panel\n                    .find('.input-properties__form__possible-answers div ul.input-properties__form__possible-answers__list li ');\n            }\n\n            possible_answers_list.append(list_item).fadeIn(consts.ANIMATION_FAST);\n\n            //save the new answer (both dom and input object)\n            input.possible_answers.push({\n                answer: consts.POSSIBILE_ANSWER_PLACEHOLDER,\n                answer_ref: answer_ref\n            });\n            input.savePossibleAnswers();\n\n            //show pager\n            possible_answers_pager.init(input);\n\n            //update pagination\n            possible_answers_pager.recalculatePagination(input);\n        }\n        else {\n            possible_answers_list.append(list_item).fadeIn(consts.ANIMATION_FAST);\n            input.savePossibleAnswers();\n        }\n\n        //if max number of allowed possible answers reached, disable \"Add answer\" button\n        switch (input.type) {\n            case consts.SEARCH_SINGLE_TYPE:\n            case consts.SEARCH_MULTIPLE_TYPE:\n                //up to 1000\n                if\n                (input.possible_answers.length >= consts.LIMITS.possible_answers_max_search) {\n                    ui.input_properties_panel.toggleAddAnswerBtn(true);\n                }\n                break;\n            case consts.CHECKBOX_TYPE:\n            case consts.RADIO_TYPE:\n            case consts.DROPDOWN_TYPE:\n                //up to 300\n\n                if\n                (input.possible_answers.length >= consts.LIMITS.possible_answers_max) {\n                    ui.input_properties_panel.toggleAddAnswerBtn(true);\n                }\n                break;\n            default:\n            //do nothing\n        }\n    },\n\n    removePossibleAnswer: function (the_input, the_answer_index_dom) {\n\n        var input = the_input;\n        var answer_index_dom = the_answer_index_dom;\n        var possible_answers_list;\n        var possible_answers;\n        var current_page = formbuilder.possible_answers_pagination[input.ref].page;\n\n        input.dom.properties_panel = formbuilder.dom.input_properties_forms_wrapper.find('form[data-input-ref=\"' + input.ref + '\"]');\n\n        possible_answers_list = input.dom.properties_panel\n            .find('.input-properties__form__possible-answers div ul.input-properties__form__possible-answers__list');\n        possible_answers = possible_answers_list.find('li');\n\n        /* check if the possible answer has got a jump attached\n         if so, the jump will be dropped so ask the user to confirm action\n         */\n        //todo check if the jump is just dropped\n\n        //do not do anything if there is only 1 possible answer\n        if (input.possible_answers.length === 1) {\n            return;\n        }\n\n        //if 'possible_answers' length is 2, after removing the element disable the one left, so we have at least 1 possible answer\n        possible_answers.eq(answer_index_dom).fadeOut(200, function () {\n\n            //get possible answer index offset based on what page we are showing in the DOM\n            var offset = (current_page - 1) * consts.LIMITS.possible_answers_per_page;\n\n            //remove from dom\n            $(this).remove();\n\n            //remove answer from project definition\n            input.possible_answers.splice(offset + answer_index_dom, 1);\n\n            if (input.possible_answers.length === 1) {\n                possible_answers_list.find('li div span button').prop('disabled', true);\n            }\n\n            //if max number of allowed possible answers reached, disable \"Add answer\" button\n            switch (input.type) {\n                case consts.SEARCH_SINGLE_TYPE:\n                case consts.SEARCH_MULTIPLE_TYPE:\n                    //up to 1000\n                    if\n                    (input.possible_answers.length < consts.LIMITS.possible_answers_max_search) {\n                        ui.input_properties_panel.toggleAddAnswerBtn(false);\n                    }\n                    //update possible answers in dom (when needed)\n                    possible_answers_pager.recalculatePossibleAnswersDOM(input);\n                    break;\n                case consts.CHECKBOX_TYPE:\n                case consts.RADIO_TYPE:\n                case consts.DROPDOWN_TYPE:\n                    //up to 300\n                    if\n                    (input.possible_answers.length < consts.LIMITS.possible_answers_max) {\n                        ui.input_properties_panel.toggleAddAnswerBtn(false);\n                    }\n                    //update possible answers in dom (when needed)\n                    possible_answers_pager.recalculatePossibleAnswersDOM(input);\n\n                    input.updatePossibleInitialAnswers();\n                    break;\n                default:\n                //do nothing\n            }\n\n            //todo check what this does here, when removing an answer?\n            // input.savePossibleAnswers();\n\n        });\n    },\n\n    updateJumpPossibleAnswers: function (the_input, the_jump_panel) {\n\n        var input = the_input;\n        var jump_panel = the_jump_panel;\n        var i;\n        var iLength = input.possible_answers.length;\n\n        //find answer <select>(s)\n        var selects_to_target = jump_panel\n            .find('.input-properties__form__jumps__list .input-properties__form__jumps__list-item .input-properties__form__jumps__logic--answer select');\n\n        selects_to_target.each(function (index) {\n\n            var target = $(this);\n            var selected_option = target.find('option:selected');\n            var current_selected_answer_id = window.parseInt(selected_option.val(), 10);\n\n            //get the updated answer text from \"possible answers\"\n            for (i = 0; i < iLength; i++) {\n                if (current_selected_answer_id === input.possible_answers[i].answer_id) {\n                    selected_option.text(current_selected_answer_id + ' - ' + input.possible_answers[i].answer);\n                }\n\n            }\n            console.log($(this).attr('id'));\n            console.log($(this).find('option:selected').val());\n        });\n    },\n\n    //get selected possible answer and save it in the input object as the default answer\n    updatePossibleInitialAnswers: function (the_input) {\n        var input = the_input;\n        var possible_initial_answers_list;\n        var selected_answer;\n\n        input.dom.advanced_properties_wrapper = formbuilder\n            .dom\n            .input_properties_forms_wrapper\n            .find('form[data-input-ref=\"' + input.ref + '\"]')\n            .find('.input-properties__form__advanced-properties');\n\n        possible_initial_answers_list = input.dom.advanced_properties_wrapper.find('div.panel-body div.input-properties__form__advanced-properties__default select');\n\n        selected_answer = possible_initial_answers_list.find('option:selected');\n\n        input.default = selected_answer.val();\n\n    },\n\n    listPossibleInitialAnswers: function (the_input) {\n\n        var input = the_input;\n        var possible_answers;\n        var possible_initial_answers_list;\n        var value;\n        var answer_ref;\n        var selected = '';\n\n        input.dom.properties_panel = formbuilder.dom.input_properties_forms_wrapper.find('form[data-input-ref=\"' + input.ref + '\"]');\n        possible_answers = input.dom\n            .properties_panel\n            .find('.input-properties__form__possible-answers .panel-body ul.input-properties__form__possible-answers__list li');\n\n\n        input.dom.advanced_properties_wrapper = formbuilder\n            .dom\n            .input_properties_forms_wrapper\n            .find('form[data-input-ref=\"' + input.ref + '\"]')\n            .find('.input-properties__form__advanced-properties');\n\n        possible_initial_answers_list = input.dom.advanced_properties_wrapper.find('div.panel-body div.input-properties__form__advanced-properties__default select');\n\n        //empty list and re-append items todo maybe too expensive, find a better way\n        possible_initial_answers_list.empty();\n\n        //append 'none' selection, using index 0 as nothing has been selected\n        possible_initial_answers_list.append('<option value=\"\">None</option>');\n\n        possible_answers.each(function (index) {\n\n            value = $(this).find('div input').val();\n\n            //get answer ref based on the index of option in the dom todo does it work?\n            answer_ref = input.possible_answers[index].answer_ref;\n\n            //pre select previously saved option\n            selected = (answer_ref === input.default) ? 'selected' : '';\n\n            possible_initial_answers_list.append('<option value=\"' + answer_ref + '\" ' + selected + ' >' + value + '</option>');\n        });\n    },\n\n    exportPossibleAnswersCSV: function () {\n\n        var input;\n        var answers = [];\n        var filename;\n\n        input = utils.getActiveInput();\n\n        //abort if no possible answers\n        if (input.possible_answers.length === 0) {\n            return false;\n        }\n\n        //abort if possible answers are invalid\n        if (!import_form_validation.arePossibleAnswersValid(input.possible_answers, input.type)) {\n            return false;\n        }\n\n        //filename gets very long if we use the input ref...so we do not\n        filename = input.question.trunc(20) + '__possible_answers.csv';\n\n        $(input.possible_answers).each(function (index, possible_answer) {\n            answers[index] = [possible_answer.answer];\n        });\n\n        // Specifying fields and data explicitly\n        var csv = Papa.unparse({\n            fields: [input.question],\n            data: answers\n        }, {\n            quotes: false,\n            quoteChar: '',\n            delimiter: ',',\n            header: true,\n            newline: '\\r\\n'\n        });\n\n        return {\n            data: csv,\n            filename: filename\n        };\n    },\n\n    importCSVFile: function (files) {\n\n        var file = files[0];\n        var file_parts;\n        var file_ext;\n        var getPossibleAnswersHTML = require('template/methods/getPossibleAnswersHTML');\n\n        //show overlay and cursor\n        formbuilder.dom.overlay.fadeIn(0);\n\n        formbuilder.isOpeningFileBrowser = false;\n\n        //if the user cancels the action\n        if (!file) {\n            //hide overlay\n            formbuilder.dom.overlay.fadeOut(consts.ANIMATION_FAST);\n            toastr.error(messages.error.CSV_FILE_INVALID);\n            return;\n        }\n\n        file_parts = file.name.split('.');\n        file_ext = file_parts[file_parts.length - 1];\n\n        //it must be csv\n        if (file_ext !== consts.CSV_FILE_EXTENSION) {\n            //hide overlay\n            formbuilder.dom.overlay.fadeOut(consts.ANIMATION_FAST);\n            toastr.error(messages.error.CSV_FILE_INVALID);\n            return;\n        }\n        //file is valid, let's parse it\n        var reader = new FileReader();\n\n        reader.onload = function (e) {\n\n            var content = e.target.result;\n            var json = Papa.parse(content, { header: true, delimiter: ',' });\n            var headers = json.meta.fields;\n            var undo = require('actions/undo');//it is here otherwise it breaks when compiling...go figure??\n            var modal = $('#csv-import-possible_answers');\n\n            if (json.data.length === 0) {\n                //empty csv file, show error\n                formbuilder.dom.overlay.fadeOut(consts.ANIMATION_FAST);\n                toastr.error(messages.error.CSV_FILE_INVALID);\n                return;\n            }\n\n            //todo show modal asking which colums and whether to replace or not the existing possible answers\n            modal.modal();\n\n            modal.off().on('shown.bs.modal', function () {\n\n                var column_picker = $('#csv-import-possible_answers').find('.possible-answers-column-picker');\n                var column_items = '';\n                var selectedHeaderIndex = null;\n                var params;\n                var userWantstoReplaceAnswers;\n                var doesFirstRowContainsHeaders;\n                var possible_answers_max = consts.LIMITS.possible_answers_max;\n                var input = utils.getActiveInput();\n\n                if (input.type === consts.SEARCH_SINGLE_TYPE || input.type === consts.SEARCH_MULTIPLE_TYPE) {\n                    possible_answers_max = consts.LIMITS.possible_answers_max_search;\n                }\n\n                //reset column picker\n                column_picker.find('.btn').html('Pick column' + ' <span class=\"caret\"></span>');\n                column_picker.find('.btn').val('');\n\n                //reset other controls\n                modal.find('.possible_answers__first-row-headers input').prop('checked', true);\n\n                modal.find('.possible_answers__append-or-replace input#replace').prop('checked', true);\n\n                //disable import button\n                modal.find('.possible_answers-perform-import').attr('disabled', true);\n\n                formbuilder.dom.overlay.fadeOut(consts.ANIMATION_FAST);\n\n                //show list of headers so the user can select which column to use\n                //generate list items\n                $(headers).each(function (headerIndex, header) {\n                    column_items += '<li>';\n                    column_items += '<a href=\"#\">' + header.trunc(25) + '</a>';\n                    column_items += '</li>';\n                });\n\n                //append items\n                column_picker.find('.dropdown-menu').empty().append(column_items);\n\n                //show selected colun in dropdown picker\n                column_picker.find('.dropdown-menu li').off().on('click', function () {\n                    $(this).parents('.possible-answers-column-picker').find('.btn').html($(this).text() + ' <span class=\"caret\"></span>');\n                    $(this).parents('.possible-answers-column-picker').find('.btn').val($(this).data('value'));\n\n                    selectedHeaderIndex = $(this).index();\n\n                    //enable import button\n                    modal.find('.possible_answers-perform-import').attr('disabled', false);\n                });\n\n\n                $('.possible_answers-perform-import').off().on('click', function () {\n\n                    //show overlay and cursor\n                    formbuilder.dom.overlay.fadeIn(0);\n\n                    //get parameters from modal\n                    userWantstoReplaceAnswers = modal.find('.possible_answers__append-or-replace').find('#replace').is(':checked');\n                    doesFirstRowContainsHeaders = modal.find('.possible_answers__first-row-headers').find('.checkbox input').is(':checked');\n\n                    //add callback to handle the import\n                    params = {\n                        userWantstoReplaceAnswers: userWantstoReplaceAnswers,\n                        doesFirstRowContainsHeaders: doesFirstRowContainsHeaders,\n                        input: input,\n                        importedJson: json,\n                        selectedHeaderIndex: selectedHeaderIndex\n                    };\n\n                    if (confirm_import_callback(params)) {\n\n                        modal.modal('hide');\n\n                        //if max number of allowed possible answers reached, disable \"Add answer\" button\n                        ui.input_properties_panel\n                            .toggleAddAnswerBtn(input.possible_answers.length >= possible_answers_max);\n\n                        //recalculate pagination\n                        possible_answers_pager.recalculatePagination(input);\n\n                        //enable save project button if all inputs are valid\n                        if (validation.areAllInputsValid(formbuilder.project_definition)) {\n                            //enable save project button (if disabled)\n                            ui.navbar.toggleSaveProjectBtn(consts.BTN_ENABLED);\n                            formbuilder.dom.save_project_btn.off().on('click', save_project_click_callback);\n                        }\n\n                        //hide overlay\n                        window.setTimeout(function () {\n                            formbuilder.dom.overlay.fadeOut(consts.ANIMATION_FAST);\n\n                            //show toast confirm\n                            toast.showSuccess(messages.success.POSSIBLE_ANSWERS_IMPORTED);\n\n                            //push state to enable undoing the action (typing) passing \"true\" so it gets a bit of throttling\n                            undo.pushState(false);\n\n                        }, consts.ANIMATION_SUPER_SLOW);\n                    }\n                    else {\n                        window.setTimeout(function () {\n                            //hide overlay\n                            formbuilder.dom.overlay.fadeOut(consts.ANIMATION_FAST);\n                            //show error/warning\n                            toast.showError(messages.error.POSSIBLE_ANSWERS_INVALID);\n                        }, consts.ANIMATION_SUPER_SLOW);\n                    }\n                });\n            });\n\n            //add events to hide the modal manually (was nt working, go figure)\n            modal.find('button[data-dismiss=\"modal\"]').one('click', function () {\n                modal.modal('hide');\n            });\n        };\n\n        reader.readAsText(file);\n    },\n\n    orderPossibleAnswers: function (order_type) {\n        //get current input object\n        var input = utils.getActiveInput();\n        var possible_answers = input.possible_answers;\n\n        formbuilder.possible_answers_pagination[input.ref].page = 1;\n        //show overlay and cursor\n        formbuilder.dom.overlay.fadeIn(0);\n\n        switch(order_type) {\n            //order A - Z for UTF-8 languages\n            case consts.POSSIBLE_ANSWERS_ORDER.AZ:\n                possible_answers = possible_answers.sort(function (a, b) {\n                    return a.answer.localeCompare(b.answer, undefined, {\n                        ignorePunctuation: true,\n                        numeric:true\n                    });\n                });\n                break;\n            //order Z - A for UTF-8 languages\n            case consts.POSSIBLE_ANSWERS_ORDER.ZA:\n                possible_answers = possible_answers.sort(function (a, b) {\n                    return b.answer.localeCompare(a.answer, undefined, {\n                        ignorePunctuation: true,\n                        numeric:true\n                    });\n                });\n                break;\n            case consts.POSSIBLE_ANSWERS_ORDER.SHUFFLE:\n                possible_answers = utils.shuffleArray(possible_answers);\n                break;\n        }\n\n        var ordered_list_html = getPossibleAnswersList(possible_answers);\n        var possible_answers_list;\n        var properties_panel = formbuilder.dom.input_properties_forms_wrapper.find('form[data-input-ref=\"' + input.ref + '\"]');\n\n        possible_answers_list = properties_panel\n            .find('.input-properties__form__possible-answers div ul.input-properties__form__possible-answers__list');\n\n        //remove current answers from dom and append ordered ones\n        possible_answers_list\n            .empty()\n            .hide()\n            .append(ordered_list_html)\n            .fadeIn(consts.ANIMATION_FAST);\n\n        //recalculate pagination\n        possible_answers_pager.recalculatePagination(input);\n\n        //push state to enable undoing the action (typing) passing \"true\" so it gets a bit of throttling\n        undo.pushState(false);\n\n        //enable save project button as user made a change\n        ui.navbar.toggleSaveProjectBtn(consts.BTN_ENABLED);\n        formbuilder.dom.save_project_btn.off().on('click', save_project_click_callback);\n\n        //hide overlay\n        window.setTimeout(function () {\n            formbuilder.dom.overlay.fadeOut(consts.ANIMATION_FAST);\n        }, consts.ANIMATION_SUPER_SLOW);\n\n    },\n\n    deleteAllAnswers: function () {\n\n        var input;\n        var answer_ref = utils.generateUniqID();\n        var undo = require('actions/undo');//it is here otherwise it breaks when compiling...go figure??\n\n        //show overlay and cursor\n        formbuilder.dom.overlay.fadeIn(0);\n\n        //get current input object\n        input = utils.getActiveInput();\n\n        var possible_answers_list;\n        var list_item = formbuilder.dom.partials.possible_answer_list_item;\n        var properties_panel = formbuilder.dom.input_properties_forms_wrapper.find('form[data-input-ref=\"' + input.ref + '\"]');\n\n        possible_answers_list = properties_panel\n            .find('.input-properties__form__possible-answers div ul.input-properties__form__possible-answers__list');\n\n        list_item = list_item.replace('{{answer}}', consts.POSSIBILE_ANSWER_PLACEHOLDER);\n        list_item = list_item.replace('{{answer-ref}}', answer_ref);\n        list_item = list_item.replace('{{disabled}}', consts.DISABLED_STATE);\n\n\n        //load html snippet based on input type\n        possible_answers_list.empty().hide().append(list_item).fadeIn(consts.ANIMATION_FAST);\n\n        //reset array of possible answers to 1 single default element\n        input.possible_answers = [{\n            answer_ref: utils.generateUniqID(),\n            answer: consts.POSSIBILE_ANSWER_PLACEHOLDER\n        }];\n\n        //push state to enable undoing the action (typing) passing \"true\" so it gets a bit of throttling\n        undo.pushState(false);\n\n        //enable save project button (if disabled)\n        ui.navbar.toggleSaveProjectBtn(consts.BTN_ENABLED);\n        formbuilder.dom.save_project_btn.off().on('click', save_project_click_callback);\n\n        //enable add answer button\n        ui.input_properties_panel.toggleAddAnswerBtn(false);\n\n        //reset pagination\n        possible_answers_pager.tearDown(input);\n\n        //hide overlay\n        window.setTimeout(function () {\n            formbuilder.dom.overlay.fadeOut(consts.ANIMATION_FAST);\n        }, consts.ANIMATION_SUPER_SLOW);\n    }\n};\n\nmodule.exports = possible_answers;\n","/* global $*/\n'use strict';\nvar saveAllInputProperties = require('actions/save/module.saveAllInputProperties');\nvar saveProperties = require('actions/save/module.saveProperties');\nvar savePossibleAnswers = require('actions/save/module.savePossibleAnswers');\nvar saveAdvancedProperties = require('actions/save/module.saveAdvancedProperties');\nvar saveJumps = require('actions/save/module.saveJumps');\nvar saveUniqueness = require('actions/save/module.saveUniqueness');\nvar doCleaningBeforeSaving = require('actions/save/module.doCleaningBeforeSaving');\n\nvar save = {\n\n    saveUniqueness: function (the_input) {\n        return saveUniqueness(the_input);\n    },\n    saveAllInputProperties: function (the_input) {\n        return saveAllInputProperties(the_input);\n    },\n    saveProperties: function (the_input) {\n        return saveProperties(the_input);\n    },\n    savePossibleAnswers: function (the_input) {\n        return savePossibleAnswers(the_input);\n    },\n    saveAdvancedProperties: function (the_input) {\n        return saveAdvancedProperties(the_input);\n    },\n    saveJumps: function (the_input) {\n        return saveJumps(the_input);\n    },\n    doCleaningBeforeSaving: function (the_forms) {\n        return doCleaningBeforeSaving(the_forms);\n    }\n};\n\nmodule.exports = save;\n","/* global $*/\n'use strict';\nvar consts = require('config/consts');\nvar formbuilder = require('config/formbuilder');\nvar utils = require('helpers/utils');\n\n\nvar doCleaningBeforeSaving = function (forms) {\n\n    var invalid_jumps_question = '';\n    var all_jumps_valid = true;\n\n    $(forms).each(function (index, form) {\n        $(form.inputs).each(function (inputIndex, input) {\n\n            //remove Word Unicode chars from question (if any)\n            form.inputs[inputIndex].question = utils.replaceWordChars(input.question);\n\n            //get valid jump destinations\n            var jump_destinations = utils.getJumpAvailableDestinationsAsKeys(inputIndex, input, form.inputs, false);\n\n            //extra validation for jumps, check if the destination still exists and it is valid\n            $(input.jumps).each(function (jumpIndex, jump) {\n                //does the jump \"to\" property reference a valid destination input?\n                ////test: screw up the jump.to\n                // jump.to = 'sfdgg';\n\n                if (!jump_destinations[jump.to]) {\n                    //invalid destination found\n                    invalid_jumps_question = input.question;\n                    all_jumps_valid = false;\n                }\n\n                //remove any leftover extra property from jump (if any)\n                //hack to avoid huge refactoring and testing ;)\n                input.jumps[jumpIndex] = {\n                    to: jump.to,\n                    when: jump.when,\n                    answer_ref: jump.answer_ref\n                };\n            });\n\n            $(input.branch).each(function (branchInputIndex, branch_input) {\n                delete branch_input.dom;\n\n                //remove Word Unicode chars from question (if any)\n                input.branch[branchInputIndex].question = utils.replaceWordChars(branch_input.question);\n\n                //todo validate branch jumps\n                jump_destinations = utils.getJumpAvailableDestinationsAsKeys(branchInputIndex, branch_input, input.branch, true);\n\n                //extra validation for jumps, check if the destination still exists and it is valid\n                $(branch_input.jumps).each(function (branchJumpIndex, branchJump) {\n                    //does the jump \"to\" property reference a valid destination input?\n                    ////test: screw up the jump.to\n                    // branchJump.to = 'sfdgg';\n\n                    if (!jump_destinations[branchJump.to]) {\n                        //invalid destination found\n                        invalid_jumps_question = ' (branch) ' + branch_input.question;\n                        all_jumps_valid = false;\n                    }\n\n                    //remove any leftover extra property from jump (if any)\n                    //hack to avoid huge refactoring and testing ;)\n                    branch_input.jumps[branchJumpIndex] = {\n                        to: branchJump.to,\n                        when: branchJump.when,\n                        answer_ref: branchJump.answer_ref\n                    };\n                });\n\n                $(branch_input.group).each(function (index, group_input) {\n\n                    //remove Word Unicode chars from question (if any)\n                    branch_input.group[index].question = utils.replaceWordChars(group_input.question);\n\n                    delete group_input.dom;\n                });\n            });\n            $(input.group).each(function (index, group_input) {\n\n                //remove Word Unicode chars from question (if any)\n                input.group[index].question = utils.replaceWordChars(group_input.question);\n\n                delete group_input.dom;\n            });\n            console.log(' delete input.dom; called *******');\n            delete input.dom;\n        });\n    });\n\n    return {\n        invalid_jumps_question: invalid_jumps_question,\n        all_jumps_valid: all_jumps_valid\n    };\n};\n\nmodule.exports = doCleaningBeforeSaving;\n","/* global $*/\n'use strict';\nvar consts = require('config/consts');\nvar formbuilder = require('config/formbuilder');\n\n\nvar saveAdvancedProperties = function (input) {\n\n    var save = require('actions/save');\n    var initial_answer_validation;\n\n    input.dom.advanced_properties_wrapper = formbuilder\n        .dom\n        .input_properties_forms_wrapper\n        .find('form[data-input-ref=\"' + input.ref + '\"]')\n        .find('.input-properties__form__advanced-properties');\n\n    //clear all advanced properties errors from dom\n    input.hideAdvancedPropertiesErrors();\n\n\n    //set properties but skip if it is a readme\n    if (input.type !== consts.README_TYPE) {\n        //set default\n        input.default = input.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__default input').val();\n        input.default = input.default === '' ? null : input.default;\n\n        //strip html tags and reset input to sanitised value\n        if (input.default) {\n            input.default = input.default.replace(/(<([^>]+)>)/ig, '');\n            input.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__default input').val(input.default);\n        }\n\n        //set regex\n        input.regex = input.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__regex input').val();\n        input.regex = input.regex === '' ? null : input.regex;\n\n        //strip html tags and reset input to sanitised value\n        if (input.regex) {\n            input.regex = input.regex.replace(/(<([^>]+)>)/ig, '');\n            input.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__regex input').val(input.regex);\n        }\n\n        //set verification flag\n        input.verify = input.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__double-entry input').is(':checked');\n\n        /* get uniqueness flag */\n        save.saveUniqueness(input);\n\n    }\n\n    /****************************************************/\n\n    //validate initial answer\n    initial_answer_validation = input.isInitialAnswerValid();\n    if (!initial_answer_validation.is_valid) {\n        input.dom.is_valid = false;\n        //highlight wrong input\n        input.showAdvancedPropertiesErrors(consts.DEFAULT_PROPERTY, initial_answer_validation.error.message);\n    }\n};\n\nmodule.exports = saveAdvancedProperties;\n","/* global $*/\n'use strict';\nvar consts = require('config/consts');\nvar formbuilder = require('config/formbuilder');\nvar ui = require('helpers/ui');\n\nvar saveAllInputProperties = function (the_input) {\n\n    var input = the_input;\n    var ui = require('helpers/ui');\n    var utils = require('helpers/utils');\n    var validation = require('actions/validation');\n    var active_branch;\n    var active_group;\n    var branch_inputs_validation;\n    var group_inputs_validation;\n    var nested_group_owner_branch_validation;\n\n    //save basic properties\n    input.saveProperties();\n\n    //if the selected input is a multiple choice input, save possible answers\n    if (consts.MULTIPLE_ANSWER_TYPES.indexOf(input.type) !== -1) {\n        //todo we are testing performance\n        input.savePossibleAnswers();\n    }\n    //save advanced properties (not for media or branch or group types)\n    if (consts.MEDIA_ANSWER_TYPES.indexOf(input.type) === -1 && input.type !== consts.BRANCH_TYPE && input.type !== consts.GROUP_TYPE) {\n        input.saveAdvancedProperties();\n    }\n\n    //save jumps\n    // if (input.type !== consts.GROUP_TYPE) {\n    if (input.jumps.length > 0) {\n        input.saveJumps();\n    }\n\n    //save branch inputs if the branch input owner is valid (header is not empty)\n    if (input.type === consts.BRANCH_TYPE && input.dom.is_valid) {\n\n        //set header preview\n        ui.inputs_collection.showInputQuestionPreview(input.ref, input.question.trunc(50));\n\n        //branch inputs are already attached to the branch property, just validate them\n        //todo check this as I should do something if there is a valid/invalid one?\n        input.validateBranchInputs();\n    }\n\n    //save branch inputs if the branch input owner is valid (header is not empty)\n    if (input.type === consts.GROUP_TYPE && input.dom.is_valid) {\n\n        //set header preview\n        ui.inputs_collection.showInputQuestionPreview(input.ref, input.question.trunc(50));\n\n        //branch inputs are already attached to the branch property, just validate them\n        input.validateGroupInputs();\n    }\n\n    //if we are editing a nested group\n    if (formbuilder.is_editing_branch && formbuilder.is_editing_group) {\n\n        // if we are editing a nested group, and all the nested group inputs are valid,\n        // set the nested group input owner as valid and toggle valid icon for the owner group input\n        active_branch = utils.getInputObjectByRef(formbuilder.branch.active_branch_ref);\n        active_group = utils.getNestedGroupObjectByRef(active_branch, formbuilder.group.active_group_ref);\n        group_inputs_validation = validation.validateGroupInputs(active_group);\n\n        if (group_inputs_validation.is_valid) {\n            active_group.dom.is_valid = true;\n            ui.inputs_collection.showInputValidIcon(active_group.ref);\n\n            //if the nested group is valid, is the owner branch valid then?\n            nested_group_owner_branch_validation = active_branch.validateBranchInputs();\n\n            //todo do i need to do something here  based on the above result?\n\n        }\n        else {\n            ui.inputs_collection.showInputInvalidIcon(active_group.ref);\n            active_group.dom.is_valid = false;\n        }\n    }\n    else {\n\n\n        // if we are editing a branch, and all the active branch inputs are valid,\n        // set the branch input owner as valid and toggle valid icon for the owner branch input\n        if (formbuilder.is_editing_branch) {\n\n            //get current active branch and validate\n            active_branch = utils.getInputObjectByRef(formbuilder.branch.active_branch_ref);\n            branch_inputs_validation = validation.validateBranchInputs(active_branch);\n\n            if (branch_inputs_validation.is_valid) {\n\n                ui.inputs_collection.showInputValidIcon(active_branch.ref);\n                active_branch.dom.is_valid = true;\n            }\n            else {\n                ui.inputs_collection.showInputInvalidIcon(active_branch.ref);\n                active_branch.dom.is_valid = false;\n            }\n        }\n\n        // if we are editing a group, and all the active group inputs are valid,\n        // set the group input owner as valid and toggle valid icon for the owner branch input\n        if (formbuilder.is_editing_group) {\n\n            //get current active group and validate\n            active_group = utils.getInputObjectByRef(formbuilder.group.active_group_ref);\n            group_inputs_validation = validation.validateGroupInputs(active_group);\n\n            if (group_inputs_validation.is_valid) {\n\n                active_group.dom.is_valid = true;\n                ui.inputs_collection.showInputValidIcon(active_group.ref);\n            }\n            else {\n                ui.inputs_collection.showInputInvalidIcon(active_group.ref);\n                active_group.dom.is_valid = false;\n            }\n        }\n    }\n};\n\nmodule.exports = saveAllInputProperties;\n","/* global $*/\n'use strict';\nvar consts = require('config/consts');\nvar formbuilder = require('config/formbuilder');\n\nvar saveJumps = function (input) {\n\n    var ui = require('helpers/ui');\n    var undo = require('actions/undo');\n    var jumps_list_wrapper = formbuilder.dom.input_properties_forms_wrapper\n        .find('form[data-input-ref=\"' + input.ref + '\"]')\n        .find('.input-properties__form__jumps .input-properties__form__jumps__list');\n\n    var jumps = jumps_list_wrapper.find('li');\n    var jump_properties = {\n        are_valid: null,\n        when: null,\n        to: null,\n        answer_ref: null,\n        type: null\n    };\n\n    input.hideJumpsErrors(jumps);\n\n    //reset all jumps\n    input.jumps = [];\n    jumps.each(function (i) {\n            jump_properties.has_valid_destination = true;\n            jump_properties.type = input.type;\n\n            //get jump properties\n            jump_properties.when = $(this).find('.input-properties__form__jumps__logic--when select option:selected').val();\n            jump_properties.to = $(this).find('.input-properties__form__jumps__logic--goto select option:selected').val();\n            jump_properties.answer_ref = $(this).find('.input-properties__form__jumps__logic--answer select option:selected').val();\n\n            //validate jump properties\n            jump_properties.are_valid = input.isJumpValid(jump_properties);\n\n            if (!jump_properties.are_valid) {\n\n                //show errors\n                input.showSingleJumpErrors($(this), jump_properties);\n\n                //set input as invalid\n                input.dom.is_valid = false;\n            }\n\n            //save jump anyway, as it is flag as invalid and it will keep the project invalid until it is either removed or set properly\n            input.jumps[i] = {\n                to: jump_properties.to,\n                //this will be always 'ALL' for this type of input\n                when: jump_properties.when,\n                //this will be null for single answer options. val() is set to answer_ref of possible answer otherwise\n                answer_ref: jump_properties.answer_ref || null\n            };\n        }\n    );\n    undo.pushState();\n};\n\nmodule.exports = saveJumps;\n","/* global $*/\n'use strict';\nvar consts = require('config/consts');\nvar formbuilder = require('config/formbuilder');\n\nvar savePossibleAnswers;\nsavePossibleAnswers = function (the_input) {\n\n    var input = the_input;\n    var answer;\n    var answer_ref;\n    var properties_panel = formbuilder.dom.input_properties_forms_wrapper.find('form[data-input-ref=\"' + input.ref + '\"]');\n    var possible_answers = properties_panel.find('.input-properties__form__possible-answers div ul.input-properties__form__possible-answers__list li');\n    var is_possible_aswer_valid;\n\n    var current_page = formbuilder.possible_answers_pagination[input.ref].page;\n    var from_index = (current_page - 1) * consts.LIMITS.possible_answers_per_page;\n\n    input.dom.properties_panel = formbuilder.dom.input_properties_forms_wrapper.find('form[data-input-ref=\"' + input.ref + '\"]');\n\n    //reset validation dom feedback (hide all errors from dom)\n    input.hidePossibleAnswersErrors(possible_answers);\n\n    /*\n     Possible answers are grabbed from the dom, so we just update the text with whatever is set\n     */\n    possible_answers.each(function (index, possible_answer) {\n\n        var current_input = $(possible_answer).find('div input');\n\n        answer = current_input.val();\n\n        //strip html tags (angle brackets)\n        answer = answer.replace(/[<>]/ig, '');\n\n        //reflect changes in dom\n        current_input.attr('value', answer);\n        current_input.val(answer);\n\n        answer_ref = current_input.attr('data-answer-ref');\n\n        //add element to the correct position in the array\n        //based on pagination\n        input.possible_answers[from_index + index] = {\n            answer: answer,\n            answer_ref: answer_ref\n        };\n\n        is_possible_aswer_valid = input.isPossibleAnswerValid(answer);\n\n        //validate each possible answer and show embedded errors if any\n        if (!is_possible_aswer_valid.is_valid) {\n            // warn user question text is wrong\n            input.dom.is_valid = false;\n\n            //highlight wrong answer and show error message\n            input.showPossibleAnswerErrors($(possible_answer), is_possible_aswer_valid.error.message);\n        }\n    });\n};\n\nmodule.exports = savePossibleAnswers;\n\n","/* global $*/\n'use strict';\nvar consts = require('config/consts');\nvar formbuilder = require('config/formbuilder');\nvar utils = require('helpers/utils');\n\nvar saveProperties = function (the_input) {\n\n    var question_text_validation;\n    var input = the_input;\n\n    input.dom.properties_panel = formbuilder.dom.input_properties_forms_wrapper.find('form[data-input-ref=\"' + input.ref + '\"]');\n    input.dom.is_valid = true;\n\n    //reset validation dom feedback (hide all errors from dom)\n    input.hidePropertiesErrors();\n\n    //set question text (readme is the only one with a textarea in the markup)\n    if (input.type === consts.README_TYPE) {\n\n        input.question = input.dom.properties_panel.find('div.input-properties__form__question textarea').val().trim();\n\n        //remove double white spaces, tabs and new lines and &nbsp;\n        input.question = input.question.replace(/\\s\\s+/g, ' ').replace(/&nbsp;/g, '');\n\n        //convert html tags to html entities\n        input.question = utils.encodeHtml(input.question)\n    }\n    else {\n        input.question = input.dom.properties_panel.find('div.input-properties__form__question input').val();\n\n        //remove angle brackets\n        input.question = input.question.replace(/[<>]/g, '');\n        input.dom.properties_panel.find('div.input-properties__form__question input').val(input.question);\n\n\n        //set required flag\n        input.is_required = input.dom.properties_panel.find('div.input-properties__form__required-flag input').is(':checked');\n\n        //set title flag\n        input.is_title = input.dom.properties_panel.find('div.input-properties__form__title-flag input').is(':checked');\n    }\n\n    //validate question text\n    question_text_validation = input.isQuestionTextValid();\n\n    if (!question_text_validation.is_valid) {\n        // warn user question text is wrong\n        input.dom.is_valid = false;\n        input.dom.error = question_text_validation.error.message;\n\n        //highlight wrong input and show error message\n        input.showPropertiesErrors(question_text_validation.error.message);\n\n    }\n};\n\nmodule.exports = saveProperties;\n","/* global $*/\n'use strict';\nvar consts = require('config/consts');\nvar formbuilder = require('config/formbuilder');\n\nvar saveUniqueness = function (input) {\n\n    /* get uniqueness flag */\n    var uniqueness = input.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__uniqueness input:checked');\n    //top parent form\n    if (formbuilder.current_form_index === 0) {\n        //this is the top level form, get single checkbox state\n        input.uniqueness = (uniqueness.length > 0) ? consts.UNIQUESS_FORM : consts.UNIQUESS_NONE;\n    }\n    else {\n        //do we have some checkboxes selected?\n        if (uniqueness.length > 0) {\n            //child form can have either hierarchy or form uniqueness\n            input.uniqueness = uniqueness.hasClass('uniqueness-hierarchy') ? consts.UNIQUESS_HIERARCHY : consts.UNIQUESS_FORM;\n        }\n        else {\n            input.uniqueness = consts.UNIQUESS_NONE;\n        }\n    }\n\n};\n\nmodule.exports = saveUniqueness;\n","/* global Flatted*/\n'use strict';\nvar formbuilder = require('config/formbuilder');\nvar parse = require('actions/parse');\nvar consts = require('config/consts');\nvar ui = require('helpers/ui');\nvar form_factory = require('factory/form-factory');\nvar utils = require('helpers/utils');\nvar push_state_timeout;\n\nvar undo = {\n\n    execute: function () {\n\n        //set render action flag so we know we do not have to push a state when we undo (since we are re-using the same functions)\n        formbuilder.render_action = consts.RENDER_ACTION_UNDO;\n\n        //show overlay and cursor, on complete execute undo\n        formbuilder.dom.overlay.fadeIn(consts.ANIMATION_FAST, function () {\n\n            //if there is only 1 element in state, that is the starting state and it cannot be undone\n            if (formbuilder.state.length > 1) {\n                formbuilder.state.pop();\n            }\n\n            formbuilder.previous_state = CircularJSON.parse(CircularJSON.stringify(formbuilder.state[formbuilder.state.length - 1]));\n\n            //remove all child tab-panel\n            formbuilder.dom.forms_tabs_content.find('.main__tabs-content-tabpanel').not(':first').remove();\n\n            //remove all inputs from top level form\n            formbuilder.dom.forms_tabs_content.find('.inputs-collection .sortable .input').remove();\n\n            //remove all properties panels for top level form\n            formbuilder.dom.forms_tabs_content.find('.main__tabs-content-tabpanel .input-properties .input-properties__form').remove();\n\n            //remove forms tabs buttons (not the first one)\n            formbuilder.dom.forms_tabs.find('.main__tabs__form-btn').not(':first').remove();\n\n            //render previous state\n            formbuilder.project_definition = formbuilder.previous_state.project_definition;//todo test for side effect of this assignment\n\n            $.when(parse.renderProject(formbuilder.project_definition)).then(function () {\n\n                //always switch tabs to form of index 0\n                    //todo\n\n                //hide overlay with a bit of delay\n                window.setTimeout(function () {\n                    formbuilder.dom.overlay.fadeOut(consts.ANIMATION_FAST, function () {\n                    });\n                }, consts.ANIMATION_SLOW);\n\n                //disable undo button if we do not have any more state\n                if (formbuilder.state.length === 1) {\n                    ui.navbar.toggleUndoBtn(consts.BTN_DISABLED);\n                }\n\n                //reset state to register new  user actions\n                formbuilder.render_action = consts.RENDER_ACTION_DO;\n\n                //clear possible answers sortable enabled array!\n                //to bind the sortable events again\n                //it might bind it twice for some elements, but the undo action is not common\n                //so it is acceptable in terms of memory usage\n                formbuilder.possible_answers.enabled_sortable = [];\n            });\n        });\n    },\n\n    pushState: function (with_throttle) {\n\n        var state = {};\n\n        //push a state only when we are NOT undoing ;)\n        if (formbuilder.render_action === consts.RENDER_ACTION_UNDO) {\n            return;\n        }\n\n        function _doPushState() {\n            //console.log('called pushState');\n            //push state\n            if (formbuilder.state.length >= consts.LIMITS.max_states) {\n                formbuilder.state.shift();\n            }\n\n             state.project_definition = Flatted.parse(Flatted.stringify(formbuilder.project_definition));\n           // state.project_definition = formbuilder.project_definition;\n            state.active_input_ref = formbuilder.current_input_ref;\n            state.active_form_index = formbuilder.current_form_index;\n            state.active_form_ref = formbuilder.current_form_ref;\n\n            state.active_properties_tab = formbuilder.dom.input_properties_forms_wrapper\n                .find('form[data-input-ref=\"' + state.active_input_ref + '\"]')\n                .find('.nav-tabs .active a').attr('href');\n\n            if (formbuilder.is_editing_branch && formbuilder.is_editing_group) {\n                //todo save reference to the nested group that was being edited\n\n                //save the branch that was being edited\n                state.active_branch_ref = formbuilder.branch.active_branch_ref;\n\n                //save the group that was being edited\n                state.active_group_ref = formbuilder.group.active_group_ref;\n\n                //override input ref reference to get the nested group input that was being edited\n                state.active_input_ref = formbuilder.group.current_input_ref;\n                state.active_properties_tab = formbuilder.dom.input_properties_forms_wrapper\n                    .find('form[data-input-ref=\"' + state.active_input_ref + '\"]')\n                    .find('.nav-tabs .active a').attr('href');\n            }\n            else {\n                if (formbuilder.is_editing_branch) {\n                    //save the branch that was being edited\n                    state.active_branch_ref = formbuilder.branch.active_branch_ref;\n\n                    //save the active branch input (if any)\n                    if (formbuilder.branch.current_input_ref) {\n                        state.active_branch_input_ref = formbuilder.branch.current_input_ref;\n                    }\n\n                    //save branch input active tab if any\n                    state.active_properties_tab = formbuilder.dom.input_properties_forms_wrapper\n                        .find('form[data-input-ref=\"' + state.active_branch_input_ref + '\"]')\n                        .find('.nav-tabs .active a').attr('href');\n                }\n\n                if (formbuilder.is_editing_group) {\n                    //save the group that was being edited\n                    state.active_group_ref = formbuilder.group.active_group_ref;\n\n                    //save the active branch input (if any)\n                    if (formbuilder.group.current_input_ref) {\n                        state.active_group_input_ref = formbuilder.group.current_input_ref;\n                    }\n\n                    //save branch input active tab if any\n                    state.active_properties_tab = formbuilder.dom.input_properties_forms_wrapper\n                        .find('form[data-input-ref=\"' + state.active_group_input_ref + '\"]')\n                        .find('.nav-tabs .active a').attr('href');\n                }\n            }\n\n            state.was_editing_branch = formbuilder.is_editing_branch;\n            state.was_editing_group = formbuilder.is_editing_group;\n\n            formbuilder.state.push(state);\n\n            console.log('current formbuilder state');\n            console.log(formbuilder.state);\n        }\n\n        //enable undo button the first tije a state is pushed\n        if (formbuilder.state.length === 1) {\n            ui.navbar.toggleUndoBtn(consts.BTN_ENABLED);\n        }\n\n        if (with_throttle) {\n            // Throttle requests\n            clearTimeout(push_state_timeout);\n            push_state_timeout = window.setTimeout(_doPushState, 500);\n        }\n        else {\n            _doPushState();\n        }\n    }\n};\n\nmodule.exports = undo;\n","/* global $, toastr*/\n'use strict';\nvar consts = require('config/consts');\nvar messages = require('config/messages');\nvar formbuilder = require('config/formbuilder');\nvar save = require('actions/save');\nvar utils = require('helpers/utils');\nvar save_project_click_callback = require('ui-handlers/event-handler-callbacks/save-project-click-callback');\nvar import_form_validation = require('helpers/import-form-validation');\nvar toast = require('config/toast');\n\nvar validation = {\n\n    isFormNameValid: function (the_name, is_adding_new_form) {\n\n        var forms = formbuilder.project_definition.data.project.forms;\n        var str = the_name.trim();\n        var validate = {\n            is_valid: true,\n            error: {\n                message: null,\n                type: consts.QUESTION_PROPERTY\n            }\n        };\n        //reject an empty string\n        if (str === '') {\n            validate.is_valid = false;\n            validate.error.message = messages.error.FORM_NAME_EMPTY;\n        }\n        else {\n            //reject if not alphanumeric\n            if (!consts.FORM_NAME_REGEX.test(str)) {\n                validate.is_valid = false;\n                validate.error.message = messages.error.FORM_NAME_INVALID;\n            }\n            else {\n\n                if (is_adding_new_form) {\n                    //check if the form name already exists (case insensitive)\n                    $(forms).each(function (index, form) {\n                        if (form.name.toLowerCase() === str.toLowerCase()) {\n                            validate.is_valid = false;\n                            validate.error.message = messages.error.FORM_NAME_EXIST;\n                        }\n                    });\n                }\n            }\n        }\n\n        return validate;\n    },\n\n    //check for empty string and the presence of either '|' or '_skipp3d_' which are reserved words/chars\n    isQuestionTextValid: function (input) {\n\n        var question = input.question;\n        var str = question.trim();\n        var validate = {\n            is_valid: true,\n            error: {\n                message: null,\n                type: consts.QUESTION_PROPERTY\n            }\n        };\n        if (str === '') {\n            validate.is_valid = false;\n            validate.error.message = messages.error.QUESTION_TEXT_EMPTY;\n        }\n\n        //readme text too long\n        if (input.type === consts.README_TYPE && str.length > consts.LIMITS.readme_length) {\n            validate.is_valid = false;\n            validate.error.message = messages.error.QUESTION_LENGTH_LIMIT_EXCEEDED;\n        }\n\n        //other questions text too long\n        if (input.type !== consts.README_TYPE && str.length > consts.LIMITS.question_length) {\n            validate.is_valid = false;\n            validate.error.message = messages.error.QUESTION_LENGTH_LIMIT_EXCEEDED;\n        }\n\n        return validate;\n    },\n\n    isPossibleAnswerValid: function (the_possible_answer) {\n\n        var str = the_possible_answer.trim();\n        var validate = {\n            is_valid: true,\n            error: {\n                message: null,\n                type: consts.QUESTION_PROPERTY\n            }\n        };\n\n        if (str === '') {\n            validate.is_valid = false;\n            validate.error.message = messages.error.POSSIBLE_ANSWER_EMPTY;\n        }\n        return validate;\n    },\n\n    //check if this is valid against the input type or the regex\n    isInitialAnswerValid: function (the_type, the_default, the_regex) {\n\n        var str = the_default || '';\n        var regex = the_regex;\n        var type = the_type;\n        var validate = {\n            is_valid: true,\n            error: {\n                message: null,\n                type: consts.DEFAULT_PROPERTY\n            }\n        };\n\n        str = str.trim();\n\n        //does the initial answer pass the regex?\n        if (regex && str) {\n            if (!str.match(regex)) {\n                validate.is_valid = false;\n                validate.error.message = messages.error.INITIAL_ANSWER_NOT_MATCHING_REGEX;\n            }\n        }\n\n        if (type === consts.PHONE_TYPE) {\n            //is the initial answer a valid phone number format?\n            //todo this is hairy, too many options\n            //validate.is_valid = false;\n            //validate.error.message = messages.error.INITIAL_ANSWER_NOT_PHONE_NUMBER;\n        }\n\n\n        return validate;\n    },\n    //convert value to a float and check if it is an integer\n    isValueInt: function (n) {\n        n = parseFloat(n);\n        return Number(n) === n && n % 1 === 0;\n    },\n    //convert value to a float and check if it is a decimal or\n    isValueFloat: function (n) {\n        n = parseFloat(n);\n        return n === Number(n) && n % 1 !== 0;\n    },\n\n    //is this right? todo double check this and maybe refactor integer/decimal validation in integer.js\n    isMinMaxValueValid: function (type, value) {\n\n        var minmax_value = value;\n        var validate = {\n            is_valid: true,\n            error: {\n                message: null,\n                type: consts.MAX_VALUE_PROPERTY\n            }\n        };\n\n        if (type === consts.INTEGER_TYPE && minmax_value !== '') {\n            //min must be an integer, not a float\n            if (!this.isValueInt(minmax_value)) {\n                validate.is_valid = false;\n                validate.error.message = messages.error.VALUE_MUST_BE_INTEGER;\n            }\n        }\n        return validate;\n    },\n\n    isJumpValid: function (the_jump, the_input) {\n\n        var jump = the_jump;\n        var input = the_input;\n        var is_valid = true;\n        var inputs;\n        var jump_destinations;\n\n        //if editing a branch, get jumps destinations within the active branch\n        if (formbuilder.is_editing_branch) {\n            inputs = utils.getInputObjectByRef(formbuilder.branch.active_branch_ref).branch;\n        }\n        else {\n            inputs = formbuilder.project_definition.data.project.forms[formbuilder.current_form_index].inputs;\n        }\n\n        jump_destinations = utils.getJumpAvailableDestinations(input, inputs);\n\n        if (consts.MULTIPLE_ANSWER_TYPES.indexOf(jump.type) !== -1) {\n            //multiple answers validation\n            if (jump.to === undefined || jump.when === undefined) {\n                is_valid = false;\n            }\n\n            //answer_ref in needed when IS ans IS NOT only\n            if (jump.answer_ref === undefined) {\n                if (jump.when === 'IS' || jump.when === 'IS_NOT') {\n                    is_valid = false;\n                }\n            }\n        }\n        else {\n            //single answer validation (it will always jump, so check if destination is set)\n            if (jump.to === undefined) {\n                is_valid = false;\n            }\n        }\n\n        //check the destination is valid (the user might have dragged the input around)\n        if (is_valid) {\n\n            var refs = jump_destinations.map(function (destination) {\n                return destination.ref;\n            });\n\n\n            if (refs.indexOf(jump.to) === -1) {\n                is_valid = false;\n                jump.has_valid_destination = false;\n            }\n            else {\n                //remove jump.has_valid_destination just in case it was there from a previous error\n                //this happens because I am mutating the object! shame on me, too much work refactoring ;)\n                delete jump.has_valid_destination;\n            }\n        }\n        return is_valid;\n    },\n\n    //todo I do not think this is used anymore\n    isPossibleAnswerlinkedToJump: function (the_possible_answer, the_jumps) {\n\n        var possible_answer = the_possible_answer;\n        var jumps = the_jumps;\n        var i;\n        var iLength = jumps.length;\n        var has_linked_jump = false;\n\n        for (i = 0; i < iLength; i++) {\n            if (jumps[i].answer_id === possible_answer.answer_id) {\n                has_linked_jump = true;\n                break;\n            }\n        }\n        return has_linked_jump;\n    },\n\n    //perform validation on an input and optionally show toast notification\n    performValidation: function (the_input, show_toast) {\n\n        var input = the_input;\n        var message;\n        var ui = require('helpers/ui');\n        var utils = require('helpers/utils');\n        var undo = require('actions/undo');\n        var question;\n        var copy_btn_state = input.dom.is_valid ? consts.BTN_ENABLED : consts.BTN_DISABLED;\n        /***************************************\n         Save will implicitly run the validation!\n         */\n        save.saveAllInputProperties(input);\n        /*************************************/\n\n        //show visual feedback if the properties are valid\n        if (input.dom.is_valid) {\n\n            //update the just saved input showing a preview of the question text (limit to 50 chars)\n            //strip html tags from readme type if any\n            if (input.type === consts.README_TYPE) {\n\n                //start with deconding the html\n                question = utils.decodeHtml(input.question);\n\n                //remove '<' and '>' from decoded string (as html entities)\n                //tags already parsed (<b>, <i>, <u>) should go through\n                //todo test this well\n                var purifiedHtml = utils.replaceAllOccurrences(question, '&lt;', '');\n                purifiedHtml = utils.replaceAllOccurrences(purifiedHtml, '&gt;', '');\n\n                //remove link protocol\n                purifiedHtml = utils.replaceAllOccurrences(purifiedHtml, 'http://', '');\n                purifiedHtml = utils.replaceAllOccurrences(purifiedHtml, 'https://', '');\n\n                //remove not allowed tags\n                purifiedHtml = utils.stripTags(purifiedHtml, consts.README_ALLOWED_TAGS);\n\n                //save purified question\n                input.question = utils.encodeHtml(purifiedHtml);\n\n                //remove ALL tags for preview only\n                question = purifiedHtml.replace(/(<([^>]+)>)/ig, ' ');\n                //wrap in double quotes to escape html in the preview so <br> do not get rendered\n                ui.inputs_collection.showInputQuestionPreview(input.ref, '\"' + question.trunc(consts.LIMITS.question_preview_length) + '\"');\n            }\n            else {\n                ui.inputs_collection.showInputQuestionPreview(input.ref, input.question.trunc(consts.LIMITS.question_preview_length));\n            }\n\n            //replace warning icon with green check\n            ui.inputs_collection.showInputValidIcon(input.ref);\n\n            //show question preview on input properties panel\n            //strip html tags from readme type if any\n            if (input.type === consts.README_TYPE) {\n                question = utils.decodeHtml(input.question);\n                question = question.replace(/(<([^>]+)>)/ig, ' ');\n                //wrap in double quotes to escape html rendering in preview\n                ui.input_properties_panel.showInputQuestionPreview('\"' + question.trunc(20) + \"\");\n            }\n            else {\n                ui.input_properties_panel.showInputQuestionPreview(input.question.trunc(20));\n            }\n\n            if (show_toast) {\n                toast.showSuccess(messages.success.INPUT_VALID);\n            }\n            //enable save project button if all inputs are valid\n            if (this.areAllInputsValid(formbuilder.project_definition)) {\n                //console.log('** all good **');\n                //enable save project button\n                ui.navbar.toggleSaveProjectBtn(consts.BTN_ENABLED);\n                formbuilder.dom.save_project_btn.off().on('click', save_project_click_callback);\n\n                //replace warning icon with green check on current form tab\n                ui.forms_tabs.showFormValidIcon(formbuilder.current_form_index);\n\n                //enable download form button on current form\n                formbuilder.dom.inputs_collection\n                    .find('.inputs-collection__export-form').removeClass('disabled');\n\n                //enable prnt as pdf button\n                formbuilder.dom.inputs_collection\n                    .find('.inputs-collection__print-as-pdf').removeClass('disabled');\n            }\n            else {\n\n                //check if inputs are all valid for current form only\n                if (this.areFormInputsValid(formbuilder.current_form_index)) {\n                    //replace warning icon with green check on current form tab\n                    ui.forms_tabs.showFormValidIcon(formbuilder.current_form_index);\n\n                    //enable download form button\n                    formbuilder.dom.inputs_collection\n                        .find('.inputs-collection__export-form').removeClass('disabled');\n\n                    //enable print as pdf form button\n                    formbuilder.dom.inputs_collection\n                        .find('.inputs-collection__print-as-pdf').removeClass('disabled');\n                }\n                else {\n                    //disable download form button\n                    formbuilder.dom.inputs_collection\n                        .find('.inputs-collection__export-form').addClass('disabled');\n\n                    //disable print as pdf form button\n                    formbuilder.dom.inputs_collection\n                        .find('.inputs-collection__print-as-pdf').addClass('disabled');\n                }\n            }\n        } else {\n            if (input.question) {\n                message = input.dom.error ? input.dom.error : input.question;\n            }\n            else {\n                switch (input.type) {\n                    case consts.BRANCH_TYPE:\n                        message = messages.error.NO_BRANCH_HEADER_YET;\n                        break;\n                    case consts.GROUP_TYPE:\n                        message = messages.error.NO_GROUP_HEADER_YET;\n                        break;\n                    default:\n                        message = messages.error.NO_QUESTION_TEXT_YET;\n                        break;\n                }\n            }\n\n            //update question preview\n            ui.inputs_collection.showInputInvalidIcon(input.ref);\n            ui.inputs_collection.showInputQuestionPreview(input.ref, message);\n            ui.input_properties_panel.showInputQuestionPreview(message);\n\n            if (show_toast) {\n                toast.showError(messages.error.INPUT_NOT_VALID, 2000);\n            }\n\n            //disable save project button\n            ui.navbar.toggleSaveProjectBtn(consts.BTN_DISABLED);\n            formbuilder.dom.save_project_btn.off('click');\n\n            //show warning icon on current form tab\n            ui.forms_tabs.showFormInvalidIcon(formbuilder.current_form_index);\n\n            //disable download form button on current form\n            formbuilder.dom.inputs_collection\n                .find('.inputs-collection__export-form').addClass('disabled');\n            //disable print as pdf button\n            formbuilder.dom.inputs_collection\n                .find('.inputs-collection__print-as-pdf').addClass('disabled');\n        }\n\n        //toggle copy button (valid, enable button else disable)\n        ui.input_properties_panel.toggleCopyInputButton(input.ref, copy_btn_state);\n    },\n\n    areAllInputsValid: function (project_definition) {\n        var are_all_valid = true;\n        var forms = project_definition.data.project.forms;\n\n        loop1:\n        for (var index = 0; index < forms.length; index++) {\n\n            //do not accept forms with no inputs\n            if (forms[index].inputs.length === 0) {\n                are_all_valid = false;\n                break;\n            }\n\n            for (var input_index = 0; input_index < forms[index].inputs.length; input_index++) {\n\n                if (!forms[index].inputs[input_index].dom.is_valid) {\n                    are_all_valid = false;\n                    break loop1;\n                }\n            }\n        }\n        return are_all_valid;\n    },\n\n    areFormInputsValid: function (form_index) {\n\n        var are_valid = true;\n        var form = formbuilder.project_definition.data.project.forms[form_index];\n\n        //do not accept forms with no inputs\n        if (form.inputs.length === 0) {\n            are_valid = false;\n        }\n\n        //loop all inputs to see if they are all valid\n        $(form.inputs).each(function (index, input) {\n            if (!input.dom.is_valid) {\n                are_valid = false;\n                return false;\n            }\n        });\n\n        return are_valid;\n    },\n\n    // a branch is valid when the branch header is not empty and there is at least a valid branch question\n    // also, all the branch questions need to pass validation to make a branch valid\n    validateBranchInputs: function (the_branch_owner) {\n\n        var validate = {\n            is_valid: true,\n            error: {\n                message: null,\n                type: consts.DEFAULT_PROPERTY\n            }\n        };\n\n        var branch_owner = the_branch_owner;\n\n        if (branch_owner.branch.length === 0) {\n            validate.is_valid = false;\n            validate.error.message = messages.error.NO_BRANCH_INPUTS_FOUND;\n        }\n        else {\n            //check if ALL the branch inputs are valid and return as soon as the first invalid is found\n            $(branch_owner.branch).each(function (index, input) {\n                // console.log('** input dom is_valid for branches');\n                // console.log(input.dom.is_valid);\n                if (!input.dom.is_valid) {\n                    validate.is_valid = false;\n                    validate.error.message = messages.error.INVALID_BRANCH_INPUTS;\n                    return false;\n                }\n            });\n        }\n        return validate;\n    },\n\n    // a group is valid when the group header is not empty and there is at least a valid group question\n    // also, all the group questions need to pass validation to make a group valid\n    validateGroupInputs: function (the_group_input) {\n\n        var validate = {\n            is_valid: true,\n            error: {\n                message: null,\n                type: consts.DEFAULT_PROPERTY\n            }\n        };\n\n        var group_input = the_group_input;\n\n        if (group_input.group.length === 0) {\n            validate.is_valid = false;\n            validate.error.message = messages.error.NO_GROUP_INPUTS_FOUND;\n        }\n        else {\n            //check if ALL the group inputs are valid and return as soon as the first invalid is found\n            $(group_input.group).each(function (index, input) {\n                if (!input.dom.is_valid) {\n                    validate.is_valid = false;\n                    validate.error.message = messages.error.INVALID_GROUP_INPUTS;\n                    return false;\n                }\n            });\n        }\n        return validate;\n    },\n\n    validateJumpsAfterSorting: function (inputs) {\n\n        var self = this;\n        var ui = require('helpers/ui');\n        var inputs_to_validate = inputs;\n        var jumps_list_wrapper_dom;\n        var jumps_dom;\n        var jump_dom;\n\n        //validate previous inputs based and current one\n        for (var index = 0; index < inputs_to_validate.length; index++) {\n\n            var input = inputs_to_validate[index];\n            var are_jumps_valid = true;\n\n            //hide all errors for a jump in the dom\n            jumps_list_wrapper_dom = formbuilder.dom.input_properties_forms_wrapper\n                .find('form[data-input-ref=\"' + input.ref + '\"]')\n                .find('.input-properties__form__jumps .input-properties__form__jumps__list');\n\n            jumps_dom = jumps_list_wrapper_dom.find('li');\n\n            //hide all the jumps error\n            input.hideJumpsErrors(jumps_dom);\n\n            for (var jump_index = 0; jump_index < input.jumps.length; jump_index++) {\n\n                var jump = input.jumps[jump_index];\n\n                // Assume the index of the <li> in the list is the same of the index in the jumps object\n                jump_dom = jumps_dom.eq(jump_index);\n\n                //todo if any error, highlight the wrong destination in the markup\n                if (!self.isJumpValid(jump, input)) {\n\n                    //show errors\n                    input.showSingleJumpErrors(jump_dom, jump);\n\n                    //keep track the jumps now are invalid\n                    are_jumps_valid = false;\n\n                    //set input in the dom as invalid, and also the form if it is the only invalid one\n                    ui.inputs_collection.showInputInvalidIcon(input.ref);\n                }\n                else {\n                    //todo what if I have multiple jumps with errors?\n                    ui.input_properties_panel.hideJumpTabError(jump_dom);\n                }\n            }\n\n            //Is the input valid aside from the jumps? That would mean all the jumps were ok, but there might be other errors\n            //we just need to check the object properties, as they do not change when sorting\n            input.dom.is_valid = self.isInputObjectValid(input) && are_jumps_valid;\n\n            //set input validation icon accordingly\n            if (input.dom.is_valid) {\n                ui.inputs_collection.showInputValidIcon(input.ref);\n            }\n            else {\n                ui.inputs_collection.showInputInvalidIcon(input.ref);\n            }\n        }\n\n\n        //check if the form is now valid\n        if (self.areFormInputsValid(formbuilder.current_form_index)) {\n            ui.forms_tabs.showFormValidIcon(formbuilder.current_form_index);\n\n            //enable download form button\n            formbuilder.dom.inputs_collection\n                .find('.inputs-collection__export-form').removeClass('disabled');\n\n            //enable print as pdf form button\n            formbuilder.dom.inputs_collection\n                .find('.inputs-collection__print-as-pdf').removeClass('disabled');\n        }\n        else {\n            ui.forms_tabs.showFormInvalidIcon(formbuilder.current_form_index);\n\n            //disable form download button\n            formbuilder.dom.inputs_collection\n                .find('.inputs-collection__export-form').addClass('disabled');\n\n            //disable print as pdf download button\n            formbuilder.dom.inputs_collection\n                .find('.inputs-collection__print-as-pdf').addClass('disabled');\n        }\n\n        //check if all inputs are now valid to enable save project button\n        if (self.areAllInputsValid(formbuilder.project_definition)) {\n            ui.navbar.toggleSaveProjectBtn(consts.BTN_ENABLED);\n        }\n        else {\n            ui.navbar.toggleSaveProjectBtn(consts.BTN_DISABLED);\n        }\n    },\n\n    isInputObjectValid: function (input) {\n\n        var self = this;\n        var is_valid = true;\n\n        //check question text ***********************************************************\n        if (!self.isQuestionTextValid(input).is_valid) {\n            is_valid = false;\n        }\n        //*******************************************************************************\n\n        //test min and max for integer **************************************************\n        if (input.type === consts.INTEGER_TYPE) {\n\n            //is min a int?\n            if (input.min !== '') {\n                if (!self.isValueInt(input.min)) {\n                    is_valid = false;\n                }\n            }\n\n            //is max a int?\n            if (input.max !== '') {\n                if (!self.isValueInt(input.max)) {\n                    is_valid = false;\n                }\n            }\n\n            //If both are set, are they valid?\n            if (is_valid && (input.min !== '' && input.max !== '')) {\n                if (parseFloat(input.min) > parseFloat(input.max)) {\n                    is_valid = false;\n                }\n            }\n\n            //if the default answer is set, is it valid?\n            if (input.default !== '') {\n                if (!self.isValueInt(input.default)) {\n                    is_valid = false;\n                }\n                else {\n                    //default answer is a valid int, is it within range?\n                    if (input.min !== '' && parseInt(input.default, 0) < input.min) {\n                        is_valid = false;\n                    }\n                    if (input.min !== '' && parseInt(input.default, 0) > input.max) {\n                        is_valid = false;\n                    }\n                }\n            }\n        }\n        //*******************************************************************************\n\n        //test min and max for decimal (float) ******************************************\n        if (input.type === consts.DECIMAL_TYPE) {\n            //is min a float or an integer?\n            if (input.min !== '') {\n                if (!(self.isValueFloat(input.min) || self.isValueInt(input.min))) {\n                    is_valid = false;\n                }\n            }\n\n            //is max a float or integer?\n            if (input.max !== '') {\n                if (!(self.isValueFloat(input.max) || self.isValueInt(input.max))) {\n                    is_valid = false;\n                }\n            }\n\n            //If both are set, are they valid?\n            if (is_valid && (input.min !== '' && input.max !== '')) {\n                if (parseFloat(input.min) > parseFloat(input.max)) {\n                    is_valid = false;\n                }\n            }\n\n            //if the default answer is set, is it valid?\n            if (input.default !== '') {\n                if (!(self.isValueFloat(input.default) || self.isValueInt(input.default))) {\n                    is_valid = false;\n                }\n                else {\n                    //default answer is a valid number, is it within range?\n                    if (input.min !== '' && parseFloat(input.default) < input.min) {\n                        is_valid = false;\n                    }\n                    if (input.min !== '' && parseFloat(input.default) > input.max) {\n                        is_valid = false;\n                    }\n                }\n            }\n        }\n        //*******************************************************************************\n\n        //check possible answers for multiple answer types ******************************\n        if (consts.MULTIPLE_ANSWER_TYPES.indexOf(input.type !== -1)) {\n            $(input.possible_answers).each(function (index, possible_answer) {\n                if (!self.isPossibleAnswerValid(possible_answer.answer).is_valid) {\n                    is_valid = false;\n                }\n            });\n        }\n        //*******************************************************************************\n\n        //group type but empty? *********************************************************\n        if (input.type === consts.GROUP_TYPE && input.group.length === 0) {\n            is_valid = false;\n        }\n        //*******************************************************************************\n\n        //branch type but empty? ********************************************************\n        if (input.type === consts.BRANCH_TYPE && input.branch.length === 0) {\n            is_valid = false;\n        }\n        //*******************************************************************************\n\n        return is_valid;\n    }\n    ,\n\n    validateBeforeSaving: function (form_ref, inputs) {\n\n        var validate = {\n            is_valid: true,\n            error: {\n                message: null\n            }\n        };\n        var invalid_question = '';\n        var are_inputs_valid = true;\n        var are_branch_inputs_valid = true;\n        $(inputs).each(function (index, input) {\n            if (!import_form_validation.isValidInput(form_ref, input, false, false)) {\n                console.log(JSON.stringify(input));\n                invalid_question = input.question.trunc(50);\n                are_inputs_valid = false;\n                return false;//exit loop only\n            }\n        });\n        var questions_total;\n\n        if (!are_inputs_valid) {\n            validate = {\n                is_valid: false,\n                error: {\n                    message: invalid_question\n                }\n            };\n            return validate;\n        }\n\n        //check total number of questions/branches\n        questions_total = utils.getInputsTotal(inputs);\n        if (questions_total > consts.INPUTS_MAX_ALLOWED) {\n            validate = {\n                is_valid: false,\n                error: {\n                    message: messages.error.TOO_MANY_QUESTIONS_FOR_CURRENT_FORM + questions_total + ', limit is ' + consts.INPUTS_MAX_ALLOWED + '!'\n                }\n            };\n            return validate;\n        }\n\n        //check total number of titles (main form)\n        if (utils.isMaxTitleLimitExceeded(inputs)) {\n            validate = {\n                is_valid: false,\n                error: {\n                    message: messages.error.TOO_MANY_TITLES\n                }\n            };\n            return validate;\n        }\n        //check total number of titles (branches)\n        $(inputs).each(function (index, input) {\n            if (utils.isMaxTitleLimitExceeded(input.branch)) {\n                are_branch_inputs_valid = false;\n                return false;\n            }\n        });\n\n        if (!are_branch_inputs_valid) {\n            validate = {\n                is_valid: false,\n                error: {\n                    message: messages.error.TOO_MANY_TITLES + ' (branch)'\n                }\n            };\n            return validate;\n        }\n\n        //check jumps destinations\n        if (!import_form_validation.areJumpsDestinationsValid(inputs)) {\n            validate = {\n                is_valid: false,\n                error: {\n                    message: messages.error.JUMPS_INVALID\n                }\n            };\n            return validate;\n        }\n\n        //check total number of search inputs\n        if (utils.getSearchInputsTotal() > consts.LIMITS.search_inputs_max) {\n            validate = {\n                is_valid: false,\n                error: {\n                    message: messages.error.TOO_MANY_SEARCH_QUESTIONS\n                }\n            };\n            return validate;\n        }\n\n        return validate;\n    }\n}\n    ;\n\nmodule.exports = validation;\n\n","/*\n set of constants and values to use across the application\n we use `consts` as const is a reserved word and `constant` is a window global object\n */\n'use strict';\n\nconsole.log(window.location.href);\n\nvar consts = {\n\n    PROJECT_URL: '',\n    PROJECT_LOGO_URL: '',\n    BACK_URL: '',\n    API_DEVELOPMENT_GET_PATH: '../project/',\n    API_DEVELOPMENT_POST_PATH: '../postdump/',\n    API_DEVELOPMENT_PROJECT: 'project.json',\n\n    API_PRODUCTION_PATH: 'api/internal/formbuilder/',\n    API_MEDIA_PATH: 'api/internal/media/',\n    API_PROJECT_LOGO_QUERY_STRING: '?type=photo&name=logo.jpg&format=project_mobile_logo',\n    API_DEVELOPMENT_SERVER: 'http://localhost/dev/epicollect5-vps-ant-new/',//to be changed accordingly\n\n    PROJECT_NAME_MAX_LENGHT: 100,\n    FORM_NAME_MAX_LENGHT: 50,\n    INPUTS_MAX_ALLOWED: 300,\n    TAB_FORM_NAME_MAX_DISPLAY_LENGHT: 22,\n    INPUTS_COLLECTION_FORM_NAME_MAX_DISPLAY_LENGHT: 22,\n    INPUTS_COLLECTION_BRANCH_NAME_MAX_DISPLAY_LENGHT: 25,\n    INPUTS_COLLECTION_GROUP_NAME_MAX_DISPLAY_LENGHT: 25,\n    MAX_NUMBER_OF_NESTED_CHILD_FORMS: 5,\n    ANIMATION_FAST: 100,//milliseconds\n    ANIMATION_NORMAL: 150,\n    ANIMATION_SLOW: 500,\n    ANIMATION_SUPER_SLOW: 1000,\n\n    FORM_NAME_REGEX: /^[\\w\\-\\s]+$/, //allow only alphanumeric chars and '-', '_'\n    FORM_HIERARCHY_TYPE: 'hierarchy',\n    FORM_TYPE: 'form',\n\n    UNIQUESS_NONE: 'none',\n    UNIQUESS_FORM: 'form',\n    UNIQUESS_HIERARCHY: 'hierarchy',\n\n    //app ids namespace\n    NAMESPACE_PREFIX: 'ec5_',\n\n    //input types icons\n    TEXT_TYPE_ICON: 'fa-text-width', //\n    TEXTAREA_TYPE_ICON: 'fa-sticky-note-o',\n    NUMERIC_TYPE_ICON: 'fa-hashtag',\n    INTEGER_TYPE_ICON: 'fa-hashtag',\n    DECIMAL_TYPE_ICON: 'fa-hashtag',\n    DATE_TYPE_ICON: 'fa-calendar',\n    TIME_TYPE_ICON: 'fa-clock-o',\n    RADIO_TYPE_ICON: 'fa-dot-circle-o',\n    README_TYPE_ICON: 'fa-file-text-o',\n    CHECKBOX_TYPE_ICON: 'fa-check-square-o',\n    DROPDOWN_TYPE_ICON: 'fa-caret-square-o-down',\n    BARCODE_TYPE_ICON: 'fa-barcode',\n    LOCATION_TYPE_ICON: 'fa-map-marker',\n    AUDIO_TYPE_ICON: 'fa-microphone',\n    VIDEO_TYPE_ICON: 'fa-video-camera',\n    PHOTO_TYPE_ICON: 'fa-camera-retro',\n    PHONE_TYPE_ICON: 'fa-phone',\n    BRANCH_TYPE_ICON: 'fa-clone',\n    GROUP_TYPE_ICON: 'fa-align-justify',\n    SEARCH_SINGLE_TYPE_ICON: 'fa-search',\n    SEARCH_MULTIPLE_TYPE_ICON: 'fa-search',\n\n    //input types\n    TEXT_TYPE: 'text', //\n    TEXTAREA_TYPE: 'textarea',\n    INTEGER_TYPE: 'integer',\n    DECIMAL_TYPE: 'decimal',\n    DATE_TYPE: 'date',\n    TIME_TYPE: 'time',\n    RADIO_TYPE: 'radio',\n    CHECKBOX_TYPE: 'checkbox',\n    DROPDOWN_TYPE: 'dropdown',\n    BARCODE_TYPE: 'barcode',\n    LOCATION_TYPE: 'location',\n    AUDIO_TYPE: 'audio',\n    VIDEO_TYPE: 'video',\n    PHOTO_TYPE: 'photo',\n    BRANCH_TYPE: 'branch',\n    GROUP_TYPE: 'group',\n    README_TYPE: 'readme',\n    PHONE_TYPE: 'phone',\n    SEARCH_SINGLE_TYPE: 'searchsingle',\n    SEARCH_MULTIPLE_TYPE: 'searchmultiple',\n\n    //date formats\n    DATE_FORMAT_1: 'dd/MM/YYYY',\n    DATE_FORMAT_2: 'MM/dd/YYYY',\n    DATE_FORMAT_3: 'YYYY/MM/dd',\n    DATE_FORMAT_4: 'MM/YYYY',\n    DATE_FORMAT_5: 'dd/MM',\n\n    //time formats\n    TIME_FORMAT_1: 'HH:mm:ss',\n    TIME_FORMAT_2: 'hh:mm:ss',\n    TIME_FORMAT_3: 'HH:mm',\n    TIME_FORMAT_4: 'hh:mm',\n    TIME_FORMAT_5: 'mm:ss',\n\n    //reserverd words/chars\n    //RESERVED_WORD_SKIPP3D: '_skipp3d_',\n    //PATH_SEPARATOR_MOBILE_CLIENT: '|',\n\n    //input properties names\n    DEFAULT_PROPERTY: 'default',\n    QUESTION_PROPERTY: 'question',\n    MIN_VALUE_PROPERTY: 'min',\n    MAX_VALUE_PROPERTY: 'max',\n\n    //button labels\n    SHOW_JUMPS: 'Show jumps',\n    HIDE_JUMPS: 'Hide jumps',\n    JUMP_TO_END_OF_FORM_REF: 'END',\n    JUMP_TO_END_OF_FORM_LABEL: 'End of form',\n\n    //possible answers\n    POSSIBILE_ANSWERS_CUSTOM_ID: 'pa_custom_id',\n    POSSIBILE_ANSWER_PLACEHOLDER: 'I am a placeholder answer',\n    USE_ANSWER_AS_TITLE: 'Use answer as title',\n    MAX_TITLE_LIMIT_REACHED: 'Limit of 3 titles reached',\n\n    //paths\n    VIEWS_PATH: 'views/',\n\n    //buttons status\n    BTN_ENABLED: 'btn-enabled',\n    BTN_DISABLED: 'btn-disabled',\n\n    ENABLED_STATE: 'enabled',\n    DISABLED_STATE: 'disabled',\n\n    //action\n    RENDER_ACTION_UNDO: 'undo',\n    RENDER_ACTION_DO: 'do',\n    RENDER_ACTION_VALIDATE: 'validate',\n\n    //form export/import\n    FORM_FILE_ACCEPTED_TYPE: 'application/json',\n    FORM_FILE_EXTENSION: 'json',\n\n    //possible answers csv import/export\n    CSV_FILE_ACCEPTED_TYPES: ['text/csv', 'application/vnd.ms-excel'], //MIME types\n    CSV_FILE_EXTENSION: 'csv'\n};\n\n//multiple answers types\nconsts.MULTIPLE_ANSWER_TYPES = [\n    consts.RADIO_TYPE,\n    consts.CHECKBOX_TYPE,\n    consts.DROPDOWN_TYPE,\n    consts.SEARCH_MULTIPLE_TYPE,\n    consts.SEARCH_SINGLE_TYPE\n];\n\n\nconsts.SINGLE_ANSWER_TYPES = [\n    consts.TEXT_TYPE,\n    consts.TEXTAREA_TYPE,\n    consts.DATE_TYPE,\n    consts.TIME_TYPE,\n    consts.INTEGER_TYPE,\n    consts.DECIMAL_TYPE,\n    consts.BARCODE_TYPE,\n    consts.README_TYPE,\n    consts.PHONE_TYPE\n];\n\n//these types do not have the required/uniqueness option\nconsts.MEDIA_ANSWER_TYPES = [\n    consts.AUDIO_TYPE,\n    consts.PHOTO_TYPE,\n    consts.VIDEO_TYPE,\n    consts.LOCATION_TYPE\n];\n\n//types that have the verify option\nconsts.VERIFY_ALLOWED_TYPES = [\n    consts.TEXT_TYPE,\n    consts.TEXTAREA_TYPE,\n    consts.INTEGER_TYPE,\n    consts.DECIMAL_TYPE,\n    consts.BARCODE_TYPE,\n    consts.PHONE_TYPE\n];\n\n//types that have the uniquess option\nconsts.UNIQUENESS_ALLOWED_TYPES = [\n    consts.TEXT_TYPE,\n    consts.TEXTAREA_TYPE,\n    consts.DATE_TYPE,\n    consts.TIME_TYPE,\n    consts.INTEGER_TYPE,\n    consts.DECIMAL_TYPE,\n    consts.BARCODE_TYPE,\n    consts.RADIO_TYPE,\n    consts.DROPDOWN_TYPE,\n    consts.PHONE_TYPE,\n    consts.SEARCH_MULTIPLE_TYPE,\n    consts.SEARCH_SINGLE_TYPE\n];\n\n//these types DO have the required option\nconsts.REQUIRED_ALLOWED_TYPES = [\n    consts.TEXT_TYPE,\n    consts.TEXTAREA_TYPE,\n    consts.DATE_TYPE,\n    consts.TIME_TYPE,\n    consts.INTEGER_TYPE,\n    consts.DECIMAL_TYPE,\n    consts.BARCODE_TYPE,\n    consts.PHONE_TYPE,\n    consts.RADIO_TYPE,\n    consts.CHECKBOX_TYPE,\n    consts.DROPDOWN_TYPE,\n    consts.SEARCH_MULTIPLE_TYPE,\n    consts.SEARCH_SINGLE_TYPE\n];\n\n\n//jump conditions\nconsts.JUMP_CONDITIONS = [\n    { key: 'NO_ANSWER_GIVEN', text: 'no answer given' },\n    { key: 'IS', text: 'answer is' },\n    { key: 'IS_NOT', text: 'answer is NOT' },\n    { key: 'ALL', text: 'always' }\n];\n\nconsts.LIMITS = {\n    question_length: 255,\n    readme_length: 1000,\n    default_answer_length: 255,\n    regex_length: 50,\n    min_value_length: 50,\n    max_value_length: 50,\n    possible_answers_max: 300,\n    possible_answers_max_search: 1000,\n    titles_max: 3,\n    max_states: 10,\n    possible_answer_ref_length: 13,\n    possible_answer_max_length: 150,\n    possible_answers_per_page: 100,\n    search_inputs_max: 5,\n    question_preview_length: 80\n};\n\nconsts.SUMMERNOTE_OPTIONS = {\n    placeholder: 'Type here...',\n    toolbar: [\n        // [groupName, [list of button]]\n        ['style', ['bold', 'italic', 'underline']]\n    ]\n};\n\nconsts.REGEX = {\n    only_letters: '^[a-zA-Z]*$',\n    only_digits: '^[0-9]+$',\n    limit_length_20: '^.{1,20}$',\n    possible_answer_ref: '^[a-zA-Z0-9]{13}$',\n    input_ref: '^[a-zA-Z0-9-_]{60}$'\n};\n\nconsts.README_ALLOWED_TAGS = [\n    '<br>',\n    '<p>',\n    '<b>',\n    '<strong>',\n    '<i>',\n    '<em>',\n    '<u>'\n];\n\nconsts.POSSIBLE_ANSWERS_ORDER = {\n    AZ: 'az',\n    ZA: 'za',\n    SHUFFLE: 'shuffle'\n};\n\nmodule.exports = consts;\n","'use strict';\n\nvar extend_natives = function () {\n\n    //from http://www.redips.net/javascript/array-move/\n    //move an element within same array and shift other elements\n    Array.prototype.move = function (from, to) {\n        // local variables\n        var i, tmp;\n        // cast input parameters to integers\n        from = parseInt(from, 10);\n        to = parseInt(to, 10);\n        // if positions are different and inside array\n        if (from !== to && from >= 0 && from <= this.length && to >= 0 && to <= this.length) {\n            // save element 'from'\n            tmp = this[from];\n            // move element down and shift other elements up\n            if (from < to) {\n                for (i = from; i < to; i++) {\n                    this[i] = this[i + 1];\n                }\n            }\n            // move element up and shift other elements down\n            else {\n                for (i = from; i > to; i--) {\n                    this[i] = this[i - 1];\n                }\n            }\n            // put element 'from' to destination\n            this[to] = tmp;\n        }\n    };\n\n    String.prototype.trunc = function (n) {\n        return this.substr(0, n - 1) + (this.length >= n ? '...' : '');\n    };\n\n    if (!String.prototype.startsWith) {\n        String.prototype.startsWith = function (str) {\n            return !this.indexOf(str);\n        };\n    }\n\n    //indexOf polyfill\n    // Production steps of ECMA-262, Edition 5, 15.4.4.14\n// Reference: http://es5.github.io/#x15.4.4.14\n    if (!Array.prototype.indexOf) {\n        Array.prototype.indexOf = function (searchElement, fromIndex) {\n\n            var k;\n\n            // 1. Let O be the result of calling ToObject passing\n            //    the this value as the argument.\n            if (this === null) {\n                throw new TypeError('\"this\" is null or not defined');\n            }\n\n            var O = Object(this);\n\n            // 2. Let lenValue be the result of calling the Get\n            //    internal method of O with the argument \"length\".\n            // 3. Let len be ToUint32(lenValue).\n            var len = O.length >>> 0;\n\n            // 4. If len is 0, return -1.\n            if (len === 0) {\n                return -1;\n            }\n\n            // 5. If argument fromIndex was passed let n be\n            //    ToInteger(fromIndex); else let n be 0.\n            var n = +fromIndex || 0;\n\n            if (Math.abs(n) === Infinity) {\n                n = 0;\n            }\n\n            // 6. If n >= len, return -1.\n            if (n >= len) {\n                return -1;\n            }\n\n            // 7. If n >= 0, then Let k be n.\n            // 8. Else, n<0, Let k be len - abs(n).\n            //    If k is less than 0, then let k be 0.\n            k = Math.max(n >= 0 ? n : len - Math.abs(n), 0);\n\n            // 9. Repeat, while k < len\n            while (k < len) {\n                // a. Let Pk be ToString(k).\n                //   This is implicit for LHS operands of the in operator\n                // b. Let kPresent be the result of calling the\n                //    HasProperty internal method of O with argument Pk.\n                //   This step can be combined with c\n                // c. If kPresent is true, then\n                //    i.  Let elementK be the result of calling the Get\n                //        internal method of O with the argument ToString(k).\n                //   ii.  Let same be the result of applying the\n                //        Strict Equality Comparison Algorithm to\n                //        searchElement and elementK.\n                //  iii.  If same is true, return k.\n                if (k in O && O[k] === searchElement) {\n                    return k;\n                }\n                k++;\n            }\n            return -1;\n        };\n    }\n};\n\nmodule.exports = extend_natives;\n\n","/* global $*/\n'use strict';\n\nvar formbuilder = {\n    current_form_ref: '',\n    current_form_index: '',\n    current_input_ref: '',\n    is_sorting: false,\n    from_index: 0,\n    to_index: 0,\n    possible_answers: {\n        enabled_sortable: [],\n        from_index: 0,\n        to_index: 0\n    },\n    state: [],\n    dom: {\n        input_properties: '',\n        input_properties_forms_wrapper: '',\n        input_properties_buttons: '',\n        input_properties_no_input_selected: '',\n        inputs_collection: '',\n        inputs_collection_sortable: '',\n        partials: {},\n        input_properties_views: {}\n    },\n    branch: {},\n    project_definition: {},//this gets loaded dynamically\n\n    setup: function (ref, partials, views) {\n\n        //set refs for current form (always top parent, on load)\n        formbuilder.current_form_ref = ref;\n        formbuilder.current_form_index = 0;\n        formbuilder.possible_answers_pagination = {};\n\n        /* cache static dom selectors to speed up dynamic queries\n         and also for consistent and quick access throughout the code as\n         we are abstracting the dom access away a little bit\n\n         to get the dom element, we concatenate find() calls, as it is faster\n         http://jsperf.com/find-chaining/2\n         */\n        formbuilder.dom = {\n            overlay: $('.wait-overlay'),\n            loader: $('.loader'),\n            navbar: $('.navbar'),\n            forms_tabs: $('.main .main__tabs'),\n            forms_tabs_content: $('.main .main__tabs-content'),\n            save_project_btn: $('.main__tabs-btns .btn-group .main__tabs__save-project-btn'),\n            undo_btn: $('.main__tabs-btns .btn-group .main__tabs__undo-btn'),\n            main_container: $('.container-fluid'),\n            input_properties: $('#' + ref + '-input-properties.input-properties'),\n            input_properties_forms_wrapper: $('#' + ref + '-input-properties.input-properties > .panel > .panel-body.input_properties__forms_wrapper'),\n            input_properties_buttons: $('#' + ref + '-input-properties .input-properties__buttons'),\n            input_properties_no_input_selected: $('.input-properties__no-input-selected'),\n            inputs_collection: $('#' + ref + '-inputs-collection.inputs-collection'),\n            inputs_collection_sortable: $('#' + ref + '-inputs-collection.inputs-collection .panel .panel-body'),\n            inputs_tools_draggable: $('ul#inputs-tools-list li div.input')\n        };\n\n        if ($.isEmptyObject(formbuilder.dom.partials) && partials) {\n            formbuilder.dom.partials = partials;\n        }\n\n        if ($.isEmptyObject(formbuilder.dom.input_properties_views) && views) {\n            formbuilder.dom.input_properties_views = views;\n        }\n\n        formbuilder.isOpeningFileBrowser = false;\n\n        console.log('formbuilder object ready');\n    }\n};\n\n\nmodule.exports = formbuilder;\n","/* global toastr, $*/\n'use strict';\nvar consts = require('config/consts');\nvar formbuilder = require('config/formbuilder');\nvar draggable = require('ui-handlers/draggable');\nvar sortable = require('ui-handlers/sortable');\nvar input_properties_click_callback = require('ui-handlers/event-handler-callbacks/input-properties-click-callback');\nvar input_collection_sortable_mousedown_callback = require('ui-handlers/event-handler-callbacks/input-collection-sortable-mousedown-callback');\nvar input_properties_focus_callback = require('ui-handlers/event-handler-callbacks/input-properties-focus-callback');\nvar input_properties_change_callback = require('ui-handlers/event-handler-callbacks/input-properties-change-callback');\nvar input_properties_title_checkbox_callback = require('ui-handlers/event-handler-callbacks/input-properties-title-checkbox-callback');\nvar form_tab_click_callback = require('ui-handlers/event-handler-callbacks/form-tab-click-callback');\nvar modal_edit_form_name_callback = require('ui-handlers/event-handler-callbacks/modal-form-callback');\nvar export_form_click_callback = require('ui-handlers/event-handler-callbacks/export-form-click-callback');\n\nvar print_as_pdf_click_callback = require('ui-handlers/event-handler-callbacks/print-as-pdf-click-callback');\n\nvar import_form_click_callback = require('ui-handlers/event-handler-callbacks/import-form-click-callback');\n\nvar delete_all_questions_callback = require('ui-handlers/event-handler-callbacks/delete-all-questions-click-callback');\n\nvar save_project_click_callback = require('ui-handlers/event-handler-callbacks/save-project-click-callback');\nvar input_properties_keyup_callback = require('ui-handlers/event-handler-callbacks/input-properties-keyup-callback');\nvar modal_regex_callback = require('ui-handlers/event-handler-callbacks/modal-regex-callback');\nvar input_properties_advanced_tab_callback = require('ui-handlers/event-handler-callbacks/input-properties-advanced-tab-click-callback');\n\n\nvar messages = require('config/messages');\nvar parse = require('actions/parse');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar undo = require('actions/undo');\n\nvar init = function () {\n\n    var project_name = formbuilder.project_definition.data.project.name;\n    var first_form_name = formbuilder.project_definition.data.project.forms[0].name;\n\n    //config toast notification options\n    window.toastr.options = {\n        closeButton: true,\n        // progressBar: true,\n        positionClass: 'toast-top-center',\n        showDuration: '200',\n        hideDuration: '300',\n        timeOut: '2000'\n    };\n\n    //on Safari 9, JSON.stringify() causes a bug, so we override it with a MDN polyfill\n    if (utils.isSafari) {\n        CircularJSON = utils.JSONPolyfill;\n    }\n\n    //set back button\n    $('.navbar-back-button').on('click', function () {\n        utils.goBack();\n    });\n\n    //set undo button\n    $('.main__tabs__undo-btn').off().on('click', function () {\n        undo.execute();\n    });\n\n    //todo disable text selection if it causes problems with drag and drop\n\n    //make text not selectable for sortable\n    formbuilder.dom.inputs_collection.disableSelection();\n\n    /*********************************************************/\n    /******* attach UI dom events and event handlers *********/\n\n    draggable();\n\n    //init inputs collection as a sortable (it is also droppable by default)\n    sortable();\n\n    //handle click action on input properties panel in the right sidebar (use event delegation)\n    formbuilder.dom.input_properties.off().on('click', 'button.btn, .possible_answer-more-action', input_properties_click_callback);\n\n    //handle click on the advanced tab button\n    formbuilder.dom.input_properties.on('click', '.advanced-tab', input_properties_advanced_tab_callback);\n\n    //attach delegate event to mousedown so we cover both clicks and click hold + drag\n    formbuilder.dom.inputs_collection_sortable.on('mousedown', 'div.input', input_collection_sortable_mousedown_callback);\n\n    //triggered when users focus on a select of the input properties panel\n    formbuilder.dom.input_properties.on('focus', 'select', input_properties_focus_callback);\n\n    //triggered when users change selected option in the input properties panel\n    formbuilder.dom.input_properties.on('change', 'select', input_properties_change_callback);\n\n    //triggered when users check/unckeck title in the input properties panel\n    formbuilder.dom.input_properties.on('change', '.input-properties__form__title-flag input', input_properties_title_checkbox_callback);\n\n    //triggered when user navigates form hierarchy using the forms tabs\n    formbuilder.dom.forms_tabs.on('click', 'a[data-toggle=\"tab\"]', form_tab_click_callback);\n\n    //triggered when user navigates form hierarchy using the forms tabsx\n    formbuilder.dom.save_project_btn.off().on('click', save_project_click_callback);\n\n    //triggered when user wants to export a form\n    formbuilder.dom.inputs_collection.on('click', '.inputs-collection__export-form', function (e) {\n\n        //avoid any action if option in dropdown is disabled\n        if ($(e.target).parent().hasClass(consts.DISABLED_STATE)) {\n            return false\n        }\n\n        export_form_click_callback();\n    });\n\n    //triggered when user wants to export a form\n    formbuilder.dom.inputs_collection.on('click', '.inputs-collection__print-as-pdf', function (e) {\n\n        //avoid any action if option in dropdown is disabled\n        if ($(e.target).parent().hasClass(consts.DISABLED_STATE)) {\n            return false\n        }\n\n        print_as_pdf_click_callback();\n    });\n\n    //triggered when the user wants to import a form\n    formbuilder.dom.inputs_collection.find('.inputs-collection__form-import input').off('change').on('change', function () {\n        import_form_click_callback(this.files);\n        $(this).val(null);\n    });\n\n    //triggered when the user wants to remove all questions at once\n    formbuilder.dom.inputs_collection.on('click', '.inputs-collection__delete-all-questions', function (e) {\n        delete_all_questions_callback();\n    });\n\n    //validate question text/ group or branch header, possible answer text on keyup\n    formbuilder.dom.input_properties\n        .off('keyup')\n        .on('keyup', '.input-properties__form__question input, .input-properties__form__possible-answers__list__possible_answer_item input', input_properties_keyup_callback);\n\n    //blur links after closing modals\n    $(document).on('hidden.bs.modal', function (e) {\n        $('a').blur();\n    });\n\n    //show project name in navbar\n    formbuilder.dom.navbar.find('.navbar-project-name span').text(project_name);\n\n    //show project logo in sidebar\n    //'var logo_url = https://test.epicollect.net/api/internal/json/media/ants-project?type=photo&name=logo.jpg&format=project_mobile_logo'\n    console.log(consts.PROJECT_URL);\n    console.log(window.location.href);\n\n    //for live server only\n    // if (window.location.href.indexOf('localhost/') === -1 && window.location.href.indexOf('epicollect5-formbuilder/') === -1) {\n    utils.setProjectLogoUrl();\n    formbuilder.dom.navbar.find('.navbar-project-name img').attr('src', consts.PROJECT_LOGO_URL);\n    // }\n    //else {\n    //  formbuilder.dom.navbar.find('.navbar-project-name img').remove();\n    // }\n\n    //show name of first form in navbar and inputs collection container\n\n    formbuilder.dom.inputs_collection.find('.inputs-collection__header__edit-state').text(messages.labels.EDITING_FORM);\n    formbuilder.dom.inputs_collection.find('.inputs-collection__header__element-name').text(first_form_name.trunc(consts.INPUTS_COLLECTION_FORM_NAME_MAX_DISPLAY_LENGHT));\n    formbuilder.dom.input_properties.find('.question-preview').text('');\n\n    //set form name in form tab\n    ui.forms_tabs.setFirstFormTabName(first_form_name);\n\n    //hide properties panel buttons as no input is selected\n    formbuilder.dom.input_properties_buttons.fadeOut();\n\n    /*********************************************************/\n\n    //init help popovers and tooltips\n    $('[data-toggle=\"popover\"]').popover();\n    $('[data-toggle=\"tooltip\"]').tooltip();\n\n    //edit form name modal handler\n    $('.main__modal--edit-form-name').on('show.bs.modal', modal_edit_form_name_callback);\n\n    //regex modal handler\n    $('#info-regex').on('show.bs.modal', modal_regex_callback);\n\n    //render project from project definition json\n    formbuilder.render_action = consts.RENDER_ACTION_DO;\n    $.when(parse.renderProject(formbuilder.project_definition)).then(function () {\n\n        //set initial state, now after render all the inputs have the 'dom' property\n        var state = {\n            project_definition: JSON.parse(JSON.stringify(formbuilder.project_definition)),\n            active_input_ref: null,\n            active_form_index: 0,\n            active_form_ref: formbuilder.project_definition.data.project.forms[0].ref\n        };\n\n        //set state as the starting state pushing a deep copy\n        formbuilder.state.push(state);\n\n        //hide loader and show formbuilder containers\n        formbuilder.dom.loader.fadeOut(consts.ANIMATION_FAST);\n        formbuilder.dom.navbar.removeClass('hidden').hide().fadeIn(consts.ANIMATION_FAST);\n        formbuilder.dom.main_container.removeClass('hidden').hide().fadeIn(consts.ANIMATION_FAST);\n    });\n\n    $(window).on('beforeunload', function () {\n        return 'Are you sure you want to leave?';\n    });\n};\n\nmodule.exports = init;\n\n","'use strict';\n\nvar consts = require('config/consts');\n\nvar messages = {\n\n    labels: {\n        EDITING_FORM: 'Form > ',\n        EDITING_BRANCH: 'Branch > ',\n        EDITING_GROUP: 'Group > ',\n        EDITING_NESTED_GROUP: ' Group: ',\n        EXIT_EDITING: 'Back',\n        ADD_BRANCH_INPUTS_HERE: 'Add branch questions here',\n        ADD_GROUP_INPUTS_HERE: 'Add group questions here'\n    },\n    success: {\n        INPUT_VALID: 'Question valid!',\n        FORM_IMPORTED: 'Form import succeeded!',\n        POSSIBLE_ANSWERS_IMPORTED: 'Possible answers import succeeded!',\n        PROJECT_SAVED: 'Project saved!',\n        JUMP_DELETED: 'Jump deleted!',//this should be a warning\n        INPUT_COPIED: 'Question copied!'\n    },\n    error: {\n        FORM_CANNOT_BE_DELETED: 'Form cannot be deleted',\n        FORM_NAME_EMPTY: 'Form name cannot be empty',\n        FORM_NAME_INVALID: 'Form name is invalid',\n        FORM_FILE_INVALID: 'Form file is invalid',\n        FORM_IS_INVALID: 'Form is invalid',\n        FORM_NAME_EXIST: 'Form name exists',\n        INPUT_NOT_VALID: 'Question NOT valid!',\n        INPUT_NOT_SELECTED: 'No question selected',\n        POSSILE_ANSWERS_CUSTOM_ID_CANNOT_SWITCH_BACK: 'Cannot switch back to basic mode',\n        QUESTION_TEXT_EMPTY: 'This field cannot be empty',\n        POSSIBLE_ANSWER_EMPTY: 'Answer text cannot be empty',\n        VALUE_MUST_BE_INTEGER: 'Value must be an integer',\n        MIN_MUST_BE_SMALLER_THAN_MAX: 'Min value must be smaller than Max',\n        INITIAL_ANSWER_OUT_OF_RANGE: 'Value is out of range',\n        INITIAL_ANSWER_NOT_MATCHING_REGEX: 'Value does not match regex',\n        INITIAL_ANSWER_NOT_PHONE_NUMBER: 'Value is not a phone number',\n        NO_QUESTION_TEXT_YET: 'No question text yet',\n        NO_BRANCH_HEADER_YET: 'No branch header yet',\n        NO_GROUP_HEADER_YET: 'No group header yet',\n        NO_BRANCH_INPUTS_FOUND: 'No branch questions found',\n        NO_GROUP_INPUTS_FOUND: 'No group questions found',\n        INVALID_BRANCH_INPUTS: 'There are invalid branch questions',\n        INVALID_GROUP_INPUTS: 'There are invalid group questions',\n        JUMP_CONDITION_NOT_SELECTED: 'You must choose a condition',\n        JUMP_ANSWER_NOT_SELECTED: 'You must choose an answer',\n        JUMP_DESTINATION_NOT_SELECTED: 'You must choose a valid destination',\n        JUMP_DESTINATION_INVALID: 'Invalid destination',\n        PROJECT_NOT_SAVED: 'Project error!',\n        JUMP_INVALID: 'Invalid jump on question:',\n        JUMPS_INVALID: 'Some jumps are invalid',\n        POSSIBLE_ANSWERS_INVALID: 'Some possible answers are invalid',\n        CSV_FILE_INVALID: 'CSV file is invalid!',\n        BROWSER_NOT_SUPPORTED: 'Browser not supported',\n        MAX_QUESTIONS_LIMIT_REACHED: 'Questions limit reached for this form!',\n        TOO_MANY_SEARCH_QUESTIONS: 'Too many search questions, only ' + consts.LIMITS.search_inputs_max + '  per project are allowed!',\n        TOO_MANY_TITLES: 'Too many titles',\n        TOO_MANY_QUESTIONS_FOR_CURRENT_FORM: 'Too many questions for this form: ',\n        QUESTION_LENGTH_LIMIT_EXCEEDED: 'Characters limit exceeded'\n    },\n    warning: {\n        POSSIBILE_ANSWER_HAS_LINKED_JUMP: 'There is a jump linked to this answer, please remove it first!',\n        INPUT_DELETED: 'Question deleted!',\n        FORM_DELETED: 'Form deleted!',\n        SEARCH_INPUTS_LIMIT_REACHED: 'Search questions limit reached!'\n    }\n};\n\nmodule.exports = messages;\n","'use strict';\nvar options = {\n    closeButton: true,\n    positionClass: 'toast-top-center',\n    preventDuplicates: true,\n    onclick: null,\n    showDuration: 500,\n    hideDuration: 500,\n    extendedTimeOut: 0,\n    showMethod: 'fadeIn',\n    hideMethod: 'fadeOut'\n};\n\nvar toast = {\n    showSuccess: function (message) {\n        options.timeOut = 2000;\n        window.toastr.options = options;\n        window.toastr.success(message);\n    },\n\n    showError: function (message, timeout) {\n        options.timeOut = timeout || 0;\n        window.toastr.options = options;\n        window.toastr.error(message);\n    },\n\n    showWarning: function (message, timeout) {\n        options.timeOut = timeout || 0;\n        window.toastr.options = options;\n        window.toastr.warning(message);\n    },\n\n    clear: function () {\n        window.toastr.clear();\n    }\n};\n\nmodule.exports = toast;\n\n","'use strict';\nvar formbuilder = require('config/formbuilder');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar consts = require('config/consts');\nvar messages = require('config/messages');\nvar input_properties_click_callback = require('ui-handlers/event-handler-callbacks/input-properties-click-callback');\nvar input_properties_focus_callback = require('ui-handlers/event-handler-callbacks/input-properties-focus-callback');\nvar delete_form_click_callback = require('ui-handlers/event-handler-callbacks/delete-form-click-callback');\nvar export_form_click_callback = require('ui-handlers/event-handler-callbacks/export-form-click-callback');\nvar print_as_pdf_click_callback = require('ui-handlers/event-handler-callbacks/print-as-pdf-click-callback');\nvar input_collection_sortable_mousedown_callback = require('ui-handlers/event-handler-callbacks/input-collection-sortable-mousedown-callback');\nvar input_properties_keyup_callback = require('ui-handlers/event-handler-callbacks/input-properties-keyup-callback');\nvar input_properties_title_checkbox_callback = require('ui-handlers/event-handler-callbacks/input-properties-title-checkbox-callback');\nvar delete_all_questions_callback = require('ui-handlers/event-handler-callbacks/delete-all-questions-click-callback');\nvar save_project_click_callback = require('ui-handlers/event-handler-callbacks/save-project-click-callback');\nvar validation = require('actions/validation');\nvar form;\nvar forms;\n\nvar form_factory = {\n\n    createTabButton: function () {\n\n        //create new tab button, append after latest form tab button\n        var form_tab_button_html = ui.forms_tabs.getFormTabButtonHTML(form);\n        var form_tab_buttons = formbuilder.dom.forms_tabs.find('li.main__tabs__form-btn');\n        form_tab_buttons.eq(form_tab_buttons.length - 1).after(form_tab_button_html);\n    },\n\n    createChildForm: function (the_form_name, the_form_ref, the_form_index, is_creating_new_child_form) {\n\n        var self = this;\n        var deferred = new $.Deferred();\n        form = {};\n        form.name = the_form_name;\n        form.slug = utils.slugify(the_form_name);\n        form.ref = the_form_ref;\n        form.type = consts.FORM_HIERARCHY_TYPE;\n        formbuilder.current_form_index = the_form_index;\n        formbuilder.current_form_ref = form.ref;\n        forms = formbuilder.project_definition.data.project.forms;\n\n        self.createTabButton();\n\n        if (is_creating_new_child_form) {\n            form.inputs = [];\n            formbuilder.project_definition.data.project.forms[the_form_index] = form;\n        }\n        else {\n            //set the form tab button to a valid green check as a parsed from must be valid\n            ui.forms_tabs.showFormValidIcon(formbuilder.current_form_index);\n        }\n\n        //create new tab content\n        $.when(ui.forms_tabs.getFormTabContentHTML(form)).then(function (html) {\n\n            formbuilder.dom.forms_tabs_content.append(html);\n\n            //update formbuilder dom references to point to the new form markup\n            self.updateFormbuilderDomReferences(form.ref);\n\n            //show name of form in tab and inputs collection container, truncating form name (>10) for UI purposes\n            formbuilder.dom.inputs_collection.find('.inputs-collection__header__edit-state').text(messages.labels.EDITING_FORM);\n            formbuilder.dom.inputs_collection.find('.inputs-collection__header__element-name').text(form.name.trunc(consts.INPUTS_COLLECTION_FORM_NAME_MAX_DISPLAY_LENGHT - (forms.length * 2)));\n\n            //show empty input question preview\n            ui.input_properties_panel.showInputQuestionPreview('');\n\n            //enable delete form button as the new form will be the last child\n            // (it is possible to delete from the last child up to the first child up to the top form which cannot be deleted)\n            formbuilder.dom.inputs_collection.find('.inputs-collection__buttons .inputs-collection__buttons--remove-form').prop('disabled', false);\n\n            //switch to newly created form/tab when creating a child form only, not when rendering an existing project for editing\n            if (is_creating_new_child_form) {\n\n                formbuilder.dom.forms_tabs.find('li a[href=\"#' + form.ref + '-tabpanel\"]').tab('show');\n\n                //bind event handlers\n                self.bindFormPanelsEvents();\n            }\n\n            deferred.resolve();\n        });\n\n        return deferred.promise();\n    },\n\n    removeForm: function (previous_form_ref, form_ref, form_tab) {\n\n        //delete form from project definition (it is always the last one)\n        formbuilder.project_definition.data.project.forms.pop();\n\n        //remove form markup from dom (a single tabpanel, which has got both the input collection and the inputs properties)\n        formbuilder.dom.forms_tabs_content.find('#' + form_ref + '-tabpanel').remove();\n\n        //remove tab\n        form_tab.remove();\n\n        //set form state to previous\n        formbuilder.current_form_index--;\n\n        //set ref to previous form\n        formbuilder.current_form_ref = previous_form_ref;\n        form_ref = previous_form_ref;\n\n        //update formbuilder dom references to point to the selected form markup\n        form_factory.updateFormbuilderDomReferences(form_ref);\n\n        //enable delete form button for previous form as it becomes the last (aside from fist form)\n        if (formbuilder.current_form_index !== 0) {\n            formbuilder.dom.inputs_collection\n                .find('.inputs-collection__buttons .inputs-collection__buttons--remove-form')\n                .prop('disabled', false);\n        }\n\n        //show add form button if total is less than max number of forms\n        if (formbuilder.project_definition.data.project.forms.length < consts.MAX_NUMBER_OF_NESTED_CHILD_FORMS) {\n            formbuilder.dom.forms_tabs.find('.main__tabs_add-form').parent().show();\n        }\n\n        //resize form tabs\n        ui.forms_tabs.resizeFormTabs();\n\n\n        //enable save project button if all inputs are valid\n        if (validation.areAllInputsValid(formbuilder.project_definition)) {\n            //console.log('** all good **');\n            //enable save project button\n            ui.navbar.toggleSaveProjectBtn(consts.BTN_ENABLED);\n            formbuilder.dom.save_project_btn.off().on('click', save_project_click_callback);\n        }\n    },\n\n    updateFormbuilderDomReferences: function (the_form_ref) {\n\n        var form_ref = the_form_ref;\n\n        //update formbuilder dom references to point to the currently active form markup\n        formbuilder.dom.input_properties = $('#' + form_ref + '-input-properties.input-properties');\n        formbuilder.dom.input_properties_forms_wrapper = $('#' + form_ref + '-input-properties.input-properties > .panel > .panel-body.input_properties__forms_wrapper');\n        formbuilder.dom.input_properties_buttons = $('#' + form_ref + '-input-properties .input-properties__buttons');\n\n        //todo check this\n        formbuilder.dom.input_properties_no_input_selected = $('.input-properties__no-input-selected');\n\n        formbuilder.dom.inputs_collection = $('#' + form_ref + '-inputs-collection.inputs-collection');\n        formbuilder.dom.inputs_collection_sortable = $('#' + form_ref + '-inputs-collection.inputs-collection .panel .panel-body');\n\n    },\n\n    bindFormPanelsEvents: function () {\n\n        var sortable = require('ui-handlers/sortable');\n        var import_form_click_callback = require('ui-handlers/event-handler-callbacks/import-form-click-callback');\n\n        sortable();\n\n        //attach delegate event to mousedown so we cover both clicks and click hold + drag\n        formbuilder.dom.inputs_collection_sortable.on('mousedown', 'div.input', input_collection_sortable_mousedown_callback);\n\n        //handle click action on input properties panel in the right sidebar (use event delegation)\n        //todo test this if it is unbinding other events\n        formbuilder.dom.input_properties.off('click').on('click', 'button.btn, .possible_answer-more-action', input_properties_click_callback);\n        //triggered when users focus on a select of the input properties panel\n        formbuilder.dom.input_properties.on('focus', 'select', input_properties_focus_callback);\n\n        //triggered when user wants to delete a form\n        formbuilder.dom.inputs_collection.find('.inputs-collection__buttons--remove-form').off('click').on('click', delete_form_click_callback);\n        //formbuilder.dom.inputs_collection.on('click', '.inputs-collection__buttons--remove-form', delete_form_click_callback);\n\n        //triggered when user wants to export a form\n        formbuilder.dom.inputs_collection.find('.inputs-collection__export-form').off('click').on('click', function (e) {\n\n            //avoid any action if option in dropdown is disabled\n            if ($(e.target).parent().hasClass(consts.DISABLED_STATE)) {\n                return false\n            }\n\n            export_form_click_callback();\n        });\n\n        //triggered when the user wants to remove all questions at once\n        formbuilder.dom.inputs_collection.on('click', '.inputs-collection__delete-all-questions', function (e) {\n            delete_all_questions_callback();\n        });\n\n        //triggered when user wants to export a form\n        formbuilder.dom.inputs_collection.find('.inputs-collection__print-as-pdf').off('click').on('click', function (e) {\n\n            //avoid any action if option in dropdown is disabled\n            if ($(e.target).parent().hasClass(consts.DISABLED_STATE)) {\n                return false\n            }\n            print_as_pdf_click_callback();\n        });\n\n        //triggered when the user wants to import a form\n        formbuilder.dom.inputs_collection.find('.inputs-collection__form-import input').off('change').on('change', function () {\n            import_form_click_callback(this.files);\n            $(this).val(null);\n\n        });\n\n        //validate question text/ group or branch header on keyup\n        formbuilder.dom.input_properties.on('keyup', '.input-properties__form__question input', input_properties_keyup_callback);\n\n        //triggered when users check/unckeck title in the input properties panel\n        formbuilder.dom.input_properties.on('change', '.input-properties__form__title-flag input', input_properties_title_checkbox_callback);\n    },\n\n    unbindFormPanelsEvents: function () {\n\n        formbuilder.dom.input_properties.off();\n        formbuilder.dom.inputs_collection.off();\n\n        //destroy sortable only if it is set already (see http://goo.gl/riN4Yk)\n        if (formbuilder.dom.inputs_collection_sortable.data('ui-sortable')) {\n            formbuilder.dom.inputs_collection_sortable.sortable('destroy');//Remove the plugin functionality\n        }\n        formbuilder.dom.inputs_collection_sortable.off();\n    }\n};\n\nmodule.exports = form_factory;\n","/* global $*/\n'use strict';\nvar consts = require('config/consts');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar AudioInput = require('inputs/audio');\nvar BarcodeInput = require('inputs/barcode');\nvar BranchInput = require('inputs/branch');\nvar CheckboxInput = require('inputs/checkbox');\nvar DateInput = require('inputs/date');\nvar DropdownInput = require('inputs/dropdown');\nvar LocationInput = require('inputs/location');\nvar NumericInput = require('inputs/integer');\nvar PhotoInput = require('inputs/photo');\nvar PhoneInput = require('inputs/phone');\nvar RadioInput = require('inputs/radio');\nvar TextInput = require('inputs/text');\nvar TextareaInput = require('inputs/textarea');\nvar ReadmeInput = require('inputs/readme');\nvar TimeInput = require('inputs/time');\nvar VideoInput = require('inputs/video');\nvar GroupInput = require('inputs/group');\nvar SearchInput = require('inputs/search');\nvar formbuilder = require('config/formbuilder');\nvar possible_answers = require('actions/possible-answers');\nvar jumps = require('actions/jumps');\nvar template = require('template');\n\n/**\n * Define an interface for creating an object, but let subclasses decide which class to instantiate.\n * Factory Method lets a class defer instantiation to subclasses.\n */\nvar input_factory = {\n\n    //set default input as type text\n    type: TextInput,\n\n    //create input based on type, set also index unique to each input\n    createInput: function (the_type, the_input_ref) {\n\n        var type = the_type;\n        var input_ref = the_input_ref;\n\n        switch (type) {\n            case consts.AUDIO_TYPE:\n                this.type = AudioInput;\n                break;\n            case consts.BARCODE_TYPE:\n                this.type = BarcodeInput;\n                break;\n            case consts.BRANCH_TYPE:\n                this.type = BranchInput;\n                break;\n            case consts.CHECKBOX_TYPE:\n                this.type = CheckboxInput;\n                break;\n            case consts.DATE_TYPE:\n                this.type = DateInput;\n                break;\n            case consts.DROPDOWN_TYPE:\n                this.type = DropdownInput;\n                break;\n            case consts.GROUP_TYPE:\n                this.type = GroupInput;\n                break;\n            case consts.LOCATION_TYPE:\n                this.type = LocationInput;\n                break;\n            case consts.INTEGER_TYPE:\n                this.type = NumericInput;\n                break;\n            case consts.DECIMAL_TYPE:\n                this.type = NumericInput;\n                break;\n            case consts.PHONE_TYPE:\n                this.type = PhoneInput;\n                break;\n            case consts.PHOTO_TYPE:\n                this.type = PhotoInput;\n                break;\n            case consts.RADIO_TYPE:\n                this.type = RadioInput;\n                break;\n            case consts.TEXT_TYPE:\n                this.type = TextInput;\n                break;\n            case consts.TEXTAREA_TYPE:\n                this.type = TextareaInput;\n                break;\n            case consts.README_TYPE:\n                this.type = ReadmeInput;\n                break;\n            case consts.TIME_TYPE:\n                this.type = TimeInput;\n                break;\n            case consts.VIDEO_TYPE:\n                this.type = VideoInput;\n                break;\n            case consts.SEARCH_SINGLE_TYPE:\n                this.type = SearchInput;\n                break;\n            case consts.SEARCH_MULTIPLE_TYPE:\n                this.type = SearchInput;\n                break;\n        }\n\n        return new this.type(input_ref);\n    },\n\n    //remove input from dom and memory\n    removeInput: function (the_ref) {\n\n        var undo = require('actions/undo');\n        var input_ref = the_ref;\n        var input_index = utils.getInputCurrentIndexByRef(input_ref);\n        var input = utils.getInputObjectByRef(input_ref);\n\n        //remove element from global array in memory\n        formbuilder.project_definition.data.project.forms[formbuilder.current_form_index].inputs.splice(input_index, 1);\n\n        //remove properties dom elements (right sidebar)\n        formbuilder.dom.input_properties.find('div.panel-body form[data-input-ref=\"' + input_ref + '\"]').fadeOut(consts.ANIMATION_FAST).remove();\n\n        //remove input from dom collection (middle column)\n        formbuilder.dom.inputs_collection_sortable.find('div.input[data-input-ref=\"' + input_ref + '\"]').fadeOut(consts.ANIMATION_FAST).remove();\n\n        //after deletion no input is selected, show message and hide context buttons\n        formbuilder.dom.input_properties_no_input_selected.fadeIn(consts.ANIMATION_FAST);\n        //show action button for input\n        formbuilder.dom.input_properties_buttons.fadeOut(consts.ANIMATION_FAST);\n\n        //remove track of this input\n        formbuilder.current_input_ref = undefined;\n        if (input.type === consts.SEARCH_SINGLE_TYPE || input.type === consts.SEARCH_MULTIPLE_TYPE) {\n            if (utils.getSearchInputsTotal() <= (consts.LIMITS.search_inputs_max - 1)) {\n                ui.input_tools.showSearchInput();\n            }\n        }\n    },\n\n    //remove branch input from dom and memory\n    removeBranchInput: function (the_owner_input_ref, the_branch_input_ref) {\n\n        var owner_input_ref = the_owner_input_ref;\n        var owner_input_index = utils.getInputCurrentIndexByRef(owner_input_ref);\n        var branch_input_ref = the_branch_input_ref;\n        var branch_input_index = utils.getBranchInputCurrentIndexByRef(owner_input_index, branch_input_ref);\n        var form_index = formbuilder.current_form_index;\n        var branch_inputs = formbuilder.project_definition.data.project.forms[form_index].inputs[owner_input_index].branch;\n\n        //remove element from global object in memory (and store the removed element for later use)\n        var branch_input = branch_inputs.splice(branch_input_index, 1)[0];\n\n        //remove properties dom elements (right sidebar)\n        formbuilder.dom.input_properties.find('div.panel-body form[data-input-ref=\"' + branch_input_ref + '\"]').fadeOut(consts.ANIMATION_FAST).remove();\n\n        //remove input from dom collection (middle column)\n        formbuilder.dom.inputs_collection_sortable.find('div.input[data-input-ref=\"' + branch_input_ref + '\"]').fadeOut(consts.ANIMATION_FAST).remove();\n\n        //after deletion no branch input is selected, so show message and hide context buttons\n        formbuilder.dom.input_properties_no_input_selected.fadeIn(consts.ANIMATION_FAST);\n        //hide action button for input\n        formbuilder.dom.input_properties_buttons.fadeOut(consts.ANIMATION_FAST);\n\n        //if branch is empty, show message\n        if (branch_inputs.length === 0) {\n            formbuilder.dom.inputs_collection_sortable.find('.active-branch').find('.input-properties__no-branch-questions-message').show();\n\n            //show invalid icon in active branch\n            ui.inputs_collection.showInputInvalidIcon(formbuilder.branch.active_branch_ref);\n\n            //set the form as invalid\n            ui.forms_tabs.showFormInvalidIcon(formbuilder.current_form_index);\n        }\n\n        //remove track of this input\n        formbuilder.branch.current_input_ref = undefined;\n\n        if (branch_input.type === consts.SEARCH_SINGLE_TYPE || branch_input.type === consts.SEARCH_MULTIPLE_TYPE) {\n            //update search inputs total\n            if (utils.getSearchInputsTotal() <= (consts.LIMITS.search_inputs_max -1)) {\n                ui.input_tools.showSearchInput();\n            }\n        }\n    },\n\n    //remove branch input from dom and memory\n    removeGroupInput: function (the_owner_input_ref, the_group_input_ref) {\n\n        var owner_input_ref = the_owner_input_ref;\n        var owner_input_index = utils.getInputCurrentIndexByRef(owner_input_ref);\n        var group_input_ref = the_group_input_ref;\n        var group_input_index = utils.getGroupInputCurrentIndexByRef(owner_input_index, group_input_ref);\n        var form_index = formbuilder.current_form_index;\n        var group_inputs = formbuilder.project_definition.data.project.forms[form_index].inputs[owner_input_index].group;\n\n        //remove element from global object in memory (and store the removed element for later use)\n        var group_input = group_inputs.splice(group_input_index, 1)[0];\n\n        //remove properties dom elements (right sidebar)\n        formbuilder.dom.input_properties.find('div.panel-body form[data-input-ref=\"' + group_input_ref + '\"]').fadeOut(consts.ANIMATION_FAST).remove();\n\n        //remove input from dom collection (middle column)\n        formbuilder.dom.inputs_collection_sortable.find('div.input[data-input-ref=\"' + group_input_ref + '\"]').fadeOut(consts.ANIMATION_FAST).remove();\n\n        //after deletion no group input is selected, so show message and hide context buttons\n        formbuilder.dom.input_properties_no_input_selected.fadeIn(consts.ANIMATION_FAST);\n        //hide action button for input\n        formbuilder.dom.input_properties_buttons.fadeOut(consts.ANIMATION_FAST);\n\n        //if group is empty, show message\n        if (group_inputs.length === 0) {\n            formbuilder.dom.inputs_collection_sortable.find('.active-group').find('.input-properties__no-group-questions-message').show();\n\n            //show invalid icon in active branch\n            ui.inputs_collection.showInputInvalidIcon(formbuilder.group.active_group_ref);\n\n            //set the form as invalid\n            ui.forms_tabs.showFormInvalidIcon(formbuilder.current_form_index);\n        }\n\n        //remove track of this input\n        formbuilder.group.current_input_ref = undefined;\n\n        if (group_input.type === consts.SEARCH_SINGLE_TYPE || group_input.type === consts.SEARCH_MULTIPLE_TYPE) {\n            if (utils.getSearchInputsTotal() <= (consts.LIMITS.search_inputs_max -1)) {\n                ui.input_tools.showSearchInput();\n            }\n        }\n    },\n\n    removeNestedGroupInput: function (the_owner_input_branch_ref, the_nested_group_ref) {\n\n        var nested_group_ref = the_nested_group_ref;\n        var form_index = formbuilder.current_form_index;\n        var owner_input_index = utils.getInputCurrentIndexByRef(formbuilder.current_input_ref);\n        var owner_branch = utils.getInputObjectByRef(formbuilder.branch.active_branch_ref);\n        var owner_branch_index = utils.getBranchInputCurrentIndexByRef(owner_input_index, formbuilder.branch.current_input_ref);\n        var nested_group_index = utils.getNestedGroupInputCurrentIndexByRef(owner_branch, nested_group_ref);\n        var nested_group_inputs = formbuilder.project_definition.data.project\n            .forms[form_index]\n            .inputs[owner_input_index]\n            .branch[owner_branch_index]\n            .group;\n\n        //remove element from global object in memory (and store the removed element for later use)\n        var nested_group_input = nested_group_inputs.splice(nested_group_index, 1)[0];\n\n        //remove properties dom elements (right sidebar)\n        formbuilder.dom.input_properties.find('div.panel-body form[data-input-ref=\"' + nested_group_ref + '\"]').fadeOut(consts.ANIMATION_FAST).remove();\n\n        //remove input from dom collection (middle column)\n        formbuilder.dom.inputs_collection_sortable.find('div.input[data-input-ref=\"' + nested_group_ref + '\"]').fadeOut(consts.ANIMATION_FAST).remove();\n\n        //after deletion no group input is selected, so show message and hide context buttons\n        formbuilder.dom.input_properties_no_input_selected.fadeIn(consts.ANIMATION_FAST);\n        //hide action button for input\n        formbuilder.dom.input_properties_buttons.fadeOut(consts.ANIMATION_FAST);\n\n        //if group is empty, show message\n        if (nested_group_inputs.length === 0) {\n            formbuilder.dom.inputs_collection_sortable.find('.active-group').find('.input-properties__no-group-questions-message').show();\n\n            //show invalid icon in active branch\n            ui.inputs_collection.showInputInvalidIcon(formbuilder.group.active_group_ref);\n\n            //set the form as invalid\n            ui.forms_tabs.showFormInvalidIcon(formbuilder.current_form_index);\n        }\n\n        //remove track of this input\n        formbuilder.group.current_input_ref = undefined;\n\n        if (nested_group_input.type === consts.SEARCH_SINGLE_TYPE || nested_group_input.type === consts.SEARCH_MULTIPLE_TYPE) {\n            if (utils.getSearchInputsTotal() <= (consts.LIMITS.search_inputs_max -1)) {\n                ui.input_tools.showSearchInput();\n            }\n        }\n    },\n\n    //todo this is a bit of code duplication, to be refactored\n    showGroupInputPropertiesDom: function (the_group_input_index) {\n\n        var form_index = formbuilder.current_form_index;\n        var owner_input_ref = formbuilder.current_input_ref;\n        var owner_input_index = utils.getInputCurrentIndexByRef(owner_input_ref);\n        var group_input_index = the_group_input_index;\n        var group_input = formbuilder.project_definition.data.project.forms[form_index].inputs[owner_input_index].group[group_input_index];\n        var input_properties_forms_wrapper = formbuilder.dom.input_properties_forms_wrapper;\n        var view = formbuilder.dom.input_properties_views[group_input.type];\n\n        input_properties_forms_wrapper.append(view).hide().fadeIn(consts.ANIMATION_FAST);\n\n        //init properties panel\n        //todo\n        //helpers.initInputPropertiesPanel(input_properties_forms_wrapper, group_input, formbuilder.dom.partials);\n    },\n\n    //todo this is a bit of code duplication, to be refactored\n    showNestedGroupInputPropertiesDom: function (the_nested_group_input_index) {\n\n\n        console.log(formbuilder.project_definition.data.project.forms);\n\n        var form_index = formbuilder.current_form_index;\n        var branch_index = utils.getInputCurrentIndexByRef(formbuilder.current_input_ref);\n        var group_index = utils.getBranchInputCurrentIndexByRef(branch_index, formbuilder.group.active_group_ref);\n        var nested_group_index = the_nested_group_input_index;\n        var nested_group_input = formbuilder.project_definition.data.project\n            .forms[form_index]\n            .inputs[branch_index]\n            .branch[group_index]\n            .group[nested_group_index];\n\n        var input_properties_forms_wrapper = formbuilder.dom.input_properties_forms_wrapper;\n        var view = formbuilder.dom.input_properties_views[nested_group_input.type];\n\n        input_properties_forms_wrapper.append(view).hide().fadeIn(consts.ANIMATION_FAST);\n\n    },\n\n    createInputToolHTML: function (input) {\n        return template.createInputToolHTML(input);\n    },\n\n    createPropertiesHTML: function (input) {\n        return template.createPropertiesHTML(input);\n    },\n    getAdvancedTabBtnHTML: function (ref, is_active) {\n        return template.getAdvancedTabBtnHTML(ref, is_active);\n    },\n    getJumpTabBtnHTML: function (ref, is_active) {\n        return template.getJumpTabBtnHTML(ref, is_active);\n    }\n};\n\nmodule.exports = input_factory;\n","/* global $*/\n'use strict';\nvar consts = require('config/consts');\nvar errors = require('actions/errors');\nvar jumps = require('actions/jumps');\nvar save = require('actions/save');\nvar possible_answers = require('actions/possible-answers');\nvar validation = require('actions/validation');\nvar formbuilder = require('config/formbuilder');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar template = require ('template');\n\nvar InputMultipleAnswers = function () {\n};\n\nInputMultipleAnswers.prototype.prepareAdvancedInputProperties = function (view) {\n    return template.prepareAdvancedInputProperties(view, this);\n};\n\nInputMultipleAnswers.prototype.setAdvancedInputProperties = function () {\n\n    this.dom.advanced_properties_wrapper = formbuilder.dom.input_properties_forms_wrapper\n        .find('form[data-input-ref=\"' + this.ref + '\"]')\n        .find('.input-properties__form__advanced-properties');\n\n    this.dom.advanced_properties_wrapper\n        .find('div.panel-body div.input-properties__form__advanced-properties__default select option[value=\"' + this.default + '\"]').prop('selected', true);\n\n    //set 'input_ref' on 'uniqueness' option\n    ui.input_properties_panel.setUniquenessProperty(formbuilder.current_form_index, this);\n\n};\n\nInputMultipleAnswers.prototype.saveAdvancedProperties = function () {\n\n    var self = this;\n\n    self.dom.advanced_properties_wrapper = formbuilder.dom.input_properties_forms_wrapper\n        .find('form[data-input-ref=\"' + self.ref + '\"]')\n        .find('.input-properties__form__advanced-properties');\n    //set default\n    this.default = this.dom.advanced_properties_wrapper\n        .find('div.panel-body div.input-properties__form__advanced-properties__default select option:selected')\n        .val();\n\n    if (this.default === 'None') {\n        this.default = null;\n    }\n\n    //for SEARCH type, save if the search allow a single answer or multiple answers\n    if(self.type === consts.SEARCH_SINGLE_TYPE || self.type === consts.SEARCH_MULTIPLE_TYPE) {\n\n        //set single or multiple search type\n        self.type = this.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__search input:checked').val();\n    }\n\n};\n\nInputMultipleAnswers.prototype.hidePropertiesErrors = function () {\n    errors.hidePropertiesErrors(this.dom.properties_panel);\n    errors.hidePossibleAnswersErrors(this);\n};\n\nInputMultipleAnswers.prototype.addPossibleAnswer = function () {\n    possible_answers.addPossibleAnswer(this);\n};\n\nInputMultipleAnswers.prototype.removePossibleAnswer = function (the_answer_index) {\n    possible_answers.removePossibleAnswer(this, the_answer_index);\n};\n\n\nInputMultipleAnswers.prototype.savePossibleAnswers = function () {\n    save.savePossibleAnswers(this);\n};\nInputMultipleAnswers.prototype.showPossibleAnswerErrors = function (the_possible_answer, the_error_message) {\n    errors.showPossibleAnswerErrors(the_possible_answer, the_error_message);\n};\nInputMultipleAnswers.prototype.hidePossibleAnswersErrors = function (the_possible_answers) {\n    errors.hidePossibleAnswersErrors(this, the_possible_answers);\n};\nInputMultipleAnswers.prototype.isPossibleAnswerValid = function (the_answer) {\n    //validate possible answer\n    return validation.isPossibleAnswerValid(the_answer);\n};\n\n/*\n update the selected possible answers for the jumps, in case the possible answers got changed by the user\n this is to refresh the dom when the user change a possible answer text and then switches to the jumps panel:\n if an old option was selected, we reflect that change on the dom\n */\nInputMultipleAnswers.prototype.updateJumpPossibleAnswers = function (the_jump_panel) {\n    possible_answers.updateJumpPossibleAnswers(this, the_jump_panel);\n};\n\nInputMultipleAnswers.prototype.updatePossibleInitialAnswers = function () {\n    possible_answers.updatePossibleInitialAnswers(this);\n};\n\nInputMultipleAnswers.prototype.listPossibleInitialAnswers = function () {\n    possible_answers.listPossibleInitialAnswers(this);\n};\n\nInputMultipleAnswers.prototype.addJump = function () {\n\n    var self = this;\n\n    //set \"Add Jump\" button reference (so it is available when playing with jumps)\n    self.dom.add_jump_button = formbuilder.dom.input_properties\n        .find('.panel-body form[data-input-ref=\"' + self.ref + '\"]')\n        .find('.input-properties__form__jumps__add-jump');\n\n    $.when(jumps.addJump(self, true)).then(function () {\n\n        //disable add jump button if total of jumps is equal to total of possible answers\n        if (self.jumps.length === self.possible_answers.length) {\n            self.dom.add_jump_button.attr('disabled', true);\n        }\n    });\n};\n\n//override the existing method, as we need an extra check for these types of input\nInputMultipleAnswers.prototype.removeJump = function (the_remove_btn) {\n\n    var self = this;\n\n    //set \"Add Jump\" button reference (so it is available when playing with jumps)\n    self.dom.add_jump_button = formbuilder.dom.input_properties\n        .find('.panel-body form[data-input-ref=\"' + self.ref + '\"]')\n        .find('.input-properties__form__jumps__add-jump');\n\n    jumps.removeJump(self, the_remove_btn);\n\n    //enable button if we removed last jump\n    if (self.jumps.length === 0) {\n        //enable add jump button\n        self.dom.add_jump_button.attr('disabled', false);\n    }\n    else {\n        //enable button if we can add jumps\n        if (self.jumps.length < self.possible_answers.length) {\n            self.dom.add_jump_button.attr('disabled', false);\n        }\n    }\n};\n\nmodule.exports = InputMultipleAnswers;\n","'use strict';\n\n//input base properties\nvar inputs_properties = {\n\n    //top level, to be exported when saving project\n   // index: null,\n    ref: null,\n    type: '',\n    question: '',\n    is_title: false,\n    is_required: false,\n    uniqueness: 'none',\n    regex: null,\n    default: null,\n    verify: false,\n    max: null,\n    min: null,\n    datetime_format: null,\n    set_to_current_datetime: false,\n    possible_answers: [],\n    jumps: [],\n    branch: [],\n    group: []\n\n    /**************************************************************************************************************/\n    //this property is not declared here anymore as with jquery the dom is cached and stays the same per each object,\n    //so I will add them later after the object is instantiated\n    ///* DOM properties*/\n    //dom: {\n    //    is_valid: false, //false by default as we sdo not have a question text after drag and drop\n    //    advanced_properties_wrapper: null,\n    //    add_jump_button: null,\n    //    properties_panel:null\n    //}\n    /**************************************************************************************************************/\n};\n\nmodule.exports = inputs_properties;\n","/* global $*/\n'use strict';\nvar consts = require('config/consts');\nvar errors = require('actions/errors');\nvar jumps = require('actions/jumps');\nvar save = require('actions/save');\nvar validation = require('actions/validation');\nvar formbuilder = require('config/formbuilder');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar template = require('template');\n\n\nvar Input = function () {\n};\n\nInput.prototype.prepareAdvancedInputProperties = function () {\n    //override in specific input type\n};\n\nInput.prototype.isQuestionTextValid = function () {\n    //validate question text\n    return validation.isQuestionTextValid(this);\n};\n\nInput.prototype.hideQuestionErrors = function () {\n    this.hidePropertiesErrors();\n};\nInput.prototype.showQuestionErrors = function (the_error_message) {\n    this.showPropertiesErrors(the_error_message);\n};\n\nInput.prototype.isInitialAnswerValid = function () {\n    //validate initial answer\n    return validation.isInitialAnswerValid(this.type, this.default, this.regex);\n};\n\nInput.prototype.isJumpValid = function (the_jump_properties) {\n    //validate initial answer\n    return validation.isJumpValid(the_jump_properties, this);\n};\n\nInput.prototype.saveProperties = function () {\n    save.saveProperties(this);\n};\n\nInput.prototype.saveAdvancedProperties = function () {\n    save.saveAdvancedProperties(this);\n};\n\nInput.prototype.saveJumps = function () {\n    save.saveJumps(this);\n};\n\nInput.prototype.showPropertiesErrors = function (the_error_message) {\n    errors.showQuestionTextErrors(this.dom.properties_panel, the_error_message);\n};\n\nInput.prototype.hidePropertiesErrors = function () {\n    errors.hidePropertiesErrors(this.dom.properties_panel);\n};\n\nInput.prototype.showAdvancedPropertiesErrors = function (the_invalid_property, the_error_message) {\n    errors.showSingleAdvancedPropertyError(this.dom.advanced_properties_wrapper, the_invalid_property, the_error_message);\n};\n\nInput.prototype.hideAdvancedPropertiesErrors = function () {\n    //override in specific input type\n};\n\nInput.prototype.addJump = function () {\n\n    var self = this;\n\n    //set \"Add Jump\" button reference (so it is available when playing with jumps)\n    self.dom.add_jump_button = formbuilder.dom.input_properties\n        .find('.panel-body form[data-input-ref=\"' + self.ref + '\"]')\n        .find('.input-properties__form__jumps__add-jump');\n\n    $.when(jumps.addJump(this)).then(function () {\n        //disable add jump button as this input type only allows to set a single jump\n        self.dom.add_jump_button.attr('disabled', true);\n    });\n};\n\nInput.prototype.removeJump = function (the_remove_btn) {\n\n    var self = this;\n\n    self.dom.add_jump_button = formbuilder.dom.input_properties\n        .find('.panel-body form[data-input-ref=\"' + self.ref + '\"]')\n        .find('.input-properties__form__jumps__add-jump');\n\n    jumps.removeJump(this, the_remove_btn);\n\n    if (this.jumps.length === 0) {\n        //enable add jump button\n        this.dom.add_jump_button.attr('disabled', false);\n    }\n};\n\nInput.prototype.showSingleJumpErrors = function (the_jump_item, the_jump_properties) {\n    errors.showSingleJumpErrors(the_jump_item, the_jump_properties);\n};\nInput.prototype.hideJumpsErrors = function (the_jumps_list) {\n    errors.hideJumpsErrors(the_jumps_list);\n};\n\nmodule.exports = Input;\n","'use strict';\nvar consts = require('config/consts');\nvar utils = require('helpers/utils');\n\nvar valid_date_formats = [\n    consts.DATE_FORMAT_1,\n    consts.DATE_FORMAT_2,\n    consts.DATE_FORMAT_3,\n    consts.DATE_FORMAT_4,\n    consts.DATE_FORMAT_5\n];\n\nvar valid_time_formats = [\n    consts.TIME_FORMAT_1,\n    consts.TIME_FORMAT_2,\n    consts.TIME_FORMAT_3,\n    consts.TIME_FORMAT_4,\n    consts.TIME_FORMAT_5\n];\n\nvar import_form_validation = {\n\n    hasValidFormStructure: function (form) {\n\n        var validFormStructure = {\n            data: {\n                id: '',\n                type: 'form',\n                form: {\n                    ref: '',\n                    name: '',\n                    slug: '',\n                    type: 'hierarchy',\n                    inputs: []\n                }\n            }\n        };\n\n        //compare a valid object against the imported form object if they have the same keys\n        if (!utils.hasSameProps(validFormStructure, form)) {\n            return false;\n        }\n\n        //data type must be form\n        if (form.data.type !== 'form') {\n            return false;\n        }\n\n        //form type must be hierarchy\n        if (form.data.form.type !== 'hierarchy') {\n            return false;\n        }\n\n        //ref, name, slug and inputs props are not considered here\n        return true;\n    },\n\n    areJumpsValid: function (input) {\n\n        var jumps = input.jumps;\n        var are_valid = true;\n        var possible_answers = input.possible_answers;\n        var validJumpStructure = {\n            to: '',\n            when: '',\n            answer_ref: ''\n        };\n\n        var answer_ref_regex = new RegExp(consts.REGEX.possible_answer_ref);\n\n        if (!$.isArray(jumps)) {\n            are_valid = false;\n        }\n        else {\n            $(jumps).each(function (index, jump) {\n\n                var answer_ref_found = false;\n\n                //validate structure\n                if (!utils.hasSameProps(validJumpStructure, jump)) {\n                    are_valid = false;\n                    return false;\n                }\n\n                //if answer_ref is in invalid format, bail out (can be null, we catch that later)\n                if (jump.answer_ref) {\n                    if (!answer_ref_regex.test(jump.answer_ref)) {\n                        are_valid = false;\n                        return false;\n                    }\n                }\n\n                //validate jumps properties values\n                if ($.inArray(input.type, consts.MULTIPLE_ANSWER_TYPES) > -1) {\n                    // multiple choice input\n                    //jump \"to\" value must be an existing \"forward\" input_ref\n                    //todo need next inputs\n\n                    //jump \"to\" must exist in possible answers (it is the answer_ref)\n                    // only if \"when\" is not either ALL or NO_ANSWER_GIVEN\n                    if (!(jump.when === 'ALL' || jump.when === 'NO_ANSWER_GIVEN')) {\n                        $(possible_answers).each(function (index, possible_answer) {\n                            if (jump.answer_ref === possible_answer.answer_ref) {\n                                answer_ref_found = true;\n                            }\n                        });\n\n                        if (!answer_ref_found) {\n                            are_valid = false;\n                            return false;\n                        }\n                    }\n                }\n                else {\n                    //single question, jump \"when\" must be set to ALL\n                    if (jump.when !== 'ALL') {\n                        are_valid = false;\n                        return false;\n                    }\n                }\n\n                // If we have an empty 'to' - error\n                // If we have an empty 'when' - error\n                // If we have an empty 'answer_ref' and 'when' is not 'ALL' or 'NO_ANSWER_GIVEN' - error\n                if (!jump.to || !jump.when ||\n                    (!jump.answer_ref && !(jump.when === 'ALL' || jump.when === 'NO_ANSWER_GIVEN'))\n                ) {\n                    are_valid = false;\n                    return false;\n                }\n\n                //validate \"when\" prop, must be one of the jump conditions\n                var isValidWhenProperty = false;\n                $(consts.JUMP_CONDITIONS).each(function (index, condition) {\n                    if (condition.key === jump.when) {\n                        isValidWhenProperty = true;\n                        return false;\n                    }\n                });\n                if (!isValidWhenProperty) {\n                    are_valid = false;\n                    return false;\n                }\n\n            });\n        }\n\n        return are_valid;\n    },\n\n    areJumpsDestinationsValid: function (inputs) {\n\n        var all_jumps_valid = true;\n\n        $(inputs).each(function (inputIndex, input) {\n\n            //get valid jump destinations\n            var jump_destinations = utils.getJumpAvailableDestinationsAsKeys(inputIndex, input, inputs, false);\n\n            //extra validation for jumps, check if the destination still exists and it is valid\n            $(input.jumps).each(function (jumpIndex, jump) {\n                //does the jump \"to\" property reference a valid destination input?\n                if (!jump_destinations[jump.to]) {\n                    //invalid destination found\n                    all_jumps_valid = false;\n                }\n            });\n\n            //validate branch jumps\n            $(input.branch).each(function (branchInputIndex, branch_input) {\n\n                jump_destinations = utils.getJumpAvailableDestinationsAsKeys(branchInputIndex, branch_input, input.branch, true);\n\n                //extra validation for jumps, check if the destination still exists and it is valid\n                $(branch_input.jumps).each(function (branchJumpIndex, branchJump) {\n                    //does the jump \"to\" property reference a valid destination input?\n                    if (!jump_destinations[branchJump.to]) {\n                        //invalid destination found\n                        all_jumps_valid = false;\n                    }\n                });\n            });\n        });\n\n        return all_jumps_valid;\n    },\n\n    arePossibleAnswersValid: function (possible_answers, input_type) {\n\n        var answer_ref_regex = new RegExp(consts.REGEX.possible_answer_ref);\n        var answer_refs = [];\n        var validPossibleAnswerStructure = {\n            answer: '',\n            answer_ref: ''//this must be unique\n        };\n\n        if (!$.isArray(possible_answers)) {\n            return false;\n        }\n        else {\n            //check possible answer total is within limits\n            if (possible_answers.length > consts.LIMITS.possible_answers_max) {\n                //is this a search type?\n                if (input_type === consts.SEARCH_MULTIPLE_TYPE || input_type === consts.SEARCH_SINGLE_TYPE) {\n                    //limit is higher for search type\n                    if (possible_answers.length > consts.LIMITS.possible_answers_max_search) {\n                        return false;\n                    }\n                }\n                else {\n                    return false;\n                }\n\n            }\n\n            //at least 1 possible answer\n            if (possible_answers.length === 0) {\n                return false;\n            }\n\n            //check possible answer structure\n            var are_possible_answer_valid = true;\n            $(possible_answers).each(function (key, possible_answer) {\n\n                answer_refs.push(possible_answer.answer_ref);\n\n                if (typeof possible_answer.answer_ref !== 'string' || typeof possible_answer.answer !== 'string') {\n                    are_possible_answer_valid = false;\n                    return false;\n                }\n\n                //check answer_ref length\n                if (possible_answer.answer_ref.length !== consts.LIMITS.possible_answer_ref_length) {\n                    are_possible_answer_valid = false;\n                    return false;\n                }\n\n                //check answer_ref to be hex characters\n                if (!answer_ref_regex.test(possible_answer.answer_ref)) {\n                    are_possible_answer_valid = false;\n                    return false;\n                }\n\n                //check answer max length\n                if (possible_answer.answer.length === 0 || possible_answer.answer.length > consts.LIMITS.possible_answer_max_length) {\n                    are_possible_answer_valid = false;\n                    return false;\n                }\n\n                //possible_answer cannot be empty\n                if (possible_answer.answer === '') {\n                    are_possible_answer_valid = false;\n                    return false;\n                }\n\n                //strip html tags from possible answers answer prop\n                possible_answer.answer = possible_answer.answer.replace(/(<([^>]+)>)/ig, ' ');\n\n                if (!utils.hasSameProps(validPossibleAnswerStructure, possible_answer)) {\n                    are_possible_answer_valid = false;\n                    return false;\n                }\n\n                ////check for answer_ref uniqueness\n                ////note: this has bad performance with big arrays\n                //var hasDuplicateAnswerRef = answer_refs.some(function (ref, index) {\n                //    return answer_refs.indexOf(ref) !== index;\n                //});\n\n                var seen = {};\n                var hasDuplicateAnswerRef = possible_answers.some(function (possible_answer) {\n                    return seen.hasOwnProperty(possible_answer.answer_ref) || (seen[possible_answer.answer_ref] === false);\n                });\n\n                if (hasDuplicateAnswerRef) {\n                    are_possible_answer_valid = false;\n                    return false;\n                }\n            });\n\n            if (!are_possible_answer_valid) {\n                return false;\n            }\n        }\n\n        return true;\n    },\n\n    isValidInput: function (form_ref, input, is_branch, is_group) {\n\n        var self = this;\n        var valid = true;\n        var input_ref_regex = new RegExp(consts.REGEX.input_ref);\n        var readme = '';\n\n        var validInputStructure = {\n            ref: '',\n            type: '',\n            question: '',\n            is_title: true,\n            is_required: false,\n            uniqueness: '',\n            regex: null,\n            default: null,\n            verify: false,\n            max: null,\n            min: null,\n            datetime_format: null,\n            set_to_current_datetime: false,\n            possible_answers: [],\n            jumps: [],\n            branch: [],\n            group: []\n        };\n\n        var accepted_types = [\n            consts.TEXT_TYPE,\n            consts.TEXTAREA_TYPE,\n            consts.INTEGER_TYPE,\n            consts.DECIMAL_TYPE,\n            consts.DATE_TYPE,\n            consts.TIME_TYPE,\n            consts.RADIO_TYPE,\n            consts.CHECKBOX_TYPE,\n            consts.DROPDOWN_TYPE,\n            consts.BARCODE_TYPE,\n            consts.LOCATION_TYPE,\n            consts.AUDIO_TYPE,\n            consts.VIDEO_TYPE,\n            consts.PHOTO_TYPE,\n            consts.BRANCH_TYPE,\n            consts.GROUP_TYPE,\n            consts.README_TYPE,\n            consts.PHONE_TYPE,\n            consts.SEARCH_SINGLE_TYPE,\n            consts.SEARCH_MULTIPLE_TYPE\n        ];\n\n        /**\n         * Validate input structure\n         */\n\n        if (!utils.hasSameProps(validInputStructure, input)) {\n            //it means the input structure is invalid\n            return false;\n        }\n\n        /**\n         * Validate ref\n         */\n        if (input.ref && typeof input.ref !== 'boolean') {\n            if (!input.ref.startsWith(form_ref)) {\n                return false;\n            }\n            //check ref structure\n            if (!input_ref_regex.test(input.ref)) {\n                return false;\n            }\n\n            // must have 3 components\n            if (input.ref.split('_').length !== 3) {\n                return false;\n            }\n        }\n        else {\n            return false;\n        }\n\n        //validate ref against regex\n        //(todo)\n\n        /**\n         * Validate type\n         */\n        if ($.inArray(input.type, accepted_types) < 0 || typeof input.type !== 'string') {\n            return false;\n        }\n\n        /**\n         * Validate question\n         */\n        if (input.type === consts.README_TYPE) {\n            //readme type is up to 1000 chars, html is allowed (server catches was it is not)\n            if (typeof input.question !== 'string' || input.question === '') {\n                return false;\n            }\n\n            //first convert html entities to tags\n            readme = utils.decodeHtml(input.question);\n            //then remove all tags\n            readme = readme.replace(/(<([^>]+)>)/ig, ' ');\n\n            //now check the lenght of the remaining pure text ;)\n            if (readme.length > consts.LIMITS.readme_length) {\n                return false;\n            }\n        }\n        else {\n            //any other question\n            if (input.question.length > consts.LIMITS.question_length || typeof input.question !== 'string' || input.question === '') {\n                return false;\n            }\n            else {\n                input.question = input.question.replace(/(<([^>]+)>)/ig, ' ');\n            }\n        }\n\n\n        /**\n         * Validate is_title\n         */\n\n        if (typeof input.is_title !== 'boolean') {\n            return false;\n        }\n\n        /**\n         *  Validate is_required\n         */\n        if (typeof input.is_required !== 'boolean') {\n            return false;\n        }\n        else {\n            //check if we can have required set to true\n            if ($.inArray(input.type, consts.REQUIRED_ALLOWED_TYPES) < 0 && input.is_required === true) {\n                return false;\n            }\n        }\n\n        /**\n         * Validate uniqueness\n         */\n        if ($.inArray(input.type, consts.UNIQUENESS_ALLOWED_TYPES) < 0) {\n            //uniquess must be \"none\"\n            if (input.uniqueness !== consts.UNIQUESS_NONE) {\n                return false;\n            }\n        }\n        else {\n            if (is_branch) {\n                if (!(input.uniqueness === consts.UNIQUESS_NONE || input.uniqueness == consts.UNIQUESS_FORM)) {\n                    return false;\n                }\n            }\n            else {\n                if (!(input.uniqueness === consts.UNIQUESS_NONE || input.uniqueness === consts.UNIQUESS_FORM || input.uniqueness == consts.UNIQUESS_HIERARCHY)) {\n                    return false;\n                }\n            }\n        }\n\n        /**\n         * Validate regex (can be null)\n         */\n        if (input.regex !== null && input.regex !== '') {\n            if (input.regex.length > consts.LIMITS.regex_length || typeof input.regex !== 'string') {\n                return false;\n            }\n        }\n        else {\n            //check if a regex is allowed for this input type?\n            //todo\n\n        }\n\n        /**\n         * Validate default answer\n         */\n        if (input.default !== null && input.default !== '') {\n            if (input.default.length > consts.LIMITS.default_answer_length || typeof input.default !== 'string') {\n                return false;\n            }\n\n            //multiple answers type?\n            if ($.inArray(input.type, consts.MULTIPLE_ANSWER_TYPES) > 0) {\n                //check that the default answer (if set) is one of the possible answers\n                var found = false;\n                $(input.possible_answers).each(function (key, possible_answer) {\n                    if (possible_answer.answer_ref === input.default) {\n                        found = true;\n                        return false;//exit the loop\n                    }\n                });\n\n                if (!found) {\n                    return false;\n                }\n            }\n            else {\n                //valid default answer, strip html tags\n                input.default = input.default.replace(/(<([^>]+)>)/ig, ' ');\n            }\n        }\n\n        /**\n         * Validate verify\n         */\n        if (typeof input.verify !== 'boolean') {\n            return false;\n        }\n\n\n        /**\n         * validate max and min (for numeric types)\n         */\n        if (input.type === consts.INTEGER_TYPE || input.type === consts.DECIMAL_TYPE) {\n            //check min, if it is set must be numeric. can be null\n            if (input.min) {\n\n                if (input.type === consts.INTEGER_TYPE && !utils.isInteger(parseInt(input.min))) {\n                    return false;\n                }\n\n                if (input.type === consts.DECIMAL_TYPE && !$.isNumeric(input.min)) {\n                    return false;\n                }\n\n                if (input.min.toString().length > consts.LIMITS.min_value_length) {\n                    return false;\n                }\n\n            }\n\n            //check min, if it is set must be numeric. can be null\n            if (input.max) {\n\n                //bail if not integer for integer type\n                if (input.type === consts.INTEGER_TYPE && !utils.isInteger(parseInt(input.max))) {\n                    return false;\n                }\n\n                //bail if not numeric for decimal type\n                if (input.type === consts.DECIMAL_TYPE && !$.isNumeric(input.max)) {\n                    return false;\n                }\n\n                if (input.max.toString().length > consts.LIMITS.max_value_length) {\n                    return false;\n                }\n            }\n\n            //if they are both set, check min < max\n            if (input.min && input.max) {\n\n                if (input.type === consts.INTEGER_TYPE) {\n                    if (parseInt(input.min, 10) >= parseInt(input.max, 10)) {\n                        return false;\n                    }\n                }\n\n                if (input.type === consts.DECIMAL_TYPE) {\n                    if (parseFloat(input.min, 10) >= parseFloat(input.max, 10)) {\n                        return false;\n                    }\n                }\n            }\n        }\n\n        /**\n         * Validate date format\n         */\n\n        //date\n        if (input.type === consts.DATE_TYPE) {\n            if (input.datetime_format) {\n                if ($.inArray(input.datetime_format, valid_date_formats) < 0) {\n                    //format not allowed\n                    return false;\n                }\n            }\n        }\n\n        //time\n        if (input.type === consts.TIME_TYPE) {\n            if (input.datetime_format) {\n                if ($.inArray(input.datetime_format, valid_time_formats) < 0) {\n                    //format not allowed\n                    return false;\n                }\n            }\n        }\n\n        /**\n         * Validate set_to_current_datetime\n         */\n        if (input.set_to_current_datetime) {\n            if (typeof input.set_to_current_datetime !== 'boolean') {\n                return false;\n            }\n\n            //it can be true only for date and time input types\n            if (input.set_to_current_datetime === true) {\n                if (!(input.type === consts.DATE_TYPE || input.type === consts.TIME_TYPE)) {\n                    return false;\n                }\n            }\n        }\n\n        /**\n         * Validate possible answers\n         */\n        if ($.inArray(input.type, consts.MULTIPLE_ANSWER_TYPES) > 0) {\n            if (!self.arePossibleAnswersValid(input.possible_answers, input.type)) {\n                return false;\n            }\n        }\n\n        if (!is_branch && !is_group) {\n            /**\n             * Validate jumps\n             */\n            if (!self.areJumpsValid(input)) {\n                return false;\n            }\n\n\n            //top level input, validate branch and group recursively\n\n            //branch\n            if ($.isArray(input.branch)) {\n                $(input.branch).each(function (index, branch_input) {\n                    self.isValidInput(form_ref, branch_input, true, false);\n                });\n            }\n            else {\n                return false;\n            }\n\n            //group\n            if ($.isArray(input.group)) {\n                $(input.group).each(function (index, group_input) {\n                    self.isValidInput(form_ref, group_input, false, true);\n                });\n            }\n            else {\n                return false;\n            }\n\n        }\n        else {\n\n            if (is_branch) {\n                //branch in branch is not allowed\n                if (input.branch.length > 0) {\n                    return false;\n                }\n\n                /**\n                 * Validate jumps\n                 */\n                if (!self.areJumpsValid(input.branch)) {\n                    return false;\n                }\n            }\n\n            if (is_group) {\n                //group in group is not allowed\n                if (input.group.length > 0) {\n                    return false;\n                }\n\n                //jumps in group are not allowed\n                if (input.jumps.length > 0) {\n                    return false;\n                }\n            }\n        }\n        return valid;\n    }\n\n};\n\n\nmodule.exports = import_form_validation;\n","'use strict';\n\nvar formbuilder = require('config/formbuilder');\nvar messages = require('config/messages');\nvar consts = require('config/consts');\nvar jumps = require('actions/jumps');\nvar utils = require('helpers/utils');\nvar load_child_form_containers = require('loaders/load-child-form-containers');\n\nvar ui = {\n\n    navbar: {\n\n        toggleUndoBtn: function (status) {\n\n            if (status === consts.BTN_DISABLED) {\n                //toggle button\n                formbuilder.dom.undo_btn\n                    .attr('disabled', true);\n            }\n\n            if (status === consts.BTN_ENABLED) {\n                //toggle button\n                formbuilder.dom.undo_btn\n                    .attr('disabled', false);\n            }\n        },\n\n        toggleSaveProjectBtn: function (status) {\n\n            if (status === consts.BTN_DISABLED) {\n                //toggle button\n                formbuilder.dom.save_project_btn\n                    .attr('disabled', true);\n\n            }\n\n            if (status === consts.BTN_ENABLED) {\n                //toggle button\n                formbuilder.dom.save_project_btn\n                    .attr('disabled', false);\n            }\n\n            //toggle icon\n            if (status === consts.BTN_ENABLED) {\n                formbuilder\n                    .dom.save_project_btn\n                    .find('.project-state')\n                    .removeClass('fa-warning')\n                    .addClass('fa-check');\n            }\n            else {\n                formbuilder\n                    .dom.save_project_btn\n                    .find('.project-state')\n                    .addClass('fa-warning')\n                    .removeClass('fa-check');\n            }\n        }\n    },\n    forms_tabs: {\n\n        injectRefIntoFormTab: function (ref) {\n\n            var tab_button = $('.main .main__tabs li').first();\n            var tab_panel = $('.main .main__tabs-content .main__tabs-content-tabpanel').first();\n\n            //inject ref of the first form to the fist tab/tab content, as it is shown by default\n            tab_button.find('a').attr('href', '#' + ref + '-tabpanel');\n            tab_panel.first().attr('id', ref + '-tabpanel');\n            tab_panel.find('.inputs-collection').attr('id', ref + '-inputs-collection');\n            tab_panel.find('.input-properties').attr('id', ref + '-input-properties');\n\n        },\n\n        toggleFormTabsButtons: function (option) {\n\n            if (option.enable) {\n                //enable form tab buttons\n                formbuilder.dom.forms_tabs.find('li')\n                    .not('.main__tabs-btns')\n                    .each(function (index, item) {\n                        $(item).removeClass('disabled disabled-tab');\n                    });\n            }\n            else {\n                //disable form tab buttons\n                formbuilder.dom.forms_tabs.find('li')\n                    .not('.main__tabs-btns')\n                    .each(function (index, item) {\n                        $(item).addClass('disabled disabled-tab');\n                    });\n            }\n        },\n\n        setFirstFormTabName: function (the_form_name) {\n\n            var forms = formbuilder.project_definition.data.project.forms;\n\n            formbuilder.dom.forms_tabs\n                .find('.active a[data-form-index=\"0\"]')\n                .text(the_form_name.trunc(consts.TAB_FORM_NAME_MAX_DISPLAY_LENGHT - (forms.length * 2)))\n                .append('&nbsp;<i class=\"form-state fa fa-exclamation-triangle\"></i>');\n        },\n\n\n        //if the form is valid show a green check on its tab button\n        showFormValidIcon: function (the_form_index) {\n            formbuilder.dom.forms_tabs\n                .find('li a[data-form-index=' + the_form_index + '] i.form-state')\n                .removeClass('fa-exclamation-triangle').addClass('fa-check');\n        },\n\n        //if the form is NOT valid show a warning icon on its tab button\n        showFormInvalidIcon: function (the_form_index) {\n            formbuilder.dom.forms_tabs\n                .find('li a[data-form-index=' + the_form_index + '] i.form-state')\n                .removeClass('fa-check').addClass('fa-exclamation-triangle');\n        },\n\n        //return the markup for a form tab button, showing form name\n        getFormTabButtonHTML: function (form) {\n\n            var html = '';\n            var form_index = formbuilder.current_form_index;\n            var forms = formbuilder.project_definition.data.project.forms;\n\n            html += '<li role=\"presentation\" class=\"main__tabs__form-btn\">';\n            html += '<a href=\"#' + form.ref + '-tabpanel\" role=\"tab\" data-toggle=\"tab\" data-form-index=\"' + form_index + '\">';\n            html += form.name.trunc(consts.TAB_FORM_NAME_MAX_DISPLAY_LENGHT - (forms.length * 2));\n            html += '&nbsp;<i class=\"form-state fa fa-exclamation-triangle\"></i>';\n            html += '</a>';\n            html += '</li>';\n\n            return html;\n        },\n\n        //get markup for a form tab content (input collection + input properties)\n        getFormTabContentHTML: function (form) {\n\n            var html = '';\n\n            var deferred = new $.Deferred();\n\n            $.when(load_child_form_containers()).then(function (views) {\n\n                html += '<div role=\"tabpanel\" class=\"main__tabs-content-tabpanel tab-pane fade in active\" id=\"' + form.ref + '-tabpanel\">';\n                html += '<div id=\"' + form.ref + '-inputs-collection\" class=\"inputs-collection col-md-6\">';\n                html += views.inputs_collection;\n                html += '</div>';\n                html += '<div id=\"' + form.ref + '-input-properties\" class=\"input-properties col-md-6\">';\n                html += views.inputs_properties;\n                html += '</div>';\n                html += '</div>';\n\n                deferred.resolve(html);\n            });\n\n            return deferred.promise();\n        },\n\n        resizeFormTabs: function () {\n\n            var forms = formbuilder.project_definition.data.project.forms;\n\n\n            formbuilder.dom.forms_tabs\n                .find('li:lt(' + forms.length + ')').each(function (index, form_btn) {\n\n                    var state = $(form_btn).find('a i').hasClass('fa-check');\n                    var btn = $(form_btn).find('a');\n                    var valid_icon_html = '&nbsp;<i class=\"form-state fa fa-check\"></i>';\n                    var invalid_icon_html = '&nbsp;<i class=\"form-state fa fa-exclamation-triangle\"></i>';\n\n                    btn.text(forms[index].name\n                        .trunc(consts.TAB_FORM_NAME_MAX_DISPLAY_LENGHT - (forms.length * 2)));\n                    btn.append(state ? valid_icon_html : invalid_icon_html);\n                });\n        }\n    },\n    inputs_collection: {\n\n        //show/hide the title not set warning message\n        toggleTitleWarning: function (count, is_branch) {\n\n            //find warning for either the active form or the active branch\n            var element_to_find = is_branch ? '.active-branch .no-branch-title-set' : '.no-form-title-set';\n\n            if (count === 0) {\n                //show\n                formbuilder.dom.inputs_collection_sortable.find(element_to_find).removeClass('hidden').animate({\n                    opacity: 1,\n                    height: 37\n                }, consts.ANIMATION_FAST);\n            }\n            else {\n                //hide\n                formbuilder.dom.inputs_collection_sortable.find(element_to_find).animate({\n                    opacity: 0,\n                    height: 0\n                }, consts.ANIMATION_FAST, function () {\n                    $(this).addClass('hidden');\n                });\n            }\n        },\n\n        getInputStateIconsHTML: function () {\n\n            var html = '';\n            html += '<i class=\"question-state fa fa-exclamation-triangle fa-2x fa-fw pull-right\"></i>';\n            html += '<i class=\"jump-state fa fa-arrow-circle-o-down fa-2x fa-fw pull-right invisible\"></i>';\n\n            return html;\n        },\n\n        showInputValidIcon: function (the_ref) {\n            formbuilder.dom.inputs_collection_sortable\n                .find('div.input[data-input-ref=\"' + the_ref + '\"] i.question-state')\n                .first()\n                .removeClass('fa-exclamation-triangle').addClass('fa-check');\n        },\n\n        showInputInvalidIcon: function (the_ref) {\n            formbuilder.dom.inputs_collection_sortable\n                .find('div.input[data-input-ref=\"' + the_ref + '\"] i.question-state')\n                .first()\n                .removeClass('fa-check').addClass('fa-exclamation-triangle');\n        },\n\n        showInputQuestionPreview: function (the_ref, the_question) {\n            formbuilder.dom.inputs_collection_sortable\n                .find('div.input[data-input-ref=\"' + the_ref + '\"] > .input-inner > .question-preview')\n                .text(the_question.trunc(50));\n        },\n        toggleFormActionButtons: function (the_state) {\n            var buttons = formbuilder.dom.inputs_collection\n                .find('.inputs-collection__buttons')\n                .find('.btn');\n\n            if (the_state) {\n                buttons.attr('disabled', false).show();\n            }\n            else {\n                buttons.attr('disabled', true).hide();\n            }\n        },\n        getEmptyCollectionSortableHTML: function (type) {\n\n            var html = '';\n\n            html += '<div class=\"' + type + '-sortable hidden\">';\n            //no title set warning (only for branch type)\n            if (type === consts.BRANCH_TYPE) {\n                html += '<div class=\"warning-well no-branch-title-set hidden\">No title set for this branch yet ';\n                html += '<i class=\"fa fa-question-circle fa-2x fa-fw\" data-toggle=\"modal\" data-target=\"#info-title\">';\n                html += '</i>';\n                html += '</div>';\n            }\n            //no inputs yet message\n            html += '<span class=\"input-properties__no-' + type + '-questions-message\" style=\"display: none;\">';\n            html += type === consts.BRANCH_TYPE ? messages.labels.ADD_BRANCH_INPUTS_HERE : messages.labels.ADD_GROUP_INPUTS_HERE;\n            html += '</span>';\n            html += '{{' + type + '-inputs}}';\n            html += '</div>';\n\n            return html;\n        }\n    },\n    input_tools: {\n\n        enable: function () {\n            $('ul#inputs-tools-list li div.input')\n                .draggable('enable')\n                .removeClass('dragging-disabled');\n        },\n        disable: function () {\n            //disable draggable\n            $('ul#inputs-tools-list li div.input')\n                .draggable('disable')\n                .addClass('dragging-disabled');\n\n            //show toast max number of input hit\n            //todo\n        },\n        hideSearchInput: function () {\n            formbuilder.dom.inputs_tools_draggable.filter('.input-search').hide();\n        },\n        showSearchInput: function () {\n            formbuilder.dom.inputs_tools_draggable.filter('.input-search').show();\n        }\n    },\n    input_properties_panel: {\n\n        toggleAddAnswerBtn: function (is_disabled) {\n\n            var input = utils.getActiveInput();\n            var properties_panel = formbuilder.dom\n                .input_properties_forms_wrapper\n                .find('form[data-input-ref=\"' + input.ref + '\"]');\n\n            properties_panel\n                .find('.input-properties__form__possible-answers__add-answer')\n                .attr('disabled', is_disabled);\n\n        },\n\n        setUniquenessProperty: function (the_form_index, the_input) {\n\n            var form_index = the_form_index;\n            var input = the_input;\n\n            if (form_index === 0) {\n                input.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__uniqueness input')\n                    .prop('checked', input.uniquess !== consts.UNIQUESS_NONE);\n            }\n            else {\n                switch (input.uniqueness) {\n\n                    case consts.UNIQUESS_FORM:\n                        input.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__uniqueness input.uniqueness-form')\n                            .prop('checked', true);\n                        break;\n                    case consts.UNIQUESS_HIERARCHY:\n                        input.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__uniqueness input.uniqueness-hierarchy')\n                            .prop('checked', true);\n                        break;\n                }\n            }\n        },\n\n        showInputQuestionPreview: function (question) {\n\n            formbuilder.dom.input_properties\n                .find('.panel .panel-heading .input-properties__header .question-preview')\n                .text(question);\n        },\n\n        toggleJumpTab: function (the_ref, the_state) {\n\n            var jump_tab = formbuilder.dom.input_properties_forms_wrapper\n                .find('form[data-input-ref=\"' + the_ref + '\"]')\n                .find('.input-properties__tabs')\n                .find('.nav-tabs')\n                .children()\n                .eq(2);\n\n            //true enable, false disable\n            if (the_state) {\n                jump_tab.removeClass('disabled disabled-tab');\n            }\n            else {\n                jump_tab.addClass('disabled disabled-tab');\n            }\n        },\n\n        showJumpTabError: function (jump_dom_object) {\n\n            //show '!' on affected tab, in this case the jump properties tab (third)\n            jump_dom_object\n                .parents()\n                .eq(5)\n                .find('.nav-tabs')\n                .find('i.jumps-error')\n                .removeClass('invisible')\n                .hide()\n                .fadeIn(300);\n\n            //set jump properties tab text to red\n            jump_dom_object\n                .parents()\n                .eq(5)\n                .find('.nav-tabs')\n                .find('i.jumps-error')\n                .parent()\n                .addClass('validation-error');\n\n        },\n\n        hideJumpTabError: function (jump_dom_object) {\n\n            //show '!' on affected tab, in this case the jump properties tab (third)\n            jump_dom_object\n                .parents()\n                .eq(5)\n                .find('.nav-tabs')\n                .find('i.jumps-error')\n                .addClass('invisible');\n\n\n            //set jump properties tab text to red\n            jump_dom_object\n                .parents()\n                .eq(5)\n                .find('.nav-tabs')\n                .find('i.jumps-error')\n                .parent()\n                .removeClass('validation-error');\n\n        },\n\n        toggleTitleCheckbox: function (state, ref) {\n\n            var title_control = formbuilder.dom\n                .input_properties_forms_wrapper\n                .find('form[data-input-ref=\"' + ref + '\"]')\n                .find('.input-properties__form__title-flag');\n\n            switch (state) {\n                case consts.DISABLED_STATE:\n                    title_control.find('label').addClass('disabled-checkbox');\n                    title_control.find('input').attr('disabled', true).addClass('disabled-checkbox');\n                    title_control.find('span.title-label').text(consts.MAX_TITLE_LIMIT_REACHED);\n                    break;\n                case consts.ENABLED_STATE:\n                    title_control.find('label').removeClass('disabled-checkbox');\n                    title_control.find('input').attr('disabled', false).removeClass('disabled-checkbox');\n                    title_control.find('span.title-label').text(consts.USE_ANSWER_AS_TITLE);\n                    break;\n            }\n        },\n        toggleCopyInputButton: function (ref, state) {\n\n            var copy_btn = formbuilder.dom\n                .input_properties\n                .find('.input-properties__buttons--copy-input');\n\n            switch (state) {\n                case consts.BTN_DISABLED:\n                    copy_btn.attr('disabled', true);\n                    break;\n                case consts.BTN_ENABLED:\n                    copy_btn.attr('disabled', false);\n                    break;\n            }\n        }\n    },\n    group: {\n\n        toggleEditGroupButton: function (the_ref, the_state) {\n            formbuilder.dom.input_properties_forms_wrapper\n                .find('form[data-input-ref=\"' + the_ref + '\"]')\n                .find('.input-properties__form__basic-properties')\n                .find('.input-properties__form__edit-group').attr('disabled', !the_state);\n        },\n\n        hideGroupInputsErrors: function (the_properties_panel) {\n            //show error message\n            the_properties_panel.find('.input-properties__form__error--group-error')\n                .addClass('hidden')\n                .text('&nbsp;');\n        }\n\n    },\n    branch: {\n\n        toggleEditBranchButton: function (the_ref, the_state) {\n            formbuilder.dom.input_properties_forms_wrapper\n                .find('form[data-input-ref=\"' + the_ref + '\"]')\n                .find('.input-properties__form__basic-properties')\n                .find('.input-properties__form__edit-branch').attr('disabled', !the_state);\n        },\n\n        hideBranchInputsErrors: function (the_properties_panel) {\n            //show error message\n            the_properties_panel.find('.input-properties__form__error--branch-error')\n                .addClass('hidden')\n                .text('&nbsp;');\n        },\n        showBranchInputPropertiesDom: function (the_branch_input_index) {\n\n            var form_index = formbuilder.current_form_index;\n            var owner_input_ref = formbuilder.current_input_ref;\n            var owner_input_index = utils.getInputCurrentIndexByRef(owner_input_ref);\n            var branch_input_index = the_branch_input_index;\n            var branch_input = formbuilder.project_definition.data.project.forms[form_index].inputs[owner_input_index].branch[branch_input_index];\n            var input_properties_forms_wrapper = formbuilder.dom.input_properties_forms_wrapper;\n            var view = formbuilder.dom.input_properties_views[branch_input.type];\n\n\n            //todo update view template with ref and stuff\n            //init properties panel\n            // helpers.initInputPropertiesPanel(input_properties_forms_wrapper, branch_input, formbuilder.dom.partials);\n\n\n            input_properties_forms_wrapper.append(view).hide().fadeIn(consts.ANIMATION_FAST);\n\n\n            ////todo move this in mousedown?\n            ////for group nested in a branch, enable keyup to check for validation of header text\n            //if (branch_input.type === consts.GROUP_TYPE) {\n            //    formbuilder.dom.input_properties.off('keyup').on('keyup', 'input', input_properties_keyup_callback);\n            //}\n            //else {\n            //    formbuilder.dom.input_properties.off('keyup');\n            //}\n        }\n    }\n};\n\nmodule.exports = ui;\n","'use strict';\nvar consts = require('config/consts');\nvar formbuilder = require('config/formbuilder');\n\nvar utils = {\n\n    //from MDN\n    JSONPolyfill: {\n        parse: function (sJSON) {\n            return eval('(' + sJSON + ')');\n        },\n        stringify: (function () {\n            var toString = Object.prototype.toString;\n            var isArray = Array.isArray || function (a) {\n                return toString.call(a) === '[object Array]';\n            };\n            var escMap = {\n                '\"': '\\\\\"',\n                '\\\\': '\\\\\\\\',\n                '\\b': '\\\\b',\n                '\\f': '\\\\f',\n                '\\n': '\\\\n',\n                '\\r': '\\\\r',\n                '\\t': '\\\\t'\n            };\n            var escFunc = function (m) {\n                return escMap[m] || '\\\\u' + (m.charCodeAt(0) + 0x10000).toString(16).substr(1);\n            };\n            var escRE = /[\\\\\"\\u0000-\\u001F\\u2028\\u2029]/g;\n            return function stringify(value) {\n                if (value == null) {\n                    return 'null';\n                } else if (typeof value === 'number') {\n                    return isFinite(value) ? value.toString() : 'null';\n                } else if (typeof value === 'boolean') {\n                    return value.toString();\n                } else if (typeof value === 'object') {\n                    if (typeof value.toJSON === 'function') {\n                        return stringify(value.toJSON());\n                    } else if (isArray(value)) {\n                        var res = '[';\n                        for (var i = 0; i < value.length; i++)\n                            res += (i ? ', ' : '') + stringify(value[i]);\n                        return res + ']';\n                    } else if (toString.call(value) === '[object Object]') {\n                        var tmp = [];\n                        for (var k in value) {\n                            if (value.hasOwnProperty(k))\n                                tmp.push(stringify(k) + ': ' + stringify(value[k]));\n                        }\n                        return '{' + tmp.join(', ') + '}';\n                    }\n                }\n                return '\"' + value.toString().replace(escRE, escFunc) + '\"';\n            };\n        })()\n    },\n    //https://goo.gl/x4jcS\n    isSafari: Object.prototype.toString.call(window.HTMLElement).indexOf('Constructor') > 0 || (function (p) {\n        return p.toString() === '[object SafariRemoteNotification]';\n    })(!window.safari || safari.pushNotification),\n\n    getContainersPath: function () {\n        return consts.VIEWS_PATH + 'containers/';\n    },\n\n    getPropertiesPath: function () {\n        return consts.VIEWS_PATH + 'properties/';\n    },\n\n    getPartialsPath: function () {\n        return consts.VIEWS_PATH + 'partials/';\n    },\n\n    //go back to project details page (when inside Epicollect5 Laravel)\n    goBack: function () {\n\n        var href = window.location.href;\n        //both http and https\n        var protocol = window.location.protocol;\n        var parts = href.replace(protocol + '//', '').split('/');\n        var last = parts.pop();\n        var back_href = parts.join('/');\n\n        //standalone mode for testing from localhost?\n        if (last.indexOf('formbuilder') !== -1) {\n            window.location.replace(protocol + '//' + back_href);\n        }\n        else {\n            return false;\n        }\n    },\n\n    //project_ref is defined on the server, and it is unique server wise\n    setProjectURL: function () {\n\n        var domain;\n        var path;\n        var slug;\n        var href = window.location.href;\n        var protocol = window.location.protocol;\n        var parts = href.replace(protocol + '//', '').split('/');\n        var subpath;\n\n        console.log('parts[0]', parts[0]);\n\n        //standalone mode for testing from localhost?\n        if (parts[0].indexOf('localhost') !== -1 || parts[0].indexOf('ngrok')) {\n\n            //is standalone formbuilder?\n            if (parts.indexOf('epicollect5-formbuilder') !== -1) {\n                buildLocalPath();//testing locally, copying the json into project.json\n            }\n            else {\n                //it is a local installation of Laravel\n                buildLaravelPath();\n            }\n        }\n        else {\n            //laravel server\n            buildLaravelPath();\n            console.log(consts.PROJECT_URL);\n        }\n\n        function buildLaravelPath() {\n\n            slug = parts[parts.length - 2];\n            parts.splice(parts.length - 3, 3);\n            domain = protocol + '//' + parts.join('/') + '/';\n\n            path = consts.API_PRODUCTION_PATH;\n            consts.PROJECT_URL = domain + path + slug;\n\n            //do this for Laravel integration\n            //remove domain (first element)\n            parts.shift();\n            if (parts.length > 0) {\n                subpath = parts.join('/');\n                consts.VIEWS_PATH = '/' + subpath + '/' + consts.VIEWS_PATH;\n            }\n            else {\n                consts.VIEWS_PATH = '/' + consts.VIEWS_PATH;\n            }\n        }\n\n        function buildLocalPath() {\n            consts.PROJECT_URL = consts.API_DEVELOPMENT_GET_PATH + consts.API_DEVELOPMENT_PROJECT;\n        }\n    },\n\n    setProjectLogoUrl: function () {\n        console.log('href =>' + window.location.href);\n        var domain;\n        var path;\n        var slug;\n        var href = window.location.href;\n        var protocol = window.location.protocol;\n        var parts = href.replace(protocol + '//', '').split('/');\n\n        slug = parts[parts.length - 2];\n        parts.splice(parts.length - 3, 3);\n        domain = window.location.protocol + '//' + parts.join('/') + '/';\n\n        path = consts.API_MEDIA_PATH;\n        consts.PROJECT_LOGO_URL = domain + path + slug + consts.API_PROJECT_LOGO_QUERY_STRING;\n\n\n        console.log(consts.PROJECT_LOGO_URL);\n    },\n\n    //we generate the refs appending a uniqid per each level\n    //form - input - branch_input - group_input\n    generateFormRef: function () {\n        return formbuilder.project_definition.data.project.ref + '_' + this.generateUniqID();\n    },\n\n    //input ref consists of form_ref + input_ref\n    generateInputRef: function (form_ref) {\n        return form_ref + '_' + this.generateUniqID();\n    },\n\n    generateInputCopyRef: function () {\n\n        var ref;\n        //top level input?\n        if (!formbuilder.is_editing_branch && !formbuilder.is_editing_group) {\n            ref = utils.generateInputRef(formbuilder.current_form_ref);\n        }\n        if (formbuilder.is_editing_branch && formbuilder.is_editing_group) {\n            //generate nested group input ref (passing active branch input ref)\n            ref = utils.generateBranchGroupInputRef(formbuilder.branch.current_input_ref);\n        }\n        else {\n            if (formbuilder.is_editing_branch) {\n                //generated branch input ref\n                ref = utils.generateBranchGroupInputRef(formbuilder.branch.active_branch_ref);\n            }\n            if (formbuilder.is_editing_group) {\n                //generate group ref\n                ref = utils.generateBranchGroupInputRef(formbuilder.group.active_group_ref);\n            }\n        }\n        return ref;\n    },\n\n    //for branch and groups, we append the unique ID to the input (nesting a level more)\n    //a nested group will be 2 levels nested\n    generateBranchGroupInputRef: function (input_ref) {\n        return input_ref + '_' + this.generateUniqID();\n    },\n    //generate PHP type uniqid to be appended to form, inputs, branch and groups\n    generateUniqID: function (prefix, more_entropy) {\n        if (typeof prefix === 'undefined') {\n            prefix = '';\n        }\n\n        var retId;\n        var formatSeed = function (seed, reqWidth) {\n            seed = parseInt(seed, 10)\n                .toString(16); // to hex str\n            if (reqWidth < seed.length) {\n                // so long we split\n                return seed.slice(seed.length - reqWidth);\n            }\n            if (reqWidth > seed.length) {\n                // so short we pad\n                return Array(1 + (reqWidth - seed.length))\n                    .join('0') + seed;\n            }\n            return seed;\n        };\n\n        // BEGIN REDUNDANT\n        if (!this.php_js) {\n            this.php_js = {};\n        }\n        // END REDUNDANT\n        if (!this.php_js.uniqidSeed) {\n            // init seed with big random int\n            this.php_js.uniqidSeed = Math.floor(Math.random() * 0x75bcd15);\n        }\n        this.php_js.uniqidSeed++;\n\n        // start with prefix, add current milliseconds hex string\n        retId = prefix;\n        retId += formatSeed(parseInt(new Date()\n            .getTime() / 1000, 10), 8);\n        // add seed hex string\n        retId += formatSeed(this.php_js.uniqidSeed, 5);\n        if (more_entropy) {\n            // for more entropy we add a float lower to 10\n            retId += (Math.random() * 10)\n                .toFixed(8)\n                .toString();\n        }\n\n        return retId;\n    },\n\n    //find duplicates in array\n    hasDuplicates: function (array) {\n        var valuesSoFar = [];\n        for (var i = 0; i < array.length; ++i) {\n            var value = array[i];\n            if (valuesSoFar.indexOf(value) !== -1) {\n                return true;\n            }\n            valuesSoFar.push(value);\n        }\n        return false;\n    },\n\n    getInputCurrentIndexByRef: function (the_ref) {\n\n        var inputs = formbuilder.project_definition.data.project.forms[formbuilder.current_form_index].inputs;\n        var i;\n        var iLength = inputs.length;\n\n        for (i = 0; i < iLength; i++) {\n            if (inputs[i].ref === the_ref) {\n                return i;\n            }\n        }\n    },\n\n    getBranchInputCurrentIndexByRef: function (the_owner_input_index, the_branch_input_ref) {\n\n        var branch_inputs = formbuilder.project_definition.data.project.forms[formbuilder.current_form_index].inputs[the_owner_input_index].branch;\n        var found = -1;\n\n        $(branch_inputs).each(function (index, branch_input) {\n            if (branch_input.ref === the_branch_input_ref) {\n                found = index;\n                return false;\n            }\n        });\n        return found;\n    },\n\n    getGroupInputCurrentIndexByRef: function (the_owner_input_index, the_group_input_ref) {\n\n        var group_inputs = formbuilder.project_definition.data.project.forms[formbuilder.current_form_index].inputs[the_owner_input_index].group;\n        var found = -1;\n\n        $(group_inputs).each(function (index, branch_input) {\n            if (branch_input.ref === the_group_input_ref) {\n                found = index;\n                return false;\n            }\n        });\n        return found;\n    },\n\n    getInputObjectByRef: function (the_ref) {\n\n        var inputs = formbuilder.project_definition.data.project.forms[formbuilder.current_form_index].inputs;\n        var i;\n        var iLength = inputs.length;\n\n        if (the_ref === undefined) {\n            return false;\n        }\n\n        for (i = 0; i < iLength; i++) {\n            if (inputs[i].ref === the_ref) {\n                return inputs[i];\n            }\n        }\n\n    },\n\n    getBranchInputObjectByRef: function (the_ref) {\n\n        var inputs = formbuilder.project_definition.data.project.forms[formbuilder.current_form_index].inputs;\n        var owner_input_index = utils.getInputCurrentIndexByRef(formbuilder.current_input_ref);\n        var branch_inputs = inputs[owner_input_index].branch;\n        var found;\n\n        if (the_ref !== undefined) {\n\n            $(branch_inputs).each(function (index, input) {\n                if (input.ref === the_ref) {\n                    found = input;\n                    return false;\n                }\n            });\n        }\n\n        return found;\n    },\n\n    getNestedGroupInputObjectByRef: function (the_owner_branch, the_current_nested_group_input_ref) {\n\n        var ref = the_current_nested_group_input_ref;\n        var owner_branch = the_owner_branch;\n        var owner_group_ref = formbuilder.group.active_group_ref;\n\n        var found;\n\n        $(owner_branch.branch).each(function (index, branch_input) {\n\n            //get the nested group\n            if (branch_input.ref === owner_group_ref) {\n\n                //for each nested group inputs, look for the one we are looking for\n                $(branch_input.group).each(function (index, nested_group_input) {\n\n                    if (nested_group_input.ref === ref) {\n                        found = nested_group_input;\n                        return false;\n                    }\n                });\n\n                if (found) {\n                    return false;\n                }\n            }\n        });\n        return found;\n    },\n\n    getNestedGroupInputCurrentIndexByRef: function (the_owner_branch, the_current_nested_group_input_ref) {\n\n        var ref = the_current_nested_group_input_ref;\n        var owner_branch = the_owner_branch;\n        var owner_group_ref = formbuilder.group.active_group_ref;\n\n        var found;\n\n        $(owner_branch.branch).each(function (index, branch_input) {\n\n            //get the nested group\n            if (branch_input.ref === owner_group_ref) {\n\n                //for each nested group inputs, look for the one we are looking for\n                $(branch_input.group).each(function (group_index, nested_group_input) {\n\n                    if (nested_group_input.ref === ref) {\n                        found = group_index;\n                        return false;\n                    }\n                });\n\n                if (found) {\n                    return false;\n                }\n            }\n        });\n        return found;\n    },\n\n    getGroupInputObjectByRef: function (the_ref) {\n\n        var inputs = formbuilder.project_definition.data.project.forms[formbuilder.current_form_index].inputs;\n        var owner_input_index = utils.getInputCurrentIndexByRef(formbuilder.current_input_ref);\n        var group_inputs = inputs[owner_input_index].group;\n        var found;\n\n        if (the_ref !== undefined) {\n\n            $(group_inputs).each(function (index, input) {\n                if (input.ref === the_ref) {\n                    found = input;\n                    return false;\n                }\n            });\n        }\n\n        return found;\n    },\n\n    getNestedGroupObjectByRef: function (owner_branch, nested_group_ref) {\n\n        var found;\n\n        $(owner_branch.branch).each(function (index, branch_input) {\n\n            //get the nested group\n            if (branch_input.ref === nested_group_ref) {\n                found = branch_input;\n                return false;\n            }\n        });\n\n        return found;\n    },\n\n    //passing in a branch input ref, removing the last `_uniqid` we have the input ref that branch belong to\n    getBranchOwnerInputRef: function (the_branch_input_ref) {\n\n        var parts = the_branch_input_ref.split('_');\n\n        parts.pop();\n\n        return parts.join('_');\n    },\n\n    //passing in a group input ref, removing the last `_uniqid` we have the input ref that group belong to\n    getGroupOwnerInputRef: function (the_group_input_ref) {\n\n        var parts = the_group_input_ref.split('_');\n\n        parts.pop();\n\n        return parts.join('_');\n    },\n\n    getInputToolIcon: function (the_type) {\n\n        var icon;\n\n        switch (the_type) {\n            case consts.AUDIO_TYPE:\n                icon = consts.AUDIO_TYPE_ICON;\n                break;\n            case consts.BARCODE_TYPE:\n                icon = consts.BARCODE_TYPE_ICON;\n                break;\n            case consts.BRANCH_TYPE:\n                icon = consts.BRANCH_TYPE_ICON;\n                break;\n            case consts.CHECKBOX_TYPE:\n                icon = consts.CHECKBOX_TYPE_ICON;\n                break;\n            case consts.DATE_TYPE:\n                icon = consts.DATE_TYPE_ICON;\n                break;\n            case consts.DROPDOWN_TYPE:\n                icon = consts.DROPDOWN_TYPE_ICON;\n                break;\n            case consts.GROUP_TYPE:\n                icon = consts.GROUP_TYPE_ICON;\n                break;\n            case consts.LOCATION_TYPE:\n                icon = consts.LOCATION_TYPE_ICON;\n                break;\n            case consts.INTEGER_TYPE:\n                icon = consts.NUMERIC_TYPE_ICON;\n                break;\n            case consts.DECIMAL_TYPE:\n                icon = consts.NUMERIC_TYPE_ICON;\n                break;\n            case consts.PHONE_TYPE:\n                icon = consts.PHONE_TYPE_ICON;\n                break;\n            case consts.PHOTO_TYPE:\n                icon = consts.PHOTO_TYPE_ICON;\n                break;\n            case consts.RADIO_TYPE:\n                icon = consts.RADIO_TYPE_ICON;\n                break;\n            case consts.README_TYPE:\n                icon = consts.README_TYPE_ICON;\n                break;\n            case consts.TEXT_TYPE:\n                icon = consts.TEXT_TYPE_ICON;\n                break;\n            case consts.TEXTAREA_TYPE:\n                icon = consts.TEXTAREA_TYPE_ICON;\n                break;\n            case consts.TIME_TYPE:\n                icon = consts.TIME_TYPE_ICON;\n                break;\n            case consts.VIDEO_TYPE:\n                icon = consts.VIDEO_TYPE_ICON;\n                break;\n            case consts.SEARCH_SINGLE_TYPE:\n                icon = consts.SEARCH_SINGLE_TYPE_ICON;\n                break;\n            case consts.SEARCH_MULTIPLE_TYPE:\n                icon = consts.SEARCH_MULTIPLE_TYPE_ICON;\n                break;\n        }\n        return icon;\n    },\n\n    slugify: function (text) {\n\n        var trimmed = $.trim(text);\n        var $slug = trimmed.replace(/[^a-z0-9-]/gi, '-').replace(/-+/g, '-').replace(/^-|-$/g, '');\n        return $slug.toLowerCase();\n    },\n\n    //get total inputs downo to al levels: counting also nested branch inputs and group inputs\n    getInputsTotal: function (inputs) {\n\n        var total = 0;\n\n        total += inputs.length;\n\n        $(inputs).each(function (index, input) {\n            if (input.type === consts.GROUP_TYPE) {\n                total += input.group.length;\n            }\n            if (input.type === consts.BRANCH_TYPE) {\n                total += input.branch.length;\n\n                //todo count nested group inputs!\n                //todo\n            }\n        });\n        return total;\n    },\n    //get total inputs down to all levels: counting also nested branch inputs and group inputs\n    getSearchInputsTotal: function () {\n\n        var total = 0;\n        var forms = formbuilder.project_definition.data.project.forms;\n\n        $(forms).each(function (formIndex, form) {\n\n            $(form.inputs).each(function (inputIndex, input) {\n                //count all search input types\n                if (input.type === consts.SEARCH_MULTIPLE_TYPE || input.type === consts.SEARCH_SINGLE_TYPE) {\n                    total++;\n                }\n\n                if (input.type === consts.GROUP_TYPE) {\n                    //count all search input types of a group\n                    $(input.group).each(function (groupIndex, groupInput) {\n                        if (groupInput.type === consts.SEARCH_MULTIPLE_TYPE || groupInput.type === consts.SEARCH_SINGLE_TYPE) {\n                            total++;\n                        }\n                    });\n                }\n\n                if (input.type === consts.BRANCH_TYPE) {\n                    //count all search input types of a branch\n                    $(input.branch).each(function (branchIndex, branchInput) {\n                        if (branchInput.type === consts.SEARCH_MULTIPLE_TYPE || branchInput.type === consts.SEARCH_SINGLE_TYPE) {\n                            total++;\n                        }\n                        //nested group?\n                        if (branchInput.type === consts.GROUP_TYPE) {\n                            $(branchInput.group).each(function (groupIndex, groupInput) {\n                                if (groupInput.type === consts.SEARCH_MULTIPLE_TYPE || groupInput.type === consts.SEARCH_SINGLE_TYPE) {\n                                    total++;\n                                }\n                            });\n                        }\n                    });\n                }\n            });\n        });\n\n        return total;\n    },\n    //jump destinations: cannot jump on the next one, but always next + 1\n    getJumpAvailableDestinations: function (input, inputs) {\n\n        var current_input_index;\n        var owner_input_index;\n        var destinations = [];\n        var available_inputs;\n\n        if (formbuilder.is_editing_branch) {\n            owner_input_index = utils.getInputCurrentIndexByRef(formbuilder.branch.active_branch_ref);\n            current_input_index = utils.getBranchInputCurrentIndexByRef(owner_input_index, input.ref);\n        }\n        else {\n            current_input_index = utils.getInputCurrentIndexByRef(input.ref);\n        }\n\n        available_inputs = inputs.slice(current_input_index + 2);\n\n        $(available_inputs).each(function (index, input) {\n            destinations.push({\n                ref: input.ref,\n                question: input.question,\n                type: input.type\n            });\n        });\n\n        //add \"End of form\" as an available destination\n        destinations.push({\n            ref: consts.JUMP_TO_END_OF_FORM_REF,\n            question: consts.JUMP_TO_END_OF_FORM_LABEL,\n            type: null\n        });\n\n\n        return destinations;\n    },\n\n    //jump destinations object: for quicker look ups, this is for extra validation on \"save\"\n    getJumpAvailableDestinationsAsKeys: function (current_input_index, input, inputs) {\n\n        var destinations = {};\n        var available_inputs;\n\n        available_inputs = inputs.slice(current_input_index + 2);\n\n        //fill with available inputs refs as keys\n        $(available_inputs).each(function (index, input) {\n            destinations[input.ref] = 1;\n        });\n        //add \"End of form\" as an available destination\n        destinations[consts.JUMP_TO_END_OF_FORM_REF] = 1;\n\n        return destinations;\n    },\n\n    //return true when the value is less or equal to max title\n    isMaxTitleLimitReached: function (inputs) {\n        return this.getTitleCount(inputs) >= consts.LIMITS.titles_max;\n    },\n    //return true when the value exceeds max title\n    isMaxTitleLimitExceeded: function (inputs) {\n        return this.getTitleCount(inputs) > consts.LIMITS.titles_max;\n    },\n\n    getTitleCount: function (inputs) {\n\n        var count = 0;\n\n        $(inputs).each(function (index, input) {\n            if (input.is_title) {\n                count++;\n            }\n            //loop all group inputs as they count towards the limit\n            if (input.type === consts.GROUP_TYPE) {\n                $(input.group).each(function (index, group_input) {\n                    if (group_input.is_title) {\n                        count++;\n                    }\n                });\n            }\n        });\n        return count;\n    },\n    //from http://goo.gl/D7FxG0\n    //  //convert html tags to html entities\n    encodeHtml: function (str) {\n        return str.replace(/[&<>\"']/g, function ($0) {\n            /* jshint ignore:start */\n            // jscs:disable\n            return \"&\" + {\n                \"&\": \"amp\",\n                \"<\": \"lt\",\n                \">\": \"gt\",\n                '\"': \"quot\",\n                \"'\": \"#39\"\n            }[$0] + \";\";\n            /* jshint ignore:end */\n            // jscs:enable\n        });\n    },\n\n    //from http://goo.gl/htCroU\n    decodeHtml: function (html) {\n        var txt = document.createElement('textarea');\n        txt.innerHTML = html;\n        return txt.value;\n    },\n\n    getPossibleAnswerLabel: function (input) {\n        var label = '';\n        $(input.possible_answers).each(function (answer_index, answer) {\n            if (answer.answer_ref === input.default) {\n                label = answer.answer;\n            }\n        });\n        return label;\n    },\n    /**\n     * @param validSource: the valid obj structure\n     * @param wannaBe: the obj structure to validate\n     * @param strict: whether the type must be the same\n     * @returns {boolean}\n     * Compare properties of objects (only keys: wannaBe must have the same keys, in any order. Values don't matter, they are check separately)\n     * we do check for the same nested properties when an object {} but arrays must be arrays []\n     */\n    hasSameProps: function (validSource, wannaBe, strict) {\n\n        var self = this;\n\n        //false when wannabe property is an array but validSource is not\n        if (typeof validSource === 'object' && Array.isArray(wannaBe)) {\n            return false;\n        }\n\n        //check for wannaBe overlapping props\n        if (!Object.keys(wannaBe).every(function (key) {\n                return validSource.hasOwnProperty(key);\n            })) {\n            // console.log('wannaBe has extra keys')\n            return false;\n        }\n\n        //check every key for being same\n        return Object.keys(validSource).every(function (key) {\n            //if object\n            if (typeof validSource[key] === 'object' && typeof wannaBe[key] === 'object' && validSource[key] !== null && wannaBe[key] !== null) {\n\n                //check array is array\n                if (Array.isArray(validSource[key])) {\n                    //console.log('must be array key: ' + key);\n                    return Array.isArray(wannaBe[key]);\n                } else {\n                    //recursively check nested object\n                    return self.hasSameProps(validSource[key], wannaBe[key]);\n                }\n\n            } else {\n                //check every key is present in the wanna be object\n                if (wannaBe[key] === undefined) {\n                    // console.log('wannaBe does not have key:' + key)\n                    return false;\n                }\n\n                //check the type of value is the same (not the actual value, which can be different)\n                if (strict) {\n                    if (typeof validSource[key] !== typeof wannaBe[key]) {\n                        //console.log('wannaBe type is wrong for key: ' + key)\n                        return false;\n                    }\n                }\n\n                return true;\n            }\n        });\n    },\n    //from MDN https://goo.gl/vOhzta\n    isInteger: function (value) {\n        return typeof value === 'number' &&\n            isFinite(value) &&\n            Math.floor(value) === value;\n    },\n\n    getActiveInput: function () {\n\n        var self = this;\n        var input;\n        var current_branch;\n        var current_input_ref = formbuilder.current_input_ref;\n\n        //get current input object based on editing state:\n\n        //nested group?\n        if (formbuilder.is_editing_branch && formbuilder.is_editing_group) {\n            //get nested group input\n            current_branch = self.getInputObjectByRef(formbuilder.branch.active_branch_ref);\n            input = self.getNestedGroupInputObjectByRef(current_branch, formbuilder.group.current_input_ref);\n        }\n\n        //branch input\n        if (formbuilder.is_editing_branch && !formbuilder.is_editing_group) {\n            //get branch input\n            input = self.getBranchInputObjectByRef(formbuilder.branch.current_input_ref);\n        }\n\n        //group input?\n        if (!formbuilder.is_editing_branch && formbuilder.is_editing_group) {\n            //get group input\n            input = self.getGroupInputObjectByRef(formbuilder.group.current_input_ref);\n        }\n\n        //top level input?\n        if (!formbuilder.is_editing_branch && !formbuilder.is_editing_group) {\n            //get input\n            input = self.getInputObjectByRef(current_input_ref);\n        }\n\n        return input;\n    },\n    /// Replaces commonly-used Windows 1252 encoded chars that do not exist in ASCII or ISO-8859-1 with ISO-8859-1 cognates.\n    replaceWordChars: function (text) {\n        var s = text;\n        // smart single quotes and apostrophe\n        s = s.replace(/[\\u2018\\u2019\\u201A]/g, \"\\'\");\n        // smart double quotes\n        s = s.replace(/[\\u201C\\u201D\\u201E]/g, '\\\"');\n        // ellipsis\n        s = s.replace(/\\u2026/g, '...');\n        // dashes\n        s = s.replace(/[\\u2013\\u2014]/g, '-');\n        // circumflex\n        s = s.replace(/\\u02C6/g, '^');\n        // open angle bracket\n        s = s.replace(/\\u2039/g, ' ');\n        // close angle bracket\n        s = s.replace(/\\u203A/g, ' ');\n        // spaces\n        s = s.replace(/[\\u02DC\\u00A0]/g, ' ');\n\n        //remove invalid chars\n        s = s.replace(/\\uFFFD/g, ' ');\n\n        return s;\n    },\n\n    getCurrentlySelectedInput: function () {\n\n        var self = this;\n        var input = self.getInputObjectByRef(formbuilder.current_input_ref);\n        var owner_branch;\n\n        //check whether we are validatin a nested input i.e. BOTH branch AND group edit flags are true\n        if (formbuilder.is_editing_branch && formbuilder.is_editing_group) {\n            //get nested group input\n            owner_branch = self.getInputObjectByRef(formbuilder.branch.active_branch_ref);\n            input = self.getNestedGroupInputObjectByRef(owner_branch, formbuilder.group.current_input_ref);\n        }\n        else {\n            if (formbuilder.is_editing_branch) {\n                //get selected branch input\n                input = self.getBranchInputObjectByRef(formbuilder.branch.current_input_ref);\n            }\n\n            if (formbuilder.is_editing_group) {\n                //get selected group input\n                input = self.getGroupInputObjectByRef(formbuilder.group.current_input_ref);\n            }\n        }\n\n        return input;\n    },\n    //http://locutus.io/php/strings/strip_tags/\n    stripTags: function (input, allowed) {\n        allowed = (((allowed || '') + '').toLowerCase().match(/<[a-z][a-z0-9]*>/g) || []).join('');\n        var tags = /<\\/?([a-z][a-z0-9]*)\\b[^>]*>/gi;\n        var commentsAndPhpTags = /<!--[\\s\\S]*?-->|<\\?(?:php)?[\\s\\S]*?\\?>/gi;\n        return input.replace(commentsAndPhpTags, '').replace(tags, function ($0, $1) {\n            return allowed.indexOf('<' + $1.toLowerCase() + '>') > -1 ? $0 : ''\n        })\n    },\n    //replace all occurences of 'needle' in string\n    replaceAllOccurrences: function (string, needle, replacement) {\n        return string.replace(new RegExp(needle, 'g'), replacement);\n    },\n\n    /**\n     * Randomize array element order in-place.\n     * Using Durstenfeld shuffle algorithm.\n     */\n    shuffleArray: function (array) {\n        for (var i = array.length - 1; i > 0; i--) {\n            var j = Math.floor(Math.random() * (i + 1));\n            var temp = array[i];\n            array[i] = array[j];\n            array[j] = temp;\n        }\n        return array;\n    }\n};\n\nmodule.exports = utils;\n","'use strict';\nvar consts = require('config/consts');\nvar errors = require('actions/errors');\nvar jumps = require('actions/jumps');\nvar save = require('actions/save');\nvar validation = require('actions/validation');\nvar input_properties = require('factory/input-properties');\nvar Input = require('factory/input-prototype');\nvar formbuilder = require('config/formbuilder');\n\nvar AudioInput = function (the_input_ref) {\n\n    //extend basic input wih common properties (easier than passing a properties object to Object.create)\n    $.extend(true, this, input_properties);\n\n    //set default properties\n    //this.index = the_index;\n    this.ref = the_input_ref;\n    this.type = consts.AUDIO_TYPE;\n\n    /* reset DOM properties (jquery selectors are not 'live', we need to run them again for new object)\n     *\n     * if the property below is not reset here, all the inputs will get the same dom reference\n     * */\n    this.dom = {};\n    this.dom.is_valid = false;\n};\n\n//extend prototype from basic input object\nAudioInput.prototype = Object.create(Input.prototype);\n\nmodule.exports = AudioInput;\n","/* global $*/\n'use strict';\nvar consts = require('config/consts');\nvar errors = require('actions/errors');\nvar jumps = require('actions/jumps');\nvar save = require('actions/save');\nvar input_properties = require('factory/input-properties');\nvar Input = require('factory/input-prototype');\nvar validation = require('actions/validation');\nvar formbuilder = require('config/formbuilder');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\n\nvar BarcodeInput = function (the_input_ref) {\n\n    //extend basic input wih common properties (easier than passing a properties object to Object.create)\n    $.extend(true, this, input_properties);\n\n    //set current instance properties\n   // this.index = the_index;\n    this.ref = the_input_ref;\n    this.type = consts.BARCODE_TYPE;\n\n    /* reset DOM properties (jquery selectors are not 'live', we need to run them again for new object)\n     *\n     * if the property below is not reset here, all the inputs will get the same dom reference\n     * */\n    this.dom = {};\n    this.dom.is_valid = false;\n};\n\n//extend prototype from basic input object\nBarcodeInput.prototype = Object.create(Input.prototype);\n\n/*\n Overrides\n */\n\nBarcodeInput.prototype.setAdvancedInputProperties = function () {\n\n    this.dom.advanced_properties_wrapper = formbuilder\n        .dom\n        .input_properties_forms_wrapper\n        .find('form[data-input-ref=\"' + this.ref + '\"]')\n        .find('.input-properties__form__advanced-properties');\n\n    //set  'default' option\n    this.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__default input').val(this.default);\n\n    //set 'regex' option\n    this.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__regex input').val(this.regex);\n\n    //set 'input_ref' on 'double entry verification' option\n    this.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__double-entry input').prop('checked', this.verify);\n\n    ui.input_properties_panel.setUniquenessProperty(formbuilder.current_form_index, this);\n};\n\nBarcodeInput.prototype.hideAdvancedPropertiesErrors = function () {\n\n    //reset validation dom feedback (hide all errors from dom)\n    var properties_to_hide_error = [\n        consts.DEFAULT_PROPERTY\n    ];\n    errors.hideAdvancedPropertiesErrors(this, properties_to_hide_error);\n};\n\nmodule.exports = BarcodeInput;\n","/* global $*/\n'use strict';\nvar consts = require('config/consts');\nvar errors = require('actions/errors');\nvar messages = require('config/messages');\nvar jumps = require('actions/jumps');\nvar save = require('actions/save');\nvar input_properties = require('factory/input-properties');\nvar Input = require('factory/input-prototype');\nvar validation = require('actions/validation');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar formbuilder = require('config/formbuilder');\nvar branch_sortable = require('ui-handlers/branch-sortable');\nvar input_collection_branch_sortable_mousedown_callback = require('ui-handlers/event-handler-callbacks/input-collection-branch-sortable-mousedown-callback');\nvar input_collection_sortable_mousedown_callback = require('ui-handlers/event-handler-callbacks/input-collection-sortable-mousedown-callback');\n\nvar BranchInput = function (the_input_ref) {\n\n    //extend basic input wih common properties (easier than passing a properties object to Object.create)\n    $.extend(true, this, input_properties);\n\n    //set current instance properties\n    //this.index = the_index;\n    this.ref = the_input_ref;\n    this.type = consts.BRANCH_TYPE;\n\n    /* reset DOM properties (jquery selectors are not 'live', we need to run them again for new object)\n     *\n     * if the property below is not reset here, all the inputs will get the same dom reference\n     * */\n    this.dom = {};\n    this.dom.is_valid = false;\n};\n\n//extend prototype from basic input object\nBranchInput.prototype = Object.create(Input.prototype);\n\nBranchInput.prototype.isHeaderTextValid = function () {\n    return this.isQuestionTextValid();\n};\n\n\n//toggle edit branch button\nBranchInput.prototype.toggleEditButton = function (the_state) {\n    ui.branch.toggleEditBranchButton(this.ref, the_state);\n};\n\nBranchInput.prototype.enterBranchSortable = function () {\n\n    var self = this;\n    var undo = require('actions/undo');\n    var active_branch = formbuilder.dom.inputs_collection_sortable\n        .find('div.input[data-input-ref=\"' + self.ref + '\"]');\n    var active_branch_inner = active_branch.find(' > .input-inner');\n    var branch_holder_html = ui.inputs_collection.getEmptyCollectionSortableHTML(consts.BRANCH_TYPE);\n    var branch_inputs = utils.getInputObjectByRef(self.ref).branch;\n    var exit_btn_html = '';\n    exit_btn_html += '<button class=\"btn btn-sm btn-default exit-branch-editing\">';\n    exit_btn_html += '<i class=\"fa fa-2x fa-fw fa-chevron-left \"></i>';\n    exit_btn_html += messages.labels.EXIT_EDITING;\n    exit_btn_html += '</button>';\n\n    //reset branch object, as we cache properties of the current enabled branch only\n    formbuilder.branch = {};\n\n    //set draggable to work with enabled branch only\n    formbuilder.dom.inputs_tools_draggable.draggable('option', 'connectToSortable', '.branch-sortable');\n\n    //set useful flags\n    formbuilder.is_editing_branch = true;\n    formbuilder.branch.active_branch_ref = self.ref;\n    formbuilder.branch.active_branch_header = self.question;\n\n    active_branch.off().on('mousedown', 'div.input', input_collection_branch_sortable_mousedown_callback);\n\n    // if it is a brand new branch, append sortable markup and show help message\n    if (active_branch.find('.branch-sortable').length === 0) {\n        branch_holder_html = branch_holder_html.replace('{{branch-inputs}}', '');\n        active_branch.append(branch_holder_html);\n        active_branch.find('.input-properties__no-branch-questions-message').show();\n    }\n    else {\n        if (formbuilder.render_action === consts.RENDER_ACTION_UNDO && active_branch.find('.branch-sortable > div').length === 0) {\n            active_branch.find('.input-properties__no-group-questions-message').show();\n        }\n    }\n\n    //enable branch sortable\n    active_branch.find('.branch-sortable').sortable(branch_sortable).disableSelection().removeClass('hidden');\n\n    //remove any previously selected branch input\n    active_branch.find('.branch-sortable').find('.input.active').removeClass('active');\n\n    //show exit editing button\n    active_branch.addClass('active-branch').removeClass('active');\n\n    //remove first two elements\n    active_branch_inner.find('.fa-clone').remove();\n    active_branch_inner.find('> .question-preview').remove();\n\n    //append exit button\n    active_branch_inner.prepend(exit_btn_html);\n\n    //disable form tab buttons\n    ui.forms_tabs.toggleFormTabsButtons({enable: false});\n\n    //prepare ui for editing branch\n    self.showEditBranchUI();\n\n    active_branch\n        .find('.exit-branch-editing')\n        .one('click', function () {\n            self.exitBranchSortable();\n        });\n\n    /*\n     change binding when editing a branch, as we want to incercept only a mousedown to the exit button on the active branch input\n     */\n    //destroy sortable only if it is set already (see http://goo.gl/riN4Yk)\n    if (formbuilder.dom.inputs_collection_sortable.data('ui-sortable')) {\n        formbuilder.dom.inputs_collection_sortable.sortable('destroy');//Remove the plugin functionality\n    }\n\n    formbuilder.dom.inputs_collection_sortable.off('mousedown').on('mousedown', '.fa-chevron-left', input_collection_sortable_mousedown_callback);\n\n    //hide form title warning regardless (passing 1)=> this is for the form which owns the branch\n    ui.inputs_collection.toggleTitleWarning(1, false);\n\n    //show/hide warning for the branch\n    ui.inputs_collection.toggleTitleWarning(utils.getTitleCount(branch_inputs), true);\n\n    //push state to enable undoing the action (adding/dragging input)\n    undo.pushState();\n};\n\nBranchInput.prototype.exitBranchSortable = function () {\n\n    var self = this;\n    var sortable = require('ui-handlers/sortable');\n    var current_form_name = formbuilder.project_definition.data.project.forms[formbuilder.current_form_index].name;\n    var active_branch = formbuilder.dom.inputs_collection_sortable.find('.input.active-branch');\n    var active_branch_input_sortable = active_branch.find('.branch-sortable');\n    var active_branch_inner = active_branch.find(' > .input-inner');\n    var active_branch_input;\n    var inputs = formbuilder.project_definition.data.project.forms[formbuilder.current_form_index].inputs;\n\n    if (formbuilder.branch.current_input_ref) {\n        active_branch_input = utils.getBranchInputObjectByRef(formbuilder.branch.current_input_ref);\n        //validate last active group input and update dom accordingly\n        validation.performValidation(active_branch_input, false);\n    }\n\n    active_branch.removeClass('active-branch').addClass('active');\n\n\n    //remove exit button\n    active_branch_inner.find('.exit-branch-editing').remove();\n\n    //restore question in input collection\n    active_branch_inner.prepend('<span class=\"question-preview\">' + self.question + '</span>');\n    active_branch_inner.prepend('<i class=\"fa fa-2x fa-fw fa-clone\"></i>');\n\n    formbuilder.dom.inputs_collection_sortable.find('.input').not('.active').slideDown(consts.ANIMATION_NORMAL);\n\n    //update panel header\n    formbuilder.dom.inputs_collection.find('.inputs-collection__header__edit-state').text(messages.labels.EDITING_FORM);\n    formbuilder.dom.inputs_collection.find('.inputs-collection__header__element-name').text(current_form_name.trunc(consts.INPUTS_COLLECTION_BRANCH_NAME_MAX_DISPLAY_LENGHT));\n\n    //show form action buttons in panel heading\n    ui.inputs_collection.toggleFormActionButtons(true);\n\n    //enable jumps tab\n    ui.input_properties_panel.toggleJumpTab(self.ref, true);\n\n    self.toggleEditButton(true);\n\n    //set draggable to work with main sortable\n    formbuilder.dom.inputs_tools_draggable.draggable('option', 'connectToSortable', '.sortable');\n\n    active_branch_input_sortable.addClass('hidden');\n\n    /*\n     restore parent binding after exiting branch editing\n     */\n    formbuilder.dom.inputs_collection_sortable.off('mousedown').on('mousedown', 'div.input', input_collection_sortable_mousedown_callback);\n\n\n    //re-bind sortable plugin\n    sortable();\n\n    self.validateBranchInputs();\n\n    //todo: hide current input and show branch\n    formbuilder.dom.input_properties_forms_wrapper\n        .find('.input-properties__no-input-selected').hide();\n\n    //hide previously selected branch input properties panel\n    formbuilder.dom.input_properties_forms_wrapper\n        .find('.input-properties__form[data-input-ref=\"' + formbuilder.branch.current_input_ref + '\"]').hide();\n\n    //show branch input properties panel\n    formbuilder.dom.input_properties_forms_wrapper\n        .find('.input-properties__form[data-input-ref=\"' + formbuilder.branch.active_branch_ref + '\"]').fadeIn(consts.ANIMATION_FAST);\n\n    //enable branch input tools in left sidebar, as we cannot have a branch withing a branch\n    formbuilder.dom.inputs_tools_draggable.filter('.input-branch').show();\n\n    formbuilder.is_editing_branch = false;\n    formbuilder.branch.current_input_ref = undefined;\n\n    //enable form tab buttons\n    ui.forms_tabs.toggleFormTabsButtons({enable: true});\n\n    //show action buttons for owner input\n    formbuilder.dom.input_properties_buttons.fadeIn(consts.ANIMATION_FAST);\n\n    //show title warning if no title set\n    //todo is this needed?\n    ui.inputs_collection.toggleTitleWarning(utils.getTitleCount(inputs), false);\n};\n\n\nBranchInput.prototype.showEditBranchUI = function () {\n\n    var self = this;\n\n    //hide first level inputs from the input collection\n    formbuilder.dom.inputs_collection_sortable.find(' > .input').not('.active-branch').slideUp(consts.ANIMATION_NORMAL);\n\n    //update panel header\n    formbuilder.dom.inputs_collection.find('.inputs-collection__header__edit-state').text(messages.labels.EDITING_BRANCH);\n    formbuilder.dom.inputs_collection.find('.inputs-collection__header__element-name').text(self.question.trunc(consts.INPUTS_COLLECTION_BRANCH_NAME_MAX_DISPLAY_LENGHT));\n\n    //disable form action buttons in panel heading\n    ui.inputs_collection.toggleFormActionButtons(false);\n\n    //disable jumps tab //todo is this needed?\n    ui.input_properties_panel.toggleJumpTab(self.ref, false);\n\n    //hide owner branch input panel and show 'no branch inputs selected' by default\n    formbuilder.dom.input_properties_forms_wrapper\n        .find('form[data-input-ref=\"' + self.ref + '\"]').hide();\n\n    formbuilder.dom.input_properties_forms_wrapper\n        .find('.input-properties__no-input-selected').show();\n\n    //hide input properties panel action buttons until a branch input gets selected\n    formbuilder.dom.input_properties_buttons.fadeOut(consts.ANIMATION_FAST);\n\n\n    //disable branch input tools in left sidebar, as we cannot have a branch withing a branch\n    formbuilder.dom.inputs_tools_draggable.filter('.input-branch').hide();\n\n};\n\nBranchInput.prototype.validateBranchInputs = function () {\n\n    var self = this;\n    var branch_inputs_validation = validation.validateBranchInputs(self);\n\n    self.dom.properties_panel = formbuilder.dom.input_properties_forms_wrapper.find('form[data-input-ref=\"' + self.ref + '\"]');\n\n    if (!branch_inputs_validation.is_valid) {\n        //highlight wrong input and show error message\n        errors.showBranchInputsErrors(self.dom.properties_panel, branch_inputs_validation.error.message);\n        //set element as invalid\n        self.dom.is_valid = false;\n    }\n    else {\n        //set element as valid\n        self.dom.is_valid = true;\n        errors.hideBranchInputsErrors(self.dom.properties_panel);\n    }\n};\n\nmodule.exports = BranchInput;\n","/* global $*/\n'use strict';\nvar consts = require('config/consts');\nvar errors = require('actions/errors');\nvar jumps = require('actions/jumps');\nvar save = require('actions/save');\nvar possible_answers = require('actions/possible-answers');\nvar input_properties = require('factory/input-properties');\nvar Input = require('factory/input-prototype');\nvar InputMultipleAnswers = require('factory/input-multiple-answers-prototype');\nvar validation = require('actions/validation');\nvar formbuilder = require('../config/formbuilder');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\n\nvar CheckboxInput = function (the_input_ref) {\n\n    //extend basic input wih common properties (easier than passing a properties object to Object.create)\n    $.extend(true, this, input_properties);\n\n    //set default properties\n    //this.index = the_index;\n    this.ref = the_input_ref;\n    this.type = consts.CHECKBOX_TYPE;\n\n    //set a default answer on newly created dropdowns inputs\n    this.possible_answers = [{\n        answer: 'I am a placeholder answer',\n        answer_ref: utils.generateUniqID()\n    }];\n\n\n    /* reset DOM properties (jquery selectors are not 'live', we need to run them again for new object)\n     *\n     * if the property below is not reset here, all the inputs will get the same dom reference\n     * */\n    this.dom = {};\n    this.dom.is_valid = false;\n\n    //pagination defaults\n    formbuilder.possible_answers_pagination[this.ref] = {};\n    formbuilder.possible_answers_pagination[this.ref].page = 1;\n};\n\n//extend prototype from basic input object and multiple answer object\nCheckboxInput.prototype = $.extend({}, Input.prototype, InputMultipleAnswers.prototype);\n\nmodule.exports = CheckboxInput;\n","'use strict';\nvar consts = require('../config/consts');\nvar errors = require('actions/errors');\nvar jumps = require('actions/jumps');\nvar save = require('actions/save');\nvar input_properties = require('factory/input-properties');\nvar Input = require('factory/input-prototype');\nvar formbuilder = require('../config/formbuilder');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\n\nvar DateInput = function (the_input_ref) {\n\n    $.extend(true, this, input_properties);\n\n    //set current instance properties\n    //this.index = the_index;\n    this.ref = the_input_ref;\n    this.type = consts.DATE_TYPE;\n\n    /* reset DOM properties (jquery selectors are not 'live', we need to run them again for new object)\n     *\n     * if the property below is not reset here, all the inputs will get the same dom reference\n     * */\n    this.dom = {};\n    this.dom.is_valid = false;\n};\n\n//extend prototype from basic input object\nDateInput.prototype = Object.create(Input.prototype);\n\n/*\n Overrides\n */\n\nDateInput.prototype.setAdvancedInputProperties = function () {\n\n    this.dom.advanced_properties_wrapper = formbuilder\n        .dom\n        .input_properties_forms_wrapper\n        .find('form[data-input-ref=\"' + this.ref + '\"]')\n        .find('.input-properties__form__advanced-properties');\n\n    //set default to current datetime?\n    this.dom.advanced_properties_wrapper\n        .find('div.input-properties__form__advanced-properties__default-to-current input').prop('checked', this.set_to_current_datetime);\n\n    //set datetime format\n    this.dom.advanced_properties_wrapper\n        .find('div.input-properties__form__advanced-properties__dateformat input[name=\"dateformatRadio\"][value=\"' + this.datetime_format + '\"]')\n        .prop('checked', true);\n\n    ui.input_properties_panel.setUniquenessProperty(formbuilder.current_form_index, this);\n};\n\n\nDateInput.prototype.saveAdvancedProperties = function () {\n\n    this.dom.advanced_properties_wrapper = formbuilder\n        .dom\n        .input_properties_forms_wrapper\n        .find('form[data-input-ref=\"' + this.ref + '\"]')\n        .find('.input-properties__form__advanced-properties');\n\n    //set default to current datetime?\n    this.set_to_current_datetime = this.dom.advanced_properties_wrapper\n        .find('div.input-properties__form__advanced-properties__default-to-current input')\n        .is(':checked');\n\n    //set datetime format\n    this.datetime_format = this.dom.advanced_properties_wrapper\n        .find('div.input-properties__form__advanced-properties__dateformat input[name=\"dateformatRadio\"]:checked')\n        .val();\n\n    //save uniqueness\n    save.saveUniqueness(this);\n};\n\nmodule.exports = DateInput;\n","/* global $*/\n'use strict';\nvar consts = require('../config/consts');\nvar errors = require('actions/errors');\nvar jumps = require('actions/jumps');\nvar save = require('actions/save');\nvar input_properties = require('factory/input-properties');\nvar Input = require('factory/input-prototype');\nvar InputMultipleAnswers = require('factory/input-multiple-answers-prototype');\nvar validation = require('actions/validation');\nvar formbuilder = require('../config/formbuilder');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\n\nvar DropdownInput = function (the_input_ref) {\n\n    //extend basic input wih common properties (easier than passing a properties object to Object.create)\n    $.extend(true, this, input_properties);\n\n    //set default properties\n    //this.index = the_index;\n    this.ref = the_input_ref;\n    this.type = consts.DROPDOWN_TYPE;\n\n    //set a default answer on newly created dropdowns inputs\n    this.possible_answers = [{\n        answer: 'I am a placeholder answer',\n        answer_ref: utils.generateUniqID()\n    }];\n\n    /* reset DOM properties (jquery selectors are not 'live', we need to run them again for new object)\n     *\n     * if the property below is not reset here, all the inputs will get the same dom reference\n     * */\n    this.dom = {};\n    this.dom.is_valid = false;\n\n    //pagination defaults\n    formbuilder.possible_answers_pagination[this.ref] = {};\n    formbuilder.possible_answers_pagination[this.ref].page = 1;\n};\n\n//extend prototype from basic input object and multiple answer object\nDropdownInput.prototype = $.extend({}, Input.prototype, InputMultipleAnswers.prototype);\n\n\nmodule.exports = DropdownInput;\n","/* global $*/\n'use strict';\nvar consts = require('config/consts');\nvar errors = require('actions/errors');\nvar messages = require('config/messages');\nvar jumps = require('actions/jumps');\nvar save = require('actions/save');\nvar input_properties = require('factory/input-properties');\nvar Input = require('factory/input-prototype');\nvar validation = require('actions/validation');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar formbuilder = require('config/formbuilder');\nvar group_sortable = require('ui-handlers/group-sortable');\nvar input_collection_branch_sortable_mousedown_callback = require('ui-handlers/event-handler-callbacks/input-collection-branch-sortable-mousedown-callback');\nvar input_collection_group_sortable_mousedown_callback = require('ui-handlers/event-handler-callbacks/input-collection-group-sortable-mousedown-callback');\nvar input_collection_nested_group_sortable_mousedown_callback = require('ui-handlers/event-handler-callbacks/input-collection-nested-group-sortable-mousedown-callback');\nvar input_collection_sortable_mousedown_callback = require('ui-handlers/event-handler-callbacks/input-collection-sortable-mousedown-callback');\n\nvar GroupInput = function (the_input_ref) {\n\n    //extend basic input wih common properties (easier than passing a properties object to Object.create)\n    $.extend(true, this, input_properties);\n\n    //set current instance properties\n    //this.index = the_index;\n    this.ref = the_input_ref;\n    this.type = consts.GROUP_TYPE;\n\n    /* reset DOM properties (jquery selectors are not 'live', we need to run them again for new object)\n     *\n     * if the property below is not reset here, all the inputs will get the same dom reference\n     * */\n    this.dom = {};\n    this.dom.is_valid = false;\n};\n\n//extend prototype from basic input object\nGroupInput.prototype = Object.create(Input.prototype);\n\nGroupInput.prototype.isHeaderTextValid = function () {\n    return this.isQuestionTextValid();\n};\n\n//toggle edit branch button\nGroupInput.prototype.toggleEditButton = function (the_state) {\n    ui.group.toggleEditGroupButton(this.ref, the_state);\n};\n\nGroupInput.prototype.enterGroupSortable = function (is_nested) {\n\n    var self = this;\n    var undo = require('actions/undo');\n    var active_group = formbuilder.dom.inputs_collection_sortable\n        .find('div.input[data-input-ref=\"' + self.ref + '\"]');\n    var active_group_inner = active_group.find(' > .input-inner');\n    var group_holder_html = ui.inputs_collection.getEmptyCollectionSortableHTML(consts.GROUP_TYPE);\n    var exit_btn_html = '';\n    var exit_button_class = is_nested ? 'exit-nested-group-editing' : 'exit-group-editing';\n    exit_btn_html += '<button class=\"btn btn-sm btn-default ' + exit_button_class + '\">';\n    exit_btn_html += '<i class=\"fa fa-2x fa-fw fa-chevron-left \"></i>';\n    exit_btn_html += messages.labels.EXIT_EDITING;\n    exit_btn_html += '</button>';\n\n\n    //disable jumps tab when editing a group\n    $('.jump-tab').addClass('disabled disabled-tab');\n\n    //reset group object, as we cache properties of the current enabled group only\n    formbuilder.group = {};\n\n    //set draggable to work with enabled group only\n    formbuilder.dom.inputs_tools_draggable.draggable('option', 'connectToSortable', '.group-sortable');\n\n    //set useful flags\n    formbuilder.is_editing_group = true;\n    formbuilder.group.active_group_ref = self.ref;\n\n    if (is_nested) {\n        active_group.off().on('mousedown', 'div.input', input_collection_nested_group_sortable_mousedown_callback);\n    } else {\n        active_group.off().on('mousedown', 'div.input', input_collection_group_sortable_mousedown_callback);\n    }\n\n    //if it is a brand new group, append sortable markup\n    if (active_group.find('.group-sortable').length === 0) {\n        group_holder_html = group_holder_html.replace('{{group-inputs}}', '');\n        active_group.append(group_holder_html);\n        active_group.find('.input-properties__no-group-questions-message').show();\n    }\n    else {\n        if (formbuilder.render_action === consts.RENDER_ACTION_UNDO && active_group.find('.group-sortable > div').length === 0) {\n            active_group.find('.input-properties__no-group-questions-message').show();\n        }\n    }\n\n    //enable group sortable\n    active_group.find('.group-sortable').sortable(group_sortable).disableSelection().removeClass('hidden');\n\n    //remove any previously selected group input\n    active_group.find('.group-sortable').find('.input.active').removeClass('active');\n\n    //show exit editing button\n    active_group.addClass('active-group').removeClass('active');\n\n    //remove first two elements\n    active_group_inner.find('.fa-align-justify').remove();\n    active_group_inner.find('> .question-preview').remove();\n\n    //append exit button\n    active_group_inner.prepend(exit_btn_html);\n\n    //disable form tab buttons\n    ui.forms_tabs.toggleFormTabsButtons({\n        enable: false\n    });\n\n    //prepare ui for editing group\n    if (is_nested) {\n        self.showEditNestedGroupUI();\n    } else {\n        self.showEditGroupUI();\n    }\n\n    active_group\n        .find('.' + exit_button_class)\n        .one('click', function () {\n            if (is_nested) {\n                self.exitNestedGroupSortable();\n            } else {\n                self.exitGroupSortable();\n            }\n        });\n\n    /*\n     change binding when editing a group, as we want to incercept only a mousedown to the exit button on the active group input\n     */\n    //destroy top parent sortable\n    console.log('group.js calls destroy');\n\n    /******** NEEDED BUG *********/\n    /* The call to 'destroy' will trigger an error the first time, but if it does not (catching the error or using the commented 'if else' statement)\n     *  when exiting the group the parent sortable will not work anymore, whether is a top level sortable or a branch sortable.\n     *  todo look into it\n     *\n     * */\n    if (formbuilder.render_action === consts.RENDER_ACTION_DO) {\n        formbuilder.dom.inputs_collection_sortable.sortable('destroy');\n    }\n    /******** END NEEDED BUG *********/\n\n    // formbuilder.dom.inputs_collection_sortable.find('.active-branch.hidden-active-branch .branch-sortable').sortable('destroy');\n    if (is_nested) {\n        //disable mousedown\n        formbuilder.dom.inputs_collection_sortable\n            .find('.active-branch.hidden-active-branch .branch-sortable')\n            .off('mousedown')\n            .on('mousedown', '.fa-chevron-left', input_collection_branch_sortable_mousedown_callback);\n    } else {\n        formbuilder.dom.inputs_collection_sortable.on('mousedown', '.fa-chevron-left', input_collection_sortable_mousedown_callback);\n    }\n\n    undo.pushState();\n};\n\nGroupInput.prototype.exitNestedGroupSortable = function () {\n\n    //exit nested group sortable\n    console.log('exiting nested group, goes up to branch');\n\n    var self = this;\n    var branch_sortable = require('ui-handlers/branch-sortable');\n    var active_branch = formbuilder.dom.inputs_collection_sortable.find('.active-branch');\n    var current_branch = utils.getInputObjectByRef(formbuilder.branch.active_branch_ref);\n    var current_branch_name = current_branch.question;\n    var active_group = formbuilder.dom.inputs_collection_sortable.find('.input.active-group');\n    var active_group_input_sortable = active_group.find('.group-sortable');\n    var active_group_inner = active_group.find(' > .input-inner');\n    var active_nested_group_input;\n\n    if (formbuilder.group.current_input_ref) {\n        active_nested_group_input = utils.getNestedGroupInputObjectByRef(current_branch, formbuilder.group.current_input_ref);\n        //validate last active group input and update dom accordingly (if an input was selected)\n        validation.performValidation(active_nested_group_input, false, formbuilder.project_definition);\n    }\n\n    //enable owner branch sortable\n    active_branch.find('.branch-sortable').sortable(branch_sortable).disableSelection();\n\n    active_group.removeClass('active-group').addClass('active');\n\n    //remove exit button\n    active_group_inner.find('.exit-nested-group-editing').remove();\n\n    //restore question in input collection\n    active_group_inner.prepend('<span class=\"question-preview\">' + self.question + '</span>');\n    active_group_inner.prepend('<i class=\"fa fa-2x fa-fw fa-align-justify\"></i>');\n\n    //show owner branch\n    active_branch\n        .removeClass('hidden-active-branch')\n        .find(' > .input-inner > i')\n        .fadeIn(consts.ANIMATION_FAST);\n\n    active_branch.find(' > .input-inner > .exit-branch-editing').fadeIn(consts.ANIMATION_FAST);\n\n    //show inactive branch inputs\n    formbuilder.dom.inputs_collection_sortable\n        .find('.active-branch')\n        .find('.branch-sortable')\n        .find(' > .input')\n        .not('.active-group')\n        .slideDown(consts.ANIMATION_NORMAL);\n\n    //update middle colum panel header showing owner branch question\n    formbuilder.dom.inputs_collection.find('.inputs-collection__header__edit-state').text(messages.labels.EDITING_BRANCH);\n    formbuilder.dom.inputs_collection.find('.inputs-collection__header__element-name').text(current_branch_name.trunc(consts.INPUTS_COLLECTION_GROUP_NAME_MAX_DISPLAY_LENGHT));\n\n    self.toggleEditButton(true);\n\n    //set draggable to work with the active branch sortable\n    formbuilder.dom.inputs_tools_draggable.draggable('option', 'connectToSortable', '.branch-sortable');\n\n    //hide nested group sortable\n    active_group_input_sortable.addClass('hidden');\n\n    /*\n     restore parent binding after exiting group editing\n     */\n    formbuilder.dom.inputs_collection_sortable\n        .find('.active-branch')\n        .off()\n        .on('mousedown', 'div.input', input_collection_branch_sortable_mousedown_callback);\n\n    formbuilder.dom.inputs_collection_sortable.find('.active-branch > .branch-sortable').sortable(branch_sortable);\n\n    //if both header and groups are valid, show green check on active group input\n    if (self.dom.is_valid) {\n        //replace warning icon with green check\n        ui.inputs_collection.showInputValidIcon(self.ref);\n    } else {\n        //replace warning icon with green check\n        ui.inputs_collection.showInputInvalidIcon(self.ref);\n    }\n\n    //show a preview of the nested group header (limit to 20 chars)\n    formbuilder.dom.input_properties.find('.panel-title span.question-preview').text(self.question.trunc(20));\n\n    //hide no inputs selected (just in case no input was selected in the nested group)\n    formbuilder.dom.input_properties_forms_wrapper\n        .find('.input-properties__no-input-selected').hide();\n\n    //hide any input previously selected\n    formbuilder.dom.input_properties_forms_wrapper\n        .find('.input-properties__form[data-input-ref=\"' + formbuilder.group.current_input_ref + '\"]').hide();\n\n    //show nested group input properties panel\n    formbuilder.dom.input_properties_forms_wrapper\n        .find('.input-properties__form[data-input-ref=\"' + formbuilder.group.active_group_ref + '\"]').fadeIn(consts.ANIMATION_FAST);\n\n    //enable group input tools in left sidebar\n    formbuilder.dom.inputs_tools_draggable.filter('.input-group').show();\n\n    formbuilder.is_editing_group = false;\n    formbuilder.group.current_input_ref = undefined;\n\n    //enable jumps tab when exit editing a group\n    $('.jump-tab').removeClass('disabled disabled-tab');\n\n    //show action buttons for owner input\n    formbuilder.dom.input_properties_buttons.fadeIn(consts.ANIMATION_FAST);\n};\n\nGroupInput.prototype.exitGroupSortable = function () {\n\n    var self = this;\n    var active_group_input;\n    var sortable = require('ui-handlers/sortable');\n    var current_form_name = formbuilder.project_definition.data.project.forms[formbuilder.current_form_index].name;\n    var active_group = formbuilder.dom.inputs_collection_sortable.find('.input.active-group');\n    var active_group_input_sortable = active_group.find('.group-sortable');\n    var active_group_inner = active_group.find(' > .input-inner');\n\n    if (formbuilder.group.current_input_ref) {\n        active_group_input = utils.getGroupInputObjectByRef(formbuilder.group.current_input_ref);\n        //validate last active group input and update dom accordingly\n        validation.performValidation(active_group_input, false, formbuilder.project_definition);\n    }\n\n    active_group.removeClass('active-group').addClass('active');\n\n    //remove exit button\n    active_group_inner.find('.exit-group-editing').remove();\n\n    //restore question in input collection\n    active_group_inner.prepend('<span class=\"question-preview\">' + self.question + '</span>');\n    active_group_inner.prepend('<i class=\"fa fa-2x fa-fw fa-align-justify\"></i>');\n\n    formbuilder.dom.inputs_collection_sortable.find('.input').not('.active').slideDown(consts.ANIMATION_NORMAL);\n\n    //update panel header\n    formbuilder.dom.inputs_collection.find('.inputs-collection__header__edit-state').text(messages.labels.EDITING_FORM);\n    formbuilder.dom.inputs_collection.find('.inputs-collection__header__element-name').text(current_form_name.trunc(consts.INPUTS_COLLECTION_GROUP_NAME_MAX_DISPLAY_LENGHT));\n\n    //show form action buttons in panel heading\n    ui.inputs_collection.toggleFormActionButtons(true);\n\n    //enable jumps tab\n    ui.input_properties_panel.toggleJumpTab(self.ref, true);\n\n    self.toggleEditButton(true);\n\n    //set draggable to work with main sortable\n    formbuilder.dom.inputs_tools_draggable.draggable('option', 'connectToSortable', '.sortable');\n\n    active_group_input_sortable.addClass('hidden');\n\n    /*\n     restore parent binding and sortable after exiting group editing\n     */\n    formbuilder.dom.inputs_collection_sortable.off('mousedown').on('mousedown', 'div.input', input_collection_sortable_mousedown_callback);\n    sortable();\n\n    //if both header and groups are valid, show green check on active group input\n    if (self.dom.is_valid) {\n        //update the just saved input showing a preview of the question text (limit to 50 chars)\n        ui.inputs_collection.showInputQuestionPreview(self.ref, self.question.trunc(50));\n        //replace warning icon with green check\n        ui.inputs_collection.showInputValidIcon(self.ref);\n    } else {\n        //replace warning icon with green check\n        ui.inputs_collection.showInputInvalidIcon(self.ref);\n    }\n\n    formbuilder.dom.input_properties_forms_wrapper\n        .find('.input-properties__no-input-selected').hide();\n\n    //hide any input previously selected\n    formbuilder.dom.input_properties_forms_wrapper\n        .find('.input-properties__form[data-input-ref=\"' + formbuilder.group.current_input_ref + '\"]').hide();\n\n    //show branch input properties panel\n    formbuilder.dom.input_properties_forms_wrapper\n        .find('.input-properties__form[data-input-ref=\"' + formbuilder.group.active_group_ref + '\"]').fadeIn(consts.ANIMATION_FAST);\n\n    //enable branch & group input tools in left sidebar\n    formbuilder.dom.inputs_tools_draggable.filter('.input-branch, .input-group').show();\n\n    formbuilder.is_editing_group = false;\n    formbuilder.group.current_input_ref = undefined;\n\n    //enable jumps tab when exit editing a group\n    $('.jump-tab').removeClass('disabled disabled-tab');\n\n    //show title flag\n    $('.input-properties__form__title-flag').removeClass('hidden');\n\n    //enable form tabs buttons\n    ui.forms_tabs.toggleFormTabsButtons({\n        enable: true\n    });\n\n    //show action buttons for owner input\n    formbuilder.dom.input_properties_buttons.fadeIn(consts.ANIMATION_FAST);\n};\n\nGroupInput.prototype.showEditGroupUI = function () {\n\n    var self = this;\n\n    //hide first level inputs from the input collection\n    formbuilder.dom.inputs_collection_sortable.find(' > .input').not('.active-group').slideUp(consts.ANIMATION_NORMAL);\n\n    //update panel header\n    formbuilder.dom.inputs_collection.find('.inputs-collection__header__edit-state').text(messages.labels.EDITING_GROUP);\n    formbuilder.dom.inputs_collection.find('.inputs-collection__header__element-name').text(self.question.trunc(consts.INPUTS_COLLECTION_GROUP_NAME_MAX_DISPLAY_LENGHT));\n\n    //disable form action buttons in panel heading\n    ui.inputs_collection.toggleFormActionButtons(false);\n\n    //disable jumps tab //todo is this needed?\n    ui.input_properties_panel.toggleJumpTab(self.ref, false);\n\n    //hide owner group input panel and show 'no group inputs selected' by default\n    formbuilder.dom.input_properties_forms_wrapper\n        .find('form[data-input-ref=\"' + self.ref + '\"]').hide();\n\n    formbuilder.dom.input_properties_forms_wrapper\n        .find('.input-properties__no-input-selected').show();\n\n    //hide input properties panel action buttons until a group input gets selected\n    formbuilder.dom.input_properties_buttons.fadeOut(consts.ANIMATION_FAST);\n\n    ////hide branch & group input tools in left sidebar, as we cannot have a branch or a group withing a group\n    formbuilder.dom.inputs_tools_draggable.filter('.input-branch, .input-group').hide();\n\n};\n\nGroupInput.prototype.showEditNestedGroupUI = function () {\n\n    var self = this;\n    var active_branch = formbuilder.dom.inputs_collection_sortable.find('.active-branch');\n\n    //render UI for a nested group, as we cannot just hide the main parent since it is a branch sortable\n    //hide inactive branch inputs from the input collection\n    active_branch\n        .find('.branch-sortable')\n        .find(' > .input')\n        .not('.active-group')\n        .slideUp(consts.ANIMATION_NORMAL);\n\n    //hide owner branch ant its inactive inputs (without using display:none as that will hide the nested group as well :/)\n    active_branch\n        .addClass('hidden-active-branch')\n        .find(' > .input-inner > i')\n        .hide();\n\n    active_branch.find('.exit-branch-editing').hide();\n\n    //remove all events from active branch as we are only interested in the mousedown event of the group sortable\n    active_branch.off();\n\n    //update panel header, as it a nested group show full breadcrumbs\n    formbuilder.dom.inputs_collection\n        .find('.inputs-collection__header__edit-state')\n        .text(messages.labels.EDITING_BRANCH + messages.labels.EDITING_NESTED_GROUP);\n\n    formbuilder.dom.inputs_collection.find('.inputs-collection__header__element-name').text(self.question.trunc(consts.INPUTS_COLLECTION_GROUP_NAME_MAX_DISPLAY_LENGHT));\n\n    //hide owner group input panel and show 'no group inputs selected' by default\n    formbuilder.dom.input_properties_forms_wrapper\n        .find('form[data-input-ref=\"' + self.ref + '\"]').hide();\n    formbuilder.dom.input_properties_forms_wrapper\n        .find('.input-properties__no-input-selected').show();\n\n    //hide input properties panel action buttons until a group input gets selected\n    formbuilder.dom.input_properties_buttons.fadeOut(consts.ANIMATION_FAST);\n\n    ////disable branch & group input tools in left sidebar, as we cannot have a branch or a group withing a group\n    formbuilder.dom.inputs_tools_draggable.filter('.input-branch, .input-group').hide();\n};\n\nGroupInput.prototype.validateGroupInputs = function () {\n\n    var self = this;\n    var group_inputs_validation = validation.validateGroupInputs(self);\n    if (!group_inputs_validation.is_valid) {\n        //highlight wrong input and show error message\n        errors.showGroupInputsErrors(self.dom.properties_panel, group_inputs_validation.error.message);\n        //set element as invalid\n        self.dom.is_valid = false;\n    } else {\n        //set element as valid\n        self.dom.is_valid = true;\n        errors.hideGroupInputsErrors(self.dom.properties_panel);\n    }\n};\n\nmodule.exports = GroupInput;\n","/* global $*/\n'use strict';\nvar consts = require('config/consts');\nvar errors = require('actions/errors');\nvar jumps = require('actions/jumps');\nvar save = require('actions/save');\nvar messages = require('config/messages');\nvar input_properties = require('factory/input-properties');\nvar Input = require('factory/input-prototype');\nvar validation = require('actions/validation');\nvar formbuilder = require('config/formbuilder');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar template = require ('template');\n\nvar NumericInput = function (the_input_ref) {\n\n    $.extend(true, this, input_properties);\n\n    //set default properties\n    //this.index = the_index;\n    this.ref = the_input_ref;\n    this.type = consts.INTEGER_TYPE;\n\n    /* reset DOM properties (jquery selectors are not 'live', we need to run them again for new object)\n     *\n     * if the property below is not reset here, all the inputs will get the same dom reference\n     * */\n    this.dom = {};\n    this.dom.is_valid = false;\n};\n\n//extend prototype from basic input object\nNumericInput.prototype = Object.create(Input.prototype);\n\n/*\n Overrides\n */\n\n//validate initial answer\nNumericInput.prototype.isInitialAnswerValid = function () {\n\n    var validate = validation.isInitialAnswerValid(this.type,this.default, this.regex);\n\n    if (validate.is_valid) {\n        //validate for integer type\n        if (this.type === consts.INTEGER_TYPE && this.default !== '') {\n            //initial answer must be an integer, not a float\n            if (!validation.isValueInt(this.default)) {\n                validate.is_valid = false;\n                validate.error.message = messages.error.VALUE_MUST_BE_INTEGER;\n            }\n        }\n    }\n    return validate;\n};\n\nNumericInput.prototype.isMinValueValid = function () {\n    //validate min value\n    return validation.isMinMaxValueValid(this.type, this.min);\n};\n\nNumericInput.prototype.isMaxValueValid = function () {\n    //validate max value\n    return validation.isMinMaxValueValid(this.type, this.max);\n};\n\nNumericInput.prototype.saveAdvancedProperties = function () {\n\n    var initial_answer_validation;\n    var min_value_validation;\n    var max_value_validation;\n    var uniqueness;\n\n    this.dom.advanced_properties_wrapper = formbuilder.dom.input_properties_forms_wrapper\n        .find('form[data-input-ref=\"' + this.ref + '\"]')\n        .find('.input-properties__form__advanced-properties');\n\n    //clear all advanced properties errors from dom\n    this.hideAdvancedPropertiesErrors();\n\n    //set integer or decimal numeric type\n    this.type = this.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__numeric input:checked').val();\n\n    //set default (initial answer)\n    this.default = this.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__default input').val();\n\n    //strip html tags\n    this.default = this.default.replace(/(<([^>]+)>)/ig, '');\n    this.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__default input').val(this.default);\n\n\n    //set min value\n    this.min = this.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__min input').val();\n    this.min = this.min.replace(/(<([^>]+)>)/ig, '');\n    this.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__min input').val(this.min);\n\n    //set max value\n    this.max = this.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__max input').val();\n    this.max = this.max.replace(/(<([^>]+)>)/ig, '');\n    this.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__max input').val(this.max);\n\n    //set regex\n    this.regex = this.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__regex input').val();\n    this.regex = this.regex.replace(/(<([^>]+)>)/ig, '');\n    this.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__regex input').val(this.regex);\n\n    //set verify flag\n    this.verify = this.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__double-entry input').is(':checked');\n\n    //validate initial answer (based also on min max and numeric type)\n    initial_answer_validation = this.isInitialAnswerValid();\n    if (!initial_answer_validation.is_valid) {\n        //warn user initial answer is not valid\n        this.dom.is_valid = false;\n        //highlight wrong input\n        this.showAdvancedPropertiesErrors(consts.DEFAULT_PROPERTY, initial_answer_validation.error.message);\n    }\n\n    //validate min value\n    min_value_validation = this.isMinValueValid();\n    if (!min_value_validation.is_valid) {\n        //warn user min value is not valid\n        this.dom.is_valid = false;\n        //highlight wrong input\n        this.showAdvancedPropertiesErrors(consts.MIN_VALUE_PROPERTY, min_value_validation.error.message);\n    }\n\n    //validate max value\n    max_value_validation = this.isMaxValueValid();\n    if (!max_value_validation.is_valid) {\n        //warn user min value is not valid\n        this.dom.is_valid = false;\n        //highlight wrong input\n        this.showAdvancedPropertiesErrors(consts.MAX_VALUE_PROPERTY, max_value_validation.error.message);\n    }\n\n    //all advanced properties are valid, validate combinations across properties\n    //min (if set) needs to be smaller than max (if set)\n    if (min_value_validation.is_valid && max_value_validation.is_valid && this.min !== '' && this.max !== '') {\n\n        if (parseFloat(this.min) >= parseFloat(this.max)) {\n            //warn user min value is not valid\n            this.dom.is_valid = false;\n            //highlight wrong input\n            this.showAdvancedPropertiesErrors(consts.MIN_VALUE_PROPERTY, messages.error.MIN_MUST_BE_SMALLER_THAN_MAX);\n        }\n    }\n\n    //intial answer (if set) should be within the range set by min/max properties\n    if (initial_answer_validation.is_valid && this.default !== '') {\n\n        if (min_value_validation.is_valid && this.min !== '') {\n            if (parseFloat(this.default) < parseFloat(this.min)) {\n                //warn user min value is not valid\n                this.dom.is_valid = false;\n                //highlight wrong input\n                this.showAdvancedPropertiesErrors(consts.DEFAULT_PROPERTY, messages.error.INITIAL_ANSWER_OUT_OF_RANGE);\n            }\n        }\n\n        if (max_value_validation.is_valid && this.max !== '') {\n            if (parseFloat(this.default) > parseFloat(this.max)) {\n                //warn user min value is not valid\n                this.dom.is_valid = false;\n                //highlight wrong input\n                this.showAdvancedPropertiesErrors(consts.DEFAULT_PROPERTY, messages.error.INITIAL_ANSWER_OUT_OF_RANGE);\n            }\n        }\n    }\n\n    //save uniqueness\n    save.saveUniqueness(this);\n};\n\nNumericInput.prototype.hideAdvancedPropertiesErrors = function () {\n\n    //reset validation dom feedback (hide all errors from dom)\n    var properties_to_hide_error = [\n        consts.DEFAULT_PROPERTY,\n        consts.MIN_VALUE_PROPERTY,\n        consts.MAX_VALUE_PROPERTY\n    ];\n\n    errors.hideAdvancedPropertiesErrors(this, properties_to_hide_error);\n};\n\nmodule.exports = NumericInput;\n","/* global $*/\n'use strict';\nvar consts = require('config/consts');\nvar errors = require('actions/errors');\nvar jumps = require('actions/jumps');\nvar save = require('actions/save');\nvar input_properties = require('factory/input-properties');\nvar Input = require('factory/input-prototype');\nvar validation = require('actions/validation');\nvar formbuilder = require('config/formbuilder');\n\nvar LocationInput = function (the_input_ref) {\n\n    //extend basic input wih common properties (easier than passing a properties object to Object.create)\n    $.extend(true, this, input_properties);\n\n    //set default properties\n   // this.index = the_index;\n    this.ref = the_input_ref;\n    this.type = consts.LOCATION_TYPE;\n\n    /* reset DOM properties (jquery selectors are not 'live', we need to run them again for new object)\n     *\n     * if the property below is not reset here, all the inputs will get the same dom reference\n     * */\n    this.dom = {};\n    this.dom.is_valid = false;\n};\n\n//extend prototype from basic input object\nLocationInput.prototype = Object.create(Input.prototype);\n\n/*\n Overrides\n */\n//LocationInput.prototype.prepareAdvancedInputProperties = function () {\n//};\n//\n//LocationInput.prototype.hideAdvancedPropertiesErrors = function () {\n//    //do nothing\n//};\n\nmodule.exports = LocationInput;\n","/* global $*/\n'use strict';\nvar consts = require('config/consts');\nvar errors = require('actions/errors');\nvar jumps = require('actions/jumps');\nvar save = require('actions/save');\nvar input_properties = require('factory/input-properties');\nvar Input = require('factory/input-prototype');\nvar validation = require('actions/validation');\nvar formbuilder = require('config/formbuilder');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\n\nvar PhoneInput = function (the_input_ref) {\n\n    //extend basic input (using a clone, not a reference) wih common properties (easier than passing a properties object to Object.create)\n    $.extend(true, this, input_properties);\n\n    //set current instance properties\n    this.ref = the_input_ref;\n    this.type = consts.PHONE_TYPE;\n\n    /* reset DOM properties (jquery selectors are not 'live')*/\n    this.dom = {};\n    this.dom.is_valid = false;\n};\n\n//extend prototype from basic input object\nPhoneInput.prototype = Object.create(Input.prototype);\n\n/*\n Overrides\n */\n\nPhoneInput.prototype.setAdvancedInputProperties = function () {\n\n    //set  'default' option\n    this.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__default input').val(this.default);\n\n    //set 'regex' option\n    this.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__regex input').val(this.regex);\n\n    //set 'input_ref' on 'double entry verification' option\n    this.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__double-entry input').prop('checked', this.verify);\n\n    //set 'input_ref' on 'uniqueness' option\n    ui.input_properties_panel.setUniquenessProperty(formbuilder.current_form_index, this);\n};\n\n\nPhoneInput.prototype.hideAdvancedPropertiesErrors = function () {\n\n    //reset validation dom feedback (hide all errors from dom)\n    var properties_to_hide_error = [\n        consts.DEFAULT_PROPERTY\n    ];\n    errors.hideAdvancedPropertiesErrors(this, properties_to_hide_error);\n};\n\nmodule.exports = PhoneInput;\n","/* global $*/\n'use strict';\nvar consts = require('../config/consts');\nvar errors = require('actions/errors');\nvar jumps = require('actions/jumps');\nvar save = require('actions/save');\nvar input_properties = require('factory/input-properties');\nvar Input = require('factory/input-prototype');\nvar validation = require('actions/validation');\nvar formbuilder = require('../config/formbuilder');\n\nvar PhotoInput = function (the_input_ref) {\n\n    //extend basic input wih common properties (easier than passing a properties object to Object.create)\n    $.extend(true, this, input_properties);\n\n    //set current instance properties\n    //this.index = the_index;\n    this.ref = the_input_ref;\n    this.type = consts.PHOTO_TYPE;\n\n    /* reset DOM properties (jquery selectors are not 'live', we need to run them again for new object)\n     *\n     * if the property below is not reset here, all the inputs will get the same dom reference\n     * */\n    this.dom = {};\n    this.dom.is_valid = false;\n};\n\n//extend prototype from basic input object\nPhotoInput.prototype = Object.create(Input.prototype);\n/*\n Overrides\n */\n//PhotoInput.prototype.prepareAdvancedInputProperties = function () {\n//};\n\n//PhotoInput.prototype.hideAdvancedPropertiesErrors = function () {\n//    //do nothing\n//};\n\nmodule.exports = PhotoInput;\n","/* global $*/\n'use strict';\nvar consts = require('config/consts');\nvar errors = require('actions/errors');\nvar jumps = require('actions/jumps');\nvar save = require('actions/save');\nvar possible_answers = require('actions/possible-answers');\nvar input_properties = require('factory/input-properties');\nvar Input = require('factory/input-prototype');\nvar InputMultipleAnswers = require('factory/input-multiple-answers-prototype');\nvar validation = require('actions/validation');\nvar formbuilder = require('config/formbuilder');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\n\nvar RadioInput = function (the_input_ref) {\n\n    //extend basic input wih common properties (easier than passing a properties object to Object.create)\n    $.extend(true, this, input_properties);\n\n    //set current instance properties\n    //this.index = the_index;\n    this.ref = the_input_ref;\n    this.type = consts.RADIO_TYPE;\n\n    //set a default answer on newly created dropdowns inputs\n    this.possible_answers = [{\n        answer: 'I am a placeholder answer',\n        answer_ref: utils.generateUniqID()\n    }];\n\n\n    /* reset DOM properties (jquery selectors are not 'live', we need to run them again for new object)\n     *\n     * if the property below is not reset here, all the inputs will get the same dom reference\n     * */\n    this.dom = {};\n    this.dom.is_valid = false;\n\n    //pagination defaults\n    formbuilder.possible_answers_pagination[this.ref] = {};\n    formbuilder.possible_answers_pagination[this.ref].page = 1;\n\n};\n\n//extend prototype from basic input object and multiple answer object\nRadioInput.prototype = $.extend({}, Input.prototype, InputMultipleAnswers.prototype);\n\nmodule.exports = RadioInput;\n","/* global $*/\n'use strict';\nvar consts = require('config/consts');\nvar errors = require('actions/errors');\nvar jumps = require('actions/jumps');\nvar save = require('actions/save');\nvar input_properties = require('factory/input-properties');\nvar Input = require('factory/input-prototype');\nvar validation = require('actions/validation');\nvar formbuilder = require('config/formbuilder');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\n\nvar ReadmeInput = function (the_input_ref) {\n\n    //extend basic input (using a clone, not a reference) wih common properties (easier than passing a properties object to Object.create)\n    $.extend(true, this, input_properties);\n\n    //set current instance properties\n    this.ref = the_input_ref;\n    this.type = consts.README_TYPE;\n\n    /* reset DOM properties (jquery selectors are not 'live')*/\n    this.dom = {};\n    this.dom.is_valid = false;\n\n    //override a few properties for validation purposes server side\n    this.is_title = false;\n    this.verify = false;\n    this.is_required = false;\n\n\n\n};\n\n//extend prototype from basic input object\nReadmeInput.prototype = Object.create(Input.prototype);\n\n\n/*\n Overrides\n */\n\n\nmodule.exports = ReadmeInput;\n","/* global $*/\n'use strict';\nvar consts = require('config/consts');\nvar errors = require('actions/errors');\nvar jumps = require('actions/jumps');\nvar save = require('actions/save');\nvar possible_answers = require('actions/possible-answers');\nvar input_properties = require('factory/input-properties');\nvar Input = require('factory/input-prototype');\nvar InputMultipleAnswers = require('factory/input-multiple-answers-prototype');\nvar validation = require('actions/validation');\nvar formbuilder = require('config/formbuilder');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\n\nvar SearchInput = function (the_input_ref) {\n\n    //extend basic input wih common properties (easier than passing a properties object to Object.create)\n    $.extend(true, this, input_properties);\n\n    //set current instance properties\n    //this.index = the_index;\n    this.ref = the_input_ref;\n    this.type = consts.SEARCH_SINGLE_TYPE;\n\n    //set a default answer on newly created dropdowns inputs\n    this.possible_answers = [{\n        answer: 'I am a placeholder answer',\n        answer_ref: utils.generateUniqID()\n    }];\n\n\n    /* reset DOM properties (jquery selectors are not 'live', we need to run them again for new object)\n     *\n     * if the property below is not reset here, all the inputs will get the same dom reference\n     * */\n    this.dom = {};\n    this.dom.is_valid = false;\n\n    formbuilder.possible_answers_pagination[this.ref] = {};\n    formbuilder.possible_answers_pagination[this.ref].page = 1;\n\n};\n\n//extend prototype from basic input object and multiple answer object\nSearchInput.prototype = $.extend({}, Input.prototype, InputMultipleAnswers.prototype);\n\nmodule.exports = SearchInput;\n","/* global $*/\n'use strict';\nvar consts = require('config/consts');\nvar errors = require('actions/errors');\nvar jumps = require('actions/jumps');\nvar save = require('actions/save');\nvar input_properties = require('factory/input-properties');\nvar Input = require('factory/input-prototype');\nvar validation = require('actions/validation');\nvar formbuilder = require('config/formbuilder');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\n\nvar TextInput = function (the_input_ref) {\n\n    //extend basic input (using a clone, not a reference) wih common properties (easier than passing a properties object to Object.create)\n    $.extend(true, this, input_properties);\n\n    //set current instance properties\n    this.ref = the_input_ref;\n    this.type = consts.TEXT_TYPE;\n\n    /* reset DOM properties (jquery selectors are not 'live')*/\n    this.dom = {};\n    this.dom.is_valid = false;\n};\n\n//extend prototype from basic input object\nTextInput.prototype = Object.create(Input.prototype);\n\n/*\n Overrides\n */\n\nTextInput.prototype.setAdvancedInputProperties = function () {\n\n    //set  'default' option\n    this.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__default input').val(this.default);\n\n    //set 'regex' option\n    this.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__regex input').val(this.regex);\n\n    //set 'input_ref' on 'double entry verification' option\n    this.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__double-entry input').prop('checked', this.verify);\n\n    //set 'input_ref' on 'uniqueness' option\n    ui.input_properties_panel.setUniquenessProperty(formbuilder.current_form_index, this);\n};\n\n\nTextInput.prototype.hideAdvancedPropertiesErrors = function () {\n\n    //reset validation dom feedback (hide all errors from dom)\n    var properties_to_hide_error = [\n        consts.DEFAULT_PROPERTY\n    ];\n    errors.hideAdvancedPropertiesErrors(this, properties_to_hide_error);\n};\n\nmodule.exports = TextInput;\n","/* global $*/\n'use strict';\nvar consts = require('config/consts');\nvar errors = require('actions/errors');\nvar jumps = require('actions/jumps');\nvar save = require('actions/save');\nvar input_properties = require('factory/input-properties');\nvar Input = require('factory/input-prototype');\nvar validation = require('actions/validation');\nvar formbuilder = require('config/formbuilder');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\n\nvar TextareaInput = function (the_input_ref) {\n\n    //extend basic input wih common properties (easier than passing a properties object to Object.create)\n    $.extend(true, this, input_properties);\n\n    //set default properties\n    //this.index = the_index;\n    this.ref = the_input_ref;\n    this.type = consts.TEXTAREA_TYPE;\n\n    /* reset DOM properties (jquery selectors are not 'live', we need to run them again for new object)\n     *\n     * if the property below is not reset here, all the inputs will get the same dom reference\n     * */\n    this.dom = {};\n    this.dom.is_valid = false;\n};\n\n//extend prototype from basic input object\nTextareaInput.prototype = Object.create(Input.prototype);\n\n/*\n Overrides\n */\n\nTextareaInput.prototype.setAdvancedInputProperties = function () {\n\n    this.dom.advanced_properties_wrapper = formbuilder\n        .dom\n        .input_properties_forms_wrapper\n        .find('form[data-input-ref=\"' + this.ref + '\"]')\n        .find('.input-properties__form__advanced-properties');\n\n    //set  'default' option\n    this.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__default input').val(this.default);\n\n    //set 'regex' option\n    this.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__regex input').val(this.regex);\n\n    //set 'input_ref' on 'double entry verification' option\n    this.dom.advanced_properties_wrapper.find('div.input-properties__form__advanced-properties__double-entry input').prop('checked', this.verify);\n\n    //set 'input_ref' on 'uniqueness' option\n    ui.input_properties_panel.setUniquenessProperty(formbuilder.current_form_index, this);\n};\n\nTextareaInput.prototype.hideAdvancedPropertiesErrors = function () {\n    //reset validation dom feedback (hide all errors from dom)\n    var properties_to_hide_error = [\n        consts.DEFAULT_PROPERTY\n    ];\n    errors.hideAdvancedPropertiesErrors(this, properties_to_hide_error);\n};\n\nmodule.exports = TextareaInput;\n","/* global $*/\n'use strict';\nvar consts = require('config/consts');\nvar errors = require('actions/errors');\nvar jumps = require('actions/jumps');\nvar save = require('actions/save');\nvar input_properties = require('factory/input-properties');\nvar Input = require('factory/input-prototype');\nvar validation = require('actions/validation');\nvar formbuilder = require('config/formbuilder');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\n\nvar TimeInput = function (the_input_ref) {\n\n    //extend basic input wih common properties (easier than passing a properties object to Object.create)\n    $.extend(true, this, input_properties);\n\n    //set current instance properties\n    //this.index = the_index;\n    this.ref = the_input_ref;\n    this.type = consts.TIME_TYPE;\n\n    /* reset DOM properties (jquery selectors are not 'live', we need to run them again for new object)\n     *\n     * if the property below is not reset here, all the inputs will get the same dom reference\n     * */\n    this.dom = {};\n    this.dom.is_valid = false;\n};\n\n//extend prototype from basic input object\nTimeInput.prototype = Object.create(Input.prototype);\n\n/*\n Overrides\n */\n\n\nTimeInput.prototype.setAdvancedInputProperties = function () {\n\n    this.dom.advanced_properties_wrapper = formbuilder\n        .dom\n        .input_properties_forms_wrapper\n        .find('form[data-input-ref=\"' + this.ref + '\"]')\n        .find('.input-properties__form__advanced-properties');\n\n\n    //set default to current datetime?\n    this.dom.advanced_properties_wrapper\n        .find('div.input-properties__form__advanced-properties__default-to-current label input').prop('checked', this.set_to_current_datetime);\n\n    //set datetime format\n    this.dom.advanced_properties_wrapper\n        .find('div.input-properties__form__advanced-properties__timeformat input[name=\"timeformatRadio\"][value=\"' + this.datetime_format + '\"]')\n        .prop('checked', true);\n\n    //set 'uniqueness' option\n    //set 'input_ref' on 'uniqueness' option\n    ui.input_properties_panel.setUniquenessProperty(formbuilder.current_form_index, this);\n\n};\n\nTimeInput.prototype.saveAdvancedProperties = function () {\n\n    var form_index = formbuilder.current_form_index;\n    var uniqueness;\n\n    this.dom.advanced_properties_wrapper = formbuilder.dom.input_properties_forms_wrapper\n        .find('form[data-input-ref=\"' + this.ref + '\"]')\n        .find('.input-properties__form__advanced-properties');\n\n    //set default to current datetime?\n    this.set_to_current_datetime = this.dom.advanced_properties_wrapper\n        .find('div.input-properties__form__advanced-properties__default-to-current input')\n        .is(':checked');\n\n    //set datetime format\n    this.datetime_format = this.dom.advanced_properties_wrapper\n        .find('div.input-properties__form__advanced-properties__timeformat input[name=\"timeformatRadio\"]:checked')\n        .val();\n\n    //save uniqueness\n    save.saveUniqueness(this);\n};\n\nmodule.exports = TimeInput;\n","/* global $*/\n'use strict';\nvar consts = require('config/consts');\nvar errors = require('actions/errors');\nvar jumps = require('actions/jumps');\nvar save = require('actions/save');\nvar input_properties = require('factory/input-properties');\nvar Input = require('factory/input-prototype');\nvar validation = require('actions/validation');\nvar formbuilder = require('config/formbuilder');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\n\nvar VideoInput = function (the_input_ref) {\n\n    //extend basic input wih common properties (easier than passing a properties object to Object.create)\n    $.extend(true, this, input_properties);\n\n    //set current instance properties\n    //this.index = the_index;\n    this.ref = the_input_ref;\n    this.type = consts.VIDEO_TYPE;\n\n    /* reset DOM properties (jquery selectors are not 'live', we need to run them again for new object)\n     *\n     * if the property below is not reset here, all the inputs will get the same dom reference\n     * */\n    this.dom = {};\n    this.dom.is_valid = false;\n};\n\n//extend prototype from basic input object\nVideoInput.prototype = Object.create(Input.prototype);\n\nmodule.exports = VideoInput;\n","'use strict';\nvar consts = require('config/consts.js');\nvar formbuilder = require('config/formbuilder');\nvar utils = require('helpers/utils');\n\nvar load_child_form_containers = function () {\n\n    var deferred = new $.Deferred();\n    var views = {};\n    var path = utils.getContainersPath();\n\n    $.when(\n        //inputs collection (sortable), holding all the inputs for a child form\n        $.get(path + 'inputs-collection.html', function (data) {\n            views.inputs_collection = data;\n        }),\n        //inputs properties, showing properties for selected input\n        $.get(path + 'inputs-properties.html', function (data) {\n            views.inputs_properties = data;\n        })\n    ).then(function () {\n        deferred.resolve(views);\n    });\n    return deferred.promise();\n};\n\nmodule.exports = load_child_form_containers;\n","'use strict';\nvar consts = require('config/consts');\nvar formbuilder = require('config/formbuilder');\nvar load_partials = require('loaders/load-partials');\nvar load_containers = require('loaders/load-containers');\nvar load_input_properties_views = require('loaders/load-input-properties-views');\nvar ui = require('helpers/ui');\n\n/********************************************\n Load html components\n *******************************************/\nvar load_components = function () {\n\n    var deferred = new $.Deferred();\n\n    //load main containers (inputs tools, inputs collection and inputs properties) (\"containers will be undefined\")\n    //load partials for input properties tabs (\"partials\")\n    //load views for input properties (\"views\")\n    $.when(load_containers(), load_partials(), load_input_properties_views()).then(function (containers, partials, views) {\n\n        //init with first form ref\n        var form_ref = formbuilder.project_definition.data.project.forms[0].ref;\n\n        //inject ref into first form in the dom\n        ui.forms_tabs.injectRefIntoFormTab(form_ref);\n\n        //setup formbuilder object\n        formbuilder.setup(form_ref, partials, views);\n\n\n        deferred.resolve();\n    });\n    return deferred.promise();\n};\n\nmodule.exports = load_components;\n","'use strict';\nvar consts = require('config/consts.js');\nvar utils = require('helpers/utils');\n\nvar get_containers = function () {\n\n    var deferred = new $.Deferred();\n    var path = utils.getContainersPath();\n\n    //load container views for index.html (main entry point)\n    $.when(\n        //navbar\n        $.get(path + 'navbar.html', function (data) {\n            $('.navbar').html(data);\n        }),\n        //inputs tools list (source inputs to drag, draggable)\n        $.get(path + 'inputs-tools.html', function (data) {\n            $('.inputs-tools').html(data);\n        }),\n        //inputs collection (sortable), holding all the inputs for a form\n        $.get(path + 'inputs-collection.html', function (data) {\n            $('.inputs-collection').html(data);\n        }),\n        //inputs properties, showing properties for selected input\n        $.get(path + 'inputs-properties.html', function (data) {\n            $('.input-properties').html(data);\n        })\n    ).then(function () {\n            deferred.resolve();\n        });\n\n    return deferred.promise();\n};\n\nmodule.exports = get_containers;\n","'use strict';\nvar consts = require('config/consts.js');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\n\n\nvar load_input_properties_views = function () {\n\n    var views = {};\n    var deferred = new $.Deferred();\n    var path = utils.getPropertiesPath();\n\n    $.when(\n        $.get(path + 'properties-audio.html', function (data) {\n            views.audio = data;\n        }),\n        $.get(path + 'properties-barcode.html', function (data) {\n            views.barcode = data;\n        }),\n        $.get(path + 'properties-branch.html', function (data) {\n            views.branch = data;\n        }),\n        $.get(path + 'properties-checkbox.html', function (data) {\n            views.checkbox = data;\n        }),\n        $.get(path + 'properties-date.html', function (data) {\n            views.date = data;\n        }),\n        $.get(path + 'properties-dropdown.html', function (data) {\n            views.dropdown = data;\n        }),\n        $.get(path + 'properties-group.html', function (data) {\n            views.group = data;\n        }),\n        $.get(path + 'properties-integer.html', function (data) {\n            views.integer = data;\n            views.decimal = data;\n        }),\n        $.get(path + 'properties-location.html', function (data) {\n            views.location = data;\n        }),\n        $.get(path + 'properties-photo.html', function (data) {\n            views.photo = data;\n        }),\n        $.get(path + 'properties-phone.html', function (data) {\n            views.phone = data;\n        }),\n        $.get(path + 'properties-radio.html', function (data) {\n            views.radio = data;\n        }),\n        $.get(path + 'properties-textarea.html', function (data) {\n            views.textarea = data;\n        }),\n        $.get(path + 'properties-readme.html', function (data) {\n            views.readme = data;\n        }),\n        $.get(path + 'properties-text.html', function (data) {\n            views.text = data;\n        }),\n        $.get(path + 'properties-time.html', function (data) {\n            views.time = data;\n        }),\n        $.get(path + 'properties-video.html', function (data) {\n            views.video = data;\n        }),\n        $.get(path + 'properties-searchsingle.html', function (data) {\n            views.searchsingle = data;\n        }),\n        $.get(path + 'properties-searchsingle.html', function (data) {\n            views.searchmultiple = data;\n        })\n    ).then(function () {\n        deferred.resolve(views);\n    });\n    return deferred.promise();\n};\n\nmodule.exports = load_input_properties_views;\n","'use strict';\nvar consts = require('config/consts.js');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\n\nvar get_partials = function () {\n\n    var partials = {};\n    var deferred = new $.Deferred();\n    var path = utils.getPartialsPath();\n\n    $.when(\n        $.get(path + 'nav-tabs.html', function (data) {\n            partials.navtabs = data;\n        }),\n        $.get(path + 'basic-properties.html', function (data) {\n            partials.basic_properties = data;\n        }),\n        $.get(path + 'uniqueness-form-checkbox.html', function (data) {\n            partials.uniqueness_form_checkbox = data;\n        }),\n        $.get(path + 'uniqueness-hierarchy-checkboxes.html', function (data) {\n            partials.uniqueness_hierarchy_checkboxes = data;\n        }),\n        $.get(path + 'uniqueness-branch-checkbox.html', function (data) {\n            partials.uniqueness_branch_checkbox = data;\n        }),\n        $.get(path + 'exit-branchgroup-editing.html', function (data) {\n            partials.exit_branchgroup_editing = data;\n        }),\n        $.get(path + 'basic-media-properties.html', function (data) {\n            partials.basic_media_properties = data;\n        }),\n        $.get(path + 'basic-branch-properties.html', function (data) {\n            partials.basic_branch_properties = data;\n        }),\n        $.get(path + 'basic-group-properties.html', function (data) {\n            partials.basic_group_properties = data;\n        }),\n        $.get(path + 'basic-readme-properties.html', function (data) {\n            partials.basic_readme_properties = data;\n        }),\n        $.get(path + 'possible-answers-wrapper.html', function (data) {\n            partials.possible_answers_wrapper = data;\n        }),\n        $.get(path + 'possible-answer-list-item.html', function (data) {\n            partials.possible_answer_list_item = data;\n        }),\n        $.get(path + 'jumps-wrapper.html', function (data) {\n            partials.jumps_wrapper = data;\n        }),\n        $.get(path + 'jump-list-item.html', function (data) {\n            partials.jump_list_item = data;\n        }),\n        $.get(path + 'jump-list-item-always-jump.html', function (data) {\n            partials.jump_list_item_always_jump = data;\n        }),\n        $.get(path + 'modal-form.html', function (data) {\n            partials.modal_edit_form_name = data;\n        }),\n        $.get(path + 'input-tool.html', function (data) {\n            partials.input_tool = data;\n        })\n    ).then(function () {\n            deferred.resolve(partials);\n        });\n    return deferred.promise();\n};\n\nmodule.exports = get_partials;\n","'use strict';\nvar formbuilder = require('config/formbuilder');\nvar consts = require('config/consts');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\n\nvar load_project = function () {\n\n    var deferred = new $.Deferred();\n\n    utils.setProjectURL();\n\n    console.log(consts.PROJECT_URL);\n\n    //load container views for index.html (main entry point)\n    $.when(\n        $.ajax({\n            url: consts.PROJECT_URL,\n            type: 'GET',\n            //contentType: 'application/vnd.api+json',\n            success: function (data) {\n                formbuilder.project_definition = data;\n               // formbuilder.project_definition = data\n            },\n            error: function(error) {\n                console.log(error);\n                formbuilder.project_definition = JSON.parse(pako.ungzip(window.atob(error.responseText), {'to': 'string'}));\n            }\n        })\n    ).then(function () {\n        deferred.resolve();\n    }).fail(function(){\n        deferred.resolve();\n    });\n    return deferred.promise();\n};\n\nmodule.exports = load_project;\n","'use strict';\nvar consts = require('config/consts');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar formbuilder = require('config/formbuilder');\nvar methods = {};\n\nmethods.replaceCommonAdvancedProperties = require('template/methods/replaceCommonAdvancedProperties');\nmethods.createInputToolHTML = require('template/methods/createInputToolHTML');\nmethods.prepareAdvancedInputPropertiesHTML = require('template/methods/prepareAdvancedInputPropertiesHTML');\nmethods.getJumpTabBtnHTML = require('template/methods/getJumpTabBtnHTML');\nmethods.getAdvancedTabBtnHTML = require('template/methods/getAdvancedTabBtnHTML');\nmethods.createBasicPropertiesHTML = require('template/methods/createBasicPropertiesHTML');\nmethods.getUniquenessHTML = require('template/methods/getUniquenessHTML');\nmethods.getPossibleAnswersHTML = require('template/methods/getPossibleAnswersHTML');\nmethods.getInputPropertiesPanelHTML = require('template/methods/getInputPropertiesPanelHTML');\nmethods.createInputPropertiesHTML = require('template/methods/createInputPropertiesHTML');\nmethods.getJumpsListHTML = require('template/methods/getJumpsListHTML');\n\nvar template = {\n\n    replaceCommonAdvancedProperties: function (the_markup, the_input) {\n        return methods.replaceCommonAdvancedProperties(the_markup, the_input);\n    },\n    createInputToolHTML: function (input) {\n        return methods.createInputToolHTML(input);\n    },\n    prepareAdvancedInputPropertiesHTML: function (view, input) {\n        return methods.prepareAdvancedInputPropertiesHTML(view, input);\n    },\n    getAdvancedTabBtnHTML: function (ref, is_active) {\n        return methods.getAdvancedTabBtnHTML(ref, is_active);\n    },\n    getJumpTabBtnHTML: function (ref, is_active) {\n        return methods.getJumpTabBtnHTML(ref, is_active);\n    },\n    createBasicPropertiesHTML: function (input) {\n        return methods.createBasicPropertiesHTML(input);\n    },\n    getUniquenessHTML: function (input) {\n        return methods.getUniquenessHTML(input);\n    },\n    getPossibleAnswersHTML: function (input) {\n        return methods.getPossibleAnswersHTML(input);\n    },\n    getInputPropertiesPanelHTML: function (input) {\n        return methods.getInputPropertiesPanelHTML(input);\n    },\n    createInputPropertiesHTML: function (input, view) {\n        return methods.createInputPropertiesHTML(input, view);\n    },\n    getJumpsListHTML: function (input) {\n        return methods.getJumpsListHTML(input);\n    }\n};\n\nmodule.exports = template;\n","'use strict';\nvar consts = require('config/consts');\nvar formbuilder = require('config/formbuilder');\nvar utils = require('helpers/utils');\n\nvar createBasicPropertiesHTML = function (input) {\n\n    var html;\n    var partials = formbuilder.dom.partials;\n    var question = input.question;\n    var is_required_checked = (input.is_required) ? 'checked' : '';\n    var is_title_checked = (input.is_title) ? 'checked' : '';\n    var is_branch_edit_disabled = (input.question === '') ? 'disabled' : '';\n    var is_group_edit_disabled = (input.question === '') ? 'disabled' : '';\n    var inputs = formbuilder.project_definition.data.project.forms[formbuilder.current_form_index].inputs;\n    var branch_inputs = [];\n\n    //when editing a branch, check the title limit against the inputs within a branch (even the group inputs)\n    if (formbuilder.is_editing_branch) {\n        branch_inputs = utils.getInputObjectByRef(formbuilder.branch.active_branch_ref).branch;\n    }\n\n    //if the input is NOT media type, get basic properties\n    if (consts.SINGLE_ANSWER_TYPES.indexOf(input.type) !== -1 || consts.MULTIPLE_ANSWER_TYPES.indexOf(input.type) !== -1) {\n\n        //if input is a readme type, get readme property\n        if (input.type === consts.README_TYPE) {\n            html = partials.basic_readme_properties;\n        }\n        else {\n            html = partials.basic_properties;\n\n            html = html.replace('{{required-flag-checked}}', is_required_checked);\n            html = html.replace('{{title-flag-checked}}', is_title_checked);\n\n            //if 3 titles are already set, disable title checkbox and show proper message\n            //if we are editing a branch, check branch inputs for titles\n\n            if (formbuilder.is_editing_branch ? utils.isMaxTitleLimitReached(branch_inputs) : utils.isMaxTitleLimitReached(inputs)) {\n                if (!input.is_title) {\n                    html = html.replace('{{is-title-disabled}}', 'disabled');\n                    html = html.replace(/{{is-checkbox-disabled}}/g, 'disabled-checkbox');\n                    html = html.replace('{{checkbox-title-label}}', consts.MAX_TITLE_LIMIT_REACHED);\n                }\n                else {\n                    html = html.replace('{{is-title-disabled}}', '');\n                    html = html.replace(/{{is-checkbox-disabled}}/g, '');\n                    html = html.replace('{{checkbox-title-label}}', consts.USE_ANSWER_AS_TITLE);\n                }\n            }\n            else {\n                html = html.replace('{{is-title-disabled}}', '');\n                html = html.replace(/{{is-checkbox-disabled}}/g, '');\n                html = html.replace('{{checkbox-title-label}}', consts.USE_ANSWER_AS_TITLE);\n            }\n        }\n    }\n\n    //if input is a media type, get media properties\n    if (consts.MEDIA_ANSWER_TYPES.indexOf(input.type) !== -1) {\n        html = partials.basic_media_properties;\n    }\n\n    //is a branch? check the edit button status\n    if (input.type === consts.BRANCH_TYPE) {\n        html = partials.basic_branch_properties;\n        html = html.replace('{{branch-edit-disabled}}', is_branch_edit_disabled);\n    }\n\n    //is a group? check the edit button status\n    if (input.type === consts.GROUP_TYPE) {\n        html = partials.basic_group_properties;\n        html = html.replace('{{group-edit-disabled}}', is_group_edit_disabled);\n    }\n\n    html = html.replace(/{{input-ref-question}}/g, input.ref + '-question');\n    html = html.replace('{{basic-input-ref}}', 'basic-' + input.ref);\n    html = html.replace('{{input-question-value}}', question);\n\n    return html;\n};\n\nmodule.exports = createBasicPropertiesHTML;\n","'use strict';\nvar formbuilder = require('config/formbuilder');\nvar consts = require('config/consts');\nvar utils = require('helpers/utils');\n\nvar createInputPropertiesHTML = function (the_input, the_view) {\n\n    var self = this;\n    var html = the_view;\n    var input = the_input;\n    var partials = formbuilder.dom.partials;\n    var is_media_type = consts.MEDIA_ANSWER_TYPES.indexOf(input.type) !== -1;\n    var nav_tabs = partials.navtabs;\n    var advanced_tab_btn;\n    var jump_tab_button;\n    var properties;\n    var jumps_html;\n    var jump_list_html;\n\n    html = html.replace('{{input-ref}}', input.ref);\n    html = html.replace('{{advanced-input-ref}}', 'advanced-' + input.ref);\n\n    //get navtabs html\n    nav_tabs = nav_tabs.replace('{{#basic-input-ref}}', '#basic-' + input.ref);\n\n    //for media inputs, branch and groups, readme, get disabled 'Advanced tab' button\n    if (is_media_type || input.type === consts.BRANCH_TYPE || input.type === consts.GROUP_TYPE || input.type === consts.README_TYPE) {\n        advanced_tab_btn = self.getAdvancedTabBtnHTML(input.ref, false);\n    }\n    else {\n        //get enable advanced tab button\n        advanced_tab_btn = self.getAdvancedTabBtnHTML(input.ref, true);\n    }\n\n    nav_tabs = nav_tabs.replace('{{advanced-tab-btn}}', advanced_tab_btn);\n\n    //for inputs NESTED within a group, disable jumps tab, as we cannot have jumps in groups\n    if (formbuilder.is_editing_group) {\n        jump_tab_button = self.getJumpTabBtnHTML(input.ref, false);\n    }\n    else {\n        jump_tab_button = self.getJumpTabBtnHTML(input.ref, true);\n    }\n\n    nav_tabs = nav_tabs.replace('{{jumps-tab-btn}}', jump_tab_button);\n\n    html = html.replace('{{nav-tabs}}', nav_tabs);\n\n    //get properties html\n    properties = self.createBasicPropertiesHTML(input);\n    html = html.replace('{{properties}}', properties);\n\n    //get jumps html\n    jumps_html = partials.jumps_wrapper;\n    jumps_html = jumps_html.replace('{{jumps-input-ref}}', 'jumps-' + input.ref);\n\n    //build jump list html\n    if (input.jumps.length > 0) {\n        //get list of jumps markup\n        jump_list_html = self.getJumpsListHTML(input);\n        jumps_html = jumps_html.replace('{{no-jumps_message-hidden}}', 'hidden');\n\n        jumps_html = jumps_html.replace('{{jumps-list}}', jump_list_html);\n\n        //if we reached the max number of jumps or this input does not allow multiple jumps, disable button\n        if (consts.MULTIPLE_ANSWER_TYPES.indexOf(input.type) > -1) {\n            //multiple answer input, disable add jump if the maximum number of jumps for the input is reached\n            // or exceeded, the latter because we had a bug.\n            if (input.jumps.length >= input.possible_answers.length) {\n                jumps_html = jumps_html.replace('{{add-jump-btn-state}}', 'disabled');\n            }\n            else {\n                jumps_html = jumps_html.replace('{{add-jump-btn-state}}', '');\n            }\n        }\n        else {\n            //single answer input\n            jumps_html = jumps_html.replace('{{add-jump-btn-state}}', 'disabled');\n        }\n    }\n    else {\n        //no jumps list to render\n        jumps_html = jumps_html.replace('{{jumps-list}}', '');\n        jumps_html = jumps_html.replace('{{add-jump-btn-state}}', '');\n        jumps_html = jumps_html.replace('{{no-jumps_message-hidden}}', '');\n    }\n\n    html = html.replace('{{jumps}}', jumps_html);\n\n    //disable \"Add Jump\" button if the max number of jumps is reached\n    if (consts.MULTIPLE_ANSWER_TYPES.indexOf(input.type) !== -1) {\n        //multiple jumps allowed, check if limit met (number of jumps must be less or equal to possible answers)\n        if (input.jumps.length >= input.possible_answers.length) {\n            html = html.replace('{{add-jump-btn-state}}', 'disabled=\"disabled\"');\n        }\n        else {\n            html = html.replace('{{add-jump-btn-state}}', '');\n        }\n    }\n    else {\n        //single jump allowed, enable add jump button\n        html = html.replace('{{add-jump-btn-state}}', '');\n    }\n\n    //if multiple choice input type, append possible answer wrapper\n    if (consts.MULTIPLE_ANSWER_TYPES.indexOf(input.type) !== -1) {\n\n        html = html.replace('{{possible-answers}}', self.getPossibleAnswersHTML(input));\n    }\n    else {\n        html = html.replace('{{possible-answers}}', '');\n    }\n\n    //check if input allows uniqueness\n    if (consts.UNIQUENESS_ALLOWED_TYPES.indexOf(input.type) !== -1) {\n        html = html.replace('{{uniqueness}}', self.getUniquenessHTML(input));\n    }\n    return html;\n};\n\nmodule.exports = createInputPropertiesHTML;\n\n\n","'use strict';\nvar utils = require('helpers/utils');\nvar consts = require('config/consts');\nvar messages = require('config/messages');\n\nvar createInputToolHTML = function (input) {\n\n    var html = '';\n    var icon = utils.getInputToolIcon(input.type);\n    var is_input_branch = (input.type === consts.BRANCH_TYPE) ? 'input-branch' : '';\n    var is_input_group = (input.type === consts.GROUP_TYPE) ? 'input-group' : '';\n    var question = input.question === '' ? messages.error.NO_QUESTION_TEXT_YET : input.question;\n    var invisible_class = input.jumps.length > 0 ? '' : 'invisible';\n\n    //convert html entities to tags and strip html tags from readme type if any\n    if (input.type === consts.README_TYPE) {\n        question = utils.decodeHtml(input.question);\n        question = question.replace(/(<([^>]+)>)/ig, ' ');\n    }\n\n    html += '<div class=\"input ' + is_input_branch + is_input_group + ' ui-draggable ui-draggable-handle\" ';\n    html += 'data-type=\"' + input.type + '\" data-input-ref=\"' + input.ref + '\">';\n    html += '<div class=\"input-inner\">';\n    html += '<i class=\"fa fa-2x fa-fw ' + icon + '\"></i>';\n    html += '<span class=\"question-preview\">' + question.trunc(consts.LIMITS.question_preview_length) + '</span>';\n    html += '<i class=\"question-state fa fa-check fa-2x fa-fw pull-right\"></i>';\n    html += '<i class=\"jump-state fa fa-arrow-circle-o-down fa-2x fa-fw pull-right ' + invisible_class + '\"></i>';\n\n    if (input.type === consts.BRANCH_TYPE) {\n        html += '{{branch-content}}';\n    }\n    if (input.type === consts.GROUP_TYPE) {\n        html += '{{group-content}}';\n    }\n    html += '</div>';\n    html += '</div>';\n\n    return html;\n};\n\nmodule.exports = createInputToolHTML;\n","'use strict';\n\nvar getAdvancedTabBtnHTML = function (ref, is_active) {\n\n    var html = '';\n\n    if (is_active) {\n        html += '<li role=\"presentation\" class=\"nav-tabs__tab-btn-item advanced-tab\">';\n        html += '<a href=\"#advanced-' + ref + '\" role=\"tab\" data-toggle=\"tab\"> Advanced&nbsp;';\n        html += '<i class=\"fa fa-exclamation fa-2x invisible advanced-error\"></i>';\n        html += '</a>';\n        html += '</li>';\n    }\n    else {\n\n        html += '<li role=\"presentation\" class=\"disabled disabled-tab nav-tabs__tab-btn-item\">';\n        html += '<a href=\"#\" role=\"tab\" > Advanced&nbsp;';\n        html += '<i class=\"fa fa-exclamation fa-2x  invisible advanced-error\"></i>';\n        html += '</a>';\n        html += '</li>';\n    }\n    return html;\n};\n\nmodule.exports = getAdvancedTabBtnHTML;\n","'use strict';\nvar consts = require('config/consts');\nvar formbuilder = require('config/formbuilder');\n\nvar getInputPropertiesPanelHTML = function (the_input) {\n\n    //todo use the function here http://jsfiddle.net/jfriend00/DyCwk/\n    var self = this;\n    var input = the_input;\n    var is_media_type = consts.MEDIA_ANSWER_TYPES.indexOf(input.type) !== -1;\n    var html = formbuilder.dom.input_properties_views[input.type];\n\n    //get dynamic html for input properties panel\n    html = self.createInputPropertiesHTML(input, html);\n\n    //prepare advanced properties (NOT for branch or groups or media types)\n    if (input.type !== consts.BRANCH_TYPE || input.type !== consts.GROUP_TYPE || !is_media_type) {\n        //manipulate dom for advanced options, which are unique (most of the time) to the input type\n        html = self.prepareAdvancedInputPropertiesHTML(html, input);\n    }\n\n    return html;\n\n};\n\nmodule.exports = getInputPropertiesPanelHTML;\n","'use strict';\n\nvar getJumpTabBtnHTML =  function (ref, is_active) {\n\n    var html = '';\n\n    if (is_active) {\n\n        html += '<li role=\"presentation\" class=\"jump-tab nav-tabs__tab-btn-item\">';\n        html += '<a href=\"#jumps-' + ref + '\" role=\"tab\" data-toggle=\"tab\" > Jumps&nbsp;';\n        html += '<i class=\"fa fa-exclamation fa-2x invisible jumps-error\"></i>';\n        html += '</a>';\n        html += '</li>';\n\n    }\n    else {\n\n        html += '<li role=\"presentation\" class=\"jump-tab disabled disabled-tab nav-tabs__tab-btn-item\">';\n        html += '<a href=\"#\" class=\"nav-tabs__jump\" role=\"tab\" > Jumps&nbsp;';\n        html += '<i class=\"fa fa-exclamation fa-2x invisible jumps-error\"></i>';\n        html += '</a>';\n        html += '</li>';\n    }\n    return html;\n};\n\nmodule.exports = getJumpTabBtnHTML;\n","/*jshint expr:true */\n'use strict';\nvar formbuilder = require('config/formbuilder');\nvar consts = require('config/consts');\nvar utils = require('helpers/utils');\n\nfunction _getSelectedJumpAnswerHTML(possible_answer) {\n    return '<option value=\"' + possible_answer.answer_ref + '\" selected=\"selected\">' + possible_answer.answer + '</option>';\n}\n\nfunction _getSelectedJumpConditionHTML(jump) {\n\n    var text = '';\n\n    $(consts.JUMP_CONDITIONS).each(function (index, condition) {\n        if (condition.key === jump.when) {\n            text = condition.text;\n            return false;\n        }\n    });\n    return '<option value=\"' + jump.when + '\" selected=\"selected\">' + text + '</option>';\n}\n\nfunction _getSelectedJumpDestinationHTML(destination_input) {\n    return '<option value=\"' + destination_input.ref + '\" selected=\"selected\">' + destination_input.question + '</option>';\n}\n\nvar getJumpsListHTML = function (input) {\n\n    var html = '';\n    var inputs = [];\n    var selected_condition_html;\n    var selected_possible_answer_html;\n\n    //get input list (hierarchy or branch)\n    var parts = input.ref.split('_');\n    if (parts.length > 3) {\n        //this is a branch ref\n        parts.pop();\n        inputs = utils.getInputObjectByRef(parts.join('_')).branch;\n    }\n    else {\n        inputs = formbuilder.project_definition.data.project.forms[formbuilder.current_form_index].inputs;\n    }\n    //jump destinations: cannot jump on the next one, but always next + 1\n    var jump_destinations = utils.getJumpAvailableDestinations(input, inputs);\n\n    $(input.jumps).each(function (index, jump) {\n\n        /****************************************************************************************************\n         * set `when option`\n         */\n        if (consts.MULTIPLE_ANSWER_TYPES.indexOf(input.type) === -1) {\n            //append a jump with condition disabled and set to 'always' jump\n            //we do this because on EC5 when the question is an open answer, a jump will always jump no matter the answer given\n            html += formbuilder.dom.partials.jump_list_item_always_jump;\n        }\n        else {\n            //jumps get full functionality with multiple answers input types\n            html += formbuilder.dom.partials.jump_list_item;\n\n            selected_condition_html = _getSelectedJumpConditionHTML(jump);\n            html = html.replace('{{logic-when-saved-option}}', selected_condition_html);\n\n            /****************************************************************************************************\n             *  set selected `answer`\n             */\n            $(input.possible_answers).each(function (index, possible_answer) {\n                if (possible_answer.answer_ref === jump.answer_ref) {\n                    selected_possible_answer_html = _getSelectedJumpAnswerHTML(possible_answer);\n                }\n            });\n            html = html.replace('{{logic-answer-saved-option}}', selected_possible_answer_html);\n            /***************************************************************************************************/\n\n        }\n        /****************************************************************************************************\n         *  set selected `goto`\n         */\n        var selected_goto_html = '';\n        if (jump.to === 'END') {\n            selected_goto_html = _getSelectedJumpDestinationHTML({ ref: 'END', question: 'End of form' });\n        }\n        else {\n            $(jump_destinations).each(function (index, jump_destination) {\n                if (jump_destination.ref === jump.to) {\n                    selected_goto_html = _getSelectedJumpDestinationHTML(jump_destination);\n                    return false;\n                }\n            });\n        }\n\n        html = html.replace('{{logic-goto-saved-option}}', selected_goto_html);\n        /***************************************************************************************************/\n\n        html = html.replace(/{{input-ref-logic-when}}/g, index + '-' + input.ref + '-logic-when');\n        html = html.replace(/{{input-ref-logic-goto}}/g, index + '-' + input.ref + '-logic-goto');\n        html = html.replace(/{{input-ref-logic-answer}}/g, index + '-' + input.ref + '-logic-answer');\n\n    });\n\n\n    return html;\n};\n\nmodule.exports = getJumpsListHTML;\n","'use strict';\nvar formbuilder = require('config/formbuilder');\nvar consts = require('config/consts');\nvar getPossibleAnswersList = require('template/methods/getPossibleAnswersList');\n\n//generate list of possible answers and inject it into its wrapper, then return it\nvar getPossibleAnswersHTML = function (the_input) {\n\n    var input = the_input;\n    var wrapper = formbuilder.dom.partials.possible_answers_wrapper;\n    var list = getPossibleAnswersList(input.possible_answers);\n\n    wrapper = wrapper.replace('{{possible-answers-list}}', list);\n\n    //toggle \"add answers\" button\n    if (input.possible_answers.length >= consts.LIMITS.possible_answers_max) {\n        //is it a search type? limit is higher for search type\n        if(input.type === consts.SEARCH_SINGLE_TYPE || input.type === consts.SEARCH_MULTIPLE_TYPE) {\n            if (input.possible_answers.length >= consts.LIMITS.possible_answers_max_search) {\n                wrapper = wrapper.replace('{{disabled}}', 'disabled');\n            }\n            else {\n                wrapper = wrapper.replace('{{disabled}}', '');\n            }\n        }\n        else {\n            wrapper = wrapper.replace('{{disabled}}', 'disabled');\n        }\n    }\n    else {\n        wrapper = wrapper.replace('{{disabled}}', '');\n    }\n\n    return wrapper;\n};\n\nmodule.exports = getPossibleAnswersHTML;\n","'use strict';\nvar formbuilder = require('config/formbuilder');\nvar consts = require('config/consts');\n\n//generate list of possible answers and return html\nvar getPossibleAnswersList = function (possible_answers) {\n\n    var list = '';\n    var list_item = '';\n\n    //generate markup for first possible answers page\n    $(possible_answers).each(function (index, possible_answer) {\n\n        if (index === consts.LIMITS.possible_answers_per_page) {\n            return false;\n        }\n\n        list_item = formbuilder.dom.partials.possible_answer_list_item;\n        list_item = list_item.replace('{{answer-ref}}', possible_answer.answer_ref);\n        list_item = list_item.replace('{{answer}}', possible_answer.answer);\n\n        if (index === 0 && possible_answers.length === 1) {\n            list_item = list_item.replace('{{disabled}}', 'disabled');\n        }\n        else {\n            list_item = list_item.replace('{{disabled}}', '');\n        }\n        list += list_item;\n    });\n\n    return list;\n};\n\nmodule.exports = getPossibleAnswersList;\n","'use strict';\nvar formbuilder = require('config/formbuilder');\nvar utils = require('helpers/utils');\nvar consts = require('config/consts');\n\n//generate list of possible answers and inject it into its wrapper, then return it\nvar getPossibleAnswersPage = function (the_input, the_page) {\n\n    var input = the_input;\n    var current_page = the_page;\n    var list_item = '';\n    var list = '';\n    var properties_panel = formbuilder.dom.input_properties_forms_wrapper.find('form[data-input-ref=\"' + input.ref + '\"]');\n    var possible_answers_wrapper = properties_panel.find('.input-properties__form__possible-answers div ul.input-properties__form__possible-answers__list');\n    var from_index = (current_page - 1) * consts.LIMITS.possible_answers_per_page;\n    var to_index = current_page * consts.LIMITS.possible_answers_per_page;\n\n    //remove possible aswers from dom\n    possible_answers_wrapper.find('li').remove();\n\n    //get next possible answers\n    var possible_answers =  input.possible_answers.slice(from_index, to_index);\n\n    $(possible_answers).each(function (index, possible_answer) {\n\n        //replace double quotes with html entities\n        possible_answer.answer = possible_answer.answer.replace(/\"/gi, '&quot;');\n\n        list_item = formbuilder.dom.partials.possible_answer_list_item;\n        list_item = list_item.replace('{{answer-ref}}', possible_answer.answer_ref);\n        list_item = list_item.replace('{{answer}}', possible_answer.answer);\n\n        if (index === 0 && input.possible_answers.length === 1) {\n            list_item = list_item.replace('{{disabled}}', 'disabled');\n        }\n        else {\n            list_item = list_item.replace('{{disabled}}', '');\n        }\n        list += list_item;\n\n        //if the possible answer is invalid, add error in the dom\n        if(possible_answer.answer === '') {\n            //todo\n\n        }\n    });\n\n    //append new page to dom\n    possible_answers_wrapper.hide().html(list).fadeIn(consts.ANIMATION_SLOW);\n};\n\nmodule.exports = getPossibleAnswersPage;\n","'use strict';\nvar formbuilder = require('config/formbuilder');\nvar consts = require('config/consts');\n\nvar getUniquenessHTML = function (the_input) {\n\n    var html = '';\n    var input = the_input;\n    var form_index = formbuilder.current_form_index;\n    var current_form_name = formbuilder.project_definition.data.project.forms[form_index].name;\n    var partials = formbuilder.dom.partials;\n    var parent_form_name;\n    var is_uniqueness_form_checked;\n    var is_uniqueness_hierarchy_checked;\n\n    function getStandardUniquessMarkup(markup) {\n\n        markup = partials.uniqueness_hierarchy_checkboxes;\n        parent_form_name = formbuilder.project_definition.data.project.forms[form_index - 1].name;\n        markup = markup.replace(/{{parent-form-name}}/g, parent_form_name);\n        markup = markup.replace('{{input-ref-uniqueness-hierarchy}}', input.ref + '-uniqueness-hierarchy');\n\n        is_uniqueness_hierarchy_checked = (input.uniqueness === consts.UNIQUESS_HIERARCHY) ? 'checked' : '';\n        markup = markup.replace('{{input-ref-uniqueness-hierarchy-checked}}', is_uniqueness_hierarchy_checked);\n\n        return markup;\n    }\n\n    function getBranchUniquenessMarkup(markup) {\n        //branch uniquess is within for all the '{branch header}' entries for a branch question within a single entry ('form')\n        markup = partials.uniqueness_branch_checkbox;\n        markup = markup.replace('{{branch-header}}', formbuilder.branch.active_branch_header);\n\n        return markup;\n    }\n\n    //add uniqueness constraint based on form hierarchy\n    if (form_index > 0) {\n        //child forms, user cn select form or hierarchy uniqueness\n        if (formbuilder.is_editing_branch) {\n            //if (formbuilder.is_editing_group) {\n            //    //nested group gets standard uniqueness\n            //    html = getStandardUniquessMarkup(html);\n            //}\n            //  else {\n            //branches get its own uniqueness\n            html = getBranchUniquenessMarkup(html);\n            //  }\n        }\n        else {\n            //standard uniqueness\n            html = getStandardUniquessMarkup(html);\n        }\n    }\n\n    else {\n        //standard uniqueness, top parent form inputscan be set to form uniqueness only\n        if (!formbuilder.is_editing_branch) {\n            html = partials.uniqueness_form_checkbox;\n        }\n        else {\n            //branches get its own uniqueness\n            //if (formbuilder.is_editing_group) {\n            //    //group gets standard uniqueness\n            //    html = partials.uniqueness_form_checkbox;\n            //}\n            //else {\n            //branch uniquess is within for all the branches within a single entry ('form')\n            html = getBranchUniquenessMarkup(html);\n            // }\n        }\n    }\n\n    //common markup\n    html = html.replace('{{input-ref-uniqueness-form}}', input.ref + '-uniqueness-form');\n    is_uniqueness_form_checked = (input.uniqueness === consts.UNIQUESS_FORM) ? 'checked' : '';\n    html = html.replace('{{input-ref-uniqueness-form-checked}}', is_uniqueness_form_checked);\n    html = html.replace(/{{form-name}}/g, current_form_name);\n\n    return html;\n};\n\nmodule.exports = getUniquenessHTML;\n","'use strict';\nvar consts = require('config/consts');\nvar utils = require('helpers/utils');\n\nvar prepareAdvancedInputPropertiesHTML = function (view, input) {\n\n    var html = view;\n    var ref = input.ref;\n    var type = input.type;\n    var datetime_format = {\n        is_checked_datetime_format_1: '',//set first format as default\n        is_checked_datetime_format_2: '',\n        is_checked_datetime_format_3: '',\n        is_checked_datetime_format_4: '',\n        is_checked_datetime_format_5: ''\n    };\n\n    var is_integer_checked;\n    var is_decimal_checked;\n    var is_search_single_checked;\n    var is_search_multiple_checked;\n\n    function _replaceDatetimeAdvancedProperties(type) {\n\n        var i;\n        var iLength = 6;\n\n        //if it is a new input, set datatime format to default\n        if (input.datetime_format === null) {\n            input.datetime_format = consts[type.toUpperCase() + '_FORMAT_1'];\n        }\n\n        //set datetime format to the one saved\n        for (i = 1; i < iLength; i++) {\n            datetime_format['is_checked_datetime_format_' + i] = input.datetime_format === consts[type.toUpperCase() + '_FORMAT_' + i] ? 'checked' : '';\n            html = html.replace('{{is-checked-datetime-format-' + i + '}}', datetime_format['is_checked_datetime_format_' + i]);\n        }\n        html = html.replace('{{input-ref-default-to-current}}', ref + '-default-to-current');\n        html = html.replace('{{set-to-current-datetime}}', set_to_current_datetime);\n    }\n\n    function _replaceNumericAdvancedProperties(type) {\n\n        is_integer_checked = 'checked';\n        is_decimal_checked = '';\n\n        if (type === consts.DECIMAL_TYPE) {\n            is_integer_checked = '';\n            is_decimal_checked = 'checked';\n        }\n\n        html = html.replace('{{is-integer-checked}}', is_integer_checked);\n        html = html.replace('{{is-decimal-checked}}', is_decimal_checked);\n        html = html.replace('{{input-ref-min-value}}', input.min);\n        html = html.replace('{{input-ref-max-value}}', input.max);\n        html = html.replace(/{{input-ref-integer}}/g, ref + '-integer');\n        html = html.replace(/{{input-ref-decimal}}/g, ref + '-decimal');\n        html = html.replace(/{{input-ref-min}}/g, ref + '-min');\n        html = html.replace(/{{input-ref-max}}/g, ref + '-max');\n\n    }\n\n    function _replaceSearchAdvancedProperties(type) {\n\n        is_search_single_checked = 'checked';\n        is_search_multiple_checked = '';\n\n        if (type === consts.SEARCH_MULTIPLE_TYPE) {\n            is_search_single_checked = '';\n            is_search_multiple_checked = 'checked';\n        }\n\n        html = html.replace('{{is-searchsingle-checked}}', is_search_single_checked);\n        html = html.replace('{{is-searchmultiple-checked}}', is_search_multiple_checked);\n\n\n    }\n\n    function _getInitialAnswerHTML(input, the_html) {\n\n        var html = the_html;\n        var answer_label = '';\n\n        html = html.replace(/{{input-ref-default}}/g, input.ref + '-default');\n\n        if (input.default === '' || input.default === null) {\n            //no, set 'none'\n            html = html.replace(/{{selected}}/g, 'selected');\n            html = html.replace(/{{initial-answer}}/g, '');\n        }\n        else {\n\n            //get possible answer label\n            answer_label = utils.getPossibleAnswerLabel(input);\n\n            html = html.replace(/{{selected}}/g, '');\n            html = html.replace(/{{initial-answer}}/g, '<option value=\"' + input.default + '\"  selected >' + answer_label + '</option>');\n        }\n        return html;\n    }\n\n    var set_to_current_datetime = (input.set_to_current_datetime) ? 'checked' : '';\n\n    switch (type) {\n\n        case consts.DROPDOWN_TYPE:\n            //set initial answer\n            html = _getInitialAnswerHTML(input, html);\n            break;\n        case consts.RADIO_TYPE:\n            //set initial answer\n            html = _getInitialAnswerHTML(input, html);\n            break;\n        case consts.CHECKBOX_TYPE:\n            //set initial answer\n            html = _getInitialAnswerHTML(input, html);\n            break;\n        case consts.INTEGER_TYPE:\n            html = this.replaceCommonAdvancedProperties(html, input);\n            _replaceNumericAdvancedProperties(type);\n            break;\n        case consts.DECIMAL_TYPE:\n            html = this.replaceCommonAdvancedProperties(html, input);\n            _replaceNumericAdvancedProperties(type);\n            break;\n        case consts.DATE_TYPE:\n            _replaceDatetimeAdvancedProperties(consts.DATE_TYPE);\n            break;\n        case consts.TIME_TYPE:\n            _replaceDatetimeAdvancedProperties(consts.TIME_TYPE);\n            break;\n        case consts.SEARCH_SINGLE_TYPE:\n            _replaceSearchAdvancedProperties(consts.SEARCH_SINGLE_TYPE);\n            //set initial answer\n            html = _getInitialAnswerHTML(input, html);\n            break;\n        case consts.SEARCH_MULTIPLE_TYPE:\n            _replaceSearchAdvancedProperties(consts.SEARCH_MULTIPLE_TYPE);\n            //set initial answer\n            html = _getInitialAnswerHTML(input, html);\n            break;\n        default:\n            html = this.replaceCommonAdvancedProperties(html, input);\n\n    }\n    return html;\n};\n\nmodule.exports = prepareAdvancedInputPropertiesHTML;\n","'use strict';\n\nvar replaceCommonAdvancedProperties = function (the_markup, the_input) {\n\n    var html = the_markup;\n    var input = the_input;\n\n    var replacements = [\n        {\n            to_be_replaced: /{{input-ref-default}}/g,\n            with_this: input.ref + '-default'\n        },\n        {\n            to_be_replaced: /{{input-ref-regex}}/g,\n            with_this: input.ref + '-regex'\n        },\n        {\n            to_be_replaced: /{{input-ref-double-entry}}/g,\n            with_this: input.ref + '-double-entry'\n        },\n        {\n            to_be_replaced: '{{input-ref-default-value}}',\n            with_this: (input.default === null) ? '' : input.default\n        },\n        {\n            to_be_replaced: '{{input-ref-regex-value}}',\n            with_this: (input.regex === null) ? '' : input.regex\n        },\n        {\n            to_be_replaced: '{{input-ref-double-entry-checked}}',\n            with_this: input.verify ? 'checked' : ''\n        }\n    ];\n\n    //replace placeholder with values from input\n    $(replacements).each(function (index, replacement) {\n        html = html.replace(replacement.to_be_replaced, replacement.with_this);\n    });\n\n    return html;\n};\n\nmodule.exports = replaceCommonAdvancedProperties;\n\n","'use strict';\nvar formbuilder = require('config/formbuilder');\nvar messages = require('config/messages');\nvar validation = require('actions/validation');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar consts = require('config/consts');\nvar template = require('template');\nvar toast = require('config/toast');\nvar possibleAnswersSortable = require('ui-handlers/possible-answers-sortable');\n\nvar branch_sortable = function () {\n\n    var branch_input;\n\n    return {\n        cursor: 'move',\n        items: '.input',\n        revert: 100,\n        //axis: 'y',// it causes the placeholder to be always active\n        containment: 'parent',\n        tolerance: 'pointer',\n        // forcePlaceholderSize: true,\n        placeholder: 'input-collection-drop-placeholder',\n\n        //triggered when a new input is dropped over the sortable\n        receive: function (e, jquery_ui) {\n\n            var form_index = formbuilder.current_form_index;\n            var previous_branch_input_ref = formbuilder.branch.current_input_ref;\n            var current_element;\n            var branch_inputs = utils.getInputObjectByRef(formbuilder.current_input_ref).branch;\n            var branch_input_ref = utils.generateBranchGroupInputRef(formbuilder.current_input_ref);\n            var branch_input_index = branch_inputs.length;\n            var branch_input_type = jquery_ui.item.attr('data-type');\n            var input_factory = require('factory/input-factory');\n\n            //do not consider branch inputs within a branch\n            if (branch_input_type === consts.BRANCH_TYPE) {\n                return false;\n            }\n            else {\n\n                formbuilder.branch.current_input_ref = branch_input_ref;\n\n                //validate previous input (if any) to show embedded errors (in case the ser did not press validate button)\n                //todo is this an overkill?\n                if (previous_branch_input_ref) {\n                    validation.performValidation(utils.getBranchInputObjectByRef(previous_branch_input_ref), false);\n                }\n\n              //  console.log('branch sortable receive');\n\n                formbuilder.branch.collection_is_being_sorted = false;\n\n                //generate input object based on type and set index incrementally\n                branch_input = input_factory.createInput(branch_input_type, branch_input_ref);\n                //formbuilder.current_input_ref = input.ref;\n             //   console.log(branch_input);\n\n                //disable current active element\n                current_element = formbuilder.dom.inputs_collection_sortable.find('.active');\n                current_element.removeClass('active');\n\n                //add input to collection as the last one\n                branch_inputs.push(branch_input);\n                //console.log(branch_inputs);\n                //console.log(formbuilder.project_definition.data.project.forms[form_index].inputs);\n            }\n\n            //disable save project button as by default an input is invalid when it is created\n            ui.navbar.toggleSaveProjectBtn(consts.BTN_DISABLED);\n\n            //set form tab as invalid, as the new input will be invalid by default\n            ui.forms_tabs.showFormInvalidIcon(formbuilder.current_form_index);\n        },\n        stop: function (e, jquery_ui) {\n\n            var undo = require('actions/undo');\n            var form_index = formbuilder.current_form_index;\n            var branch_input_ref = formbuilder.branch.current_input_ref;\n            var owner_input_ref = formbuilder.current_input_ref;\n            var owner_input_index = utils.getInputCurrentIndexByRef(owner_input_ref);\n            var inputs = formbuilder.project_definition.data.project.forms[form_index].inputs;\n            var branch_inputs = inputs[owner_input_index].branch;\n            var placeholder_text = messages.error.NO_QUESTION_TEXT_YET;\n            var input_type = jquery_ui.item.attr('data-type');\n            var active_branch;\n            var properties_panel_html;\n\n            //disable draggable if we hit the max amount of inputs allowed\n            if (utils.getInputsTotal(inputs) >= consts.INPUTS_MAX_ALLOWED) {\n                ui.input_tools.disable();\n            }\n\n            //reject branch inputs here\n            if (input_type === consts.BRANCH_TYPE) {\n                jquery_ui.item.remove();\n\n                //if branch inputs length is zero, show help text placeholder\n                //todo\n            }\n            else {\n\n                //count search inputs\n                if(input_type === consts.SEARCH_SINGLE_TYPE && !formbuilder.branch.collection_is_being_sorted) {\n                    //if the limit is reached, hide search from input tools\n                    if (utils.getSearchInputsTotal() >= consts.LIMITS.search_inputs_max) {\n                        ui.input_tools.hideSearchInput();\n                        console.log('search limit reached');\n\n                        //show warning to user\n                        toast.showWarning(messages.warning.SEARCH_INPUTS_LIMIT_REACHED + '(' + consts.LIMITS.search_inputs_max + ')');\n                    }\n                }\n\n            //    console.log('sortable stop');\n                jquery_ui.item.removeAttr('style'); // undo styling set by jqueryUI (http://goo.gl/EKz8tC)\n\n                //get the index where the input was dropped (skip when list is empty)\n                //nb the -2 is to remove the element which are no input (warning messages)\n                formbuilder.branch.to_index = jquery_ui.item.index() === 0 ? jquery_ui.item.index() : jquery_ui.item.index() - 2;\n\n                //hide message about no input selected, as dropped input gets focus\n                formbuilder.dom.input_properties_no_input_selected.hide();\n\n                /*\n                 if the user is dragging a new input over, it was added as the last element of the array\n                 otherwise the current input position is set in the start event\n                 */\n                if (!formbuilder.branch.collection_is_being_sorted) {\n\n                    //override 'from_index' as we are dropping a new element (min value for length is 1, as we add the input in the `receive` function)\n                    formbuilder.branch.from_index = branch_inputs.length - 1;\n\n                    //move inputs to keep the array sequence like the input sequence on screen\n                    branch_inputs.move(formbuilder.branch.from_index, formbuilder.branch.to_index);\n                    //console.log(branch_inputs);\n                    //console.log(branch_inputs.length);\n\n                    jquery_ui.item.addClass('active');\n                    jquery_ui.item.attr('data-input-ref', branch_input_ref);\n\n                    //append input id and a warning icon, as by default the question does not have any text\n                    jquery_ui.item.find('.input-inner').append(ui.inputs_collection.getInputStateIconsHTML());\n                    jquery_ui.item.find('span.question-preview').text(placeholder_text);\n\n                    //set owner branch as invalid as we are adding an invalid input\n                    active_branch = utils.getInputObjectByRef(formbuilder.branch.active_branch_ref);\n                    ui.inputs_collection.showInputInvalidIcon(active_branch.ref);\n\n                    //show input properties for the new dropped input\n                    formbuilder.dom.input_properties.find('.panel-body form').hide();\n                    formbuilder.dom.input_properties.find('.panel-title span').text(placeholder_text);\n\n                    //create properties panel in right sidebar for this input (common properties)\n                    properties_panel_html = template.getInputPropertiesPanelHTML(branch_input);\n\n                    //append input and show it as it gets selected by default\n                    formbuilder.dom.input_properties_forms_wrapper.hide();\n                    $(properties_panel_html).removeClass('hidden').appendTo(formbuilder.dom.input_properties_forms_wrapper);\n                    formbuilder.dom.input_properties_forms_wrapper.fadeIn(consts.ANIMATION_FAST);\n\n\n                    //show action buttons for input\n                    formbuilder.dom.input_properties_buttons.fadeIn(consts.ANIMATION_FAST);\n\n                    //for nested group, enable keyup to check for validation of header text\n                    //triggered when users type in the header input field for nested group\n                    //todo check this\n                    if (branch_input.type === consts.GROUP_TYPE) {\n                        //formbuilder.dom.input_properties.off('keyup').on('keyup', 'input', input_properties_keyup_callback);\n                    }\n                    else {\n                        //formbuilder.dom.input_properties.off('keyup');\n                    }\n\n                    //enable sortable on current input (only when first created)\n                    possibleAnswersSortable(branch_input);\n                }\n                else {\n\n                    //'from_index is set in start event of sortable'\n                    //move branch inputs to keep the array sequence like the input sequence on screen\n                    branch_inputs.move(formbuilder.branch.from_index, formbuilder.branch.to_index);\n                    //console.log(branch_inputs);\n\n                    //run the validation on all branch jumps, as we might have some invalid destinations after re-ordering\n                    //I am forced to do this against all the branch inputs\n                    validation.validateJumpsAfterSorting(branch_inputs);\n\n                    jquery_ui.item.addClass('active');\n                }\n            }\n\n            //todo test this thing\n            //add this state for undoing, so it is easier to rebind everything\n            formbuilder.render_action = consts.RENDER_ACTION_DO;\n            undo.pushState();\n\n            if (input_type === consts.README_TYPE) {\n                $('.summernote').summernote(consts.SUMMERNOTE_OPTIONS);\n            }\n\n            //if there is not any title set, show warning\n            ui.inputs_collection.toggleTitleWarning(utils.getTitleCount(branch_inputs), true);\n\n        },\n        //this callback is triggered when the user start dragging an existing input from the      sortable\n        start: function (e, jquery_ui) {\n\n\n            console.log('sortable start');\n            //get current input position, as we need to move from here\n            //console.log('branch input index: ' + jquery_ui.item.index());\n\n            formbuilder.branch.collection_is_being_sorted = true;\n\n            //nb the -2 is to remove the element which are no input (warning messages)\n            formbuilder.branch.from_index = jquery_ui.item.index() === 0 ? 0 : jquery_ui.item.index() - 2;\n\n            //de-activate all inputs in collection\n            formbuilder.dom.inputs_collection_sortable.removeClass('active');\n\n        },\n        scroll: true,\n        snap: false,\n        over: function (e, jquery_ui) {\n\n            var owner_input_ref = formbuilder.branch.active_branch_ref;\n            var owner_input = utils.getInputObjectByRef(owner_input_ref);\n\n            //hide help text if the list is empty and we are hovering with an input\n            if (owner_input.branch.length === 0) {\n                //remove input from dom collection (middle column)\n                formbuilder.dom.inputs_collection_sortable\n                    .find('div.input[data-input-ref=\"' + owner_input_ref + '\"]')\n                    .find('.input-properties__no-branch-questions-message')\n                    .hide();\n            }\n        }\n    };\n};\n\nmodule.exports = branch_sortable();\n","'use strict';\nvar formbuilder = require('../config/formbuilder');\nvar draggable = function () {\n\n    $('ul#inputs-tools-list li div.input').draggable({\n        connectToSortable: '.sortable',\n        //clone element keeping same width when dragging\n        //mind: `evt` is jquery generated, it cannot be called anything else!\n        helper: function (evt) {\n\n            var event = evt || window.event;\n\n            /*\n             clone always the input wrapper, checking which element the user is actually dragging\n             */\n            if ($(event.target).prop('tagName') === 'SPAN' || $(event.target).prop('tagName') === 'I') {\n                //dragging elements inside inner div\n                return $(event.target).parent().parent().clone().css({\n                    width: $(event.target).parent().width()\n\n                });\n\n            } else {\n                //dragging inner div\n                if ($(event.target).hasClass('input-inner')) {\n                    return $(event.target).parent().clone().css({\n                        width: $(event.target).width()\n                    });\n\n                }\n                else {\n                    //dragging outer div (input wrapper)\n                    return $(event.target).clone().css({\n                        width: $(event.target).width()\n                    });\n                }\n            }\n        },\n        snap: false,\n        //cursorAt: {left: '50%', top: '50%'}, get mouse x and y dinamically\n        //handle: 'i',\n        // cancel: 'i', //this stop the dragging over the icon, not good\n        //better stop propagation on mousedown like\n        // cursor: 'move', this keep the cursor 'move' after dropping, not good\n        revert: 'invalid',\n        revertDuration: 100,\n        zIndex: 9999,\n        appendTo: 'body',//append outside sortable to avoid flickering\n        stop: function () {\n            formbuilder.collection_is_being_sorted = false;\n\n\n        },\n        start: function (e, ui) {\n\n\n            if ($(e.target).prop('tagName') === 'SPAN' || $(e.target).prop('tagName') === 'I') {\n                $(this).width($(e.target).parent().width());\n            } else {\n                $(this).width($(e.target).width());\n            }\n            //keep track we are dragging from sidebar a new input to the input list\n            formbuilder.collection_is_being_sorted = false;\n        },\n        scroll: true\n    }).disableSelection();\n};\n\nmodule.exports = draggable;\n","/* global $, toastr*/\n'use strict';\nvar consts = require('config/consts');\nvar formbuilder = require('config/formbuilder');\nvar utils = require('helpers/utils');\nvar possible_answers_pager = require('actions/possible-answers-pager');\nvar getPossibleAnswersList = require('template/methods/getPossibleAnswersList');\n\nvar callback = function (params) {\n\n    var selectedHeaderIndex = params.selectedHeaderIndex;\n    var input = params.input;\n    var importedJson = params.importedJson;\n    var list;\n    var properties_panel;\n    var possible_answers_list;\n    var headers = importedJson.meta.fields;\n    var userWantstoReplaceAnswers = params.userWantstoReplaceAnswers;\n    var doesFirstRowContainsHeaders = params.doesFirstRowContainsHeaders;\n    var possible_answers_max = consts.LIMITS.possible_answers_max;\n\n    if(input.type === consts.SEARCH_SINGLE_TYPE || input.type === consts.SEARCH_MULTIPLE_TYPE) {\n        possible_answers_max = consts.LIMITS.possible_answers_max_search;\n    }\n\n    //if no column is selected abort\n    if (selectedHeaderIndex === null) {\n        return false;\n    }\n\n    //replace or append?\n    if (userWantstoReplaceAnswers) {\n        //reset answers array\n        input.possible_answers = [];\n    }\n\n    //headers on first row or not?\n    if (!doesFirstRowContainsHeaders) {\n\n        var first_row = {};\n        first_row[importedJson.meta.fields[selectedHeaderIndex]] = importedJson.meta.fields[selectedHeaderIndex];\n        //csv file does not have any headers, prepend meta.fields (which is the headers)\n        importedJson.data.unshift(first_row);\n    }\n\n    //append imported possible answers based on selected column (up to max number allowed)\n    $(importedJson.data).each(function (index, item) {\n\n        var imported_answer = item[headers[selectedHeaderIndex]];\n\n        //import as many as we can\n        if (input.possible_answers.length < possible_answers_max && imported_answer !== undefined) {\n\n            //strip html tags\n            imported_answer = imported_answer.replace(/(<([^>]+)>)/ig, ' ');\n\n            //escape double quotes\n            imported_answer = imported_answer.replace(/\"/gi, '&quot;');\n\n            //filter out empty answers\n            if (imported_answer.trim() !== '') {\n\n                //truncate if too long\n                if (imported_answer.length > consts.LIMITS.possible_answer_max_length) {\n                    imported_answer = imported_answer.substring(0,consts.LIMITS.possible_answer_max_length);\n                }\n\n                //add to object\n                input.possible_answers.push({\n                    answer: imported_answer,\n                    answer_ref: utils.generateUniqID()\n                });\n            }\n        }\n        else {\n            //too many, exit\n            console.log('exit at ' + possible_answers_max);\n            return false;//just to exit loop\n        }\n    });\n\n    //get possible answers list markup\n    list = getPossibleAnswersList(input.possible_answers);\n\n    properties_panel = formbuilder.dom.input_properties_forms_wrapper\n        .find('form[data-input-ref=\"' + input.ref + '\"]');\n\n    possible_answers_list = properties_panel\n        .find('.input-properties__form__possible-answers div ul.input-properties__form__possible-answers__list');\n\n    //empty current list and append new one to dom\n    possible_answers_list\n        .empty()\n        .hide()\n        .append(list)\n        .fadeIn(consts.ANIMATION_FAST);\n\n    //when there is more than 1 possible answers, enable all remove buttons\n    possible_answers_list.find('li div span button').prop('disabled', false);\n\n    //show pagination if needed, starting from page 1\n    if(input.possible_answers.length > consts.LIMITS.possible_answers_per_page) {\n        formbuilder.possible_answers_pagination[input.ref].page = 1;\n        possible_answers_pager.init(input);\n    }\n    else {\n        //reset pagination\n        possible_answers_pager.tearDown(input);\n    }\n\n    return true;\n};\n\nmodule.exports = callback;\n","/* global $, toastr*/\n'use strict';\nvar consts = require('config/consts');\nvar messages = require('config/messages');\nvar formbuilder = require('config/formbuilder');\nvar ui = require('helpers/ui');\nvar toast = require('config/toast');\nvar utils = require('helpers/utils');\n\nvar callback = function (files) {\n\n    var undo = require('actions/undo');\n    var inputs = formbuilder.project_definition.data.project.forms[formbuilder.current_form_index].inputs;\n\n\n    //show overlay and cursor\n    formbuilder.dom.overlay.fadeIn(consts.ANIMATION_FAST);\n\n    //delete all inputs from dom\n    $(inputs).each(function (index, input) {\n        //remove properties dom elements (right sidebar)\n        formbuilder.dom.input_properties\n            .find('div.panel-body form[data-input-ref=\"' + input.ref + '\"]')\n            .fadeOut(consts.ANIMATION_FAST).remove();\n\n        //remove input from dom collection (middle column)\n        formbuilder.dom.inputs_collection_sortable\n            .find('div.input[data-input-ref=\"' + input.ref + '\"]')\n            .fadeOut(consts.ANIMATION_FAST).remove();\n    });\n\n    //delete all question from project definition\n    formbuilder.project_definition.data.project.forms[formbuilder.current_form_index].inputs = [];\n\n    //after deletion no input is selected, show message and hide context buttons\n    formbuilder.dom.input_properties_no_input_selected.fadeIn(consts.ANIMATION_FAST);\n    //hide action button for input\n    formbuilder.dom.input_properties_buttons.fadeOut(consts.ANIMATION_FAST);\n\n    //remove track of any inputs\n    formbuilder.current_input_ref = undefined;\n\n    //re calculate search questions total\n    if (utils.getSearchInputsTotal() <= (consts.LIMITS.search_inputs_max - 1)) {\n        ui.input_tools.showSearchInput();\n    }\n\n    //remove title warning if any\n    ui.inputs_collection.toggleTitleWarning(1,false);\n\n    //set form as invalid\n    ui.forms_tabs.showFormInvalidIcon(formbuilder.current_form_index);\n\n    //disable save project button\n    ui.navbar.toggleSaveProjectBtn(consts.BTN_DISABLED);\n\n    //show import form button\n    formbuilder.dom.inputs_collection.find('.input-properties__no-questions-message').removeClass('hidden');\n\n    //handle the undo...can we go back?\n    ui.navbar.toggleUndoBtn(consts.BTN_ENABLED);\n\n    //hide overlay\n    window.setTimeout(function () {\n        formbuilder.dom.overlay.fadeOut(consts.ANIMATION_FAST);\n    }, 1000);\n\n};\n\nmodule.exports = callback;\n","/* global $, toastr*/\n'use strict';\nvar consts = require('config/consts');\nvar messages = require('config/messages');\nvar formbuilder = require('config/formbuilder');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar validation = require('actions/validation');\n\n\nvar callback = function (e) {\n\n    var undo = require('actions/undo');\n    var form_factory = require('factory/form-factory');\n    var form_ref = formbuilder.current_form_ref;\n    var form_tab = formbuilder.dom.forms_tabs.find('.active');\n    var previous_tab_trigger = form_tab.prev().find('a');\n    var previous_form_ref = previous_tab_trigger.attr('href');\n    var forms = formbuilder.project_definition.data.project.forms;\n\n    //if current form index === 0, do not delete as this is the first form\n    if(formbuilder.current_form_index === 0) {\n        //cannot delete top parent form\n        toastr.error(messages.error.FORM_CANNOT_BE_DELETED);\n        return;\n    }\n\n    //if the current form is not the last in the hierarchy, do not delete it\n    if(formbuilder.current_form_index !== (forms.length - 1)) {\n        //cannot delete top parent form\n        toastr.error(messages.error.FORM_CANNOT_BE_DELETED);\n        return;\n    }\n\n    previous_form_ref = previous_form_ref.substring(1, previous_form_ref.length - 9);\n    //after the form to be deleted is hidden, delete it and unbind the callback\n    previous_tab_trigger.on('shown.bs.tab', function (e) {\n\n        form_factory.removeForm(previous_form_ref, form_ref, form_tab);\n\n        //show toast\n        toastr.warning(messages.warning.FORM_DELETED);\n        undo.pushState();\n\n        previous_tab_trigger.off();\n\n        //run validation, the removed form night have been the only one with invalid inputs\n        if (validation.areAllInputsValid(formbuilder.project_definition)) {\n            ui.navbar.toggleSaveProjectBtn(consts.BTN_ENABLED);\n        }\n\n        //show search input if we deleted some search qestions\n        if (utils.getSearchInputsTotal() <= consts.LIMITS.search_inputs_max) {\n            ui.input_tools.showSearchInput();\n        }\n    });\n\n    //unbind current panel handlers before switching\n    form_factory.unbindFormPanelsEvents();\n\n    //update formbuilder dom references to point to the selected form markup\n    form_factory.updateFormbuilderDomReferences(previous_form_ref);\n\n    //bind events to active form\n    form_factory.bindFormPanelsEvents();\n\n    //switch to previous form\n    form_tab.prev().find('a').tab('show');\n};\n\nmodule.exports = callback;\n","/* global $, toastr*/\n'use strict';\nvar consts = require('config/consts');\nvar messages = require('config/messages');\nvar formbuilder = require('config/formbuilder');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar validation = require('actions/validation');\nvar toast = require('config/toast');\n\nvar callback = function (e) {\n\n    var undo = require('actions/undo');\n    // var generate_search_type_project = require('helpers/generate-search-type-project');\n    //\n    // generate_search_type_project.doIt();\n    // return false;\n\n    var index = formbuilder.current_form_index;\n    var formToExport = {\n        data: {\n            id: '',\n            type: 'form',\n            form: {}\n        }\n    };\n    //create a deep copy of the project object properties\n    var project_definition_json = CircularJSON.parse(CircularJSON.stringify(formbuilder.project_definition));\n    var is_valid_form = true;\n    var project_slug = project_definition_json.data.project.slug;\n    var form = project_definition_json.data.project.forms[index];\n    var filename = project_slug + '__' + form.slug + '__form.json';\n\n    if (form.inputs.length === 0) {\n        toast.showError(messages.error.FORM_IS_INVALID);\n        return;\n    }\n\n    $(form.inputs).each(function (inputIndex, input) {\n\n        //get valid jump destinations\n        var jump_destinations = utils.getJumpAvailableDestinationsAsKeys(inputIndex, input, form.inputs, false);\n\n        //extra validation for jumps, check if the destination still exists and it is valid\n        $(input.jumps).each(function (jumpIndex, jump) {\n            //does the jump \"to\" property reference a valid destination input?\n            if (!jump_destinations[jump.to]) {\n                //invalid destination found\n                is_valid_form = false;\n            }\n        });\n\n        $(input.branch).each(function (branchInputIndex, branch_input) {\n\n            if (!branch_input.dom.is_valid) {\n                is_valid_form = false;\n            }\n\n            delete branch_input.dom;\n\n            //todo validate branch jumps\n            jump_destinations = utils.getJumpAvailableDestinationsAsKeys(branchInputIndex, branch_input, input.branch, true);\n\n            //extra validation for jumps, check if the destination still exists and it is valid\n            $(branch_input.jumps).each(function (branchJumpIndex, branchJump) {\n                //does the jump \"to\" property reference a valid destination input?\n                if (!jump_destinations[branchJump.to]) {\n                    //invalid destination found\n                    is_valid_form = false;\n                }\n            });\n\n            $(branch_input.group).each(function (index, group_input) {\n\n                if (!group_input.dom.is_valid) {\n                    is_valid_form = false;\n                }\n                delete group_input.dom;\n            });\n        });\n        $(input.group).each(function (index, group_input) {\n            if (!group_input.dom.is_valid) {\n                is_valid_form = false;\n            }\n            delete group_input.dom;\n        });\n\n        if (!input.dom.is_valid) {\n            is_valid_form = false;\n        }\n        delete input.dom;\n    });\n\n    //wrap form in \"data {}\" accordin to json api\n    formToExport.data.id = form.ref;\n    formToExport.data.form = form;\n\n    if (is_valid_form) {\n        //do export\n\n        var file;\n\n        try {\n            file = new File([JSON.stringify(formToExport)], filename, { type: 'text/plain:charset=utf-8' });\n            saveAs(file);\n        }\n        catch (error) {\n            console.log(error);\n\n            //Microsoft browsers?\n           if(navigator.msSaveBlob) {\n               return navigator.msSaveBlob(new Blob([JSON.stringify(formToExport)], { type: 'text/plain:charset=utf-8'  }), filename);\n           }\n           else {\n               //browser not supported yet\n               toast.showError(messages.error.BROWSER_NOT_SUPPORTED);\n           }\n        }\n\n    }\n    else {\n        toast.showError(messages.error.FORM_IS_INVALID);\n    }\n};\n\nmodule.exports = callback;\n","/* global $, toastr*/\n'use strict';\nvar consts = require('config/consts');\nvar messages = require('config/messages');\nvar formbuilder = require('config/formbuilder');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar validation = require('actions/validation');\nvar form_factory = require('factory/form-factory');\n\nvar callback = function (e) {\n\n    var target = $(this);\n    var href = target.attr('href');\n    var form_ref = target.attr('href').substring(1, href.length - 9);\n    var forms = formbuilder.project_definition.data.project.forms;\n    var inputs;\n    var is_last_child_form;\n    var active_input;\n\n\n    //ignore clicks on active tab\n    if (target.parent().hasClass('active')) {\n        return;\n    }\n\n    //validate active input (if any) before switching\n    if (formbuilder.current_input_ref) {\n        active_input = utils.getInputObjectByRef(formbuilder.current_input_ref);\n    }\n\n    //validate previous input (if any, I might have only one left) when user goes to another input, but do not show toast\n    if (active_input) {\n        validation.performValidation(active_input, false);\n    }\n\n    //unbind current panel handlers before switching\n    form_factory.unbindFormPanelsEvents();\n\n    //update formbuilder dom references to point to the selected form markup\n    form_factory.updateFormbuilderDomReferences(form_ref);\n\n    //bind events to active form\n    form_factory.bindFormPanelsEvents();\n\n    //get active input for the selected form (if any)\n    var active_input_ref = formbuilder.dom.inputs_collection_sortable.find('.active').attr('data-input-ref');\n\n    //switch form to selected one\n    formbuilder.current_form_index = parseInt(target.attr('data-form-index'), 10);\n    formbuilder.current_form_ref = forms[formbuilder.current_form_index].ref;\n\n    //remove any reference to selected input\n    //todo check this as we might need to run a validation before switching tab\n    formbuilder.current_input_ref = active_input_ref;\n\n    is_last_child_form = formbuilder.current_form_index === forms.length - 1;\n    //enable delete button if the active child form is the last child\n    if (is_last_child_form) {\n        formbuilder.dom.inputs_collection\n            .find('.inputs-collection__buttons--remove-form')\n            .attr('disabled', false);\n    }\n    else {\n        formbuilder.dom.inputs_collection\n            .find('.inputs-collection__buttons--remove-form')\n            .attr('disabled', true);\n    }\n\n    inputs = forms[formbuilder.current_form_index].inputs;\n\n    //if the new active form does not have a title set, show warning\n    //show no title warning (if no title set for the first form)\n    if (utils.getTitleCount(inputs) === 0 && inputs.length > 0) {\n        ui.inputs_collection.toggleTitleWarning(0, false);\n    }\n\n    //if no inputs, disable download form button\n    if (inputs.length === 0) {\n        formbuilder.dom.inputs_collection\n            .find('.inputs-collection__export-form').addClass('disabled');\n\n        formbuilder.dom.inputs_collection\n            .find('.inputs-collection__print-as-pdf').addClass('disabled');\n    }\n    else {\n        formbuilder.dom.inputs_collection\n            .find('.inputs-collection__export-form').removeClass('disabled');\n\n        formbuilder.dom.inputs_collection\n            .find('.inputs-collection__print-as-pdf').removeClass('disabled');\n    }\n\n    //toggle form icon to a green chck if the top parent form is valid\n    if (validation.areFormInputsValid(formbuilder.current_form_index)) {\n        ui.forms_tabs.showFormValidIcon(formbuilder.current_form_index);\n\n        //enable download form button\n        formbuilder.dom.inputs_collection\n            .find('.inputs-collection__export-form').removeClass('disabled');\n\n        //enable print as pdf form button\n        formbuilder.dom.inputs_collection\n            .find('.inputs-collection__print-as-pdf').removeClass('disabled');\n    }\n    else {\n        //disable download form button\n        formbuilder.dom.inputs_collection\n            .find('.inputs-collection__export-form').addClass('disabled');\n\n        //disable print as pdf form button\n        formbuilder.dom.inputs_collection\n            .find('.inputs-collection__print-as-pdf').addClass('disabled');\n    }\n};\n\nmodule.exports = callback;\n","/* global $, toastr*/\n'use strict';\nvar consts = require('config/consts');\nvar messages = require('config/messages');\nvar formbuilder = require('config/formbuilder');\nvar ui = require('helpers/ui');\nvar toast = require('config/toast');\nvar utils = require('helpers/utils');\nvar validation = require('actions/validation');\nvar parser = {\n    getBranchInputsHTML: require('actions/parse/methods/getBranchInputsHTML'),\n    getGroupInputsHTML: require('actions/parse/methods/getGroupInputsHTML'),\n    renderInputs: require('actions/parse/methods/renderInputs'),\n    renderProject: require('actions/parse/methods/renderProject'),\n    renderChildForms: require('actions/parse/methods/renderChildForms'),\n    initFormbuilder: require('actions/parse/methods/initFormbuilder')\n};\n\nvar import_form_validation = require('helpers/import-form-validation');\nvar save_project_click_callback = require('ui-handlers/event-handler-callbacks/save-project-click-callback');\n\nvar callback = function (files) {\n\n    var undo = require('actions/undo');\n    var file = files[0];\n    var file_parts;\n    var file_ext;\n\n    //show overlay and cursor\n    formbuilder.dom.overlay.fadeIn(consts.ANIMATION_FAST);\n\n    //if the user cancels the action\n    if (!file) {\n        //hide overlay\n        formbuilder.dom.overlay.fadeOut(consts.ANIMATION_FAST);\n        toastr.error(messages.error.FORM_FILE_INVALID);\n        return;\n    }\n\n    file_parts = file.name.split('.');\n    file_ext = file_parts[file_parts.length - 1];\n\n    console.log(file);\n\n    //it must be json\n    if (file_ext !== consts.FORM_FILE_EXTENSION) {\n        //hide overlay\n        formbuilder.dom.overlay.fadeOut(consts.ANIMATION_FAST);\n        toastr.error(messages.error.FORM_FILE_INVALID);\n        return;\n    }\n\n    //todo skip MIME type validation on the front end as it is a mess\n    //json format according to epicollect5 api\n    //if (file.type !== consts.FORM_FILE_ACCEPTED_TYPE) {\n    //hide overlay\n    //     formbuilder.dom.overlay.fadeOut(consts.ANIMATION_FAST);\n    //     toastr.error(messages.error.FORM_FILE_INVALID);\n    //     return;\n    // }\n\n    var reader = new FileReader();\n\n    reader.onload = function (e) {\n\n        var json_text = e.target.result;\n        var form;\n        var current_form_ref;\n        var imported_form_ref;\n        var regex;\n        var inputs;\n        try {\n            form = JSON.parse(json_text);\n        }\n        catch (error) {\n            //hide overlay\n            formbuilder.dom.overlay.fadeOut(consts.ANIMATION_FAST);\n            //it means the json is in invalid format\n            toastr.error(messages.error.FORM_FILE_INVALID);\n            return;\n        }\n\n\n        //validate form structure\n        if (!import_form_validation.hasValidFormStructure(form)) {\n            //hide overlay\n            formbuilder.dom.overlay.fadeOut(consts.ANIMATION_FAST);\n            //it means the structure is invalid\n            toastr.error(messages.error.FORM_FILE_INVALID);\n            return;\n        }\n\n        //grab inputs\n        inputs = form.data.form.inputs;\n\n        //are there any inputs?\n        if (inputs.length === 0) {\n            formbuilder.dom.overlay.fadeOut(consts.ANIMATION_FAST);\n            toastr.error(messages.error.FORM_FILE_INVALID);\n            return;\n        }\n\n        //is inputs array?\n        if (!$.isArray(inputs)) {\n            formbuilder.dom.overlay.fadeOut(consts.ANIMATION_FAST);\n            toastr.error(messages.error.FORM_FILE_INVALID);\n            return;\n        }\n        else {\n            var are_valid_inputs = true;\n            $(inputs).each(function (index, input) {\n                if (!import_form_validation.isValidInput(form.data.form.ref, input, false, false)) {\n                    console.log(input);\n                    console.log(JSON.stringify(input));\n                    are_valid_inputs = false;\n                    return false;\n                }\n            });\n\n            if (!are_valid_inputs) {\n                formbuilder.dom.overlay.fadeOut(consts.ANIMATION_FAST);\n                toastr.error(messages.error.FORM_FILE_INVALID);\n                return;\n            }\n\n            //check total number of questions/branches\n            if (utils.getInputsTotal(inputs) > consts.INPUTS_MAX_ALLOWED) {\n                //hide overlay\n                formbuilder.dom.overlay.fadeOut(consts.ANIMATION_FAST);\n                toastr.error(messages.error.FORM_FILE_INVALID);\n                return;\n            }\n\n            //check total number of titles (main form)\n            if (utils.isMaxTitleLimitExceeded(inputs)) {\n                //hide overlay\n                formbuilder.dom.overlay.fadeOut(consts.ANIMATION_FAST);\n                toastr.error(messages.error.FORM_FILE_INVALID);\n                return;\n            }\n            //check total number of titles (branches)\n            var are_branch_inputs_valid = true;\n            $(inputs).each(function (index, input) {\n                if (utils.isMaxTitleLimitExceeded(input.branch)) {\n                    are_branch_inputs_valid = false;\n                    return false;\n                }\n            });\n\n            if (!are_branch_inputs_valid) {\n                //hide overlay\n                formbuilder.dom.overlay.fadeOut(consts.ANIMATION_FAST);\n                toastr.error(messages.error.FORM_FILE_INVALID);\n                return;\n            }\n\n            //check jumps destinations\n            if (!import_form_validation.areJumpsDestinationsValid(inputs)) {\n                //hide overlay\n                formbuilder.dom.overlay.fadeOut(consts.ANIMATION_FAST);\n                toastr.error(messages.error.FORM_FILE_INVALID);\n                return;\n            }\n        }\n\n        //we need to use the current form ref\n        current_form_ref = formbuilder.current_form_ref;\n        imported_form_ref = form.data.form.ref;\n        regex = new RegExp(imported_form_ref, 'g');\n\n        //replace imported form ref with current form ref(all occurrrences)\n        json_text = json_text.replace(regex, current_form_ref);\n        form = JSON.parse(json_text);\n\n        // temporarly setup inputs with the current_form_ref in formbuilder global object (so it can pass jump destinations validation when parsing, and also to render jumps properly in the dom)\n        formbuilder.project_definition.data.project.forms[formbuilder.current_form_index]\n            .inputs = form.data.form.inputs.slice();\n\n        //parse the form and add the markup then.\n        var renderedInputs = parser.renderInputs(form.data.form.inputs);\n\n        //remove no questions message (if any inputs)\n        if (renderedInputs.length > 0) {\n            formbuilder.dom.inputs_collection.find('.input-properties__no-questions-message').addClass('hidden');\n        }\n\n        //show no title warning (if no title set for the first form)\n        if (utils.getTitleCount(renderedInputs) === 0) {\n            ui.inputs_collection.toggleTitleWarning(0, false);\n        }\n\n        //toggle form icon to a green check if the top parent form is valid\n        if (validation.areFormInputsValid(formbuilder.current_form_index)) {\n            ui.forms_tabs.showFormValidIcon(formbuilder.current_form_index);\n            //enable download form button\n            formbuilder.dom.inputs_collection\n                .find('.inputs-collection__export-form').removeClass('disabled');\n\n            //enable print as pdf form button\n            formbuilder.dom.inputs_collection\n                .find('.inputs-collection__print-as-pdf').removeClass('disabled');\n        }\n\n        //replace object literal inputs with newly generated ones via factory (i.e. using new) so they get the prototype\n        formbuilder.project_definition.data.project.forms[formbuilder.current_form_index].inputs = renderedInputs.slice();//by value\n\n\n        //enable save project button if all inputs are valid\n        if (validation.areAllInputsValid(formbuilder.project_definition)) {\n\n            //enable save project button (if disabled)\n            ui.navbar.toggleSaveProjectBtn(consts.BTN_ENABLED);\n\n            //reset some flags\n            formbuilder.current_input_ref = null; //no input is selected\n\n            formbuilder.dom.save_project_btn.off().on('click', save_project_click_callback);\n        }\n\n        //if there are too many search inputs, hide the search input tool in the sidebar\n        if (utils.getSearchInputsTotal() >= consts.LIMITS.search_inputs_max) {\n            ui.input_tools.hideSearchInput();\n\n            //also show warning\n            //show warning to user\n            toast.showWarning(messages.warning.SEARCH_INPUTS_LIMIT_REACHED + '(' + consts.LIMITS.search_inputs_max + ')');\n        }\n\n        window.setTimeout(function () {\n            //hide overlay\n            formbuilder.dom.overlay.fadeOut(consts.ANIMATION_SLOW);\n            //show success toast\n            toastr.success(messages.success.FORM_IMPORTED);\n            //push state for undo\n            undo.pushState();\n        }, consts.ANIMATION_SLOW);\n    };\n\n    reader.readAsText(file);\n};\n\nmodule.exports = callback;\n","/* global $, toastr*/\n'use strict';\nvar consts = require('config/consts');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar messages = require('config/messages');\nvar formbuilder = require('config/formbuilder');\nvar save = require('actions/save');\nvar validation = require('actions/validation');\nvar possibleAnswersSortable = require('ui-handlers/possible-answers-sortable');\nvar possible_answers_pager = require('actions/possible-answers-pager');\n\n\nvar callback = function (e) {\n\n    console.log('called branch-sortable-mousedown');\n\n    var self = $(this);\n    var ref = self.attr('data-input-ref');\n    var branch_input = utils.getBranchInputObjectByRef(ref);\n    var previous_branch_input = utils.getBranchInputObjectByRef(formbuilder.branch.current_input_ref);\n    var branch_inputs = utils.getInputObjectByRef(formbuilder.current_input_ref).branch;\n    var question;\n\n    //branch_input.dom.properties_panel = formbuilder.dom.input_properties_forms_wrapper.find('form[data-input-ref=\"' + ref + '\"]');\n\n    /*\n     if both the editing branch flag and the editing group flag are set, we are exiting a nested group\n     */\n    if (formbuilder.is_editing_branch && formbuilder.is_editing_group) {\n        //we are in nested group edit mode, exit is the only action we need to intercept\n        if (self.hasClass('fa-chevron-left')) {\n\n            //get active nested group we are exiting from\n            var input = utils.getBranchInputObjectByRef(formbuilder.branch.current_input_ref);\n\n            //exit nested group editing\n            input.exitNestedGroupSortable();\n        }\n        else {\n            return false;\n        }\n    }\n    else {\n\n        //deactivate all inputs in active branch sortable collection\n        formbuilder.dom.inputs_collection_sortable.find('.active-branch .branch-sortable').find('.active').removeClass('active');\n        //activate new clicked element\n        self.addClass('active');\n\n        //validate previous input (if any, I might have only one left) when user goes to another input, but do not show toast\n        if (previous_branch_input) {\n            validation.performValidation(previous_branch_input, false);\n        }\n\n        /*\n         show properties for the selected input in properties panel\n         */\n\n        if (!branch_input.question) {\n            //empty question text? show warning\n            formbuilder.dom.input_properties.find('.panel-title span.question-preview').text(messages.error.NO_QUESTION_TEXT_YET);\n        }\n        else {\n\n            //strip html tags from readme type if any\n            if (branch_input.type === consts.README_TYPE) {\n                question = utils.decodeHtml(branch_input.question);\n                question = question.replace(/(<([^>]+)>)/ig, ' ');\n                formbuilder.dom.input_properties.find('.panel-title span.question-preview').text(question.trunc(20));\n            }\n            else {\n                formbuilder.dom.input_properties.find('.panel-title span.question-preview').text(branch_input.question.trunc(20));\n            }\n        }\n\n        //toggle title base on number of titles selected within this branch (but only if not checked)\n        if (utils.isMaxTitleLimitReached(branch_inputs)) {\n            if (!branch_input.is_title) {\n                ui.input_properties_panel.toggleTitleCheckbox(consts.DISABLED_STATE, ref);\n            }\n        }\n        else {\n            ui.input_properties_panel.toggleTitleCheckbox(consts.ENABLED_STATE, ref);\n\n        }\n\n        formbuilder.dom.input_properties.find('.panel-body form').hide();\n        // //formbuilder.dom.input_properties.find('.panel-body form[data-input-ref=\"' + ref + '\"]');\n        formbuilder.dom.input_properties.find('.panel-body form[data-input-ref=\"' + ref + '\"]').removeClass('hidden').fadeIn(consts.ANIMATION_NORMAL);\n\n        //hide 'no inputs selected buttons'\n        formbuilder.dom.input_properties_forms_wrapper.find('.input-properties__no-input-selected').hide();\n\n        //if the input type has possible answers, show pager if needed\n        if ($.inArray(branch_input.type, consts.MULTIPLE_ANSWER_TYPES) > -1) {\n            if (branch_input.possible_answers.length > consts.LIMITS.possible_answers_per_page) {\n                //show pagination\n                possible_answers_pager.init(branch_input);\n            }\n            else {\n                possible_answers_pager.tearDown(branch_input);\n            }\n        }\n\n        //show save/delete btns\n        formbuilder.dom.input_properties_buttons.fadeIn(consts.ANIMATION_FAST);\n        formbuilder.branch.current_input_ref = ref;\n\n        //enable sortable on current input\n        possibleAnswersSortable(branch_input);\n    }\n\n    if (branch_input.type === consts.README_TYPE) {\n        $('.summernote').summernote(consts.SUMMERNOTE_OPTIONS);\n    }\n};\n\nmodule.exports = callback;\n","/* global $, toastr*/\n'use strict';\nvar consts = require('config/consts');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar messages = require('config/messages');\nvar formbuilder = require('config/formbuilder');\nvar save = require('actions/save');\nvar validation = require('actions/validation');\nvar possibleAnswersSortable = require('ui-handlers/possible-answers-sortable');\nvar possible_answers_pager = require('actions/possible-answers-pager');\n\nvar callback = function (e) {\n\n    console.log('called group-sortable-mousedown');\n\n    var self = $(this);\n    var ref = self.attr('data-input-ref');\n    var group_input = utils.getGroupInputObjectByRef(ref);\n    var previous_group_input = utils.getGroupInputObjectByRef(formbuilder.group.current_input_ref);\n    var inputs = formbuilder.project_definition.data.project.forms[formbuilder.current_form_index].inputs;\n    var question;\n\n    //deactivate all inputs in active group sortable collection\n    formbuilder.dom.inputs_collection_sortable.find('.active-group .group-sortable').find('.active').removeClass('active');\n    //activate new clicked element\n    self.addClass('active');\n\n    //validate previous input (if any, I might have only one left) when user goes to another input, but do not show toast\n    if (previous_group_input) {\n        validation.performValidation(previous_group_input, false);\n    }\n\n    /*\n     show properties for the selected input in properties panel\n     */\n    if (!group_input.question) {\n        //empty question text? show warning\n        formbuilder.dom.input_properties.find('.panel-title span.question-preview').text(messages.error.NO_QUESTION_TEXT_YET);\n    }\n    else {\n\n        //strip html tags from readme type if any\n        if (group_input.type === consts.README_TYPE) {\n            question = utils.decodeHtml(group_input.question);\n            question = question.replace(/(<([^>]+)>)/ig, ' ');\n            formbuilder.dom.input_properties.find('.panel-title span.question-preview').text(question.trunc(20));\n        }\n        else {\n            formbuilder.dom.input_properties.find('.panel-title span.question-preview').text(group_input.question.trunc(20));\n        }\n    }\n\n    //toggle title base on number of titles selected (but only if not checked)\n    if (utils.isMaxTitleLimitReached(inputs)) {\n        if (!group_input.is_title) {\n            ui.input_properties_panel.toggleTitleCheckbox(consts.DISABLED_STATE, ref);\n        }\n    }\n    else {\n        ui.input_properties_panel.toggleTitleCheckbox(consts.ENABLED_STATE, ref);\n    }\n\n    formbuilder.dom.input_properties.find('.panel-body form').hide();\n    formbuilder.dom.input_properties.find('.panel-body form[data-input-ref=\"' + ref + '\"]').removeClass('hidden').fadeIn(consts.ANIMATION_NORMAL);\n\n    //hide 'no inputs selected buttons'\n    formbuilder.dom.input_properties_forms_wrapper.find('.input-properties__no-input-selected').hide();\n\n    //if the input type has possible answers, show pager if needed\n    if ($.inArray(group_input.type, consts.MULTIPLE_ANSWER_TYPES) > -1) {\n        if (group_input.possible_answers.length > consts.LIMITS.possible_answers_per_page) {\n            //show pagination\n            possible_answers_pager.init(group_input);\n        }\n        else {\n            possible_answers_pager.tearDown(group_input);\n        }\n    }\n\n    //show save/delete btns\n    formbuilder.dom.input_properties_buttons.fadeIn(consts.ANIMATION_FAST);\n    formbuilder.group.current_input_ref = ref;\n\n    if (group_input.type === consts.README_TYPE) {\n        $('.summernote').summernote(consts.SUMMERNOTE_OPTIONS);\n    }\n    //enable sortable on current input\n    possibleAnswersSortable(group_input);\n};\n\nmodule.exports = callback;\n","/* global $, toastr*/\n'use strict';\nvar consts = require('config/consts');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar messages = require('config/messages');\nvar formbuilder = require('config/formbuilder');\nvar validation = require('actions/validation');\nvar possibleAnswersSortable = require('ui-handlers/possible-answers-sortable');\nvar possible_answers_pager = require('actions/possible-answers-pager');\n\nvar callback = function (e) {\n\n    var self = $(this);\n    var ref = self.attr('data-input-ref');\n    var owner_branch = utils.getInputObjectByRef(formbuilder.branch.active_branch_ref);\n    var group_input = utils.getNestedGroupInputObjectByRef(owner_branch, ref);\n    var previous_group_input = utils.getNestedGroupInputObjectByRef(owner_branch, formbuilder.group.current_input_ref);\n    var branch_inputs = utils.getInputObjectByRef(formbuilder.current_input_ref).branch;\n    var question;\n\n    // group_input.dom.properties_panel = formbuilder.dom.input_properties_forms_wrapper.find('form[data-input-ref=\"' + ref + '\"]');\n\n    //deactivate all inputs in active nested group sortable collection\n    formbuilder.dom.inputs_collection_sortable.find('.active-group .group-sortable').find('.active').removeClass('active');\n    //activate new clicked element\n    self.addClass('active');\n\n    //validate previous input (if any, I might have only one left) when user goes to another input, but do not show toast\n    if (previous_group_input) {\n        validation.performValidation(previous_group_input, false);\n    }\n\n    /*\n     show properties for the selected input in properties panel\n     */\n    if (!group_input.question) {\n        //empty question text? show warning\n        formbuilder.dom.input_properties.find('.panel-title span.question-preview').text(messages.error.NO_QUESTION_TEXT_YET);\n    }\n    else {\n        //strip html tags from readme type if any\n        if (group_input.type === consts.README_TYPE) {\n            question = utils.decodeHtml(group_input.question);\n            question = question.replace(/(<([^>]+)>)/ig, ' ');\n            formbuilder.dom.input_properties.find('.panel-title span.question-preview').text(question.trunc(20));\n        }\n        else {\n            formbuilder.dom.input_properties.find('.panel-title span.question-preview').text(group_input.question.trunc(20));\n        }\n    }\n\n    //toggle title base on number of titles selected (but only if not checked)\n    if (utils.isMaxTitleLimitReached(branch_inputs)) {\n        if (!group_input.is_title) {\n            ui.input_properties_panel.toggleTitleCheckbox(consts.DISABLED_STATE, ref);\n        }\n    }\n    else {\n        ui.input_properties_panel.toggleTitleCheckbox(consts.ENABLED_STATE, ref);\n    }\n\n    formbuilder.dom.input_properties.find('.panel-body form').hide();\n    formbuilder.dom.input_properties.find('.panel-body form[data-input-ref=\"' + ref + '\"]').removeClass('hidden').fadeIn(consts.ANIMATION_NORMAL);\n\n    //hide 'no inputs selected buttons'\n    formbuilder.dom.input_properties_forms_wrapper.find('.input-properties__no-input-selected').hide();\n\n    //if the input type has possible answers, show pager if needed\n    if ($.inArray(group_input.type, consts.MULTIPLE_ANSWER_TYPES) > -1) {\n        if (group_input.possible_answers.length > consts.LIMITS.possible_answers_per_page) {\n            //show pagination\n            possible_answers_pager.init(group_input);\n        }\n        else {\n            possible_answers_pager.tearDown(group_input);\n        }\n    }\n\n    //show save/delete btns\n    formbuilder.dom.input_properties_buttons.fadeIn(consts.ANIMATION_FAST);\n    formbuilder.group.current_input_ref = ref;\n\n    if (group_input.type === consts.README_TYPE) {\n        $('.summernote').summernote(consts.SUMMERNOTE_OPTIONS);\n    }\n\n    //enable sortable on current input\n    possibleAnswersSortable(group_input);\n};\n\nmodule.exports = callback;\n","/* global $, toastr*/\n'use strict';\nvar consts = require('config/consts');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar messages = require('config/messages');\nvar formbuilder = require('config/formbuilder');\nvar save = require('actions/save');\nvar validation = require('actions/validation');\nvar input_properties_keyup_callback = require('ui-handlers/event-handler-callbacks/input-properties-keyup-callback');\nvar jumps = require('actions/jumps');\nvar possible_answers_pager = require('actions/possible-answers-pager');\nvar possibleAnswersSortable = require('ui-handlers/possible-answers-sortable');\n\nfunction _exitBranch(the_input) {\n\n    var active_branch_input;\n    var input = the_input;\n    var branch_validation;\n\n    //if there is any branch to validate, do it before exiting\n    if (formbuilder.branch.current_input_ref) {\n        //validate currently active branch input (in case the user did not click validate himself)\n        active_branch_input = utils.getBranchInputObjectByRef(formbuilder.branch.current_input_ref);\n        validation.performValidation(active_branch_input, false);\n\n    }\n    //exit\n    input.exitBranchSortable();\n}\n\nfunction _exitGroup(the_input) {\n\n    var active_group_input;\n    var input = the_input;\n\n    //if there is any group to validate, do it before exiting\n    if (formbuilder.group.current_input_ref) {\n        //validate currently active group input (in case the user did not click validate himself)\n        active_group_input = utils.getGroupInputObjectByRef(formbuilder.group.current_input_ref);\n        validation.performValidation(active_group_input, false);\n\n        //branch inputs are already attached to the branch property ot the owner input, just validate them\n        input.validateGroupInputs();\n    }\n    //exit\n    input.exitGroupSortable();\n}\n\n\nvar callback = function (e) {\n\n    /***************************************/\n    //hack to remove focus from jump select so it gets refreshed\n    var $focused = $(':focus');\n    var jump_select = $focused.attr('data-jump-logic');\n    if (jump_select === 'goto') {\n        $focused.blur();\n    }\n    //end hack\n    /*************************************/\n\n    var self = $(this);\n    var previous_input;\n    var ref;\n    var input;\n    var inputs = formbuilder.project_definition.data.project.forms[formbuilder.current_form_index].inputs;\n    var question;\n    var copy_btn_state;\n    //var pager;\n\n    /*\n     If we are editng a nested branch  or group we are just interested on a click on the exit button\n     to go back to the parent sortable\n     */\n    if (formbuilder.is_editing_branch || formbuilder.is_editing_group) {\n        //we are in branch edit mode, exit is the only action we need to intercept\n        if (self.hasClass('chevron-left')) {\n            //get ref from parent\n            ref = self.parents().eq(1).attr('data-input-ref');\n            input = utils.getInputObjectByRef(ref);\n\n            if (formbuilder.is_editing_branch) {\n                _exitBranch(input);\n            }\n            else {\n                _exitGroup(input);\n            }\n        }\n        else {\n            return false;\n        }\n    }\n    else {\n\n        /*\n         we are editing a top level sortable\n         */\n        previous_input = utils.getInputObjectByRef(formbuilder.current_input_ref);\n        ref = self.attr('data-input-ref');\n        input = utils.getInputObjectByRef(ref);\n\n        //enable sortable on current input\n        possibleAnswersSortable(input);\n\n        //validate previous input (if any, I might have only one left) when user goes to another input, but do not show toast\n        if (previous_input) {\n            validation.performValidation(previous_input, false);\n        }\n\n        //deactivate all inputs in collection\n        formbuilder.dom.inputs_collection_sortable.find('.active').removeClass('active');\n\n        //activate just current clicked input in the collection\n        self.addClass('active');\n\n        /*\n         show properties for the selected input in properties panel\n         */\n        if (!input.question) {\n            //empty question text? show warning\n            formbuilder.dom.input_properties.find('.panel-title span.question-preview').text(messages.error.NO_QUESTION_TEXT_YET);\n        }\n        else {\n\n            //strip html tags from readme type if any\n            if (input.type === consts.README_TYPE) {\n                question = utils.decodeHtml(input.question);\n                question = question.replace(/(<([^>]+)>)/ig, ' ');\n                formbuilder.dom.input_properties.find('.panel-title span.question-preview').text(question.trunc(20));\n            }\n            else {\n                formbuilder.dom.input_properties.find('.panel-title span.question-preview').text(input.question.trunc(20));\n            }\n        }\n    }\n\n    //toggle checkbox events for uniqueness if this is a child form\n    // i.e. checkboxes behave like radio\n    if (formbuilder.current_form_index > 0) {\n\n        //do not attach this event for branches\n        if (!formbuilder.is_editing_branch) {\n\n            //get handle of current active properties panel\n            input.dom.advanced_properties_wrapper = formbuilder\n                .dom\n                .input_properties_forms_wrapper\n                .find('form[data-input-ref=\"' + input.ref + '\"]')\n                .find('.input-properties__form__advanced-properties');\n\n            //bind function to make only a single checkbox selected at a time\n            input.dom.advanced_properties_wrapper\n                .find('.input-properties__form__advanced-properties__uniqueness input')\n                .off().on('change', function () {\n\n                //get the current check/unckeck state of the checkbox the user has click to restore it\n                var currentCheckBoxState = $(this).prop('checked');\n\n                //uncheck all\n                $(this).parents('.input-properties__form__advanced-properties__uniqueness')\n                    .find('input[type=\"checkbox\"]')\n                    .prop('checked', false);\n\n                //check/uncheck the selected one based on the previous state\n                $(this).prop('checked', currentCheckBoxState);\n            });\n        }\n    }\n\n\n    //toggle title base on number of titles selected (but only if not checked)\n    if (utils.isMaxTitleLimitReached(inputs)) {\n        if (!input.is_title) {\n            ui.input_properties_panel.toggleTitleCheckbox(consts.DISABLED_STATE, ref);\n        }\n    }\n    else {\n        ui.input_properties_panel.toggleTitleCheckbox(consts.ENABLED_STATE, ref);\n    }\n\n    ////if any jump, refresh the jumps selected destination label as it might have changed (current selected input only)\n    if (input.jumps.length > 0) {\n        jumps.refreshInputJumpsDom(input, inputs);\n    }\n\n    //show current active input properties panel\n    //formbuilder.dom.input_properties.find('.panel-body form').removeClass('shown').addClass('hidden');\n    formbuilder.dom.input_properties.find('.panel-body form').css('display', 'none');\n    formbuilder.dom.input_properties.find('.panel-body form[data-input-ref=\"' + ref + '\"]').removeClass('hidden').fadeIn(consts.ANIMATION_NORMAL);\n\n\n    // //if the input type has possible answers, show pager if needed\n    if ($.inArray(input.type, consts.MULTIPLE_ANSWER_TYPES) > -1) {\n         // pager = formbuilder.dom.input_properties\n         //    .find('.panel-body form[data-input-ref=\"' + input.ref + '\"]')\n         //    .find('.possible-answers__list_pager');\n        if (input.possible_answers.length > consts.LIMITS.possible_answers_per_page) {\n            //show pagination\n            possible_answers_pager.init(input);\n        }\n        else {\n            possible_answers_pager.tearDown(input);\n        }\n    }\n\n    //show save/delete btns\n    formbuilder.dom.input_properties_buttons.fadeIn(consts.ANIMATION_FAST);\n\n    //hide message about no input selected, as input gets focus\n    formbuilder.dom.input_properties_no_input_selected.hide();\n\n    formbuilder.current_input_ref = ref;\n\n    if (input.type === consts.README_TYPE) {\n        $('.summernote').summernote(consts.SUMMERNOTE_OPTIONS);\n    }\n\n    //toggle copy button\n    copy_btn_state = input.dom.is_valid ? consts.BTN_ENABLED : consts.BTN_DISABLED;\n    ui.input_properties_panel.toggleCopyInputButton(input.ref, copy_btn_state);\n\n};\n\nmodule.exports = callback;\n","'use strict';\nvar consts = require('config/consts');\nvar messages = require('config/messages');\nvar formbuilder = require('config/formbuilder');\nvar utils = require('helpers/utils');\n\nvar callback = function (e) {\n\n    var input = utils.getInputObjectByRef(formbuilder.current_input_ref);\n\n    console.log(e.target);\n    console.log($(this));\n\n    input.dom.properties_panel = formbuilder.dom.input_properties_forms_wrapper.find('form[data-input-ref=\"' + input.ref + '\"]');\n\n    //get selected initial answer\n    var initial_answer = input.dom.properties_panel\n        .find('.input-properties__form__advanced-properties')\n        .find('.input-properties__form__advanced-properties__default')\n        .find('select').find(':selected');\n\n    console.log(initial_answer);\n\n    if (initial_answer.val() === input.default && input.default !== '') {\n        initial_answer.text(utils.getPossibleAnswerLabel(input));\n    }\n\n    console.log(input);\n    console.log('refresh initial answer');\n\n\n};\n\nmodule.exports = callback;\n","/* global $, toastr*/\n'use strict';\nvar formbuilder = require('config/formbuilder');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\n\nvar callback = function () {\n\n    var input = utils.getInputObjectByRef(formbuilder.current_input_ref);\n    var owner_branch;\n\n    //is editing a branch?\n    if (formbuilder.is_editing_branch) {\n        //override input to be the branch input\n        input = utils.getBranchInputObjectByRef(formbuilder.branch.current_input_ref);\n\n        //handle nested group inside a branch\n        if (formbuilder.is_editing_group) {\n            owner_branch = utils.getInputObjectByRef(formbuilder.branch.active_branch_ref);\n            input = utils.getNestedGroupInputObjectByRef(owner_branch, formbuilder.group.current_input_ref);\n        }\n    }\n    else {\n        //is editing a group?\n        if (formbuilder.is_editing_group) {\n            //override input to be the branch input\n            input = utils.getGroupInputObjectByRef(formbuilder.group.current_input_ref);\n        }\n    }\n\n    if ($(this).attr('data-jump-logic')) {\n        console.log('it is a jump');\n    }\n\n    if ($(this).attr('data-initial-answer')) {\n        console.log('multi select');\n        input.updatePossibleInitialAnswers();\n    }\n};\n\nmodule.exports = callback;\n","/* global $, toastr, File, saveAs*/\n'use strict';\nvar consts = require('config/consts');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar messages = require('config/messages');\nvar formbuilder = require('config/formbuilder');\nvar validation = require('actions/validation');\nvar input_duplicator = require('actions/input-duplicator');\nvar toast = require('config/toast');\n\n/*\n handle click action on input properties panel in the right sidebar (use event delegation)\n we check the class of the target element to trigger the proper action\n */\nvar callback = function (e) {\n\n    console.log('properties panel clicked.');\n\n    var undo = require('actions/undo');\n    var possible_answers = require('actions/possible-answers');\n    var input_factory = require('factory/input-factory');\n    //get hold of the current active input in the input collection (middle column)\n    var input = utils.getInputObjectByRef(formbuilder.current_input_ref);\n    var first_input_ref;\n    var nested_group;\n    var owner_branch;\n    //get hold of tapped element dom element\n    var target = $(this);\n    var csv;\n    var form_index = formbuilder.current_form_index;\n    var inputs = formbuilder.project_definition.data.project.forms[form_index].inputs;\n\n    formbuilder.render_action = consts.RENDER_ACTION_DO;\n\n    function _getInput() {\n\n        //check whether we are validatin a nested input i.e. BOTH branch AND group edit flags are true\n        if (formbuilder.is_editing_branch && formbuilder.is_editing_group) {\n            //get nested group input\n            owner_branch = utils.getInputObjectByRef(formbuilder.branch.active_branch_ref);\n            input = utils.getNestedGroupInputObjectByRef(owner_branch, formbuilder.group.current_input_ref);\n        }\n        else {\n            if (formbuilder.is_editing_branch) {\n                //get selected branch input\n                input = utils.getBranchInputObjectByRef(formbuilder.branch.current_input_ref);\n            }\n\n            if (formbuilder.is_editing_group) {\n                //get selected group input\n                input = utils.getGroupInputObjectByRef(formbuilder.group.current_input_ref);\n            }\n        }\n\n        return input;\n    }\n\n    function _validateBranch() {\n\n        //check the branch has got at least 1 input left\n\n        var active_branch = utils.getInputObjectByRef(formbuilder.branch.active_branch_ref);\n\n        if (active_branch.branch.length > 0) {\n            validation.performValidation(active_branch.branch[0], false);\n        }\n        else {\n            //invalid the form as it does not have any inputs\n            ui.forms_tabs.showFormInvalidIcon(formbuilder.current_form_index);\n\n            //disable save project button\n            ui.navbar.toggleSaveProjectBtn(consts.BTN_DISABLED);\n            formbuilder.dom.save_project_btn.off('click');\n        }\n    }\n\n    function _validateForm() {\n\n        var form_index = formbuilder.current_form_index;\n\n        if (formbuilder.project_definition.data.project.forms[form_index].inputs.length > 0) {\n            first_input_ref = formbuilder.project_definition.data.project.forms[form_index].inputs[0].ref;\n            if (first_input_ref) {\n                validation.performValidation(utils.getInputObjectByRef(first_input_ref), false);\n            }\n        }\n        else {\n            //invalid the form as it does not have any inputs\n            ui.forms_tabs.showFormInvalidIcon(formbuilder.current_form_index);\n\n            //disable save project button\n            ui.navbar.toggleSaveProjectBtn(consts.BTN_DISABLED);\n            formbuilder.dom.save_project_btn.off('click');\n\n            //add no question message\n            formbuilder.dom.inputs_collection.find('.input-properties__no-questions-message').removeClass('hidden');\n        }\n    }\n\n    //get hold of advanced properties panel for this input\n    input.dom.advanced_properties_wrapper = formbuilder\n        .dom\n        .input_properties_forms_wrapper\n        .find('form[data-input-ref=\"' + input.ref + '\"]')\n        .find('.input-properties__form__advanced-properties');\n\n    /***************************************************************\n     * Remove selected input\n     **************************************************************/\n    if (target.hasClass('input-properties__buttons--remove-input')) {\n\n        //re-nable draggable if needed\n        if ($('ul#inputs-tools-list li div.input').hasClass('dragging-disabled')) {\n            ui.input_tools.enable();\n        }\n\n        //enable save project button\n        ui.navbar.toggleSaveProjectBtn(consts.BTN_ENABLED);\n\n        //check whether we are validatin a nested input i.e. BOTH branch AND group edit flags are true\n        if (formbuilder.is_editing_branch && formbuilder.is_editing_group) {\n\n            //remove nested group\n            input_factory.removeNestedGroupInput(formbuilder.branch.active_branch_ref, formbuilder.group.current_input_ref);\n            toastr.warning(messages.warning.INPUT_DELETED);\n            _validateForm();\n            //push state to enable undoing the action (deleting input)\n            undo.pushState();\n            return;\n        }\n        else {\n\n            //nested group?\n            if (formbuilder.is_editing_branch && formbuilder.is_editing_group) {\n                //to handle nested group\n            }\n            else {\n\n                if (formbuilder.is_editing_branch) {\n                    input_factory.removeBranchInput(input.ref, formbuilder.branch.current_input_ref);\n                    toastr.warning(messages.warning.INPUT_DELETED);\n\n                    //run validation as I might have deleted the only invalid input for the branch\n                    //since there is not a previous one, so it uses the first input of the top parent form (if any) just to trigger the validation\n                    _validateBranch();\n\n                    //push state to enable undoing the action (deleting input)\n                    undo.pushState();\n                    return;\n                }\n\n                if (formbuilder.is_editing_group) {\n                    input_factory.removeGroupInput(input.ref, formbuilder.group.current_input_ref);\n                    toastr.warning(messages.warning.INPUT_DELETED);\n                    //push state to enable undoing the action (deleting input)\n                    undo.pushState();\n                    return;\n                }\n            }\n\n            //remove input from input collection (also remove its properties)\n            input_factory.removeInput(input.ref);\n            toastr.warning(messages.warning.INPUT_DELETED);\n\n            //todo I need to do the same for branches, groups and nested groups\n            //run validation as I might have deleted the only invalid input\n            //there is not a previous one, so it uses the first input of the top parent form (if any)\n            _validateForm();\n            //push state to enable undoing the action (deleting input)\n            undo.pushState();\n\n            //show message and import button when no inputs left\n\n            //remove no questions message and upload button, as now we have at least 1 input\n            //todo avoid to to this all the time?\n            if (inputs.length === 0) {\n                formbuilder.dom.inputs_collection\n                    .find('.input-properties__no-questions-message')\n                    .hide()\n                    .removeClass('hidden')\n                    .fadeIn();\n\n                //hide title warning message, passing a count > 1\n                ui.inputs_collection.toggleTitleWarning(1, false);\n\n                //disable download form button\n                formbuilder.dom.inputs_collection\n                    .find('.inputs-collection__export-form').addClass('disabled');\n\n                //disable print as pdf form button\n                formbuilder.dom.inputs_collection\n                    .find('.inputs-collection__print-as-pdf').addClass('disabled');\n            }\n            return;\n        }\n    }\n\n    /***************************************************************\n     * Copy selected input\n     **************************************************************/\n    if (target.hasClass('input-properties__buttons--copy-input')) {\n        console.log('copying input ***************************************************');\n\n        var input_copied;\n        var search_inputs_total = utils.getSearchInputsTotal();\n\n        input = _getInput();\n\n        //if the input is not valid, reject copy action\n        if (!input.dom.is_valid) {\n            toast.showError(messages.error.INPUT_NOT_VALID);\n            return;\n        }\n\n        //if we reached the max number of questions for this form, bail out\n        if (utils.getInputsTotal(inputs) >= consts.INPUTS_MAX_ALLOWED) {\n            toast.showError(messages.error.MAX_QUESTIONS_LIMIT_REACHED + ' ('+ consts.INPUTS_MAX_ALLOWED+')');\n            ui.input_tools.disable();\n            return;\n        }\n\n        //if the input is of type search and we reached the limit already, bail out\n        if(input.type === consts.SEARCH_SINGLE_TYPE || input.type === consts.SEARCH_MULTIPLE_TYPE) {\n\n            //warn the user if limit was reached\n            if (search_inputs_total === consts.LIMITS.search_inputs_max) {\n                toast.showError(messages.warning.SEARCH_INPUTS_LIMIT_REACHED + '(' + consts.LIMITS.search_inputs_max + ')');\n                return;\n            }\n            //if we are reaching the search input limits with this copy, hide search question tool\n            if (search_inputs_total === consts.LIMITS.search_inputs_max - 1) {\n                //hide search input from question list\n                ui.input_tools.hideSearchInput();\n            }\n        }\n\n        //show overlay\n        formbuilder.dom.overlay.fadeIn();\n\n        //get copy if original input\n        input_copied = input_duplicator.createInputCopy(input);\n\n        //add copied input to project definition\n        input_duplicator.pushInput(input_copied);\n\n        //append the copied input markup\n        input_duplicator.appendInputToDom(input_copied);\n\n        //hide overlay (with delay)\n        window.setTimeout(function () {\n            formbuilder.dom.overlay.fadeOut(consts.ANIMATION_FAST, function () {\n                toast.showSuccess(messages.success.INPUT_COPIED);\n            });\n        }, consts.ANIMATION_SLOW);\n    }\n\n    /***************************************************************\n     * Validate selected input\n     **************************************************************/\n    if (target.hasClass('input-properties__buttons--validate-input')) {\n        validation.performValidation(_getInput(), true);\n    }\n\n    /***************************************************************\n     * Add possible answer\n     **************************************************************/\n    if (target.hasClass('input-properties__form__possible-answers__add-answer')) {\n\n        var possible_answers_max = consts.LIMITS.possible_answers_max;\n\n        input = _getInput();\n\n        if (input.type === consts.SEARCH_SINGLE_TYPE || input.type === consts.SEARCH_MULTIPLE_TYPE) {\n            possible_answers_max = consts.LIMITS.possible_answers_max_search;\n        }\n\n        //add possible answer (if total is less than max allowed)\n        if (input.possible_answers.length < possible_answers_max) {\n            input.addPossibleAnswer();\n            undo.pushState();\n        }\n    }\n\n    /***************************************************************\n     * Remove possible answer\n     **************************************************************/\n    if (target.hasClass('input-properties__form__possible-answers__list__remove-answer')) {\n\n        input = _getInput();\n\n        //we need to leave at least 1 possible answer\n        if (input.possible_answers.length >= 2) {\n            input.removePossibleAnswer(target.closest('li').index());\n            undo.pushState();\n        }\n    }\n\n    /***************************************************************\n     * Add jump to selected input\n     **************************************************************/\n    if (target.hasClass('input-properties__form__jumps__add-jump')) {\n\n        input = _getInput();\n\n        //disable save project button as the new added jump makes the input invalid\n        ui.navbar.toggleSaveProjectBtn(consts.BTN_DISABLED);\n\n        //set input as invalid\n        input.dom.is_valid = false;\n\n        //flag input dom in input collection as invalid\n        ui.inputs_collection.showInputInvalidIcon(input.ref);\n\n        //flag current form as invalid\n        ui.forms_tabs.showFormInvalidIcon(formbuilder.current_form_index);\n\n        input.addJump();\n        undo.pushState();\n    }\n\n    /***************************************************************\n     * Remove selected jump\n     **************************************************************/\n    if (target.hasClass('input-properties__form__jumps__remove-jump')) {\n\n        input = _getInput();\n\n        input.removeJump(target);\n\n        //revalidate input after deleting a jump as the jump might have been the only thing keeping it invalid\n        validation.performValidation(input, false);\n        undo.pushState();\n    }\n\n    /***************************************************************\n     * Edit branch\n     **************************************************************/\n    if (target.hasClass('input-properties__form__edit-branch')) {\n        target.attr('disabled', true);\n        input.enterBranchSortable();\n    }\n    if (target.hasClass('input-properties__form__exit-branch-editing')) {\n        target.attr('disabled', true);\n        target.prev('.input-properties__form__edit-branch').attr('disabled', false);\n        input.exitBranchSortable();\n    }\n\n    /***************************************************************\n     * Edit group\n     **************************************************************/\n    if (target.hasClass('input-properties__form__edit-group')) {\n        target.attr('disabled', true);\n\n        //check whether we are editing a group nested into a branch\n        if (formbuilder.is_editing_branch) {\n\n            nested_group = utils.getBranchInputObjectByRef(formbuilder.branch.current_input_ref);\n\n            if (nested_group) {\n                //user clicked on edit nested group button\n                input = nested_group;\n                input.enterGroupSortable(true);\n            }\n        }\n        else {\n            input.enterGroupSortable(false);\n        }\n    }\n\n    if (target.hasClass('input-properties__form__exit-group-editing')) {\n        target.attr('disabled', true);\n        target.prev('.input-properties__form__edit-branch').attr('disabled', false);\n\n        //check whether we are editing a group nested into a branch\n        if (formbuilder.is_editing_branch) {\n            nested_group = utils.getBranchInputObjectByRef(formbuilder.branch.current_input_ref);\n\n            if (nested_group) {\n                //user clicked on edit nested group button\n                input = nested_group;\n                input.exitGroupSortable(true);\n            }\n        }\n        else {\n            input.exitGroupSortable(false);\n        }\n    }\n\n    if (target.hasClass('possible_answers__export-csv')) {\n\n        //show overlay and cursor\n        formbuilder.dom.overlay.fadeIn(0);\n\n        csv = possible_answers.exportPossibleAnswersCSV();\n\n        window.setTimeout(function () {\n            formbuilder.dom.overlay.fadeOut(consts.ANIMATION_FAST);\n\n            if (csv) {\n                //do export\n                var file;\n\n                try {\n                    file = new File([csv.data], csv.filename, { type: 'text/plain:charset=utf-8' });\n                    saveAs(file);\n                }\n                catch (error) {\n                    //Microsoft browsers?\n                    if (navigator.msSaveBlob) {\n                        return navigator.msSaveBlob(new Blob([csv.data], { type: 'text/plain:charset=utf-8' }), csv.filename);\n                    }\n                    else {\n                        //browser not supported yet\n                        toast.showError(messages.error.BROWSER_NOT_SUPPORTED);\n                    }\n                }\n            }\n            else {\n                //show error\n                toast.showError(messages.error.POSSIBLE_ANSWERS_INVALID);\n            }\n        }, consts.ANIMATION_SUPER_SLOW);\n    }\n\n    if (target.hasClass('possible_answers__import-csv')) {\n\n        //import file first then show modal to pick which column (if more than one)\n        //todo not use window, use formbuilder object\n        if (!formbuilder.isOpeningFileBrowser) {\n\n            var file_input = target.find('.possible_answers__import-csv-input-file');\n\n            formbuilder.isOpeningFileBrowser = true;\n\n            file_input.off('change').on('change', function () {\n                possible_answers.importCSVFile(this.files);\n                $(this).val(null);\n            });\n\n            target.find('.possible_answers__import-csv-input-file').trigger('click');\n        }\n\n        //to avoid a infinte loop (since we are triggering the click event)\n        //we remove the flag later, to be able to upload another file\n        //even if the user tapped on \"cancel\"\n        window.setTimeout(function () {\n            formbuilder.isOpeningFileBrowser = false;\n        }, 3000);\n\n    }\n\n    if (target.hasClass('possible_answers__delete-all')) {\n        possible_answers.deleteAllAnswers();\n    }\n\n    if (target.hasClass('possible_answers__order-az')) {\n        possible_answers.orderPossibleAnswers(consts.POSSIBLE_ANSWERS_ORDER.AZ);\n    }\n\n    if (target.hasClass('possible_answers__order-za')) {\n        possible_answers.orderPossibleAnswers(consts.POSSIBLE_ANSWERS_ORDER.ZA);\n    }\n\n    if (target.hasClass('possible_answers__order-shuffle')) {\n        possible_answers.orderPossibleAnswers(consts.POSSIBLE_ANSWERS_ORDER.SHUFFLE);\n    }\n\n};\n\nmodule.exports = callback;\n","/* global $, toastr*/\n'use strict';\nvar consts = require('config/consts');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar jumps = require('actions/jumps');\nvar messages = require('config/messages');\nvar formbuilder = require('config/formbuilder');\n\nvar callback = function (e) {\n\n    var input = utils.getInputObjectByRef(formbuilder.current_input_ref);\n    var inputs = formbuilder.project_definition.data.project.forms[formbuilder.current_form_index].inputs;\n    var jump_destinations;\n    var owner_branch;\n\n    //is editing a branch?\n    if (formbuilder.is_editing_branch) {\n        //override inputs, get branch inputs from owner input\n        inputs = input.branch;\n        //override input to be the branch input\n        input = utils.getBranchInputObjectByRef(formbuilder.branch.current_input_ref);\n\n        //handle nested group inside a branch\n        if (formbuilder.is_editing_group) {\n            inputs = input.group;\n            owner_branch = utils.getInputObjectByRef(formbuilder.branch.active_branch_ref);\n            input = utils.getNestedGroupInputObjectByRef(owner_branch, formbuilder.group.current_input_ref);\n        }\n    }\n    else {\n        //is editing a group?\n        if (formbuilder.is_editing_group) {\n            //override inputs, get group inputs from owner input\n            inputs = input.group;\n            //override input to be the branch input\n            input = utils.getGroupInputObjectByRef(formbuilder.group.current_input_ref);\n        }\n    }\n\n    //get all jumps available\n    jump_destinations = utils.getJumpAvailableDestinations(input, inputs);\n\n    //check if the <select> is either a jump logic or a multiple choice input\n    if ($(this).attr('data-jump-logic')) {\n\n        var focused_select = $(this);\n        var focused_select_id = focused_select.attr('id');\n\n        //split on the dash to remove the first part of \"focused_select_id\" as it can\n        //be 1-, 2-, 11-, 45-.... so:\n        var focused_select_id_parts = focused_select_id.split('-');\n        focused_select_id_parts.shift();\n        focused_select_id = focused_select_id_parts.join('-');\n        //todo the above is faster with a regex, when there is time...\n\n        switch (focused_select_id) {\n\n            //for open answer input type like  'text', this will be set to 'always'\n            case input.ref + '-logic-when':\n                //list al the available conditions\n                jumps.listJumpConditions(focused_select);\n                break;\n            /*\n             get all possible answers for current input and list them as options\n             (for open answer input type like  'text', this will be hidden)\n             */\n            case input.ref + '-logic-answer':\n                jumps.listJumpPossibleAnswers(focused_select, input);\n                break;\n\n            //get all possible jump destinations for current input and list them as options\n            case input.ref + '-logic-goto':\n                jumps.listJumpDestinations(focused_select, jump_destinations);\n                break;\n        }\n    }\n    else {\n        input.listPossibleInitialAnswers();\n    }\n};\n\nmodule.exports = callback;\n","/* global $, toastr*/\n'use strict';\nvar consts = require('config/consts');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar jumps = require('actions/jumps');\nvar messages = require('config/messages');\nvar formbuilder = require('config/formbuilder');\nvar validation = require('actions/validation');\n\nvar callback = function (e) {\n\n    //ignore left and right arrow keyboard keys (otherwise the user cannot edit a string)\n    //from the docs:\n    // The event.which property normalizes event.keyCode and event.charCode.\n    // It is recommended to watch event.which for keyboard key input.\n    if (e.which === 37 || e.which === 39) {\n        return;\n    }\n\n    var input;\n    var input_question_validation;\n    var possible_answer_validation;\n    var target = $(this);\n    var undo = require('actions/undo');//it is here otherwise it breaks when compiling...go figure??\n    // Capture initial cursor position, as we are replacing the input value on keyup, to avoid the cursor go to the end of the string\n    var position = target[0].selectionStart;\n\n    function _inputIsValid() {\n\n        input.dom.is_valid = true;\n\n        //validate input to refresh dom\n        validation.performValidation(input, false);\n\n        target[0].selectionEnd = position;    // Set the cursor back to the initial position.\n    }\n\n    function _getInput() {\n\n        var input = utils.getInputObjectByRef(formbuilder.current_input_ref);\n        var current_branch;\n\n        //check whether we are validatin a nested input i.e. BOTH branch AND group edit flags are true\n        if (formbuilder.is_editing_branch && formbuilder.is_editing_group) {\n\n            //get owner branch\n            current_branch = utils.getInputObjectByRef(formbuilder.branch.active_branch_ref);\n\n            //get nested group input\n            input = utils.getNestedGroupInputObjectByRef(current_branch, formbuilder.group.current_input_ref);\n        }\n        else {\n            if (formbuilder.is_editing_branch) {\n                //get selected branch input\n                input = utils.getBranchInputObjectByRef(formbuilder.branch.current_input_ref);\n            }\n\n            if (formbuilder.is_editing_group) {\n                //get selected group input\n                input = utils.getGroupInputObjectByRef(formbuilder.group.current_input_ref);\n            }\n        }\n\n        return input;\n    }\n\n    input = _getInput();\n    //get handle of input properties panel\n    input.dom.properties_panel = formbuilder.dom.input_properties_forms_wrapper.find('form[data-input-ref=\"' + input.ref + '\"]');\n\n    //hide errors\n    input.hideQuestionErrors();\n\n    if (target.parent().hasClass('input-properties__form__question')) {\n        //get question\n        input.question = $(this).val();\n\n        //validate question or header\n        if (input.type === consts.BRANCH_TYPE || input.type === consts.GROUP_TYPE) {\n            input_question_validation = input.isHeaderTextValid();\n        }\n        else {\n            input_question_validation = input.isQuestionTextValid();\n        }\n\n        if (!input_question_validation.is_valid) {\n            // warn user question text is wrong\n            input.dom.is_valid = false;\n\n            //highlight wrong input and show error message\n            input.showQuestionErrors(input_question_validation.error.message);\n\n            //disable edit btn for groups or branches\n            if (input.type === consts.BRANCH_TYPE || input.type === consts.GROUP_TYPE) {\n                input.toggleEditButton(false);\n            }\n\n            //validate all inputs (to toggle save project button on keyup)\n            validation.performValidation(input, false);\n            target[0].selectionEnd = position;    // Set the cursor back to the initial position.\n        }\n        else {\n\n            //branch and group inputs are invalid if they do not have any inputs\n            if (input.type === consts.BRANCH_TYPE || input.type === consts.GROUP_TYPE) {\n\n                //enable edit btn for groups or branches\n                input.toggleEditButton(true);\n\n                if (input.type === consts.BRANCH_TYPE && input.branch.length === 0) {\n                    input.dom.is_valid = false;\n                }\n                if (input.type === consts.GROUP_TYPE && input.group.length === 0) {\n                    input.dom.is_valid = false;\n                }\n                if (input.dom.is_valid) {\n                    _inputIsValid();\n                }\n            }\n            else {\n                _inputIsValid();\n            }\n        }\n    }\n\n    if (target.parent().hasClass('input-properties__form__possible-answers__list__possible_answer_item')) {\n\n        possible_answer_validation = validation.isPossibleAnswerValid(target.val());\n\n        //validate each possible answer and show embedded errors if any\n        if (!possible_answer_validation.is_valid) {\n            // warn user question text is wrong\n            input.dom.is_valid = false;\n\n            //highlight wrong answer and show error message\n            input.showPossibleAnswerErrors(target.parent().parent(), possible_answer_validation.error.message);\n\n            validation.performValidation(input, false);\n            target[0].selectionEnd = position;    // Set the cursor back to the initial position.\n\n        } else {\n            _inputIsValid();\n        }\n    }\n\n    //push state to enable undoing the action (typing) passing \"true\" so it gets a bit of throttling\n    undo.pushState(true);\n};\n\nmodule.exports = callback;\n","/* global $, Ftoastr*/\n'use strict';\nvar formbuilder = require('config/formbuilder');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar save = require('actions/save');\n\nvar callback = function () {\n\n    var count;\n    var inputs = [];\n    var active_input;\n    var active_branch;\n\n    if (formbuilder.is_editing_branch) {\n\n        active_branch = utils.getInputObjectByRef(formbuilder.branch.active_branch_ref);\n\n        //group in a branch?\n        if (formbuilder.is_editing_group) {\n            //set active input to be the active group input\n            active_input = utils.getNestedGroupInputObjectByRef(active_branch, formbuilder.group.current_input_ref);\n        }\n        else {\n            active_input = utils.getBranchInputObjectByRef(formbuilder.branch.current_input_ref);\n        }\n\n        //save current input\n        save.saveProperties(active_input);\n\n        inputs = active_branch.branch;\n        count = utils.getTitleCount(inputs);\n        ui.inputs_collection.toggleTitleWarning(count, true);\n\n    }\n    else {\n        //is it a group?\n        if (formbuilder.is_editing_group) {\n            //set active input to be the active group input\n            active_input = utils.getGroupInputObjectByRef(formbuilder.group.current_input_ref);\n        }\n        else {\n            //form level input\n            active_input = utils.getInputObjectByRef(formbuilder.current_input_ref);\n        }\n        //save current input\n        save.saveProperties(active_input);\n\n        inputs = formbuilder.project_definition.data.project.forms[formbuilder.current_form_index].inputs;\n        count = utils.getTitleCount(inputs);\n        //if there is not any title set form the form, show warning\n        ui.inputs_collection.toggleTitleWarning(count, false);\n    }\n};\n\nmodule.exports = callback;\n","/* global $, toastr*/\n'use strict';\nvar messages = require('config/messages');\nvar validation = require('actions/validation');\nvar errors = require('actions/errors');\nvar formbuilder = require('config/formbuilder');\nvar consts = require('config/consts');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar form_factory = require('factory/form-factory');\nvar save_project_click_callback = require('ui-handlers/event-handler-callbacks/save-project-click-callback');\nvar undo = require('actions/undo');\n\nvar callback = function (evt) {\n\n    var target = $(evt.relatedTarget);// Button that triggered the modal\n    var modal = $(this);\n    var form_name_input;\n    var form_ref;\n    var is_adding_new_form = false;\n    var form = {};\n    var next_form_index;\n\n    //get partial\n    modal.html(formbuilder.dom.partials.modal_edit_form_name);\n    form_name_input = modal.find('.modal-body input');\n\n    //validate on keyup for better UX todo\n    form_name_input.on('keyup', function () {\n        console.log('activated');\n    });\n\n    if (target.hasClass('main__tabs_add-form')) {\n        console.log('************ - add new form - **************');\n        //todo\n        is_adding_new_form = true;\n        form_ref = utils.generateFormRef();\n        next_form_index = formbuilder.project_definition.data.project.forms.length;\n    }\n    else {\n        //set current form name in modal\n        form_name_input.val(formbuilder.project_definition.data.project.forms[formbuilder.current_form_index].name);\n        form_ref = formbuilder.current_form_ref;\n    }\n\n    //bind save changes button\n    $('.main__modal--edit-form-name__save-btn').off().on('click', function () {\n\n        //get updated value\n        var name = form_name_input.val();\n        var is_form_name_valid;\n        var form_index = formbuilder.current_form_index;\n        var forms = formbuilder.project_definition.data.project.forms;\n\n        //hide errors\n        errors.hideFormNameErrors(modal);\n\n        //validate form name\n        is_form_name_valid = validation.isFormNameValid(name, is_adding_new_form);\n\n        if (!is_form_name_valid.is_valid) {\n            //show errors\n            errors.showFormNameErrors(modal, is_form_name_valid.error.message);\n        }\n        else {\n\n            //disable button to avoid double clicks\n            $(this).off().attr('disabled', true);\n\n            if (is_adding_new_form) {\n\n                //add child form\n                form_factory.createChildForm(name, form_ref, next_form_index, true);\n\n                //disable save project button as we do not accept empty forms\n                ui.navbar.toggleSaveProjectBtn(consts.BTN_DISABLED);\n\n                undo.pushState();\n            }\n            else {\n                //update name for current form\n                formbuilder.project_definition.data.project.forms[form_index].name = name;\n                formbuilder.project_definition.data.project.forms[form_index].slug = utils.slugify(name);\n\n                //show name of form in tab and inputs collection container, truncating form name (>10) for UI purposes\n                formbuilder.dom.inputs_collection.find('.inputs-collection__header__element-name')\n                    .text(name.trunc(consts.TAB_FORM_NAME_MAX_DISPLAY_LENGHT - (forms.length * 2)));\n\n                //tab, target the active one\n                formbuilder.dom.forms_tabs.find('.active a')\n                    .text(name.trunc(consts.TAB_FORM_NAME_MAX_DISPLAY_LENGHT - (forms.length * 2)))\n                    .append('&nbsp;<i class=\"form-state fa fa-check\"></i>');\n\n                //enable save project button\n                ui.navbar.toggleSaveProjectBtn(consts.BTN_ENABLED);\n                formbuilder.dom.save_project_btn.off().on('click', save_project_click_callback);\n            }\n\n            //hide add child form button if the form total is MAX_NUMBER_OF_NESTED_CHILD_FORMS\n            if (formbuilder.project_definition.data.project.forms.length === consts.MAX_NUMBER_OF_NESTED_CHILD_FORMS) {\n                formbuilder.dom.forms_tabs.find('.main__tabs_add-form').parent().hide();\n            }\n\n            //resize form tabs\n            ui.forms_tabs.resizeFormTabs();\n\n            //close modal (with a little delay for better UX, no FOUC)\n            window.setTimeout(function () {\n                modal.modal('hide');\n                //force a backdrop removal as sometimes it is triggered twice\n                $('.modal-backdrop').remove();\n            }, 100);\n        }\n    });\n};\n\nmodule.exports = callback;\n\n\n","/* global $, toastr*/\n'use strict';\nvar formbuilder = require('config/formbuilder');\nvar consts = require('config/consts');\n\n//todo maybe this callback is not needed anymore\nvar callback = function () {\n\n    //get hold of modal;\n    var modal = $(this);\n\n    //bind buttons\n    $('.table').on('click', '.btn', function () {\n\n        var button = $(this);\n        var current_input_regex_property = formbuilder.dom.input_properties_forms_wrapper\n            .find('form[data-input-ref=\"' + formbuilder.current_input_ref + '\"]')\n            .find('.input-properties__form__advanced-properties__regex input');\n\n        //apply the selected regex\n        current_input_regex_property.val(consts.REGEX[button.attr('data-apply-regex')]);\n\n        modal.modal('hide');\n    });\n};\n\nmodule.exports = callback;\n","/* global $, toastr*/\n'use strict';\nvar consts = require('config/consts');\nvar messages = require('config/messages');\nvar formbuilder = require('config/formbuilder');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar validation = require('actions/validation');\nvar toast = require('config/toast');\n\nvar callback = function (e) {\n\n    function _renderQuestion(input) {\n\n        //strip html tags from readme type if any\n        if (input.type === consts.README_TYPE) {\n            input.question = utils.decodeHtml(input.question);\n            input.question = input.question.replace(/(<([^>]+)>)/ig, ' ');\n            html += '<hr/>';\n        }\n\n        html += '<h4 class=\"question\">' + input.question + '</h4>';\n\n        if (input.type === consts.TEXTAREA_TYPE) {\n            html += '<table border=\"1\" width=\"100%\">';\n            html += '<tr><td></td></td></tr>';\n            html += '<tr><td></td></td></tr>';\n            html += '<tr><td></td></td></tr>';\n            html += '<tr><td></td></td></tr>';\n            html += '</table>';\n        }\n        else {\n            if (input.type !== consts.README_TYPE) {\n                html += '<table border=\"1\" width=\"100%\">';\n                html += '<tr><td></td></td></tr>';\n                html += '</table>';\n            }\n            else{\n                html += '<hr/>';\n            }\n        }\n    }\n\n    function _renderPossibleAnswers(input) {\n        $.each(input.possible_answers, function (index, possible_answer) {\n\n            switch (input.type) {\n                case consts.SEARCH_SINGLE_TYPE:\n                case consts.SEARCH_MULTIPLE_TYPE:\n\n                    if (index === 0) {\n                        html += '<ul class=\"possible-answers-list\">';\n                    }\n\n                    html += '<li><h5>' + possible_answer.answer + '</h5></li>';\n\n                    if (index === input.possible_answers.length - 1) {\n                        html += '</ul>';\n                    }\n                    break;\n                //render dropdown and radio as radio buttons (single choice)\n                case consts.DROPDOWN_TYPE:\n                case consts.RADIO_TYPE:\n                    html += '<div class=\"radio-type\"><h5>';\n                    html += '<input type=\"radio\"  value=\"' + possible_answer.answer + '\">';\n                    html += '<label for=\"' + possible_answer.answer + '\">' + possible_answer.answer + '</label>';\n                    html += '</h5></div>';\n                    break;\n                case consts.CHECKBOX_TYPE:\n                    html += '<div class=\"checkbox-type\"><h5>';\n                    html += '<input type=\"checkbox\"  value=\"' + possible_answer.answer + '\">';\n                    html += '<label for=\"' + possible_answer.answer + '\">' + possible_answer.answer + '</label>';\n                    html += '</h5></div>';\n                    break;\n                default:\n                //do nothing\n            }\n        });\n    }\n\n\n    var html = '';\n\n    //add form title\n    html += '';\n    var index = formbuilder.current_form_index;\n\n    //create a deep copy of the project object properties\n    var project_definition_json = CircularJSON.parse(CircularJSON.stringify(formbuilder.project_definition));\n    var is_valid_form = true;\n    var project_slug = project_definition_json.data.project.slug;\n    var form = project_definition_json.data.project.forms[index];\n\n    if (form.inputs.length === 0) {\n        toast.showError(messages.error.FORM_IS_INVALID);\n        return;\n    }\n\n    //print project name as header\n    html += '<h2>' + project_definition_json.data.project.name + '</h2>';\n\n    //print form name as header\n    html += '<h3>' + form.name + '</h3>';\n\n    $(form.inputs).each(function (inputIndex, input) {\n\n        //get valid jump destinations\n        var jump_destinations = utils.getJumpAvailableDestinationsAsKeys(inputIndex, input, form.inputs, false);\n\n        //extra validation for jumps, check if the destination still exists and it is valid\n        $(input.jumps).each(function (jumpIndex, jump) {\n            //does the jump \"to\" property reference a valid destination input?\n            if (!jump_destinations[jump.to]) {\n                //invalid destination found\n                is_valid_form = false;\n            }\n        });\n\n        switch (input.type) {\n\n            case consts.BRANCH_TYPE:\n                html += '<h4 class=\"branch-header\">' + input.question + '</h4>';\n\n                html += '<table border=\"1\" cellpadding=\"10\" cellspacing=\"10\">';\n                html += '<tr>';\n                html += '<td>';\n\n                $(input.branch).each(function (branchInputIndex, branch_input) {\n\n                    if (!branch_input.dom.is_valid) {\n                        is_valid_form = false;\n                    }\n\n                    delete branch_input.dom;\n\n                    //todo validate branch jumps\n                    jump_destinations = utils.getJumpAvailableDestinationsAsKeys(branchInputIndex, branch_input, input.branch, true);\n\n                    //extra validation for jumps, check if the destination still exists and it is valid\n                    $(branch_input.jumps).each(function (branchJumpIndex, branchJump) {\n                        //does the jump \"to\" property reference a valid destination input?\n                        if (!jump_destinations[branchJump.to]) {\n                            //invalid destination found\n                            is_valid_form = false;\n                        }\n                    });\n\n                    //multiple choice question?\n                    if ($.inArray(branch_input.type, consts.MULTIPLE_ANSWER_TYPES) !== -1) {\n                        html += '<h4 class=\"question\">' + branch_input.question + '</h4>';\n                        //render possible answers\n                        _renderPossibleAnswers(branch_input);\n                    }\n                    else {\n                       _renderQuestion(branch_input);\n                    }\n\n                    $(branch_input.group).each(function (index, group_input) {\n\n                        if (!group_input.dom.is_valid) {\n                            is_valid_form = false;\n                        }\n                        delete group_input.dom;\n\n                        //multiple choice question?\n                        if ($.inArray(group_input.type, consts.MULTIPLE_ANSWER_TYPES) !== -1) {\n                            html += '<h4 class=\"question\">' + group_input.question + '</h4>';\n                            //render possible answers\n                            _renderPossibleAnswers(group_input);\n                        }\n                        else {\n                            _renderQuestion(group_input);\n                        }\n                    });\n                });\n\n                html += '</td>';\n                html += '</tr>';\n                html += '</table>';\n                break;\n\n            case consts.GROUP_TYPE:\n                html += '<h4 class=\"group-header\">' + input.question + '</h4>';\n\n                html += '<table border=\"1\" cellpadding=\"10\" cellspacing=\"10\">';\n                html += '<tr>';\n                html += '<td>';\n\n\n                $(input.group).each(function (index, group_input) {\n                    if (!group_input.dom.is_valid) {\n                        is_valid_form = false;\n                    }\n                    delete group_input.dom;\n\n                    //multiple choice question?\n                    if ($.inArray(group_input.type, consts.MULTIPLE_ANSWER_TYPES) !== -1) {\n                        html += '<h4 class=\"question\">' + group_input.question + '</h4>';\n                        //render possible answers\n                        _renderPossibleAnswers(group_input);\n                    }\n                    else {\n                       _renderQuestion(group_input);\n                    }\n                });\n\n                html += '</td>';\n                html += '</tr>';\n                html += '</table>';\n                break;\n\n            default:\n                //multiple choice question?\n                if ($.inArray(input.type, consts.MULTIPLE_ANSWER_TYPES) !== -1) {\n                    html += '<h4 class=\"question\">' + input.question + '</h4>';\n                    //render possible answers\n                    _renderPossibleAnswers(input);\n                }\n                else {\n                    //open answer question\n                    _renderQuestion(input);\n                }\n        }\n\n        if (!input.dom.is_valid) {\n            is_valid_form = false;\n        }\n        delete input.dom;\n    });\n\n    if (is_valid_form) {\n        //do print\n        $('.print-preview-wrapper').empty().append(html);\n        window.print();\n    }\n    else {\n        toast.showError(messages.error.FORM_IS_INVALID);\n    }\n};\n\nmodule.exports = callback;\n","/* global $, toastr, Flatted, require */\n'use strict';\nvar consts = require('config/consts');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar messages = require('config/messages');\nvar formbuilder = require('config/formbuilder');\nvar jumps = require('actions/jumps');\nvar save = require('actions/save');\nvar toast = require('config/toast');\n\n\n/*\n handle click action on save project button\n */\nvar callback = function (e) {\n\n    //for testing\n    var url = '../postdump/index.php';\n    var validation = require('actions/validation');\n    var current_input = utils.getCurrentlySelectedInput();\n\n    /***************************************************************\n     * Save project\n     **************************************************************/\n\n    //save the currently selected input just in case\n    if (current_input) {\n        validation.performValidation(utils.getCurrentlySelectedInput(), false);\n    }\n\n\n\n    //create a deep copy of the project object properties\n    var project_definition_json = Flatted.parse(Flatted.stringify(formbuilder.project_definition));\n    //clean up forms from extra properties\n\n    var cleanedForms = save.doCleaningBeforeSaving(project_definition_json.data.project.forms);\n\n    if (cleanedForms.all_jumps_valid && cleanedForms.invalid_jumps_question === '') {\n\n        //*****************************************************************************************************\n        //after cleaning, do extra validation, the same one that runs when importing a form -------------------------\n        var result = {\n            is_valid: true,\n            error: {\n                message: null\n            }\n        };\n\n        $(project_definition_json.data.project.forms).each(function (formIndex, form) {\n\n            var validateBeforeSaving = require('actions/validation').validateBeforeSaving;\n\n            result = validateBeforeSaving(form.ref, form.inputs);\n\n            if (!result.is_valid) {\n                return false;//exit loop\n            }\n        });\n\n        //catch forms invalid here\n        if (!result.is_valid) {\n            toast.showError(result.error.message);\n            return false;\n        }\n\n        //******************************************************************************************************\n        //all valid, start saving ------------------------------------------------------------------------------\n\n        //show overlay and cursor\n        formbuilder.dom.overlay.fadeIn(consts.ANIMATION_FAST);\n\n        //for local testing only\n        if (window.location.href.indexOf('localhost/') !== -1 && window.location.href.indexOf('epicollect5-formbuilder/') !== -1) {\n            consts.PROJECT_URL = url;\n        }\n\n        $.ajax({\n            url: consts.PROJECT_URL,\n            //  contentType: 'application/vnd.api+json',\n            data: window.btoa(pako.gzip(JSON.stringify(project_definition_json), {\n                'to': 'string'\n            }\n            )),\n            //  data: JSON.stringify(project_definition_json),\n            //   dataType: 'json',\n            method: 'POST',\n            crossDomain: true,\n            success: function (data) {\n                window.setTimeout(function () {\n                    formbuilder.dom.overlay.fadeOut(consts.ANIMATION_FAST, function () {\n                        toast.showSuccess(messages.success.PROJECT_SAVED);\n                    });\n\n                }, consts.ANIMATION_SLOW);\n                console.log(data);\n                console.log('posted successfully');\n\n            },\n            error: function (xhr, error, response) {\n\n                var error_obj;\n                var titles = '';\n\n                try {\n                    error_obj = JSON.parse(xhr.responseText);\n                    console.log(xhr.responseText);\n                    console.log(xhr, error, response);\n                    //get server errors\n                    $(error_obj.errors).each(function (index, error) {\n                        titles += '<br/>' + error.title;\n                    });\n                } catch (error) {\n                    console.log(error);\n                }\n                formbuilder.dom.overlay.fadeOut(consts.ANIMATION_FAST);\n                toast.showError(messages.error.PROJECT_NOT_SAVED + titles, 3000);\n            }\n        }\n        );\n    }\n    else {\n        toast.showError(messages.error.JUMP_INVALID + cleanedForms.invalid_jumps_question);\n    }\n};\n\nmodule.exports = callback;\n","'use strict';\nvar formbuilder = require('config/formbuilder');\nvar messages = require('config/messages');\nvar validation = require('actions/validation');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar consts = require('config/consts');\nvar input_properties_keyup_callback = require('ui-handlers/event-handler-callbacks/input-properties-keyup-callback');\nvar template = require('template');\nvar toast = require('config/toast');\nvar possibleAnswersSortable = require('ui-handlers/possible-answers-sortable');\n\nvar group_sortable = function () {\n\n    var group_input;\n\n    return {\n        cursor: 'move',\n        items: '.input',\n        revert: 100,\n        //axis: 'y',// it causes the placeholder to be always active\n        containment: 'parent',\n        tolerance: 'pointer',\n        // forcePlaceholderSize: true,\n        placeholder: 'input-collection-drop-placeholder',\n\n        //triggered when a new input is dropped over the sortable\n        receive: function (e, jquery_ui) {\n\n            var form_index = formbuilder.current_form_index;\n            var previous_group_input_ref = formbuilder.group.current_input_ref;\n            var current_element;\n            var group_inputs = utils.getInputObjectByRef(formbuilder.current_input_ref).group;\n            var group_input_ref = utils.generateBranchGroupInputRef(formbuilder.current_input_ref);\n            var group_input_index = group_inputs.length;\n            var group_input_type = jquery_ui.item.attr('data-type');\n            var input_factory = require('factory/input-factory');\n            var owner_branch;\n\n            //if we are editing a branch, it means this is a nested group, update references accordingly\n            if (formbuilder.is_editing_branch) {\n                console.log('we are editing a nested group');\n\n                group_inputs = utils.getBranchInputObjectByRef(formbuilder.branch.current_input_ref).group;\n                group_input_ref = utils.generateBranchGroupInputRef(formbuilder.branch.current_input_ref);\n                group_input_index = group_inputs.length;\n            }\n\n            //do not consider group/branch inputs within a group\n            if (group_input_type === consts.BRANCH_TYPE || group_input_type === consts.GROUP_TYPE) {\n                return false;\n            }\n            else {\n\n                formbuilder.group.current_input_ref = group_input_ref;\n\n                //validate previous input (if any) to show embedded errors (in case the user did not press validate button)\n                //todo is this an overkill?\n                if (previous_group_input_ref) {\n\n                    if (formbuilder.is_editing_branch) {\n                        //this is a nested group,get owner branch\n                        owner_branch = utils.getInputObjectByRef(formbuilder.branch.active_branch_ref);\n\n                        validation.performValidation(utils.getNestedGroupInputObjectByRef(owner_branch, previous_group_input_ref), false);\n                    }\n                    else {\n                        validation.performValidation(utils.getGroupInputObjectByRef(previous_group_input_ref), false);\n                    }\n\n                }\n\n                console.log('group sortable receive');\n\n                formbuilder.group.collection_is_being_sorted = false;\n\n                //generate input object based on type and set index incrementally\n                group_input = input_factory.createInput(group_input_type, group_input_ref);\n                console.log(group_input);\n\n                //disable current active element\n                current_element = formbuilder.dom.inputs_collection_sortable.find('.active');\n                current_element.removeClass('active');\n\n                //add input to collection as the last one\n                group_inputs.push(group_input);\n            }\n\n            //disable save project button as by default an input is invalid when it is created\n            ui.navbar.toggleSaveProjectBtn(consts.BTN_DISABLED);\n        },\n        stop: function (e, jquery_ui) {\n\n            var undo = require('actions/undo');\n            var form_index = formbuilder.current_form_index;\n            var group_input_ref = formbuilder.group.current_input_ref;\n            var owner_input_ref = formbuilder.current_input_ref;\n            var owner_input_index = utils.getInputCurrentIndexByRef(owner_input_ref);\n            var inputs = formbuilder.project_definition.data.project.forms[form_index].inputs;\n            var group_inputs = inputs[owner_input_index].group;\n            var placeholder_text = messages.error.NO_QUESTION_TEXT_YET;\n            var input_type = jquery_ui.item.attr('data-type');\n            var properties_panel_html;\n\n            //disable draggable if we hit the max amount of inputs allowed\n            if (utils.getInputsTotal(inputs) >= consts.INPUTS_MAX_ALLOWED) {\n                ui.input_tools.disable();\n            }\n            //reject group/branch inputs here\n            if (input_type === consts.BRANCH_TYPE || input_type === consts.GROUP_TYPE) {\n                jquery_ui.item.remove();\n                //if group inputs length is zero, show help text placeholder\n                //todo\n            }\n            else {\n                //count search inputs\n                if(input_type === consts.SEARCH_SINGLE_TYPE && !formbuilder.group.collection_is_being_sorted) {\n                    //if the limit is reached, hide search from input tools\n                    if (utils.getSearchInputsTotal() >= consts.LIMITS.search_inputs_max) {\n                        ui.input_tools.hideSearchInput();\n                        //show warning to user\n                        toast.showWarning(messages.warning.SEARCH_INPUTS_LIMIT_REACHED + '(' + consts.LIMITS.search_inputs_max + ')')\n                    }\n                }\n\n                //if we are editing a branch, it means this is a nested group\n                if (formbuilder.is_editing_branch) {\n                    console.log('we are editing a nested group');\n                    owner_input_ref = formbuilder.branch.current_input_ref;\n                    group_inputs = utils.getBranchInputObjectByRef(owner_input_ref).group;\n                }\n\n                jquery_ui.item.removeAttr('style'); // undo styling set by jqueryUI (http://goo.gl/EKz8tC)\n\n                //get the index where the input was dropped (skip when list is empty)\n                formbuilder.group.to_index = jquery_ui.item.index() === 0 ? jquery_ui.item.index() : jquery_ui.item.index() - 1;\n\n                //hide message about no input selected, as dropped input gets focus\n                formbuilder.dom.input_properties_no_input_selected.hide();\n\n\n                /*\n                 if the user is dragging a new input over, it was added as the last element of the array\n                 otherwise the current input position is set in the start event\n                 */\n                if (!formbuilder.group.collection_is_being_sorted) {\n\n                    //override 'from_index' as we are dropping a new element (min value for length is 1, as we add the input in the `receive` function)\n                    formbuilder.group.from_index = group_inputs.length - 1;\n\n                    //move inputs to keep the array sequence like the input sequence on screen\n                    group_inputs.move(formbuilder.group.from_index, formbuilder.group.to_index);\n\n                    jquery_ui.item.addClass('active');\n                    jquery_ui.item.attr('data-input-ref', group_input_ref);\n\n                    //append input id and a warning icon, as by default the question does not have any text\n                    jquery_ui.item.find('.input-inner').append(ui.inputs_collection.getInputStateIconsHTML());\n                    jquery_ui.item.find('span.question-preview').text(placeholder_text);\n\n                    //show input properties for the new dropped input\n                    formbuilder.dom.input_properties.find('.panel-body form').hide();\n                    formbuilder.dom.input_properties.find('.panel-title span').text(placeholder_text);\n\n                    //create properties panel in right sidebar for this input (common properties)\n                    properties_panel_html = template.getInputPropertiesPanelHTML(group_input);\n\n                    //append input and show it as it gets selected by default\n                    formbuilder.dom.input_properties_forms_wrapper.hide();\n                    $(properties_panel_html).removeClass('hidden').appendTo(formbuilder.dom.input_properties_forms_wrapper);\n\n                    formbuilder.dom.input_properties_forms_wrapper.fadeIn(consts.ANIMATION_FAST);\n\n                    //show action buttons for input\n                    formbuilder.dom.input_properties_buttons.fadeIn(consts.ANIMATION_FAST);\n\n                    if (!formbuilder.is_editing_branch) {\n\n                        //formbuilder.dom.input_properties.off('keyup');\n\n                        //this is NOT nested group\n                        //triggered when users type in the header input field for branches or groups\n                        if (group_input.type === consts.GROUP_TYPE) {\n                            formbuilder.dom.input_properties.on('keyup', 'input', input_properties_keyup_callback);\n                        }\n                    }\n\n                    //enable sortable on current input\n                    possibleAnswersSortable(group_input);\n                }\n                else {\n                    //'from_index is set in start event of sortable'\n                    //move inputs to keep the array sequence like the input sequence on screen\n                    group_inputs.move(formbuilder.group.from_index, formbuilder.group.to_index);\n\n                    //run the validation on all group jumps, as we might have some invalid destinations after re-ordering\n                    //I am forced to do this against all the branch inputs\n                    validation.validateJumpsAfterSorting(group_inputs);\n\n                    jquery_ui.item.addClass('active');\n                }\n            }\n\n            //add this state for undoing, so it is easier to rebind everything\n            formbuilder.render_action = consts.RENDER_ACTION_DO;\n            undo.pushState();\n\n            if (input_type === consts.README_TYPE) {\n                $('.summernote').summernote(consts.SUMMERNOTE_OPTIONS);\n            }\n        },\n        //this callback is triggered when the user start dragging an existing input from the sortable\n        start: function (e, jquery_ui) {\n\n            //get current input position, as we need to move from here\n            formbuilder.group.collection_is_being_sorted = true;\n            formbuilder.group.from_index = jquery_ui.item.index() === 0 ? 0 : jquery_ui.item.index() - 1;\n            //de-activate all inputs in collection\n            formbuilder.dom.inputs_collection_sortable.removeClass('active');\n\n        },\n        scroll: true,\n        snap: false,\n        over: function (e, jquery_ui) {\n\n            var owner_input_ref = formbuilder.group.active_group_ref;\n            var owner_input = utils.getInputObjectByRef(owner_input_ref);\n\n            //if we are editing a nested group, grab the nested group\n            if (formbuilder.is_editing_branch) {\n                owner_input = utils.getBranchInputObjectByRef(owner_input_ref);\n            }\n\n            //hide help text if the list is empty and we are hovering with an input\n            if (owner_input.group.length === 0) {\n                //remove input from dom collection (middle column)\n                formbuilder.dom.inputs_collection_sortable\n                    .find('div.input[data-input-ref=\"' + owner_input_ref + '\"]')\n                    .find('.input-properties__no-group-questions-message')\n                    .hide();\n            }\n        }\n    };\n};\n\nmodule.exports = group_sortable();\n","'use strict';\nvar formbuilder = require('config/formbuilder');\nvar consts = require('config/consts');\nvar ui = require('helpers/ui');\nvar save_project_click_callback = require('ui-handlers/event-handler-callbacks/save-project-click-callback');\n\nvar possibleAnswersSortable = function (input) {\n\n    var validation = require('actions/validation');\n\n    //if not multiple choice type, return\n    if ($.inArray(input.type, consts.MULTIPLE_ANSWER_TYPES) === -1) {\n        return false;\n    }\n\n    //attach sortable only once per each input to keep low memory usage\n    if ($.inArray(input.ref, formbuilder.possible_answers.enabled_sortable) === -1) {\n\n        //enable sortable for this input\n        formbuilder.dom.input_properties_forms_wrapper\n            .find('.input-properties__form__possible-answers__list').sortable({\n            axis: 'y',\n            containment: 'parent',\n            handle: '.input-properties__form__possible-answers__list__drag-answer',\n            cancel: '',\n            helper: 'clone',\n            tolerance: 'pointer',\n            placeholder: 'possible-answers-drop-placeholder',\n            stop: function (e, jquery_ui) {\n                //'from_index is set in start event of sortable'\n                formbuilder.possible_answers.to_index = jquery_ui.item.index('') === 0 ? jquery_ui.item.index() : jquery_ui.item.index();\n\n                //move inputs to keep the possible answers sequence like the sequence on screen (dom)\n                input.possible_answers.move(formbuilder.possible_answers.from_index, formbuilder.possible_answers.to_index);\n\n                //save possible answers\n                input.savePossibleAnswers();\n                //validate input\n                validation.performValidation(input, false);\n\n                //enable save project button as user made a change\n                //and ALL the inputs are valid\n\n                //enable save project button if all inputs are valid\n                if (validation.areAllInputsValid(formbuilder.project_definition)) {\n                    //enable save project button (if disabled)\n                    ui.navbar.toggleSaveProjectBtn(consts.BTN_ENABLED);\n                    formbuilder.dom.save_project_btn.off().on('click', save_project_click_callback);\n                }\n            },\n            start: function(e, jquery_ui){\n                formbuilder.possible_answers.from_index = jquery_ui.item.index() === 0 ? 0 : jquery_ui.item.index();\n            }\n        }).disableSelection();\n\n        //keep track of the current inpuot so we do not attach the event more than once\n        formbuilder.possible_answers.enabled_sortable.push(input.ref);\n    }\n};\n\nmodule.exports = possibleAnswersSortable;\n","'use strict';\nvar formbuilder = require('config/formbuilder');\nvar input_factory = require('factory/input-factory');\nvar ui = require('helpers/ui');\nvar utils = require('helpers/utils');\nvar consts = require('config/consts');\nvar messages = require('config/messages');\nvar validation = require('actions/validation');\nvar template = require('template');\nvar undo = require('actions/undo');\nvar toast = require('config/toast');\nvar possibleAnswersSortable = require('ui-handlers/possible-answers-sortable');\n\nvar sortable = function () {\n\n    var input;\n\n    formbuilder.dom.inputs_collection_sortable.sortable({\n        zIndex: 9999,\n        cursor: 'move',\n        items: '> div.input',\n        revert: 100,\n        //axis: 'y',// it causes the placeholder to be always active\n        containment: 'parent',\n        // containment: 'document', no!\n        tolerance: 'pointer',\n        // forcePlaceholderSize: true,\n        placeholder: 'input-collection-drop-placeholder',\n\n        //triggered when a new input is dropped over the sortable\n        receive: function (e, jquery_ui) {\n\n            var input_factory = require('factory/input-factory');\n            var form_index = formbuilder.current_form_index;\n            var form_ref = formbuilder.current_form_ref;\n            var inputs = formbuilder.project_definition.data.project.forms[form_index].inputs;\n            var previous_input_ref = formbuilder.current_input_ref;\n            var input_type = jquery_ui.item.attr('data-type');\n            var input_index = inputs.length;\n            var input_ref = utils.generateInputRef(form_ref);\n\n            //validate previous input (if any) to show embedded errors (in case the user did not press validate button)\n            if (previous_input_ref && input_index > 0) {\n                validation.performValidation(utils.getInputObjectByRef(previous_input_ref), false);\n            }\n\n            //console.log('sortable receive');\n            jquery_ui.item.removeAttr('style'); // undo styling set by jqueryUI (http://goo.gl/EKz8tC)\n\n            formbuilder.collection_is_being_sorted = false;\n            //generate input object based on type and set index incrementally\n            input = input_factory.createInput(input_type, input_ref);\n            formbuilder.current_input_ref = input.ref;\n            // console.log(input);\n\n            //disable current active element\n            var current_element = formbuilder.dom.inputs_collection_sortable.find('.active');\n            current_element.removeClass('active');\n\n            //add input to collection as the last one\n            inputs.push(input);\n            //console.log(inputs);\n\n            //hide message about no input selected, as dropped input gets focus\n            formbuilder.dom.input_properties_no_input_selected.hide();\n\n            //get hold of advanced properties panel for this input\n            input.dom.advanced_properties_wrapper = formbuilder\n                .dom\n                .input_properties_forms_wrapper\n                .find('form[data-input-ref=\"' + input.ref + '\"]')\n                .find('.input-properties__form__advanced-properties');\n\n            //disable save project button as by default an input is invalid when it is created\n            ui.navbar.toggleSaveProjectBtn(consts.BTN_DISABLED);\n\n            //set form tab as invalid, as the new input will be invalid by default\n            ui.forms_tabs.showFormInvalidIcon(formbuilder.current_form_index);\n\n\n\n        },\n        stop: function (e, jquery_ui) {\n\n            var form_index = formbuilder.current_form_index;\n            var inputs = formbuilder.project_definition.data.project.forms[form_index].inputs;\n            var placeholder_text = messages.error.NO_QUESTION_TEXT_YET;\n            var input_type = jquery_ui.item.attr('data-type');\n            var properties_panel_html;\n\n            //disable draggable if we hit the max amount of inputs allowed\n            if (utils.getInputsTotal(inputs) >= consts.INPUTS_MAX_ALLOWED) {\n                ui.input_tools.disable();\n            }\n\n            //hide search input if we hit the max (globally) but only when adding new inputs\n            if (input_type === consts.SEARCH_SINGLE_TYPE && !formbuilder.collection_is_being_sorted) {\n                if (utils.getSearchInputsTotal() >= consts.LIMITS.search_inputs_max) {\n                    ui.input_tools.hideSearchInput();\n                    console.log('search limit reached');\n\n                    //show warning to user\n                    toast.showWarning(messages.warning.SEARCH_INPUTS_LIMIT_REACHED + '(' + consts.LIMITS.search_inputs_max + ')');\n                }\n            }\n\n            //console.log('sortable stop');\n            jquery_ui.item.removeAttr('style'); // undo styling set by jqueryUI (http://goo.gl/EKz8tC)\n\n            var input_ref = formbuilder.current_input_ref;\n\n            //get the index where the input was dropped (skip when list is empty)\n            console.log(jquery_ui.item.index());\n            //here from_index is based on the siblings, so we need to remove the indexes for the warning messages <div>\n            //we have 2 <div>, so remove 2\n            formbuilder.to_index = jquery_ui.item.index('') === 0 ? jquery_ui.item.index() : jquery_ui.item.index() - 2;\n\n            /*\n             if the user is dragging a new input over, it was added as the last element of the array\n             otherwise the current input position is set in the start event\n             */\n            if (!formbuilder.collection_is_being_sorted) {\n\n                //override 'from_index' as we are dropping a new element\n                formbuilder.from_index = inputs.length - 1;\n\n                //move inputs to keep the array sequence like the input sequence on screen\n                inputs.move(formbuilder.from_index, formbuilder.to_index);\n\n                jquery_ui.item.addClass('active');\n                jquery_ui.item.attr('data-input-ref', input_ref);\n\n                //append input id and a warning icon, as by default the question does not have any text\n                jquery_ui.item.find('.input-inner').append(ui.inputs_collection.getInputStateIconsHTML());\n\n                //add placeholder text on current input (based on input type)\n                if (input_type === consts.BRANCH_TYPE) {\n                    //it is a branch, add branch placeholder\n                    placeholder_text = messages.error.NO_BRANCH_HEADER_YET;\n                }\n\n                if (input_type === consts.GROUP_TYPE) {\n                    //it is a group, add group placeholder\n                    placeholder_text = messages.error.NO_GROUP_HEADER_YET;\n                }\n\n                jquery_ui.item.find('span.question-preview').text(placeholder_text);\n\n                //show input properties for the new dropped input\n                formbuilder.dom.input_properties.find('.panel-body form').hide();\n                formbuilder.dom.input_properties.find('.panel-title span').text(placeholder_text);\n\n                //create properties panel in right sidebar for this input (common properties)\n                properties_panel_html = template.getInputPropertiesPanelHTML(input);\n\n                //append input and show it as it gets selected by default\n                formbuilder.dom.input_properties_forms_wrapper.hide();\n                $(properties_panel_html).removeClass('hidden').appendTo(formbuilder.dom.input_properties_forms_wrapper);\n                formbuilder.dom.input_properties_forms_wrapper.fadeIn(consts.ANIMATION_FAST);\n\n                //show action buttons for input\n                formbuilder.dom.input_properties_buttons.fadeIn(consts.ANIMATION_FAST);\n\n                //for branches, enable keyup to check for validation of header text\n                //triggered when users type in the header input field for branches or groups\n\n                if (input.type === consts.BRANCH_TYPE || input.type === consts.GROUP_TYPE) {\n                    //formbuilder.dom.input_properties.off('keyup').on('keyup', 'input', input_properties_keyup_callback);\n                }\n                else {\n                    // formbuilder.dom.input_properties.off('keyup');\n                }\n\n                //enable sortable on current input (only when it gets created)\n                possibleAnswersSortable(input);\n            }\n            else {\n\n                //todo do I need to bind keyup for branches and groups here?\n\n                //'from_index is set in start event of sortable'\n                //move inputs to keep the array sequence like the input sequence on screen\n                inputs.move(formbuilder.from_index, formbuilder.to_index);\n\n                //run the validation on all jumps, as we might have some invalid destinations after re-ordering\n                //I am forced to do this against all the inputs\n                validation.validateJumpsAfterSorting(inputs);\n\n                jquery_ui.item.addClass('active');\n            }\n\n\n            //push state to enable undoing the action (adding/dragging input)\n            formbuilder.render_action = consts.RENDER_ACTION_DO;\n            undo.pushState();\n\n            if (input_type === consts.README_TYPE) {\n                $('.summernote').summernote(consts.SUMMERNOTE_OPTIONS);\n            }\n\n            //if there is not any title set, show warning\n            //but only if there are any inputs\n            if (inputs.length > 0) {\n                ui.inputs_collection.toggleTitleWarning(utils.getTitleCount(inputs), false);\n            }\n            else {\n                //hide it, passing a count > 1\n                ui.inputs_collection.toggleTitleWarning(1, false);\n\n                //disable download form button\n                formbuilder.dom.inputs_collection\n                    .find('.inputs-collection__export-form').addClass('disabled');\n\n                //disable print as pdf form button\n                formbuilder.dom.inputs_collection\n                    .find('.inputs-collection__print-as-pdf').addClass('disabled');\n            }\n\n\n\n        },\n        //this callback is triggered when the user start dragging an existing input from the sortable\n        start: function (e, jquery_ui) {\n\n            //get current input position, as we need to move from here (if there is any input)\n            formbuilder.collection_is_being_sorted = true;\n            //here from_index is based on the siblings, so we need to remove the indexes for the warning messages <div>\n            //we have 2 <div>, so remove 2\n            formbuilder.from_index = jquery_ui.item.index() === 0 ? 0 : jquery_ui.item.index() - 2;\n\n            //de-activate all inputs in collection\n            formbuilder.dom.inputs_collection_sortable.removeClass('active');\n        },\n        over: function () {\n            var form_index = formbuilder.current_form_index;\n            var inputs = formbuilder.project_definition.data.project.forms[form_index].inputs;\n            //remove no questions message and upload button if no inputs\n            if (inputs.length === 0) {\n                formbuilder.dom.inputs_collection\n                    .find('.input-properties__no-questions-message')\n                    .addClass('hidden');\n            }\n        },\n        out: function () {\n            var form_index = formbuilder.current_form_index;\n            var inputs = formbuilder.project_definition.data.project.forms[form_index].inputs;\n            //show no questions message and upload button if no inputs\n            if (inputs.length === 0) {\n                formbuilder.dom.inputs_collection\n                    .find('.input-properties__no-questions-message')\n                    .hide()\n                    .removeClass('hidden')\n                    .fadeIn(consts.ANIMATION_FAST);\n            }\n        },\n        scroll: true\n    }).disableSelection();\n};\n\nmodule.exports = sortable;\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJqcy9hcHAuanMiLCJqcy9hcHBfbW9kdWxlcy9hY3Rpb25zL2Vycm9ycy5qcyIsImpzL2FwcF9tb2R1bGVzL2FjdGlvbnMvaW5wdXQtZHVwbGljYXRvci5qcyIsImpzL2FwcF9tb2R1bGVzL2FjdGlvbnMvanVtcHMuanMiLCJqcy9hcHBfbW9kdWxlcy9hY3Rpb25zL3BhcnNlL2luZGV4LmpzIiwianMvYXBwX21vZHVsZXMvYWN0aW9ucy9wYXJzZS9tZXRob2RzL2dldEJyYW5jaElucHV0c0hUTUwuanMiLCJqcy9hcHBfbW9kdWxlcy9hY3Rpb25zL3BhcnNlL21ldGhvZHMvZ2V0R3JvdXBJbnB1dHNIVE1MLmpzIiwianMvYXBwX21vZHVsZXMvYWN0aW9ucy9wYXJzZS9tZXRob2RzL2luaXRGb3JtYnVpbGRlci5qcyIsImpzL2FwcF9tb2R1bGVzL2FjdGlvbnMvcGFyc2UvbWV0aG9kcy9yZW5kZXJDaGlsZEZvcm1zLmpzIiwianMvYXBwX21vZHVsZXMvYWN0aW9ucy9wYXJzZS9tZXRob2RzL3JlbmRlcklucHV0cy5qcyIsImpzL2FwcF9tb2R1bGVzL2FjdGlvbnMvcGFyc2UvbWV0aG9kcy9yZW5kZXJQcm9qZWN0LmpzIiwianMvYXBwX21vZHVsZXMvYWN0aW9ucy9wb3NzaWJsZS1hbnN3ZXJzLXBhZ2VyLmpzIiwianMvYXBwX21vZHVsZXMvYWN0aW9ucy9wb3NzaWJsZS1hbnN3ZXJzLmpzIiwianMvYXBwX21vZHVsZXMvYWN0aW9ucy9zYXZlL2luZGV4LmpzIiwianMvYXBwX21vZHVsZXMvYWN0aW9ucy9zYXZlL21vZHVsZS5kb0NsZWFuaW5nQmVmb3JlU2F2aW5nLmpzIiwianMvYXBwX21vZHVsZXMvYWN0aW9ucy9zYXZlL21vZHVsZS5zYXZlQWR2YW5jZWRQcm9wZXJ0aWVzLmpzIiwianMvYXBwX21vZHVsZXMvYWN0aW9ucy9zYXZlL21vZHVsZS5zYXZlQWxsSW5wdXRQcm9wZXJ0aWVzLmpzIiwianMvYXBwX21vZHVsZXMvYWN0aW9ucy9zYXZlL21vZHVsZS5zYXZlSnVtcHMuanMiLCJqcy9hcHBfbW9kdWxlcy9hY3Rpb25zL3NhdmUvbW9kdWxlLnNhdmVQb3NzaWJsZUFuc3dlcnMuanMiLCJqcy9hcHBfbW9kdWxlcy9hY3Rpb25zL3NhdmUvbW9kdWxlLnNhdmVQcm9wZXJ0aWVzLmpzIiwianMvYXBwX21vZHVsZXMvYWN0aW9ucy9zYXZlL21vZHVsZS5zYXZlVW5pcXVlbmVzcy5qcyIsImpzL2FwcF9tb2R1bGVzL2FjdGlvbnMvdW5kby5qcyIsImpzL2FwcF9tb2R1bGVzL2FjdGlvbnMvdmFsaWRhdGlvbi5qcyIsImpzL2FwcF9tb2R1bGVzL2NvbmZpZy9jb25zdHMuanMiLCJqcy9hcHBfbW9kdWxlcy9jb25maWcvZXh0ZW5kLW5hdGl2ZXMuanMiLCJqcy9hcHBfbW9kdWxlcy9jb25maWcvZm9ybWJ1aWxkZXIuanMiLCJqcy9hcHBfbW9kdWxlcy9jb25maWcvaW5pdC5qcyIsImpzL2FwcF9tb2R1bGVzL2NvbmZpZy9tZXNzYWdlcy5qcyIsImpzL2FwcF9tb2R1bGVzL2NvbmZpZy90b2FzdC5qcyIsImpzL2FwcF9tb2R1bGVzL2ZhY3RvcnkvZm9ybS1mYWN0b3J5LmpzIiwianMvYXBwX21vZHVsZXMvZmFjdG9yeS9pbnB1dC1mYWN0b3J5LmpzIiwianMvYXBwX21vZHVsZXMvZmFjdG9yeS9pbnB1dC1tdWx0aXBsZS1hbnN3ZXJzLXByb3RvdHlwZS5qcyIsImpzL2FwcF9tb2R1bGVzL2ZhY3RvcnkvaW5wdXQtcHJvcGVydGllcy5qcyIsImpzL2FwcF9tb2R1bGVzL2ZhY3RvcnkvaW5wdXQtcHJvdG90eXBlLmpzIiwianMvYXBwX21vZHVsZXMvaGVscGVycy9pbXBvcnQtZm9ybS12YWxpZGF0aW9uLmpzIiwianMvYXBwX21vZHVsZXMvaGVscGVycy91aS5qcyIsImpzL2FwcF9tb2R1bGVzL2hlbHBlcnMvdXRpbHMuanMiLCJqcy9hcHBfbW9kdWxlcy9pbnB1dHMvYXVkaW8uanMiLCJqcy9hcHBfbW9kdWxlcy9pbnB1dHMvYmFyY29kZS5qcyIsImpzL2FwcF9tb2R1bGVzL2lucHV0cy9icmFuY2guanMiLCJqcy9hcHBfbW9kdWxlcy9pbnB1dHMvY2hlY2tib3guanMiLCJqcy9hcHBfbW9kdWxlcy9pbnB1dHMvZGF0ZS5qcyIsImpzL2FwcF9tb2R1bGVzL2lucHV0cy9kcm9wZG93bi5qcyIsImpzL2FwcF9tb2R1bGVzL2lucHV0cy9ncm91cC5qcyIsImpzL2FwcF9tb2R1bGVzL2lucHV0cy9pbnRlZ2VyLmpzIiwianMvYXBwX21vZHVsZXMvaW5wdXRzL2xvY2F0aW9uLmpzIiwianMvYXBwX21vZHVsZXMvaW5wdXRzL3Bob25lLmpzIiwianMvYXBwX21vZHVsZXMvaW5wdXRzL3Bob3RvLmpzIiwianMvYXBwX21vZHVsZXMvaW5wdXRzL3JhZGlvLmpzIiwianMvYXBwX21vZHVsZXMvaW5wdXRzL3JlYWRtZS5qcyIsImpzL2FwcF9tb2R1bGVzL2lucHV0cy9zZWFyY2guanMiLCJqcy9hcHBfbW9kdWxlcy9pbnB1dHMvdGV4dC5qcyIsImpzL2FwcF9tb2R1bGVzL2lucHV0cy90ZXh0YXJlYS5qcyIsImpzL2FwcF9tb2R1bGVzL2lucHV0cy90aW1lLmpzIiwianMvYXBwX21vZHVsZXMvaW5wdXRzL3ZpZGVvLmpzIiwianMvYXBwX21vZHVsZXMvbG9hZGVycy9sb2FkLWNoaWxkLWZvcm0tY29udGFpbmVycy5qcyIsImpzL2FwcF9tb2R1bGVzL2xvYWRlcnMvbG9hZC1jb21wb25lbnRzLmpzIiwianMvYXBwX21vZHVsZXMvbG9hZGVycy9sb2FkLWNvbnRhaW5lcnMuanMiLCJqcy9hcHBfbW9kdWxlcy9sb2FkZXJzL2xvYWQtaW5wdXQtcHJvcGVydGllcy12aWV3cy5qcyIsImpzL2FwcF9tb2R1bGVzL2xvYWRlcnMvbG9hZC1wYXJ0aWFscy5qcyIsImpzL2FwcF9tb2R1bGVzL2xvYWRlcnMvbG9hZC1wcm9qZWN0LmpzIiwianMvYXBwX21vZHVsZXMvdGVtcGxhdGUvaW5kZXguanMiLCJqcy9hcHBfbW9kdWxlcy90ZW1wbGF0ZS9tZXRob2RzL2NyZWF0ZUJhc2ljUHJvcGVydGllc0hUTUwuanMiLCJqcy9hcHBfbW9kdWxlcy90ZW1wbGF0ZS9tZXRob2RzL2NyZWF0ZUlucHV0UHJvcGVydGllc0hUTUwuanMiLCJqcy9hcHBfbW9kdWxlcy90ZW1wbGF0ZS9tZXRob2RzL2NyZWF0ZUlucHV0VG9vbEhUTUwuanMiLCJqcy9hcHBfbW9kdWxlcy90ZW1wbGF0ZS9tZXRob2RzL2dldEFkdmFuY2VkVGFiQnRuSFRNTC5qcyIsImpzL2FwcF9tb2R1bGVzL3RlbXBsYXRlL21ldGhvZHMvZ2V0SW5wdXRQcm9wZXJ0aWVzUGFuZWxIVE1MLmpzIiwianMvYXBwX21vZHVsZXMvdGVtcGxhdGUvbWV0aG9kcy9nZXRKdW1wVGFiQnRuSFRNTC5qcyIsImpzL2FwcF9tb2R1bGVzL3RlbXBsYXRlL21ldGhvZHMvZ2V0SnVtcHNMaXN0SFRNTC5qcyIsImpzL2FwcF9tb2R1bGVzL3RlbXBsYXRlL21ldGhvZHMvZ2V0UG9zc2libGVBbnN3ZXJzSFRNTC5qcyIsImpzL2FwcF9tb2R1bGVzL3RlbXBsYXRlL21ldGhvZHMvZ2V0UG9zc2libGVBbnN3ZXJzTGlzdC5qcyIsImpzL2FwcF9tb2R1bGVzL3RlbXBsYXRlL21ldGhvZHMvZ2V0UG9zc2libGVBbnN3ZXJzUGFnZS5qcyIsImpzL2FwcF9tb2R1bGVzL3RlbXBsYXRlL21ldGhvZHMvZ2V0VW5pcXVlbmVzc0hUTUwuanMiLCJqcy9hcHBfbW9kdWxlcy90ZW1wbGF0ZS9tZXRob2RzL3ByZXBhcmVBZHZhbmNlZElucHV0UHJvcGVydGllc0hUTUwuanMiLCJqcy9hcHBfbW9kdWxlcy90ZW1wbGF0ZS9tZXRob2RzL3JlcGxhY2VDb21tb25BZHZhbmNlZFByb3BlcnRpZXMuanMiLCJqcy9hcHBfbW9kdWxlcy91aS1oYW5kbGVycy9icmFuY2gtc29ydGFibGUuanMiLCJqcy9hcHBfbW9kdWxlcy91aS1oYW5kbGVycy9kcmFnZ2FibGUuanMiLCJqcy9hcHBfbW9kdWxlcy91aS1oYW5kbGVycy9ldmVudC1oYW5kbGVyLWNhbGxiYWNrcy9jb25maXJtLWltcG9ydC1wb3NzaWJsZS1hbnN3ZXJzLWNhbGxiYWNrLmpzIiwianMvYXBwX21vZHVsZXMvdWktaGFuZGxlcnMvZXZlbnQtaGFuZGxlci1jYWxsYmFja3MvZGVsZXRlLWFsbC1xdWVzdGlvbnMtY2xpY2stY2FsbGJhY2suanMiLCJqcy9hcHBfbW9kdWxlcy91aS1oYW5kbGVycy9ldmVudC1oYW5kbGVyLWNhbGxiYWNrcy9kZWxldGUtZm9ybS1jbGljay1jYWxsYmFjay5qcyIsImpzL2FwcF9tb2R1bGVzL3VpLWhhbmRsZXJzL2V2ZW50LWhhbmRsZXItY2FsbGJhY2tzL2V4cG9ydC1mb3JtLWNsaWNrLWNhbGxiYWNrLmpzIiwianMvYXBwX21vZHVsZXMvdWktaGFuZGxlcnMvZXZlbnQtaGFuZGxlci1jYWxsYmFja3MvZm9ybS10YWItY2xpY2stY2FsbGJhY2suanMiLCJqcy9hcHBfbW9kdWxlcy91aS1oYW5kbGVycy9ldmVudC1oYW5kbGVyLWNhbGxiYWNrcy9pbXBvcnQtZm9ybS1jbGljay1jYWxsYmFjay5qcyIsImpzL2FwcF9tb2R1bGVzL3VpLWhhbmRsZXJzL2V2ZW50LWhhbmRsZXItY2FsbGJhY2tzL2lucHV0LWNvbGxlY3Rpb24tYnJhbmNoLXNvcnRhYmxlLW1vdXNlZG93bi1jYWxsYmFjay5qcyIsImpzL2FwcF9tb2R1bGVzL3VpLWhhbmRsZXJzL2V2ZW50LWhhbmRsZXItY2FsbGJhY2tzL2lucHV0LWNvbGxlY3Rpb24tZ3JvdXAtc29ydGFibGUtbW91c2Vkb3duLWNhbGxiYWNrLmpzIiwianMvYXBwX21vZHVsZXMvdWktaGFuZGxlcnMvZXZlbnQtaGFuZGxlci1jYWxsYmFja3MvaW5wdXQtY29sbGVjdGlvbi1uZXN0ZWQtZ3JvdXAtc29ydGFibGUtbW91c2Vkb3duLWNhbGxiYWNrLmpzIiwianMvYXBwX21vZHVsZXMvdWktaGFuZGxlcnMvZXZlbnQtaGFuZGxlci1jYWxsYmFja3MvaW5wdXQtY29sbGVjdGlvbi1zb3J0YWJsZS1tb3VzZWRvd24tY2FsbGJhY2suanMiLCJqcy9hcHBfbW9kdWxlcy91aS1oYW5kbGVycy9ldmVudC1oYW5kbGVyLWNhbGxiYWNrcy9pbnB1dC1wcm9wZXJ0aWVzLWFkdmFuY2VkLXRhYi1jbGljay1jYWxsYmFjay5qcyIsImpzL2FwcF9tb2R1bGVzL3VpLWhhbmRsZXJzL2V2ZW50LWhhbmRsZXItY2FsbGJhY2tzL2lucHV0LXByb3BlcnRpZXMtY2hhbmdlLWNhbGxiYWNrLmpzIiwianMvYXBwX21vZHVsZXMvdWktaGFuZGxlcnMvZXZlbnQtaGFuZGxlci1jYWxsYmFja3MvaW5wdXQtcHJvcGVydGllcy1jbGljay1jYWxsYmFjay5qcyIsImpzL2FwcF9tb2R1bGVzL3VpLWhhbmRsZXJzL2V2ZW50LWhhbmRsZXItY2FsbGJhY2tzL2lucHV0LXByb3BlcnRpZXMtZm9jdXMtY2FsbGJhY2suanMiLCJqcy9hcHBfbW9kdWxlcy91aS1oYW5kbGVycy9ldmVudC1oYW5kbGVyLWNhbGxiYWNrcy9pbnB1dC1wcm9wZXJ0aWVzLWtleXVwLWNhbGxiYWNrLmpzIiwianMvYXBwX21vZHVsZXMvdWktaGFuZGxlcnMvZXZlbnQtaGFuZGxlci1jYWxsYmFja3MvaW5wdXQtcHJvcGVydGllcy10aXRsZS1jaGVja2JveC1jYWxsYmFjay5qcyIsImpzL2FwcF9tb2R1bGVzL3VpLWhhbmRsZXJzL2V2ZW50LWhhbmRsZXItY2FsbGJhY2tzL21vZGFsLWZvcm0tY2FsbGJhY2suanMiLCJqcy9hcHBfbW9kdWxlcy91aS1oYW5kbGVycy9ldmVudC1oYW5kbGVyLWNhbGxiYWNrcy9tb2RhbC1yZWdleC1jYWxsYmFjay5qcyIsImpzL2FwcF9tb2R1bGVzL3VpLWhhbmRsZXJzL2V2ZW50LWhhbmRsZXItY2FsbGJhY2tzL3ByaW50LWFzLXBkZi1jbGljay1jYWxsYmFjay5qcyIsImpzL2FwcF9tb2R1bGVzL3VpLWhhbmRsZXJzL2V2ZW50LWhhbmRsZXItY2FsbGJhY2tzL3NhdmUtcHJvamVjdC1jbGljay1jYWxsYmFjay5qcyIsImpzL2FwcF9tb2R1bGVzL3VpLWhhbmRsZXJzL2dyb3VwLXNvcnRhYmxlLmpzIiwianMvYXBwX21vZHVsZXMvdWktaGFuZGxlcnMvcG9zc2libGUtYW5zd2Vycy1zb3J0YWJsZS5qcyIsImpzL2FwcF9tb2R1bGVzL3VpLWhhbmRsZXJzL3NvcnRhYmxlLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN1RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2Y0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzdFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDak5BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzdDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25IQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0bkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL0RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzdEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6S0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzl6QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVSQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDakhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BOQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdkNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pWQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BKQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3R0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xxQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BmQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzM0QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcEVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDclJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9FQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL0NBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNjQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNUxBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM0NBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0NBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2RkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25DQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdEVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDekRBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM0hBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNwREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25GQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDckpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JQQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbEhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdEVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbFBBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2SEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNUZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDekNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZkQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbkZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdkpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqUEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0UEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIid1c2Ugc3RyaWN0Jztcbi8vbW9kdWxlcyBhcmUgcmVxdWlyZWQgdXNpbmcgYWJzb2x1dGUgcGF0aHMgaW4gYnJvd3NlcmlmeTogaHR0cHM6Ly9nb28uZ2wvVWtjY0d6XG52YXIgaW5pdCA9IHJlcXVpcmUoJ2NvbmZpZy9pbml0Jyk7XG52YXIgZXh0ZW5kX25hdGl2ZXMgPSByZXF1aXJlKCdjb25maWcvZXh0ZW5kLW5hdGl2ZXMnKTtcbnZhciBsb2FkX2NvbXBvbmVudHMgPSByZXF1aXJlKCdsb2FkZXJzL2xvYWQtY29tcG9uZW50cycpO1xudmFyIGxvYWRfcHJvamVjdCA9IHJlcXVpcmUoJ2xvYWRlcnMvbG9hZC1wcm9qZWN0Jyk7XG5cbi8vbG9hZCBwcm9qZWN0IGZpcnN0XG4kLndoZW4oXG4gICAgbG9hZF9wcm9qZWN0KClcbikudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgLy9sb2FkIHBhcnRpYWwgdmlld3MgZm9yIGluZGV4Lmh0bWwsIGV4dGVuZCBuYXRpdmVzLCB0aGVuIGluaXQgYXBwXG4gICAgJC53aGVuKFxuICAgICAgICBsb2FkX2NvbXBvbmVudHMoKSxcbiAgICAgICAgZXh0ZW5kX25hdGl2ZXMoKSlcbiAgICAgICAudGhlbihpbml0KTtcbn0pO1xuXG4vKlxuIFNldCBtaWRkbGUgYW5kIHJpZ2h0IHBhbmVsIHRvIHRoZSBzYW1lIGhlaWdodCBvZiB0aGUgaW5wdXRzLWNvbGxlY3Rpb24gcGFuZWxcbiBNYXliZSB0aGVyZSBpcyBhIHB1cmUgY3NzIHNvbHV0aW9uIChmbGV4Ym94KSwgYnV0IG1pZGRsZSBjb2x1bW4gbmVlZHMgdG8gYmUgc2Nyb2xsYWJsZSB0aG91Z2ggd2hlbiBJIGFkZCBpbnB1dHNcbiBGb3IgdGhlIHRpbWUgYmVpbmcgdGhpcyB3aWxsIGRvXG4gKi9cbi8vdmFyIGlucHV0c19jb2xsZWN0aW9uX2hlaWdodCA9ICQoJy5pbnB1dHMtdG9vbHMnKS5oZWlnaHQoKTtcbi8vJCgnLm1haW4gLnBhbmVsLWJvZHknKS5oZWlnaHQoaW5wdXRzX2NvbGxlY3Rpb25faGVpZ2h0KTtcblxuIiwiLyogZ2xvYmFsICQqL1xuJ3VzZSBzdHJpY3QnO1xudmFyIGNvbnN0cyA9IHJlcXVpcmUoJ2NvbmZpZy9jb25zdHMnKTtcbnZhciBtZXNzYWdlcyA9IHJlcXVpcmUoJ2NvbmZpZy9tZXNzYWdlcycpO1xudmFyIGZvcm1idWlsZGVyID0gcmVxdWlyZSgnY29uZmlnL2Zvcm1idWlsZGVyJyk7XG5cblxudmFyIGVycm9ycyA9IHtcblxuICAgIC8vaGlkZSBhbGwgcHJvcGVydGllcyBlcnJvcnMgZm9yIHRoZSBjdXJyZW50IHNlbGVjdGVkIGlucHV0XG4gICAgaGlkZVByb3BlcnRpZXNFcnJvcnM6IGZ1bmN0aW9uICh0aGVfcHJvcGVydGllc19wYW5lbCkge1xuXG4gICAgICAgIHZhciBwcm9wZXJ0aWVzX3BhbmVsID0gdGhlX3Byb3BlcnRpZXNfcGFuZWw7XG5cbiAgICAgICAgLy9yZW1vdmUgaW5saW5lIGVycm9yc1xuICAgICAgICBwcm9wZXJ0aWVzX3BhbmVsLmZpbmQoJ2Rpdi5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19xdWVzdGlvbicpLnJlbW92ZUNsYXNzKCdoYXMtZXJyb3IgaGFzLWZlZWRiYWNrJyk7XG4gICAgICAgIHByb3BlcnRpZXNfcGFuZWwuZmluZCgnZGl2LmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX3F1ZXN0aW9uID4gaScpLmFkZENsYXNzKCdoaWRkZW4nKTtcbiAgICAgICAgcHJvcGVydGllc19wYW5lbC5maW5kKCdkaXYuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fcXVlc3Rpb24gc3Bhbi5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19lcnJvcicpLnRleHQoJycpO1xuXG4gICAgICAgIC8vcmVtb3ZlIHZpc3VhbCBlcnJvcnMgZnJvbSB0YWJzXG4gICAgICAgIHByb3BlcnRpZXNfcGFuZWwuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX3RhYnMgLm5hdi10YWJzIGknKS5hZGRDbGFzcygnaW52aXNpYmxlJyk7XG4gICAgICAgIHByb3BlcnRpZXNfcGFuZWwuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX3RhYnMgLm5hdi10YWJzIGknKS5wYXJlbnQoKS5yZW1vdmVDbGFzcygndmFsaWRhdGlvbi1lcnJvcicpO1xuICAgIH0sXG5cbiAgICBoaWRlUG9zc2libGVBbnN3ZXJzRXJyb3JzOiBmdW5jdGlvbiAodGhlX2lucHV0KSB7XG5cbiAgICAgICAgLy90b2RvIHRoaXMgZnVuY3Rpb24gaXMgY2FsbGVkIDMgdGltZXMgd2huZSB2YWxpZGF0aW5nIG9uIGtleXVwLCBsb29rIGlub3QgaXQgd2hlbiB0aGVyZSBpcyB0aW1lXG4gICAgICAgIHZhciBpbnB1dCA9IHRoZV9pbnB1dDtcbiAgICAgICAgdmFyIHBvc3NpYmxlX2Fuc3dlcl9saXN0ID0gaW5wdXQuZG9tLnByb3BlcnRpZXNfcGFuZWwuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX3Bvc3NpYmxlLWFuc3dlcnNfX2xpc3QnKTtcblxuICAgICAgICAkKHBvc3NpYmxlX2Fuc3dlcl9saXN0KS5lYWNoKGZ1bmN0aW9uIChpbmRleCwgcG9zc2libGVfYW5zd2VyKSB7XG5cbiAgICAgICAgICAgIC8vaGlnaGxpZ2h0IHdyb25nIGlucHV0IGFuZCBzaG93IGVycm9yIG1lc3NhZ2VcbiAgICAgICAgICAgICQocG9zc2libGVfYW5zd2VyKS5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fcG9zc2libGUtYW5zd2Vyc19fbGlzdF9fcG9zc2libGVfYW5zd2VyX2l0ZW0nKVxuICAgICAgICAgICAgICAgIC5yZW1vdmVDbGFzcygnaGFzLWVycm9yIGhhcy1mZWVkYmFjaycpO1xuXG4gICAgICAgICAgICAkKHBvc3NpYmxlX2Fuc3dlcikuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2Vycm9yJylcbiAgICAgICAgICAgICAgICAuYWRkQ2xhc3MoJ2hpZGRlbicpXG4gICAgICAgICAgICAgICAgLnRleHQoJycpOy8vc2V0IGVycm9yIGRlc2NyaXB0aW9uXG5cbiAgICAgICAgfSk7XG4gICAgICAgIC8vcmVtb3ZlIHZpc3VhbCBlcnJvcnMgZnJvbSB0YWJzIChpZiB0aGUgaW5wdXQgaXMgdmFsaWQsIHRoZXJlIG1pZ2h0IGJlIHNvbWUgY3VuY3VycmVuY3kgY29uZGl0aW9ucylcbiAgICAgICAgaWYgKGlucHV0LmRvbS5pc192YWxpZCkge1xuICAgICAgICAgICAgaW5wdXQuZG9tLnByb3BlcnRpZXNfcGFuZWwuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX3RhYnMgLm5hdi10YWJzIGknKS5hZGRDbGFzcygnaW52aXNpYmxlJyk7XG4gICAgICAgICAgICBpbnB1dC5kb20ucHJvcGVydGllc19wYW5lbC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fdGFicyAubmF2LXRhYnMgaScpLnBhcmVudCgpLnJlbW92ZUNsYXNzKCd2YWxpZGF0aW9uLWVycm9yJyk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgaGlkZVRhYkJ1dHRvbnNFcnJvcnM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy90b2RvIG1heWJlIHRoaXMgaXMgbm90IG5lZWRlZFxuICAgIH0sXG5cbiAgICBoaWRlQWR2YW5jZWRQcm9wZXJ0aWVzRXJyb3JzOiBmdW5jdGlvbiAoaW5wdXQsIHRoZV9wcm9wZXJ0aWVzKSB7XG5cbiAgICAgICAgdmFyIGk7XG4gICAgICAgIHZhciBwcm9wZXJ0aWVzID0gdGhlX3Byb3BlcnRpZXM7XG4gICAgICAgIHZhciBpTGVuZ3RoID0gcHJvcGVydGllcy5sZW5ndGg7XG4gICAgICAgIHZhciB3cmFwcGVyID0gZm9ybWJ1aWxkZXIuZG9tXG4gICAgICAgICAgICAuaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyXG4gICAgICAgICAgICAuZmluZCgnZm9ybVtkYXRhLWlucHV0LXJlZj1cIicgKyBpbnB1dC5yZWYgKyAnXCJdJylcbiAgICAgICAgICAgIC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fYWR2YW5jZWQtcHJvcGVydGllcycpO1xuXG5cbiAgICAgICAgZm9yIChpID0gMDsgaSA8IGlMZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgd3JhcHBlclxuICAgICAgICAgICAgICAgIC5maW5kKCdkaXYuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fYWR2YW5jZWQtcHJvcGVydGllc19fJyArIHByb3BlcnRpZXNbaV0pXG4gICAgICAgICAgICAgICAgLnJlbW92ZUNsYXNzKCdoYXMtZXJyb3IgaGFzLWZlZWRiYWNrJyk7XG5cbiAgICAgICAgICAgIHdyYXBwZXJcbiAgICAgICAgICAgICAgICAuZmluZCgnZGl2LmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2FkdmFuY2VkLXByb3BlcnRpZXNfXycgKyBwcm9wZXJ0aWVzW2ldICsgJyBpJylcbiAgICAgICAgICAgICAgICAuYWRkQ2xhc3MoJ2hpZGRlbicpO1xuXG4gICAgICAgICAgICB3cmFwcGVyXG4gICAgICAgICAgICAgICAgLmZpbmQoJ2Rpdi5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19hZHZhbmNlZC1wcm9wZXJ0aWVzX18nICsgcHJvcGVydGllc1tpXSArICcgc3Bhbi5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19lcnJvcicpXG4gICAgICAgICAgICAgICAgLmFkZENsYXNzKCdoaWRkZW4nKVxuICAgICAgICAgICAgICAgIC50ZXh0KCcnKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvL2hpZGUgaW5saW5lIGVycm9ycyBmcm9tIGp1bXBzIChyZWQgb3VsaW5lIGFuZCBlcnJvciBtZXNzYWdlKVxuICAgIGhpZGVKdW1wc0Vycm9yczogZnVuY3Rpb24gKHRoZV9qdW1wc19saXN0KSB7XG5cbiAgICAgICAgdmFyIGp1bXBfbGlzdCA9IHRoZV9qdW1wc19saXN0O1xuICAgICAgICB2YXIganVtcF9wcm9wZXJ0aWVzID0gWyd3aGVuJywgJ2Fuc3dlcicsICdnb3RvJ107XG5cbiAgICAgICAgJChqdW1wX2xpc3QpLmVhY2goZnVuY3Rpb24gKGluZGV4LCBqdW1wKSB7XG4gICAgICAgICAgICAkKGp1bXBfcHJvcGVydGllcykuZWFjaChmdW5jdGlvbiAoaW5kZXgsIHByb3ApIHtcbiAgICAgICAgICAgICAgICAkKGp1bXApXG4gICAgICAgICAgICAgICAgICAgIC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fanVtcHNfX2xvZ2ljLS0nICsgcHJvcClcbiAgICAgICAgICAgICAgICAgICAgLnJlbW92ZUNsYXNzKCdoYXMtZXJyb3InKVxuICAgICAgICAgICAgICAgICAgICAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2Vycm9yJylcbiAgICAgICAgICAgICAgICAgICAgLmFkZENsYXNzKCdoaWRkZW4nKVxuICAgICAgICAgICAgICAgICAgICAudGV4dCgnJyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIHNob3dRdWVzdGlvblRleHRFcnJvcnM6IGZ1bmN0aW9uICh0aGVfcHJvcGVydGllc19wYW5lbCwgdGhlX2Vycm9yX21lc3NhZ2UpIHtcblxuICAgICAgICB2YXIgcHJvcGVydGllc19wYW5lbCA9IHRoZV9wcm9wZXJ0aWVzX3BhbmVsO1xuICAgICAgICB2YXIgZXJyb3IgPSB0aGVfZXJyb3JfbWVzc2FnZTtcblxuICAgICAgICAvL2hpZ2hsaWdodCB3cm9uZyBpbnB1dCBhbmQgc2hvdyBlcnJvciBtZXNzYWdlXG4gICAgICAgIHByb3BlcnRpZXNfcGFuZWwuZmluZCgnZGl2LmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX3F1ZXN0aW9uJylcbiAgICAgICAgICAgIC5hZGRDbGFzcygnaGFzLWVycm9yIGhhcy1mZWVkYmFjaycpO1xuICAgICAgICBwcm9wZXJ0aWVzX3BhbmVsLmZpbmQoJ2Rpdi5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19xdWVzdGlvbiBpJylcbiAgICAgICAgICAgIC5yZW1vdmVDbGFzcygnaGlkZGVuJylcbiAgICAgICAgICAgIC5oaWRlKClcbiAgICAgICAgICAgIC5mYWRlSW4oY29uc3RzLkFOSU1BVElPTl9GQVNUKTtcbiAgICAgICAgcHJvcGVydGllc19wYW5lbC5maW5kKCdkaXYuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fcXVlc3Rpb24gc3Bhbi5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19lcnJvcicpXG4gICAgICAgICAgICAucmVtb3ZlQ2xhc3MoJ2hpZGRlbicpXG4gICAgICAgICAgICAudGV4dChlcnJvcikvL3NldCBlcnJvciBkZXNjcmlwdGlvblxuICAgICAgICAgICAgLmhpZGUoKVxuICAgICAgICAgICAgLmZhZGVJbihjb25zdHMuQU5JTUFUSU9OX0ZBU1QpO1xuXG4gICAgICAgIC8vc2hvdyAnIScgb24gYWZmZWN0ZWQgdGFiLCBpbiB0aGlzIGNhc2UgdGhlIGJhc2ljIHByb3BlcnRpZXMgdGFiIChmaXJzdClcbiAgICAgICAgcHJvcGVydGllc19wYW5lbC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fdGFicyAubmF2LXRhYnMgaTpmaXJzdCcpXG4gICAgICAgICAgICAucmVtb3ZlQ2xhc3MoJ2ludmlzaWJsZScpXG4gICAgICAgICAgICAuZmFkZUluKGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG5cbiAgICAgICAgLy9zZXQgcHJvcGVydGllcyB0YWIgdGV4dCB0byByZWRcbiAgICAgICAgcHJvcGVydGllc19wYW5lbC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fdGFicyAubmF2LXRhYnMgaTpmaXJzdCcpXG4gICAgICAgICAgICAucGFyZW50KClcbiAgICAgICAgICAgIC5hZGRDbGFzcygndmFsaWRhdGlvbi1lcnJvcicpO1xuXG5cbiAgICB9LFxuXG4gICAgc2hvd0Zvcm1OYW1lRXJyb3JzOiBmdW5jdGlvbiAodGhlX21vZGFsLCB0aGVfZXJyb3JfbWVzc2FnZSkge1xuXG4gICAgICAgIHZhciBtb2RhbCA9IHRoZV9tb2RhbDtcbiAgICAgICAgdmFyIGVycm9yID0gdGhlX2Vycm9yX21lc3NhZ2U7XG5cbiAgICAgICAgbW9kYWwuZmluZCgnLm1vZGFsLWJvZHkgLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2Vycm9yJylcbiAgICAgICAgICAgIC5yZW1vdmVDbGFzcygnaGlkZGVuJylcbiAgICAgICAgICAgIC50ZXh0KGVycm9yKS8vc2V0IGVycm9yIGRlc2NyaXB0aW9uXG4gICAgICAgICAgICAuaGlkZSgpXG4gICAgICAgICAgICAuZmFkZUluKDMwMCk7XG4gICAgfSxcblxuICAgIGhpZGVGb3JtTmFtZUVycm9yczogZnVuY3Rpb24gKHRoZV9tb2RhbCkge1xuXG4gICAgICAgIHZhciBtb2RhbCA9IHRoZV9tb2RhbDtcbiAgICAgICAgbW9kYWwuZmluZCgnLm1vZGFsLWJvZHkgLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2Vycm9yJylcbiAgICAgICAgICAgIC5hZGRDbGFzcygnaGlkZGVuJylcbiAgICAgICAgICAgIC50ZXh0KCcnKTtcbiAgICB9LFxuXG4gICAgc2hvd1Bvc3NpYmxlQW5zd2VyRXJyb3JzOiBmdW5jdGlvbiAodGhlX3Bvc3NpYmxlX2Fuc3dlciwgdGhlX2Vycm9yX21lc3NhZ2UpIHtcblxuICAgICAgICB2YXIgcG9zc2libGVfYW5zd2VyID0gdGhlX3Bvc3NpYmxlX2Fuc3dlcjtcbiAgICAgICAgdmFyIHByb3BlcnRpZXNfcGFuZWwgPSBwb3NzaWJsZV9hbnN3ZXIucGFyZW50cygpLmVxKDkpO1xuICAgICAgICB2YXIgZXJyb3IgPSB0aGVfZXJyb3JfbWVzc2FnZTtcblxuICAgICAgICAvL2hpZ2hsaWdodCB3cm9uZyBpbnB1dCBhbmQgc2hvdyBlcnJvciBtZXNzYWdlXG4gICAgICAgIHBvc3NpYmxlX2Fuc3dlci5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fcG9zc2libGUtYW5zd2Vyc19fbGlzdF9fcG9zc2libGVfYW5zd2VyX2l0ZW0nKVxuICAgICAgICAgICAgLmFkZENsYXNzKCdoYXMtZXJyb3IgaGFzLWZlZWRiYWNrJyk7XG5cbiAgICAgICAgcG9zc2libGVfYW5zd2VyLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19lcnJvcicpXG4gICAgICAgICAgICAucmVtb3ZlQ2xhc3MoJ2hpZGRlbicpXG4gICAgICAgICAgICAudGV4dChlcnJvcikvL3NldCBlcnJvciBkZXNjcmlwdGlvblxuICAgICAgICAgICAgLmhpZGUoKVxuICAgICAgICAgICAgLmZhZGVJbigzMDApO1xuXG5cbiAgICAgICAgLy9zaG93ICchJyBvbiBhZmZlY3RlZCB0YWIsIGluIHRoaXMgY2FzZSB0aGUgYmFzaWMgcHJvcGVydGllcyB0YWIgKGZpcnN0KVxuICAgICAgICBwcm9wZXJ0aWVzX3BhbmVsLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX190YWJzIC5uYXYtdGFicyBpOmZpcnN0JylcbiAgICAgICAgICAgIC5yZW1vdmVDbGFzcygnaW52aXNpYmxlJylcbiAgICAgICAgICAgIC5oaWRlKClcbiAgICAgICAgICAgIC5mYWRlSW4oMzAwKTtcblxuICAgICAgICAvL3NldCBwcm9wZXJ0aWVzIHRhYiB0ZXh0IHRvIHJlZFxuICAgICAgICBwcm9wZXJ0aWVzX3BhbmVsLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX190YWJzIC5uYXYtdGFicyBpOmZpcnN0JylcbiAgICAgICAgICAgIC5wYXJlbnQoKVxuICAgICAgICAgICAgLmFkZENsYXNzKCd2YWxpZGF0aW9uLWVycm9yJyk7XG5cbiAgICB9LFxuXG4gICAgc2hvd1NpbmdsZUFkdmFuY2VkUHJvcGVydHlFcnJvcjogZnVuY3Rpb24gKHRoZV93cmFwcGVyLCB0aGVfcHJvcGVydHksIHRoZV9lcnJvcikge1xuXG4gICAgICAgIHZhciBwcm9wID0gdGhlX3Byb3BlcnR5O1xuICAgICAgICB2YXIgZXJyb3IgPSB0aGVfZXJyb3I7XG4gICAgICAgIHZhciB3cmFwcGVyID0gdGhlX3dyYXBwZXI7XG5cbiAgICAgICAgd3JhcHBlclxuICAgICAgICAgICAgLmZpbmQoJ2Rpdi5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19hZHZhbmNlZC1wcm9wZXJ0aWVzX18nICsgcHJvcCkuYWRkQ2xhc3MoJ2hhcy1lcnJvciBoYXMtZmVlZGJhY2snKTtcblxuICAgICAgICB3cmFwcGVyXG4gICAgICAgICAgICAuZmluZCgnZGl2LmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2FkdmFuY2VkLXByb3BlcnRpZXNfXycgKyBwcm9wICsgJyBpJylcbiAgICAgICAgICAgIC5yZW1vdmVDbGFzcygnaGlkZGVuJylcbiAgICAgICAgICAgIC5oaWRlKClcbiAgICAgICAgICAgIC5mYWRlSW4oMzAwKTtcblxuICAgICAgICB3cmFwcGVyXG4gICAgICAgICAgICAuZmluZCgnZGl2LmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2FkdmFuY2VkLXByb3BlcnRpZXNfXycgKyBwcm9wICsgJyBzcGFuLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2Vycm9yJylcbiAgICAgICAgICAgIC5yZW1vdmVDbGFzcygnaGlkZGVuJylcbiAgICAgICAgICAgIC50ZXh0KGVycm9yKVxuICAgICAgICAgICAgLmhpZGUoKVxuICAgICAgICAgICAgLmZhZGVJbigzMDApO1xuXG4gICAgICAgIC8vc2hvdyAnIScgb24gYWZmZWN0ZWQgdGFiLCBpbiB0aGlzIGNhc2UgdGhlIGFkdmFuY2VkIHByb3BlcnRpZXMgdGFiXG4gICAgICAgIHdyYXBwZXIucGFyZW50KCkucGFyZW50KCkuZmluZCgnLm5hdi10YWJzJykuZmluZCgnaS5hZHZhbmNlZC1lcnJvcicpXG4gICAgICAgICAgICAucmVtb3ZlQ2xhc3MoJ2ludmlzaWJsZScpXG4gICAgICAgICAgICAuaGlkZSgpXG4gICAgICAgICAgICAuZmFkZUluKDMwMCk7XG5cbiAgICAgICAgLy9zZXQgcHJvcGVydGllcyB0YWIgdGV4dCB0byByZWRcbiAgICAgICAgd3JhcHBlci5wYXJlbnQoKS5wYXJlbnQoKS5maW5kKCcubmF2LXRhYnMnKS5maW5kKCdpLmFkdmFuY2VkLWVycm9yJylcbiAgICAgICAgICAgIC5wYXJlbnQoKVxuICAgICAgICAgICAgLmFkZENsYXNzKCd2YWxpZGF0aW9uLWVycm9yJyk7XG4gICAgfSxcblxuICAgIHNob3dTaW5nbGVKdW1wRXJyb3JzOiBmdW5jdGlvbiAodGhlX2p1bXBfaXRlbV93cmFwcGVyLCB0aGVfcHJvcGVydGllcykge1xuXG4gICAgICAgIHZhciBqdW1wX3Byb3BlcnRpZXMgPSB0aGVfcHJvcGVydGllcztcbiAgICAgICAgdmFyIHdyYXBwZXIgPSB0aGVfanVtcF9pdGVtX3dyYXBwZXI7XG4gICAgICAgIHZhciB1aSA9IHJlcXVpcmUoJ2hlbHBlcnMvdWknKTtcblxuICAgICAgICAvL2p1bXAgY29uZGl0aW9uIHdhcyBub3Qgc2VsZWN0ZWRcbiAgICAgICAgaWYgKGp1bXBfcHJvcGVydGllcy53aGVuID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHdyYXBwZXJcbiAgICAgICAgICAgICAgICAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2p1bXBzX19sb2dpYy0td2hlbicpXG4gICAgICAgICAgICAgICAgLmFkZENsYXNzKCdoYXMtZXJyb3InKVxuICAgICAgICAgICAgICAgIC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fZXJyb3InKVxuICAgICAgICAgICAgICAgIC5yZW1vdmVDbGFzcygnaGlkZGVuJylcbiAgICAgICAgICAgICAgICAudGV4dChtZXNzYWdlcy5lcnJvci5KVU1QX0NPTkRJVElPTl9OT1RfU0VMRUNURUQpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9qdW1wIGFuc3dlciBub3Qgc2VsZWN0ZWRcbiAgICAgICAgaWYgKGp1bXBfcHJvcGVydGllcy5hbnN3ZXJfcmVmID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHdyYXBwZXJcbiAgICAgICAgICAgICAgICAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2p1bXBzX19sb2dpYy0tYW5zd2VyJylcbiAgICAgICAgICAgICAgICAuYWRkQ2xhc3MoJ2hhcy1lcnJvciAnKVxuICAgICAgICAgICAgICAgIC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fZXJyb3InKVxuICAgICAgICAgICAgICAgIC5yZW1vdmVDbGFzcygnaGlkZGVuJylcbiAgICAgICAgICAgICAgICAudGV4dChtZXNzYWdlcy5lcnJvci5KVU1QX0FOU1dFUl9OT1RfU0VMRUNURUQpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9qdW1wIGRlc3RpbmF0aW9uIG5vdCBzZWxlY3RlZFxuICAgICAgICBpZiAoanVtcF9wcm9wZXJ0aWVzLnRvID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHdyYXBwZXJcbiAgICAgICAgICAgICAgICAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2p1bXBzX19sb2dpYy0tZ290bycpXG4gICAgICAgICAgICAgICAgLmFkZENsYXNzKCdoYXMtZXJyb3IgJylcbiAgICAgICAgICAgICAgICAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2Vycm9yJylcbiAgICAgICAgICAgICAgICAucmVtb3ZlQ2xhc3MoJ2hpZGRlbicpXG4gICAgICAgICAgICAgICAgLnRleHQobWVzc2FnZXMuZXJyb3IuSlVNUF9ERVNUSU5BVElPTl9OT1RfU0VMRUNURUQpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9qdW1wIGRlc3RpbmF0aW9uIG5vdCB2YWxpZCAoYWZ0ZXIgZHJhZ2dpbmcpXG4gICAgICAgIGlmICghanVtcF9wcm9wZXJ0aWVzLmhhc192YWxpZF9kZXN0aW5hdGlvbikge1xuICAgICAgICAgICAgd3JhcHBlclxuICAgICAgICAgICAgICAgIC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fanVtcHNfX2xvZ2ljLS1nb3RvJylcbiAgICAgICAgICAgICAgICAuYWRkQ2xhc3MoJ2hhcy1lcnJvcicpXG4gICAgICAgICAgICAgICAgLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19lcnJvcicpXG4gICAgICAgICAgICAgICAgLnJlbW92ZUNsYXNzKCdoaWRkZW4nKVxuICAgICAgICAgICAgICAgIC50ZXh0KG1lc3NhZ2VzLmVycm9yLkpVTVBfREVTVElOQVRJT05fTk9UX1NFTEVDVEVEKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnNvbGUubG9nKHdyYXBwZXIucGFyZW50cygpLmVxKDUpKTtcblxuICAgICAgICB1aS5pbnB1dF9wcm9wZXJ0aWVzX3BhbmVsLnNob3dKdW1wVGFiRXJyb3Iod3JhcHBlcik7XG4gICAgfSxcblxuICAgIHNob3dCcmFuY2hJbnB1dHNFcnJvcnM6IGZ1bmN0aW9uICh0aGVfcHJvcGVydGllc19wYW5lbCwgdGhlX2Vycm9yX21lc3NhZ2UpIHtcblxuICAgICAgICB2YXIgcHJvcGVydGllc19wYW5lbCA9IHRoZV9wcm9wZXJ0aWVzX3BhbmVsO1xuICAgICAgICB2YXIgZXJyb3IgPSB0aGVfZXJyb3JfbWVzc2FnZTtcbiAgICAgICAgdmFyIGJyYW5jaF9pbnB1dF9yZWYgPSBmb3JtYnVpbGRlci5icmFuY2guY3VycmVudF9pbnB1dF9yZWY7XG4gICAgICAgIHZhciB1aSA9IHJlcXVpcmUoJ2hlbHBlcnMvdWknKTtcblxuXG4gICAgICAgIC8vc2hvdyBlcnJvciBtZXNzYWdlXG4gICAgICAgIHByb3BlcnRpZXNfcGFuZWwuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2Vycm9yLS1icmFuY2gtZXJyb3InKVxuICAgICAgICAgICAgLnJlbW92ZUNsYXNzKCdpbnZpc2libGUnKVxuICAgICAgICAgICAgLnRleHQoZXJyb3IpO1xuICAgICAgICAvLy5oaWRlKClcbiAgICAgICAgLy8gIC5mYWRlSW4oMzAwKTtcblxuICAgICAgICAvL3RvZ2dsZSBpY29uIHRvIHdhcm5pbmdcbiAgICAgICAgdWkuaW5wdXRzX2NvbGxlY3Rpb24uc2hvd0lucHV0SW52YWxpZEljb24oYnJhbmNoX2lucHV0X3JlZik7XG4gICAgfSxcblxuICAgIHNob3dHcm91cElucHV0c0Vycm9yczogZnVuY3Rpb24gKHRoZV9wcm9wZXJ0aWVzX3BhbmVsLCB0aGVfZXJyb3JfbWVzc2FnZSkge1xuXG4gICAgICAgIHZhciBwcm9wZXJ0aWVzX3BhbmVsID0gdGhlX3Byb3BlcnRpZXNfcGFuZWw7XG4gICAgICAgIHZhciBlcnJvciA9IHRoZV9lcnJvcl9tZXNzYWdlO1xuICAgICAgICB2YXIgYnJhbmNoX2lucHV0X3JlZiA9IGZvcm1idWlsZGVyLmJyYW5jaC5jdXJyZW50X2lucHV0X3JlZjtcbiAgICAgICAgdmFyIHVpID0gcmVxdWlyZSgnaGVscGVycy91aScpO1xuXG5cbiAgICAgICAgLy9zaG93IGVycm9yIG1lc3NhZ2VcbiAgICAgICAgcHJvcGVydGllc19wYW5lbC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fZXJyb3ItLWdyb3VwLWVycm9yJylcbiAgICAgICAgICAgIC5yZW1vdmVDbGFzcygnaW52aXNpYmxlJylcbiAgICAgICAgICAgIC50ZXh0KGVycm9yKTtcbiAgICAgICAgLy8gLmhpZGUoKVxuICAgICAgICAvLy5mYWRlSW4oMzAwKTtcblxuICAgICAgICAvL3RvZ2dsZSBpY29uIHRvIHdhcm5pbmdcbiAgICAgICAgdWkuaW5wdXRzX2NvbGxlY3Rpb24uc2hvd0lucHV0SW52YWxpZEljb24oYnJhbmNoX2lucHV0X3JlZik7XG4gICAgfSxcblxuICAgIGhpZGVCcmFuY2hJbnB1dHNFcnJvcnM6IGZ1bmN0aW9uICh0aGVfcHJvcGVydGllc19wYW5lbCkge1xuICAgICAgICAvL3Nob3cgZXJyb3IgbWVzc2FnZVxuICAgICAgICB0aGVfcHJvcGVydGllc19wYW5lbC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fZXJyb3ItLWJyYW5jaC1lcnJvcicpXG4gICAgICAgICAgICAuYWRkQ2xhc3MoJ2ludmlzaWJsZScpXG4gICAgICAgICAgICAudGV4dCgnJm5ic3A7Jyk7XG4gICAgfSxcblxuICAgIGhpZGVHcm91cElucHV0c0Vycm9yczogZnVuY3Rpb24gKHRoZV9wcm9wZXJ0aWVzX3BhbmVsKSB7XG4gICAgICAgIC8vc2hvdyBlcnJvciBtZXNzYWdlXG4gICAgICAgIHRoZV9wcm9wZXJ0aWVzX3BhbmVsLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19lcnJvci0tZ3JvdXAtZXJyb3InKVxuICAgICAgICAgICAgLmFkZENsYXNzKCdpbnZpc2libGUnKVxuICAgICAgICAgICAgLnRleHQoJyZuYnNwOycpO1xuICAgIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gZXJyb3JzO1xuIiwiLyogZ2xvYmFsIENpcmN1bGFySlNPTiovXG4ndXNlIHN0cmljdCc7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoJ2hlbHBlcnMvdXRpbHMnKTtcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgdGVtcGxhdGUgPSByZXF1aXJlKCd0ZW1wbGF0ZScpO1xudmFyIGlucHV0X2ZhY3RvcnkgPSByZXF1aXJlKCdmYWN0b3J5L2lucHV0LWZhY3RvcnknKTtcblxudmFyIGNvcHkgPSB7XG5cbiAgICBwdXNoSW5wdXQ6IGZ1bmN0aW9uIChpbnB1dCkge1xuXG4gICAgICAgIHZhciBicmFuY2hfaW5wdXRzO1xuICAgICAgICB2YXIgZ3JvdXBfaW5wdXRzO1xuXG4gICAgICAgIC8vcmVtb3ZlIGp1bXBzICh0aGV5IHdvdWxkIGJlIGludmFsaWQgd2hlbiBjb3BpZWQsIHNvIG5vdCB3b3J0aHkpXG4gICAgICAgIGlucHV0Lmp1bXBzID0gW107XG5cbiAgICAgICAgLy9hbHNvLCBkbyBub3QgY29weSB0aGUgdGl0bGUsIHNldCBpdCBhcyBmYWxzZSAoYXMgd2UgbWlnaHQgZ28gb3ZlciB0aGUgMyB0aXRsZSBsaW1pdHMpXG4gICAgICAgIGlucHV0LmlzX3RpdGxlID0gZmFsc2U7XG5cbiAgICAgICAgLy9hZGQgaW5wdXQgdG8gY29sbGVjdGlvbiBhcyB0aGUgbGFzdCBvbmVcbiAgICAgICAgaWYgKGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfYnJhbmNoICYmIGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfZ3JvdXApIHtcblxuICAgICAgICAgICAgdmFyIGJyYW5jaF9pbmRleCA9IHV0aWxzLmdldElucHV0Q3VycmVudEluZGV4QnlSZWYoZm9ybWJ1aWxkZXIuY3VycmVudF9pbnB1dF9yZWYpO1xuICAgICAgICAgICAgdmFyIG5lc3RlZF9ncm91cF9pbmRleCA9IHV0aWxzLmdldEJyYW5jaElucHV0Q3VycmVudEluZGV4QnlSZWYoYnJhbmNoX2luZGV4LCBmb3JtYnVpbGRlci5ncm91cC5hY3RpdmVfZ3JvdXBfcmVmKTtcblxuICAgICAgICAgICAgLy9wdXNoIG5lc3RlZCBncm91cCBpbnB1dFxuICAgICAgICAgICAgZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uLmRhdGEucHJvamVjdFxuICAgICAgICAgICAgICAgIC5mb3Jtc1tmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXhdXG4gICAgICAgICAgICAgICAgLmlucHV0c1ticmFuY2hfaW5kZXhdXG4gICAgICAgICAgICAgICAgLmJyYW5jaFtuZXN0ZWRfZ3JvdXBfaW5kZXhdXG4gICAgICAgICAgICAgICAgLmdyb3VwLnB1c2goaW5wdXQpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuXG4gICAgICAgICAgICBpZiAoIWZvcm1idWlsZGVyLmlzX2VkaXRpbmdfYnJhbmNoICYmICFmb3JtYnVpbGRlci5pc19lZGl0aW5nX2dyb3VwKSB7XG4gICAgICAgICAgICAgICAgLy9wdXNoIHRvcCBsZXZlbCBpbnB1dFxuICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbi5kYXRhLnByb2plY3QuZm9ybXNbZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4XS5pbnB1dHMucHVzaChpbnB1dCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChmb3JtYnVpbGRlci5pc19lZGl0aW5nX2JyYW5jaCkge1xuICAgICAgICAgICAgICAgIGJyYW5jaF9pbnB1dHMgPSB1dGlscy5nZXRJbnB1dE9iamVjdEJ5UmVmKGZvcm1idWlsZGVyLmJyYW5jaC5hY3RpdmVfYnJhbmNoX3JlZikuYnJhbmNoO1xuICAgICAgICAgICAgICAgIC8vcHVzaCBicmFuY2ggaW5wdXRcbiAgICAgICAgICAgICAgICBicmFuY2hfaW5wdXRzLnB1c2goaW5wdXQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19ncm91cCkge1xuICAgICAgICAgICAgICAgIGdyb3VwX2lucHV0cyA9IHV0aWxzLmdldElucHV0T2JqZWN0QnlSZWYoZm9ybWJ1aWxkZXIuZ3JvdXAuYWN0aXZlX2dyb3VwX3JlZikuZ3JvdXA7XG4gICAgICAgICAgICAgICAgLy9wdXNoIGdyb3VwIGlucHV0XG4gICAgICAgICAgICAgICAgZ3JvdXBfaW5wdXRzLnB1c2goaW5wdXQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSxcblxuICAgIGFwcGVuZElucHV0VG9Eb206IGZ1bmN0aW9uIChpbnB1dCkge1xuXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdmFyIGlucHV0X2h0bWwgPSBzZWxmLmNyZWF0ZUlucHV0SFRNTChpbnB1dCk7XG4gICAgICAgIHZhciBhY3RpdmVfYnJhbmNoX3NvcnRhYmxlO1xuICAgICAgICB2YXIgYWN0aXZlX2dyb3VwX3NvcnRhYmxlO1xuXG4gICAgICAgIGlmIChmb3JtYnVpbGRlci5pc19lZGl0aW5nX2JyYW5jaCAmJiBmb3JtYnVpbGRlci5pc19lZGl0aW5nX2dyb3VwKSB7XG5cbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ2FjdGl2ZSBncm91cCByZWYgPSAnICsgZm9ybWJ1aWxkZXIuZ3JvdXAuYWN0aXZlX2dyb3VwX3JlZik7XG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKCdhY3RpdmUgYnJhbmNoIHJlZiA9ICcgKyBmb3JtYnVpbGRlci5icmFuY2guYWN0aXZlX2JyYW5jaF9yZWYpO1xuXG4gICAgICAgICAgICAvL3RvZG9cbiAgICAgICAgICAgIC8vZ2V0IGFjdGl2ZSBncm91cCBzb3J0YWJsZVxuICAgICAgICAgICAgYWN0aXZlX2dyb3VwX3NvcnRhYmxlID0gZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uX3NvcnRhYmxlXG4gICAgICAgICAgICAgICAgLmZpbmQoJ2Rpdi5pbnB1dFtkYXRhLWlucHV0LXJlZj1cIicgKyBmb3JtYnVpbGRlci5ncm91cC5hY3RpdmVfZ3JvdXBfcmVmICsgJ1wiXScpXG4gICAgICAgICAgICAgICAgLmZpbmQoJy5ncm91cC1zb3J0YWJsZScpO1xuXG4gICAgICAgICAgICAvL2FwcGVuZCBtYXJrdXAgdG8gZ3JvdXAgc29ydGFibGVcbiAgICAgICAgICAgIGFjdGl2ZV9ncm91cF9zb3J0YWJsZS5hcHBlbmQoaW5wdXRfaHRtbC5jb2xsZWN0aW9uKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmICghZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19icmFuY2ggJiYgIWZvcm1idWlsZGVyLmlzX2VkaXRpbmdfZ3JvdXApIHtcbiAgICAgICAgICAgICAgICAvL2FwcGVuZCB0byB0b3AgbGV2ZWwgc29ydGFibGVcbiAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25fc29ydGFibGUuYXBwZW5kKGlucHV0X2h0bWwuY29sbGVjdGlvbik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChmb3JtYnVpbGRlci5pc19lZGl0aW5nX2JyYW5jaCkge1xuXG4gICAgICAgICAgICAgICAgLy9nZXQgYWN0aXZlIGJyYW5jaCBzb3J0YWJsZVxuICAgICAgICAgICAgICAgIGFjdGl2ZV9icmFuY2hfc29ydGFibGUgPSBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25fc29ydGFibGVcbiAgICAgICAgICAgICAgICAgICAgLmZpbmQoJ2Rpdi5pbnB1dFtkYXRhLWlucHV0LXJlZj1cIicgKyBmb3JtYnVpbGRlci5icmFuY2guYWN0aXZlX2JyYW5jaF9yZWYgKyAnXCJdJylcbiAgICAgICAgICAgICAgICAgICAgLmZpbmQoJy5icmFuY2gtc29ydGFibGUnKTtcblxuICAgICAgICAgICAgICAgIC8vYXBwZW5kIG1hcmt1cCB0byBicmFjbmggc29ydGFibGVcbiAgICAgICAgICAgICAgICBhY3RpdmVfYnJhbmNoX3NvcnRhYmxlLmFwcGVuZChpbnB1dF9odG1sLmNvbGxlY3Rpb24pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19ncm91cCkge1xuXG4gICAgICAgICAgICAgICAgLy9nZXQgYWN0aXZlIGdyb3VwIHNvcnRhYmxlXG4gICAgICAgICAgICAgICAgYWN0aXZlX2dyb3VwX3NvcnRhYmxlID0gZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uX3NvcnRhYmxlXG4gICAgICAgICAgICAgICAgICAgIC5maW5kKCdkaXYuaW5wdXRbZGF0YS1pbnB1dC1yZWY9XCInICsgZm9ybWJ1aWxkZXIuZ3JvdXAuYWN0aXZlX2dyb3VwX3JlZiArICdcIl0nKVxuICAgICAgICAgICAgICAgICAgICAuZmluZCgnLmdyb3VwLXNvcnRhYmxlJyk7XG5cbiAgICAgICAgICAgICAgICAvL2FwcGVuZCBtYXJrdXAgdG8gZ3JvdXAgc29ydGFibGVcbiAgICAgICAgICAgICAgICBhY3RpdmVfZ3JvdXBfc29ydGFibGUuYXBwZW5kKGlucHV0X2h0bWwuY29sbGVjdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvL2FwcGVuZCBwYW5lbHNcbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlci5hcHBlbmQoaW5wdXRfaHRtbC5wYW5lbHMpO1xuICAgIH0sXG5cbiAgICBjcmVhdGVJbnB1dEhUTUw6IGZ1bmN0aW9uIChpbnB1dCkge1xuXG4gICAgICAgIHZhciBwYXJzZSA9IHJlcXVpcmUoJ2FjdGlvbnMvcGFyc2UnKTtcbiAgICAgICAgdmFyIGlucHV0X2ZhY3RvcnkgPSByZXF1aXJlKCdmYWN0b3J5L2lucHV0LWZhY3RvcnknKTtcbiAgICAgICAgdmFyIGZvcm1faW5kZXggPSBmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXg7XG4gICAgICAgIHZhciBpbnB1dHMgPSBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0LmZvcm1zW2Zvcm1faW5kZXhdLmlucHV0cztcbiAgICAgICAgLy9jcmVhdGUgaHRtbCBlbGVtZW50IGZvciBpbnB1dCBjb2xsZWN0aW9uIChtaWRkbGUgY29sdW1uKVxuICAgICAgICB2YXIgaW5wdXRfY29sbGVjdGlvbl9odG1sID0gaW5wdXRfZmFjdG9yeS5jcmVhdGVJbnB1dFRvb2xIVE1MKGlucHV0KTtcbiAgICAgICAgdmFyIHByb3BlcnRpZXNfcGFuZWxfaHRtbDtcbiAgICAgICAgdmFyIGlucHV0X3Byb3BlcnRpZXNfcGFuZWxfaHRtbCA9ICcnO1xuXG5cbiAgICAgICAgLy9pZiBpdCBpcyBhIGJyYW5jaCwgbG9vcCBhbGwgdGhlIGJyYW5jaCBpbnB1dHMgKHRoZXJlIG11c3QgYmUgYXQgbGVhc3QgYSBicmFuY2ggaW5wdXQpXG4gICAgICAgIGlmIChpbnB1dC50eXBlID09PSBjb25zdHMuQlJBTkNIX1RZUEUpIHtcbiAgICAgICAgICAgIC8vdG9kbyBjaGVjayB0aGUgc2Vjb25zIGFyZyBvZiBnZXRCcmFuY2hJbnB1dHNIVE1MLCBJIGhhZCB0byBwYXNzIGBpbnB1dHMubGVuZ3RoIC0gMWBcbiAgICAgICAgICAgIHZhciBicmFuY2hfaW5wdXRzX2h0bWwgPSBwYXJzZS5nZXRCcmFuY2hJbnB1dHNIVE1MKGlucHV0LCBpbnB1dHMubGVuZ3RoIC0gMSk7XG4gICAgICAgICAgICBpbnB1dF9jb2xsZWN0aW9uX2h0bWwgPSBpbnB1dF9jb2xsZWN0aW9uX2h0bWwucmVwbGFjZSgne3ticmFuY2gtY29udGVudH19JywgYnJhbmNoX2lucHV0c19odG1sLmNvbGxlY3Rpb24pO1xuICAgICAgICAgICAgLy90b2RvIGNoZWNrIHdoZXJlIHRoZSBzdHJpbmcgcmVwbGFjZW1lbnQgaGFwcGVuc1xuICAgICAgICAgICAgaW5wdXRfcHJvcGVydGllc19wYW5lbF9odG1sICs9IGJyYW5jaF9pbnB1dHNfaHRtbC5wYW5lbHM7XG4gICAgICAgIH1cblxuICAgICAgICAvL2lmIGl0IGlzIGEgZ3JvdXAsIGxvb3AgYWxsIHRoZSBncm91cCBpbnB1dHMgKHRoZXJlIG11c3QgYmUgYXQgbGVhc3QgYSBncm91cCBpbnB1dClcbiAgICAgICAgaWYgKGlucHV0LnR5cGUgPT09IGNvbnN0cy5HUk9VUF9UWVBFKSB7XG5cbiAgICAgICAgICAgIHZhciBncm91cF9pbnB1dHNfaHRtbCA9IHBhcnNlLmdldEdyb3VwSW5wdXRzSFRNTChpbnB1dCwgaW5wdXRzLmxlbmd0aCAtIDEsIG51bGwpO1xuICAgICAgICAgICAgaW5wdXRfY29sbGVjdGlvbl9odG1sID0gaW5wdXRfY29sbGVjdGlvbl9odG1sLnJlcGxhY2UoJ3t7Z3JvdXAtY29udGVudH19JywgZ3JvdXBfaW5wdXRzX2h0bWwuY29sbGVjdGlvbik7XG4gICAgICAgICAgICAvL3RvZG8gY2hlY2sgd2hlcmUgdGhlIHN0cmluZyByZXBsYWNlbWVudCBoYXBwZW5zXG4gICAgICAgICAgICBpbnB1dF9wcm9wZXJ0aWVzX3BhbmVsX2h0bWwgKz0gZ3JvdXBfaW5wdXRzX2h0bWwucGFuZWxzO1xuICAgICAgICB9XG5cblxuICAgICAgICAvL2NyZWF0ZSBwcm9wZXJ0aWVzIHBhbmVsIGZvciBjdXJyZW50IGlucHV0XG4gICAgICAgIHByb3BlcnRpZXNfcGFuZWxfaHRtbCA9IHRlbXBsYXRlLmdldElucHV0UHJvcGVydGllc1BhbmVsSFRNTChpbnB1dCk7XG5cbiAgICAgICAgLyogQWRkIHRoZSBncm91cCBvciBicmFuY2ggaW5wdXRzIHBhbmVscyBtYXJrdXAgKGlmIGFueSlcbiAgICAgICAgIFRoZSBwYW5lbHMgYXJlIG5vdCBhdHRhY2hlZCBpbiB0aGUgcmlnaHQgb3JkZXIgaW4gdGhlIGRvbSBidXQgaXQgZG9lcyBub3QgbWF0dGVyLFxuICAgICAgICAgYXMgb25seSBvbmUgaXMgc2hvd24gYXQgYSB0aW1lXG4gICAgICAgICAqL1xuICAgICAgICBpbnB1dF9wcm9wZXJ0aWVzX3BhbmVsX2h0bWwgKz0gcHJvcGVydGllc19wYW5lbF9odG1sO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBjb2xsZWN0aW9uOiBpbnB1dF9jb2xsZWN0aW9uX2h0bWwsXG4gICAgICAgICAgICBwYW5lbHM6IGlucHV0X3Byb3BlcnRpZXNfcGFuZWxfaHRtbFxuICAgICAgICB9O1xuICAgIH0sXG5cbiAgICBjcmVhdGVQb3NzaWJsZUFuc3dlcnNDb3B5OiBmdW5jdGlvbiAocG9zc2libGVfYW5zd2Vycykge1xuXG4gICAgICAgIHZhciBwb3NzaWJsZV9hbnN3ZXJzX2NvcHkgPSBbXTtcblxuICAgICAgICAkLmVhY2gocG9zc2libGVfYW5zd2VycywgZnVuY3Rpb24gKGluZGV4LCBwb3NzaWJsZV9hbnN3ZXIpIHtcbiAgICAgICAgICAgIHBvc3NpYmxlX2Fuc3dlcnNfY29weVtpbmRleF0gPSB7fTtcbiAgICAgICAgICAgIHBvc3NpYmxlX2Fuc3dlcnNfY29weVtpbmRleF0uYW5zd2VyID0gcG9zc2libGVfYW5zd2VyLmFuc3dlcjtcbiAgICAgICAgICAgIHBvc3NpYmxlX2Fuc3dlcnNfY29weVtpbmRleF0uYW5zd2VyX3JlZiA9IHV0aWxzLmdlbmVyYXRlVW5pcUlEKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBwb3NzaWJsZV9hbnN3ZXJzX2NvcHk7XG4gICAgfSxcblxuICAgIGNyZWF0ZUlucHV0Q29weTogZnVuY3Rpb24gKGlucHV0KSB7XG5cbiAgICAgICAgdmFyIGlucHV0X2ZhY3RvcnkgPSByZXF1aXJlKCdmYWN0b3J5L2lucHV0LWZhY3RvcnknKTtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB2YXIgaW5wdXRfY29waWVkX3JlZiA9IHV0aWxzLmdlbmVyYXRlSW5wdXRDb3B5UmVmKCk7XG4gICAgICAgIHZhciBpbnB1dF9jb3BpZWQgPSBpbnB1dF9mYWN0b3J5LmNyZWF0ZUlucHV0KGlucHV0LnR5cGUsIGlucHV0X2NvcGllZF9yZWYpO1xuICAgICAgICB2YXIgcmVmX21hcCA9W107XG5cbiAgICAgICAgLy9zZXQgaW5wdXQgY29weSBwcm9wZXJ0aWVzIHRvIG9yaWdpbmFsIGlucHV0IHByb3BlcnRpZXNcbiAgICAgICAgLy8gKG9ubHkgdGhlIG9uZSBzYXZlZCBpbiB0aGUgcHJvamVjdCBkZWZpbml0aW9uLCBsZWF2ZSB0aGUgb3RoZXJzIGludGFjdCxcbiAgICAgICAgLy8gYW5kIERPIE5PVCBjb3B5IHRoZSByZWYhKVxuICAgICAgICBmb3IgKHZhciBwcm9wZXJ0eSBpbiBpbnB1dF9jb3BpZWQpIHtcbiAgICAgICAgICAgIGlmIChpbnB1dC5oYXNPd25Qcm9wZXJ0eShwcm9wZXJ0eSkgJiYgcHJvcGVydHkgIT09ICdyZWYnKSB7XG5cbiAgICAgICAgICAgICAgICAvKiBJbXBvcnRhbnQ6IGJyYW5jaC9ncm91cCBpcyBhbiBhcnJheSwgc28gcGVyZm9ybSBkZWVwIGNvcHlcbiAgICAgICAgICAgICAgICAgKiB1c2luZyBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KG9iaikpO1xuICAgICAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgICAgICogVGhpcyBpcyBiZWNhdXNlIGFycmF5LnNsaWNlIGRvZXMgbm90IHBlcmZvcm0gYSBkZWVwIGNvcHkgb24gYW55dGhpbmcgbmVzdGVkLCBqdXN0IG9uIGEgcGxhaW4gYXJyYXlcbiAgICAgICAgICAgICAgICAgKiBhbmQgJC5leHRlbmQodHJ1ZSwgW10sIG9sZEFycmF5KSB3YXMgbm90IHdvcmtpbmdcbiAgICAgICAgICAgICAgICAgKiAqL1xuICAgICAgICAgICAgICAgIHN3aXRjaCAocHJvcGVydHkpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBjb25zdHMuQlJBTkNIX1RZUEU6XG4gICAgICAgICAgICAgICAgICAgICAgICBpbnB1dF9jb3BpZWQuYnJhbmNoID0gQ2lyY3VsYXJKU09OLnBhcnNlKENpcmN1bGFySlNPTi5zdHJpbmdpZnkoaW5wdXQuYnJhbmNoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBjb25zdHMuR1JPVVBfVFlQRTpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0X2NvcGllZC5ncm91cCA9IENpcmN1bGFySlNPTi5wYXJzZShDaXJjdWxhckpTT04uc3RyaW5naWZ5KGlucHV0Lmdyb3VwKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0X2NvcGllZFtwcm9wZXJ0eV0gPSBpbnB1dFtwcm9wZXJ0eV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy9icmFuY2hcbiAgICAgICAgcmVmX21hcCA9IHNlbGYuY3JlYXRlQnJhbmNoQ29weShpbnB1dF9jb3BpZWQucmVmLCBpbnB1dF9jb3BpZWQuYnJhbmNoLCBpbnB1dCk7XG5cbiAgICAgICAgLy9hIHRvcCBsZXZlbCBncm91cDpcbiAgICAgICAgc2VsZi5jcmVhdGVHcm91cENvcHkoaW5wdXRfY29waWVkLnJlZiwgaW5wdXRfY29waWVkLmdyb3VwLCBpbnB1dCk7XG5cbiAgICAgICAgLy9vdmVycmlkZSBwb3NzaWJsZSBhbnN3ZXJzIFwiYW5zd2VyX3JlZlwiIG9uIGNvcGllZCB0b3AgbGV2ZWwgaW5wdXQgKG9uIG11bHRpcGxlIGFuc3dlcnMgdHlwZSBvbmx5KVxuICAgICAgICBpZiAoJC5pbkFycmF5KGlucHV0X2NvcGllZC50eXBlLCBjb25zdHMuTVVMVElQTEVfQU5TV0VSX1RZUEVTKSAhPT0gLTEpIHtcbiAgICAgICAgICAgIGlucHV0X2NvcGllZC5wb3NzaWJsZV9hbnN3ZXJzID0gc2VsZi5jcmVhdGVQb3NzaWJsZUFuc3dlcnNDb3B5KGlucHV0X2NvcGllZC5wb3NzaWJsZV9hbnN3ZXJzKTtcblxuICAgICAgICAgICAgLy90b2RvIGNoZWNrIHdoYXQgdGhlIGRlZmF1bHQgcHJvcGVydHkgaXMgc2V0IHRvLCB3aGV0aGVyIG51bGwgb3IgZW1wdHkgc3RyaW5nXG4gICAgICAgICAgICBpZiAoIShpbnB1dC5kZWZhdWx0ID09PSAnJyB8fCBpbnB1dC5kZWZhdWx0ID09PSBudWxsKSkge1xuICAgICAgICAgICAgICAgIC8vdGhlcmUgaXMgYSBkZWZhdWx0IHZhbHVlIHRvIHJlbWFwIVxuICAgICAgICAgICAgICAgIGlucHV0X2NvcGllZC5kZWZhdWx0ID0gc2VsZi5nZXREZWZhdWx0VmFsdWVGcm9tSW5wdXRDb3B5KGlucHV0LCBpbnB1dF9jb3BpZWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy9jbGVhciBqdW1wcyBmb3IgdG9wIGxldmVsIGlucHV0ICh3aGVuIG5vdCBhIGJyYW5jaCEpXG4gICAgICAgIGlmKGlucHV0X2NvcGllZC50eXBlID09PSBjb25zdHMuQlJBTkNIX1RZUEUpIHtcbiAgICAgICAgICAgIC8vdXBkYXRlIGp1bXBzIGZvciBhbGwgdGhlIGJyYW5jaCBpbnB1dHNcbiAgICAgICAgICAgIHNlbGYudXBkYXRlQnJhbmNoSnVtcHMoaW5wdXRfY29waWVkLmJyYW5jaCwgcmVmX21hcCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpbnB1dF9jb3BpZWQuanVtcHMgPSBbXTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBpbnB1dF9jb3BpZWQ7XG4gICAgfSxcblxuICAgIHVwZGF0ZUJyYW5jaEp1bXBzOiBmdW5jdGlvbihicmFuY2gsIHJlZl9tYXApIHtcblxuICAgICAgICAvL3RvIHN0b3JlIHRoZSBuZXcganVtcHNcbiAgICAgICAgdmFyIHVwZGF0ZWRfanVtcHM7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcblxuICAgICAgICAkKGJyYW5jaCkuZWFjaChmdW5jdGlvbiAoYnJhbmNoX2luZGV4LCBicmFuY2hfaW5wdXQpIHtcblxuICAgICAgICAgICAgdXBkYXRlZF9qdW1wcyA9W107XG5cbiAgICAgICAgICAgIGlmKGJyYW5jaF9pbnB1dC5qdW1wcy5sZW5ndGggPiAwKSB7XG5cbiAgICAgICAgICAgICAgICAkKGJyYW5jaF9pbnB1dC5qdW1wcykuZWFjaChmdW5jdGlvbihqaSwganVtcCl7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCQuaW5BcnJheShicmFuY2hfaW5wdXQudHlwZSwgY29uc3RzLk1VTFRJUExFX0FOU1dFUl9UWVBFUykgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL3VwZGF0ZSB0aGUganVtcCByZWZlcmVuY2VzXG4gICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVkX2p1bXBzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoZW46IGp1bXAud2hlbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bzogc2VsZi5nZXRKdW1wVG9WYWx1ZUZyb21SZWZNYXAocmVmX21hcCwganVtcC50byksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5zd2VyX3JlZjogcmVmX21hcFticmFuY2hfaW5kZXhdLmFuc3dlcl9yZWZzW2p1bXAuYW5zd2VyX3JlZl1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy91cGRhdGUgdGhlIGp1bXAgcmVmZXJlbmNlc1xuICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlZF9qdW1wcy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGVuOiBqdW1wLndoZW4sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG86IHNlbGYuZ2V0SnVtcFRvVmFsdWVGcm9tUmVmTWFwKHJlZl9tYXAsIGp1bXAudG8pLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuc3dlcl9yZWY6IG51bGxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvL3JlcGxhY2UganVtcHMgd2l0aCB1cGRhdGVkIG9uZXNcbiAgICAgICAgICAgIGJyYW5jaF9pbnB1dC5qdW1wcyA9IHVwZGF0ZWRfanVtcHM7XG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICBjcmVhdGVHcm91cENvcHk6IGZ1bmN0aW9uIChyZWYsIGdyb3VwLCBpbnB1dCl7XG5cbiAgICAgICAgdmFyIGdyb3VwX2NvcHkgPVtdO1xuXG4gICAgICAgICQoZ3JvdXApLmVhY2goZnVuY3Rpb24gKGdyb3VwX2lucHV0X2luZGV4LCBncm91cF9pbnB1dCkge1xuXG4gICAgICAgICAgICB2YXIgIGdyb3VwX2Fuc3dlcl9yZWZfbWFwID0ge307XG5cbiAgICAgICAgICAgIGdyb3VwX2NvcHlbZ3JvdXBfaW5wdXRfaW5kZXhdID0gZ3JvdXBfaW5wdXQ7XG4gICAgICAgICAgICBncm91cF9jb3B5W2dyb3VwX2lucHV0X2luZGV4XS5yZWYgPSB1dGlscy5nZW5lcmF0ZUJyYW5jaEdyb3VwSW5wdXRSZWYocmVmKTtcblxuICAgICAgICAgICAgLy9vdmVycmlkZSBhbnkgXCJhbnN3ZXJfcmVmXCJcbiAgICAgICAgICAgIGlmICgkLmluQXJyYXkoZ3JvdXBfaW5wdXQudHlwZSwgY29uc3RzLk1VTFRJUExFX0FOU1dFUl9UWVBFUykgIT09IC0xKSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgZ3JvdXBfaW5wdXRfcG9zc2libGVfYW5zd2Vyc19jb3B5ID0gW107XG5cbiAgICAgICAgICAgICAgICAkLmVhY2goZ3JvdXBfaW5wdXQucG9zc2libGVfYW5zd2VycywgZnVuY3Rpb24gKGluZGV4LCBwb3NzaWJsZV9hbnN3ZXIpIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgbmV3X2Fuc3dlcl9yZWYgPSB1dGlscy5nZW5lcmF0ZVVuaXFJRCgpO1xuXG4gICAgICAgICAgICAgICAgICAgIGdyb3VwX2lucHV0X3Bvc3NpYmxlX2Fuc3dlcnNfY29weVtpbmRleF0gPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgZ3JvdXBfaW5wdXRfcG9zc2libGVfYW5zd2Vyc19jb3B5W2luZGV4XS5hbnN3ZXIgPSBwb3NzaWJsZV9hbnN3ZXIuYW5zd2VyO1xuICAgICAgICAgICAgICAgICAgICBncm91cF9pbnB1dF9wb3NzaWJsZV9hbnN3ZXJzX2NvcHlbaW5kZXhdLmFuc3dlcl9yZWYgPSBuZXdfYW5zd2VyX3JlZjtcblxuICAgICAgICAgICAgICAgICAgICBncm91cF9hbnN3ZXJfcmVmX21hcFtwb3NzaWJsZV9hbnN3ZXIuYW5zd2VyX3JlZl0gPSBuZXdfYW5zd2VyX3JlZjtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIC8vb3ZlcnJpZGUgcG9zc2libGUgYW5zd2VycyBmb3IgdGhpcyBicmFuY2ggaW5wdXRcbiAgICAgICAgICAgICAgICBncm91cF9pbnB1dC5wb3NzaWJsZV9hbnN3ZXJzID0gZ3JvdXBfaW5wdXRfcG9zc2libGVfYW5zd2Vyc19jb3B5O1xuXG4gICAgICAgICAgICAgICAgLy9yZW1hcCBkZWZhdWx0IHZhbHVlIHRvIG5ldyBhbnN3ZXJfcmVmXG4gICAgICAgICAgICAgICAgaWYgKCEoZ3JvdXBfaW5wdXQuZGVmYXVsdCA9PT0gJycgfHwgZ3JvdXBfaW5wdXQuZGVmYXVsdCA9PT0gbnVsbCkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy90aGVyZSBpcyBhIGRlZmF1bHQgdmFsdWUgdG8gcmVtYXAhXG4gICAgICAgICAgICAgICAgICAgIGlmICgkLmluQXJyYXkoZ3JvdXBfaW5wdXQudHlwZSwgY29uc3RzLk1VTFRJUExFX0FOU1dFUl9UWVBFUykgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBncm91cF9pbnB1dC5kZWZhdWx0ID0gZ3JvdXBfYW5zd2VyX3JlZl9tYXBbaW5wdXQuZ3JvdXBbZ3JvdXBfaW5wdXRfaW5kZXhdLmRlZmF1bHRdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9kbyBub3RoaW5nXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICBjcmVhdGVCcmFuY2hDb3B5OiBmdW5jdGlvbihyZWYsIGJyYW5jaCwgaW5wdXQpe1xuXG4gICAgICAgIHZhciBicmFuY2hfY29weSA9W107XG4gICAgICAgIHZhciBicmFuY2hfaW5wdXRfcG9zc2libGVfYW5zd2Vyc19jb3B5O1xuICAgICAgICB2YXIgcmVmX21hcCA9IFtdO1xuICAgICAgICB2YXIgYnJhbmNoX2lucHV0X2p1bXBzX2NvcHk7XG4gICAgICAgIHZhciBhbnN3ZXJfcmVmX21hcDtcbiAgICAgICAgdmFyIG5ld19hbnN3ZXJfcmVmcztcbiAgICAgICAgdmFyIG5lc3RlZF9ncm91cF9jb3B5ID0gW107XG4gICAgICAgIHZhciBuZXN0ZWRfZ3JvdXBfaW5wdXRfcG9zc2libGVfYW5zd2Vyc19jb3B5O1xuXG4gICAgICAgICQoYnJhbmNoKS5lYWNoKGZ1bmN0aW9uIChicmFuY2hfaW5kZXgsIGJyYW5jaF9pbnB1dCkge1xuXG4gICAgICAgICAgICBicmFuY2hfY29weVticmFuY2hfaW5kZXhdID0gYnJhbmNoX2lucHV0O1xuICAgICAgICAgICAgYnJhbmNoX2NvcHlbYnJhbmNoX2luZGV4XS5yZWYgPSB1dGlscy5nZW5lcmF0ZUJyYW5jaEdyb3VwSW5wdXRSZWYocmVmKTtcblxuICAgICAgICAgICAgcmVmX21hcFticmFuY2hfaW5kZXhdID0ge1xuICAgICAgICAgICAgICAgIGp1bXBzOiBicmFuY2hfaW5wdXQuanVtcHMsXG4gICAgICAgICAgICAgICAgYW5zd2VyX3JlZnM6IHt9XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAvL21hcCBvbGQgLSBuZXcgaW5wdXQgcmVmXG4gICAgICAgICAgICByZWZfbWFwW2JyYW5jaF9pbmRleF0ub2xkX3JlZiA9IGlucHV0LmJyYW5jaFticmFuY2hfaW5kZXhdLnJlZjtcbiAgICAgICAgICAgIHJlZl9tYXBbYnJhbmNoX2luZGV4XS5uZXdfcmVmID0gYnJhbmNoX2NvcHlbYnJhbmNoX2luZGV4XS5yZWY7XG5cbiAgICAgICAgICAgIC8vb3ZlcnJpZGUgYW55IFwiYW5zd2VyX3JlZlwiIGFuZCB1cGRhdGUganVtcHNcbiAgICAgICAgICAgIC8vdG9kbyBhbGwgdGhlIGp1bXBzLCB0aGVyZSBpcyB0aGUganVtcCBhbHdheXMgYXMgd2VsbCEhISEhXG4gICAgICAgICAgICBpZiAoJC5pbkFycmF5KGJyYW5jaF9pbnB1dC50eXBlLCBjb25zdHMuTVVMVElQTEVfQU5TV0VSX1RZUEVTKSAhPT0gLTEpIHtcblxuICAgICAgICAgICAgICAgIGJyYW5jaF9pbnB1dF9wb3NzaWJsZV9hbnN3ZXJzX2NvcHkgPSBbXTtcbiAgICAgICAgICAgICAgICBicmFuY2hfaW5wdXRfanVtcHNfY29weSA9IFtdO1xuICAgICAgICAgICAgICAgIGFuc3dlcl9yZWZfbWFwID0ge307XG5cbiAgICAgICAgICAgICAgICAkLmVhY2goYnJhbmNoX2lucHV0LnBvc3NpYmxlX2Fuc3dlcnMsIGZ1bmN0aW9uIChpbmRleCwgcG9zc2libGVfYW5zd2VyKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgLy9idWlsZCBhIG1hcCB0byB1cGRhdGUganVtcHMgcmVmZXJlbmNlc1xuICAgICAgICAgICAgICAgICAgICB2YXIgbmV3X2Fuc3dlcl9yZWYgPSB1dGlscy5nZW5lcmF0ZVVuaXFJRCgpO1xuICAgICAgICAgICAgICAgICAgICBhbnN3ZXJfcmVmX21hcFtwb3NzaWJsZV9hbnN3ZXIuYW5zd2VyX3JlZl0gPSBuZXdfYW5zd2VyX3JlZjtcblxuICAgICAgICAgICAgICAgICAgICAvL292ZXJyaWRlXG4gICAgICAgICAgICAgICAgICAgIGJyYW5jaF9pbnB1dF9wb3NzaWJsZV9hbnN3ZXJzX2NvcHlbaW5kZXhdID0ge307XG4gICAgICAgICAgICAgICAgICAgIGJyYW5jaF9pbnB1dF9wb3NzaWJsZV9hbnN3ZXJzX2NvcHlbaW5kZXhdLmFuc3dlciA9IHBvc3NpYmxlX2Fuc3dlci5hbnN3ZXI7XG4gICAgICAgICAgICAgICAgICAgIGJyYW5jaF9pbnB1dF9wb3NzaWJsZV9hbnN3ZXJzX2NvcHlbaW5kZXhdLmFuc3dlcl9yZWYgPSBuZXdfYW5zd2VyX3JlZlxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgLy9vdmVycmlkZSBwb3NzaWJsZSBhbnN3ZXJzIGZvciB0aGlzIGJyYW5jaCBpbnB1dFxuICAgICAgICAgICAgICAgIGJyYW5jaF9pbnB1dC5wb3NzaWJsZV9hbnN3ZXJzID0gYnJhbmNoX2lucHV0X3Bvc3NpYmxlX2Fuc3dlcnNfY29weTtcblxuICAgICAgICAgICAgICAgIG5ld19hbnN3ZXJfcmVmcyA9IGFuc3dlcl9yZWZfbWFwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgbmV3X2Fuc3dlcl9yZWZzID0gbnVsbDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy9hZGQgYW5zd2VyX3JlZnMgbWFwIHRvIGp1bXBzIG1hcFxuICAgICAgICAgICAgcmVmX21hcFticmFuY2hfaW5kZXhdLmFuc3dlcl9yZWZzID0gbmV3X2Fuc3dlcl9yZWZzO1xuXG4gICAgICAgICAgICAvL3JlbWFwIGRlZmF1bHQgdmFsdWUgdG8gbmV3IGFuc3dlcl9yZWZcbiAgICAgICAgICAgIGlmICghKGJyYW5jaF9pbnB1dC5kZWZhdWx0ID09PSAnJyB8fCBicmFuY2hfaW5wdXQuZGVmYXVsdCA9PT0gbnVsbCkpIHtcbiAgICAgICAgICAgICAgICAvL3RoZXJlIGlzIGEgZGVmYXVsdCB2YWx1ZSB0byByZW1hcCFcbiAgICAgICAgICAgICAgICBpZiAoJC5pbkFycmF5KGJyYW5jaF9pbnB1dC50eXBlLCBjb25zdHMuTVVMVElQTEVfQU5TV0VSX1RZUEVTKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgYnJhbmNoX2lucHV0LmRlZmF1bHQgPSBuZXdfYW5zd2VyX3JlZnNbYnJhbmNoX2lucHV0LmRlZmF1bHRdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy9hIGdyb3VwIHdpdGhpbiBhIGJyYW5jaDpcblxuICAgICAgICAgICAgJChicmFuY2hfaW5wdXQuZ3JvdXApLmVhY2goZnVuY3Rpb24gKG5lc3RlZF9ncm91cF9pbnB1dF9pbmRleCwgbmVzdGVkX2dyb3VwX2lucHV0KSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgIGdyb3VwX2lucHV0X2Fuc3dlcl9yZWZfbWFwID0ge307XG5cbiAgICAgICAgICAgICAgICBuZXN0ZWRfZ3JvdXBfY29weVtuZXN0ZWRfZ3JvdXBfaW5wdXRfaW5kZXhdID0gbmVzdGVkX2dyb3VwX2lucHV0O1xuICAgICAgICAgICAgICAgIG5lc3RlZF9ncm91cF9jb3B5W25lc3RlZF9ncm91cF9pbnB1dF9pbmRleF0ucmVmID0gdXRpbHMuZ2VuZXJhdGVCcmFuY2hHcm91cElucHV0UmVmKGJyYW5jaFticmFuY2hfaW5kZXhdLnJlZik7XG5cbiAgICAgICAgICAgICAgICBpZiAoJC5pbkFycmF5KG5lc3RlZF9ncm91cF9pbnB1dC50eXBlLCBjb25zdHMuTVVMVElQTEVfQU5TV0VSX1RZUEVTKSAhPT0gLTEpIHtcblxuICAgICAgICAgICAgICAgICAgICBuZXN0ZWRfZ3JvdXBfaW5wdXRfcG9zc2libGVfYW5zd2Vyc19jb3B5ID0gW107XG5cbiAgICAgICAgICAgICAgICAgICAgJC5lYWNoKG5lc3RlZF9ncm91cF9pbnB1dC5wb3NzaWJsZV9hbnN3ZXJzLCBmdW5jdGlvbiAoaW5kZXgsIHBvc3NpYmxlX2Fuc3dlcikge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbmV3X2Fuc3dlcl9yZWYgPSB1dGlscy5nZW5lcmF0ZVVuaXFJRCgpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvL292ZXJyaWRlXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXN0ZWRfZ3JvdXBfaW5wdXRfcG9zc2libGVfYW5zd2Vyc19jb3B5W2luZGV4XSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgbmVzdGVkX2dyb3VwX2lucHV0X3Bvc3NpYmxlX2Fuc3dlcnNfY29weVtpbmRleF0uYW5zd2VyID0gcG9zc2libGVfYW5zd2VyLmFuc3dlcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5lc3RlZF9ncm91cF9pbnB1dF9wb3NzaWJsZV9hbnN3ZXJzX2NvcHlbaW5kZXhdLmFuc3dlcl9yZWYgPSBuZXdfYW5zd2VyX3JlZjtcblxuICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXBfaW5wdXRfYW5zd2VyX3JlZl9tYXBbcG9zc2libGVfYW5zd2VyLmFuc3dlcl9yZWZdID0gbmV3X2Fuc3dlcl9yZWY7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vb3ZlcnJpZGUgcG9zc2libGUgYW5zd2VycyBmb3IgdGhpcyBicmFuY2ggaW5wdXRcbiAgICAgICAgICAgICAgICAgICAgbmVzdGVkX2dyb3VwX2lucHV0LnBvc3NpYmxlX2Fuc3dlcnMgPSBuZXN0ZWRfZ3JvdXBfaW5wdXRfcG9zc2libGVfYW5zd2Vyc19jb3B5O1xuXG4gICAgICAgICAgICAgICAgICAgIC8vcmVtYXAgZGVmYXVsdCB2YWx1ZSB0byBuZXcgYW5zd2VyX3JlZlxuICAgICAgICAgICAgICAgICAgICBpZiAoIShuZXN0ZWRfZ3JvdXBfaW5wdXQuZGVmYXVsdCA9PT0gJycgfHwgbmVzdGVkX2dyb3VwX2lucHV0LmRlZmF1bHQgPT09IG51bGwpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL3RoZXJlIGlzIGEgZGVmYXVsdCB2YWx1ZSB0byByZW1hcCFcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkLmluQXJyYXkobmVzdGVkX2dyb3VwX2lucHV0LnR5cGUsIGNvbnN0cy5NVUxUSVBMRV9BTlNXRVJfVFlQRVMpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5lc3RlZF9ncm91cF9pbnB1dC5kZWZhdWx0ID0gZ3JvdXBfaW5wdXRfYW5zd2VyX3JlZl9tYXBbYnJhbmNoX2lucHV0Lmdyb3VwW25lc3RlZF9ncm91cF9pbnB1dF9pbmRleF0uZGVmYXVsdF07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIHJlZl9tYXA7XG4gICAgfSxcblxuICAgIGdldERlZmF1bHRWYWx1ZUZyb21JbnB1dENvcHk6IGZ1bmN0aW9uIChvcmlnaW5hbCwgY29weSkge1xuXG4gICAgICAgIHZhciBvcmlnaW5hbF9kZWZhdWx0X2Fuc3dlcl9yZWZfaW5kZXggPSAtMTtcblxuICAgICAgICAkKG9yaWdpbmFsLnBvc3NpYmxlX2Fuc3dlcnMpLmVhY2goZnVuY3Rpb24gKGluZGV4LCBwb3NzaWJsZV9hbnN3ZXIpIHtcbiAgICAgICAgICAgIGlmIChwb3NzaWJsZV9hbnN3ZXIuYW5zd2VyX3JlZiA9PT0gb3JpZ2luYWwuZGVmYXVsdCkge1xuICAgICAgICAgICAgICAgIG9yaWdpbmFsX2RlZmF1bHRfYW5zd2VyX3JlZl9pbmRleCA9IGluZGV4O1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gY29weS5wb3NzaWJsZV9hbnN3ZXJzW29yaWdpbmFsX2RlZmF1bHRfYW5zd2VyX3JlZl9pbmRleF0uYW5zd2VyX3JlZjtcblxuICAgIH0sXG5cbiAgICBnZXRKdW1wVG9WYWx1ZUZyb21SZWZNYXA6IGZ1bmN0aW9uKHJlZl9tYXAsIHRvKXtcblxuICAgICAgICB2YXIganVtcF90byA9IG51bGw7XG5cbiAgICAgICAgLy9pZiB0byBpZCBcIkVORFwiLCBqdXN0IHJldHVybiBpdFxuICAgICAgICBpZih0byA9PT0gY29uc3RzLkpVTVBfVE9fRU5EX09GX0ZPUk1fUkVGKSB7XG4gICAgICAgICAgICBqdW1wX3RvID0gY29uc3RzLkpVTVBfVE9fRU5EX09GX0ZPUk1fUkVGO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy9vdGhlcndpc2UgcmV0dXJuIHRoZSBuZXcgcmVmXG4gICAgICAgICAgICAkKHJlZl9tYXApLmVhY2goZnVuY3Rpb24gKGluZGV4LCBtYXApIHtcbiAgICAgICAgICAgICAgICBpZiAobWFwLm9sZF9yZWYgPT09IHRvKSB7XG4gICAgICAgICAgICAgICAgICAgIGp1bXBfdG8gPSBtYXAubmV3X3JlZjtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGp1bXBfdG9cbiAgICB9XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGNvcHk7XG4iLCIvKiBnbG9iYWwgJCovXG4ndXNlIHN0cmljdCc7XG52YXIgY29uc3RzID0gcmVxdWlyZSgnY29uZmlnL2NvbnN0cycpO1xudmFyIG1lc3NhZ2VzID0gcmVxdWlyZSgnY29uZmlnL21lc3NhZ2VzJyk7XG52YXIgdmFsaWRhdGlvbiA9IHJlcXVpcmUoJ2FjdGlvbnMvdmFsaWRhdGlvbicpO1xudmFyIGZvcm1idWlsZGVyID0gcmVxdWlyZSgnY29uZmlnL2Zvcm1idWlsZGVyJyk7XG52YXIgdXRpbHMgPSByZXF1aXJlKCdoZWxwZXJzL3V0aWxzJyk7XG5cbnZhciBqdW1wcyA9IHtcblxuICAgIGFkZEp1bXA6IGZ1bmN0aW9uICh0aGVfaW5wdXQpIHtcblxuICAgICAgICB2YXIgaW5wdXQgPSB0aGVfaW5wdXQ7XG4gICAgICAgIHZhciBqdW1wc19saXN0X3dyYXBwZXIgPSBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyXG4gICAgICAgICAgICAuZmluZCgnZm9ybVtkYXRhLWlucHV0LXJlZj1cIicgKyBpbnB1dC5yZWYgKyAnXCJdJylcbiAgICAgICAgICAgIC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fanVtcHMgLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2p1bXBzX19saXN0Jyk7XG4gICAgICAgIHZhciBodG1sID0gJyc7XG4gICAgICAgIHZhciBqdW1wX2luZGV4ID0gaW5wdXQuanVtcHMubGVuZ3RoO1xuXG4gICAgICAgIC8vaWYgdGhlIG51bWJlciBvZiBqdW1wcyBpcyBhbHJlYWR5IGVxdWFsIHRvIHRoZSBudW1iZXIgb2YgcG9zc2libGUgYW5zd2VycywgZG8gbm90IGFkZCBqdW1wXG4gICAgICAgIC8vRG8gdGhpcyBjaGVjayBvbmx5IGZvciBtdWx0aXBsZSBhbnN3ZXJzIGlucHV0cywgYXMgc2luZ2xlIGFuc3dlciBpbnB1dHMgZG8gaGF2ZSB6ZXJvIHBvc3NpYmxlX2Fuc3dlcnMgYXQgYWxsIHRpbWVzLlxuICAgICAgICBpZiAoY29uc3RzLk1VTFRJUExFX0FOU1dFUl9UWVBFUy5pbmRleE9mKGlucHV0LnR5cGUpID4gLTEpIHtcbiAgICAgICAgICAgIGlmIChpbnB1dC5qdW1wcy5sZW5ndGggPj0gaW5wdXQucG9zc2libGVfYW5zd2Vycy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvL2lmIGp1bXBzLCByZW1vdmUgJ25vIGp1bXBzIHNldCcgaXRlbVxuICAgICAgICBqdW1wc19saXN0X3dyYXBwZXIucGFyZW50KCkuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2p1bXBzX19uby1qdW1wcy1tZXNzYWdlJykuYWRkQ2xhc3MoJ2hpZGRlbicpO1xuXG4gICAgICAgIGlmIChjb25zdHMuTVVMVElQTEVfQU5TV0VSX1RZUEVTLmluZGV4T2YoaW5wdXQudHlwZSkgPT09IC0xKSB7XG4gICAgICAgICAgICAvL2FwcGVuZCBhIGp1bXAgd2l0aCBjb25kaXRpb24gZGlzYWJsZWQgYW5kIHNldCB0byAnYWx3YXlzJyBqdW1wXG4gICAgICAgICAgICAvL3dlIGRvIHRoaXMgYmVjYXVzZSBvbiBFQzUgd2hlbiB0aGUgcXVlc3Rpb24gaXMgYW4gb3BlbiBhbnN3ZXIsIGEganVtcCB3aWxsIGFsd2F5cyBqdW1wIG5vIG1hdHRlciB0aGUgYW5zd2VyIGdpdmVuXG4gICAgICAgICAgICAvLyBqdW1wc19saXN0X3dyYXBwZXIuYXBwZW5kKCk7XG5cbiAgICAgICAgICAgIGh0bWwgKz0gZm9ybWJ1aWxkZXIuZG9tLnBhcnRpYWxzLmp1bXBfbGlzdF9pdGVtX2Fsd2F5c19qdW1wO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy9qdW1wcyBnZXQgZnVsbCBmdW5jdGlvbmFsaXR5IHdpdGggbXVsdGlwbGUgYW5zd2VycyBpbnB1dCB0eXBlc1xuICAgICAgICAgICAgaHRtbCArPSBmb3JtYnVpbGRlci5kb20ucGFydGlhbHMuanVtcF9saXN0X2l0ZW07XG4gICAgICAgIH1cblxuICAgICAgICBodG1sID0gaHRtbC5yZXBsYWNlKC97e2lucHV0LXJlZi1sb2dpYy13aGVufX0vZywganVtcF9pbmRleCArICctJyArIGlucHV0LnJlZiArICctbG9naWMtd2hlbicpO1xuICAgICAgICBodG1sID0gaHRtbC5yZXBsYWNlKC97e2lucHV0LXJlZi1sb2dpYy1hbnN3ZXJ9fS9nLCBqdW1wX2luZGV4ICsgJy0nICsgaW5wdXQucmVmICsgJy1sb2dpYy1hbnN3ZXInKTtcbiAgICAgICAgaHRtbCA9IGh0bWwucmVwbGFjZSgve3tpbnB1dC1yZWYtbG9naWMtZ290b319L2csIGp1bXBfaW5kZXggKyAnLScgKyBpbnB1dC5yZWYgKyAnLWxvZ2ljLWdvdG8nKTtcblxuICAgICAgICBqdW1wc19saXN0X3dyYXBwZXIuYXBwZW5kKGh0bWwpO1xuXG4gICAgICAgIC8vYWRkIGVtcHR5IGp1bXAgdG8gaW5wdXRcbiAgICAgICAgaW5wdXQuanVtcHMucHVzaCh7fSk7XG5cbiAgICAgICAgLy9zaG93IGp1bXAgaWNvbiBpbiBpbnB1dCB0b29sXG4gICAgICAgIC8vdG9kb1xuICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb24uZmluZCgnLmlucHV0W2RhdGEtaW5wdXQtcmVmPVwiJyArIGlucHV0LnJlZiArICdcIl0nKTtcbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uLmZpbmQoJy5pbnB1dFtkYXRhLWlucHV0LXJlZj1cIicgKyBpbnB1dC5yZWYgKyAnXCJdIC5pbnB1dC1pbm5lcicpO1xuICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb24uZmluZCgnLmlucHV0W2RhdGEtaW5wdXQtcmVmPVwiJyArIGlucHV0LnJlZiArICdcIl0gLmlucHV0LWlubmVyIC5qdW1wLXN0YXRlJykucmVtb3ZlQ2xhc3MoJ2ludmlzaWJsZScpO1xuXG4gICAgfSxcblxuICAgIHJlbW92ZUp1bXA6IGZ1bmN0aW9uICh0aGVfY3VycmVudF9pbnB1dCwgdGhlX3JlbW92ZV9idG4pIHtcblxuICAgICAgICB2YXIgaW5wdXQgPSB0aGVfY3VycmVudF9pbnB1dDtcbiAgICAgICAgdmFyIGp1bXBfaXRlbSA9IHRoZV9yZW1vdmVfYnRuLnBhcmVudCgpO1xuICAgICAgICB2YXIganVtcF9saXN0ID0ganVtcF9pdGVtLnBhcmVudCgpO1xuICAgICAgICAvLyBqdW1wIGluZGV4IHN0YXJ0cyBmcm9tIDEsIGFzIGluZGV4IDAgaXMgJ25vIGp1bXBzIHlldCcgcGxhY2Vob2xkZXIsIHdyYXBwZWQgaW4gYSA8bGk+IHRhZ1xuICAgICAgICB2YXIganVtcF9pbmRleCA9IGp1bXBfaXRlbS5pbmRleCgpO1xuXG4gICAgICAgIC8vcmVtb3ZlIHNlbGVjdGVkIGZyb20gZG9tXG4gICAgICAgIGp1bXBfaXRlbS5yZW1vdmUoKTtcblxuICAgICAgICAvL3JlbW92ZSBmcm9tIG1lbW9yeVxuICAgICAgICBpbnB1dC5qdW1wcy5zcGxpY2UoKGp1bXBfaW5kZXggLSAxKSwgMSk7XG5cbiAgICAgICAgLy9pZiBubyBqdW1wcywgc2hvdyBtZXNzYWdlXG4gICAgICAgIGlmIChqdW1wX2xpc3QuZmluZCgnbGknKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIC8vaWYgbm8ganVtcHMgeWV0LCByZW1vdmUgJ25vIGp1bXBzIHNldCcgaXRlbVxuICAgICAgICAgICAganVtcF9saXN0LnBhcmVudCgpLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19qdW1wc19fbm8tanVtcHMtbWVzc2FnZScpLnJlbW92ZUNsYXNzKCdoaWRkZW4nKTtcblxuICAgICAgICAgICAgLy9oaWRlIGp1bXBzIGljb24gZnJvbSBpbnB1dCB0b29sXG4gICAgICAgICAgICAvL3RvZG9cbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbi5maW5kKCcuaW5wdXRbZGF0YS1pbnB1dC1yZWY9XCInICsgaW5wdXQucmVmICsgJ1wiXSAuaW5wdXQtaW5uZXIgLmp1bXAtc3RhdGUnKS5hZGRDbGFzcygnaW52aXNpYmxlJyk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgbGlzdEp1bXBQb3NzaWJsZUFuc3dlcnM6IGZ1bmN0aW9uICh0aGVfc2VsZWN0LCB0aGVfaW5wdXQpIHtcblxuICAgICAgICB2YXIgZm9jdXNlZF9zZWxlY3QgPSB0aGVfc2VsZWN0O1xuICAgICAgICB2YXIgaW5wdXQgPSB0aGVfaW5wdXQ7XG4gICAgICAgIHZhciBodG1sID0gJyc7XG5cbiAgICAgICAgLy90cmlnZ2VyIGEgc2F2ZSBpbiBjYXNlIHRoZSB1c2VyIHR5cGVkIGluIGEgcG9zc2liaWxlIGFuc3dlciBhbmQgc3dpdGNoZWQgZGlyZWN0bHkgdG8gdGhlIGp1bXAgdGFiXG4gICAgICAgIGlucHV0LnNhdmVQb3NzaWJsZUFuc3dlcnMoKTtcblxuICAgICAgICBmb2N1c2VkX3NlbGVjdC5lbXB0eSgpO1xuICAgICAgICAkKGlucHV0LnBvc3NpYmxlX2Fuc3dlcnMpLmVhY2goZnVuY3Rpb24gKGluZGV4LCBwb3NzaWJsZV9hbnN3ZXIpIHtcbiAgICAgICAgICAgIGh0bWwgKz0gJzxvcHRpb24gdmFsdWU9XCInO1xuICAgICAgICAgICAgaHRtbCArPSBwb3NzaWJsZV9hbnN3ZXIuYW5zd2VyX3JlZiArICdcIj4nO1xuICAgICAgICAgICAgaHRtbCArPSBwb3NzaWJsZV9hbnN3ZXIuYW5zd2VyLnRydW5jKDUwKTtcbiAgICAgICAgICAgIGh0bWwgKz0gJzwvb3B0aW9uPic7XG4gICAgICAgIH0pO1xuICAgICAgICBmb2N1c2VkX3NlbGVjdC5hcHBlbmQoaHRtbCk7XG4gICAgfSxcblxuICAgIC8vbGlzdCBqdW1wIGNvbnNpdGlvbnMgKGlzLCBpcyBub3QgZXRjLi4uKVxuICAgIGxpc3RKdW1wQ29uZGl0aW9uczogZnVuY3Rpb24gKHRoZV9zZWxlY3QpIHtcblxuICAgICAgICB2YXIgZm9jdXNlZF9zZWxlY3QgPSB0aGVfc2VsZWN0O1xuICAgICAgICB2YXIgcG9zc2libGVfY29uZGl0aW9ucyA9IGNvbnN0cy5KVU1QX0NPTkRJVElPTlM7XG4gICAgICAgIHZhciBodG1sID0gJyc7XG5cbiAgICAgICAgZm9jdXNlZF9zZWxlY3QuZW1wdHkoKTtcbiAgICAgICAgJChwb3NzaWJsZV9jb25kaXRpb25zKS5lYWNoKGZ1bmN0aW9uIChpKSB7XG5cbiAgICAgICAgICAgIGh0bWwgKz0gJzxvcHRpb24gdmFsdWU9XCInO1xuICAgICAgICAgICAgaHRtbCArPSB0aGlzLmtleSArICdcIj4nO1xuICAgICAgICAgICAgaHRtbCArPSB0aGlzLnRleHQ7XG4gICAgICAgICAgICBodG1sICs9ICc8L29wdGlvbj4nO1xuICAgICAgICB9KTtcbiAgICAgICAgZm9jdXNlZF9zZWxlY3QuYXBwZW5kKGh0bWwpO1xuICAgIH0sXG5cbiAgICAvL2R5bmFtaWNhbGx5IHNob3cgYSBsaXN0IG9mIHBvc3NpYmxlIGRlc3RpbmF0aW9uIGZvciBhIGp1bXBcbiAgICBsaXN0SnVtcERlc3RpbmF0aW9uczogZnVuY3Rpb24gKHRoZV9zZWxlY3QsIHRoZV9qdW1wX2Rlc3RpbmF0aW9ucykge1xuXG4gICAgICAgIHZhciBmb2N1c2VkX3NlbGVjdCA9IHRoZV9zZWxlY3Q7XG4gICAgICAgIHZhciBqdW1wX2Rlc3RpbmF0aW9ucyA9IHRoZV9qdW1wX2Rlc3RpbmF0aW9ucztcblxuICAgICAgICAvKlxuICAgICAgICAganVtcHMgY2FuIGdvIG9ubHkgZm9yd2FyZCwgcG9zc2libGUganVtcHMgZGVzdGluYXRpb25zIGFyZSBpbmRleCBvZiBjdXJyZW50IGlucHV0ICsxLFxuICAgICAgICAgYXMgaXQgbm90IHBvc3NpYmxlIHRvIGp1bXAgdG8gYW4gYWRqYWNlbnQgaW5wdXRcbiAgICAgICAgICovXG4gICAgICAgIGZvY3VzZWRfc2VsZWN0LmVtcHR5KCk7XG4gICAgICAgICQoanVtcF9kZXN0aW5hdGlvbnMpLmVhY2goZnVuY3Rpb24gKGluZGV4LCBkZXN0aW5hdGlvbikge1xuXG4gICAgICAgICAgICB2YXIgcXVlc3Rpb247XG4gICAgICAgICAgICB2YXIgcHVyaWZpZWRSZWFkbWUgPSAnJztcblxuICAgICAgICAgICAgaWYgKGRlc3RpbmF0aW9uLnF1ZXN0aW9uID09PSAnJykge1xuICAgICAgICAgICAgICAgIGlmIChkZXN0aW5hdGlvbi50eXBlID09PSBjb25zdHMuQlJBTkNIX1RZUEUpIHtcbiAgICAgICAgICAgICAgICAgICAgcXVlc3Rpb24gPSBtZXNzYWdlcy5lcnJvci5OT19CUkFOQ0hfSEVBREVSX1lFVDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHF1ZXN0aW9uID0gbWVzc2FnZXMuZXJyb3IuTk9fUVVFU1RJT05fVEVYVF9ZRVQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKGRlc3RpbmF0aW9uLnR5cGUgPT09IGNvbnN0cy5SRUFETUVfVFlQRSkge1xuICAgICAgICAgICAgICAgICAgICAvL3N0cmlwIGFsbCB0YWdzIGZvciBwcmV2aWV3IHdpdGhpbiBzZWxlY3RcbiAgICAgICAgICAgICAgICAgICAgcHVyaWZpZWRSZWFkbWUgPSB1dGlscy5kZWNvZGVIdG1sKGRlc3RpbmF0aW9uLnF1ZXN0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgcHVyaWZpZWRSZWFkbWUgPSB1dGlscy5zdHJpcFRhZ3MocHVyaWZpZWRSZWFkbWUpO1xuICAgICAgICAgICAgICAgICAgICBxdWVzdGlvbiA9IHB1cmlmaWVkUmVhZG1lLnRydW5jKDUwKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHF1ZXN0aW9uID0gZGVzdGluYXRpb24ucXVlc3Rpb24udHJ1bmMoNTApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvY3VzZWRfc2VsZWN0LmFwcGVuZCgnPG9wdGlvbiB2YWx1ZT1cIicgKyBkZXN0aW5hdGlvbi5yZWYgKyAnXCI+JyArIHF1ZXN0aW9uICsgJyA8L29wdGlvbj4nKTtcbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIC8vLy9pZiBhbnkganVtcCwgcmVmcmVzaCB0aGUganVtcHMgc2VsZWN0ZWQgZGVzdGluYXRpb24gbGFiZWwgYXMgaXQgbWlnaHQgaGF2ZSBjaGFuZ2VkXG4gICAgcmVmcmVzaElucHV0SnVtcHNEb206IGZ1bmN0aW9uIChpbnB1dCwgaW5wdXRzKSB7XG5cbiAgICAgICAgdmFyIHNlbGVjdGVkX2Rlc3RpbmF0aW9ucyA9IGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXJcbiAgICAgICAgICAgIC5maW5kKCdmb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIGlucHV0LnJlZiArICdcIl0nKVxuICAgICAgICAgICAgLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19qdW1wc19fbG9naWMtLWdvdG8gc2VsZWN0IG9wdGlvbjpzZWxlY3RlZCcpO1xuICAgICAgICB2YXIgcHVyaWZpZWRSZWFkbWUgPSAnJztcblxuICAgICAgICB2YXIgYXZhaWxhYmxlX2Rlc3RpbmF0aW9ucyA9IHV0aWxzLmdldEp1bXBBdmFpbGFibGVEZXN0aW5hdGlvbnMoaW5wdXQsIGlucHV0cyk7XG5cbiAgICAgICAgLy9sb29wIGVhY2gganVtcFxuICAgICAgICAkKGlucHV0Lmp1bXBzKS5lYWNoKGZ1bmN0aW9uIChqdW1wSW5kZXgsIGp1bXApIHtcblxuICAgICAgICAgICAgLy9maW5kIHRoZSBkZXN0aW5hdGlvbiBcInF1ZXN0aW9uXCIgYW5kIHVwZGF0ZSB0aGUgdGV4dCBzaG93biBpbiB0aGUgZHJvcGRvd24gXCJnbyB0b1wiXG4gICAgICAgICAgICAkKGF2YWlsYWJsZV9kZXN0aW5hdGlvbnMpLmVhY2goZnVuY3Rpb24gKGRlc3RpbmF0aW9uSW5kZXgsIGRlc3RpbmF0aW9uKSB7XG5cbiAgICAgICAgICAgICAgICBpZiAoanVtcC50byA9PT0gZGVzdGluYXRpb24ucmVmKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkZXN0aW5hdGlvbi50eXBlID09PSBjb25zdHMuUkVBRE1FX1RZUEUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vc3RyaXAgYWxsIHRhZ3MgZm9yIHByZXZpZXcgd2l0aGluIHNlbGVjdFxuICAgICAgICAgICAgICAgICAgICAgICAgcHVyaWZpZWRSZWFkbWUgPSB1dGlscy5kZWNvZGVIdG1sKGRlc3RpbmF0aW9uLnF1ZXN0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHB1cmlmaWVkUmVhZG1lID0gdXRpbHMuc3RyaXBUYWdzKHB1cmlmaWVkUmVhZG1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICQoc2VsZWN0ZWRfZGVzdGluYXRpb25zW2p1bXBJbmRleF0pLnRleHQocHVyaWZpZWRSZWFkbWUudHJ1bmMoNTApKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICQoc2VsZWN0ZWRfZGVzdGluYXRpb25zW2p1bXBJbmRleF0pLnRleHQoZGVzdGluYXRpb24ucXVlc3Rpb24pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBqdW1wcztcbiIsIid1c2Ugc3RyaWN0JztcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgdWkgPSByZXF1aXJlKCdoZWxwZXJzL3VpJyk7XG52YXIgdXRpbHMgPSByZXF1aXJlKCdoZWxwZXJzL3V0aWxzJyk7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcbnZhciBpbnB1dF9mYWN0b3J5ID0gcmVxdWlyZSgnZmFjdG9yeS9pbnB1dC1mYWN0b3J5Jyk7XG52YXIgSW5wdXQgPSByZXF1aXJlKCdmYWN0b3J5L2lucHV0LXByb3RvdHlwZScpO1xudmFyIGZvcm1fZmFjdG9yeSA9IHJlcXVpcmUoJ2ZhY3RvcnkvZm9ybS1mYWN0b3J5Jyk7XG52YXIgdGVtcGxhdGUgPSByZXF1aXJlKCd0ZW1wbGF0ZScpO1xudmFyIHZhbGlkYXRpb24gPSByZXF1aXJlKCdhY3Rpb25zL3ZhbGlkYXRpb24nKTtcbnZhciBtZXRob2RzID0ge1xuICAgIGdldEJyYW5jaElucHV0c0hUTUw6IHJlcXVpcmUoJ2FjdGlvbnMvcGFyc2UvbWV0aG9kcy9nZXRCcmFuY2hJbnB1dHNIVE1MJyksXG4gICAgZ2V0R3JvdXBJbnB1dHNIVE1MOiByZXF1aXJlKCdhY3Rpb25zL3BhcnNlL21ldGhvZHMvZ2V0R3JvdXBJbnB1dHNIVE1MJyksXG4gICAgcmVuZGVySW5wdXRzOiByZXF1aXJlKCdhY3Rpb25zL3BhcnNlL21ldGhvZHMvcmVuZGVySW5wdXRzJyksXG4gICAgcmVuZGVyUHJvamVjdDogcmVxdWlyZSgnYWN0aW9ucy9wYXJzZS9tZXRob2RzL3JlbmRlclByb2plY3QnKSxcbiAgICByZW5kZXJDaGlsZEZvcm1zOiByZXF1aXJlKCdhY3Rpb25zL3BhcnNlL21ldGhvZHMvcmVuZGVyQ2hpbGRGb3JtcycpLFxuICAgIGluaXRGb3JtYnVpbGRlcjogcmVxdWlyZSgnYWN0aW9ucy9wYXJzZS9tZXRob2RzL2luaXRGb3JtYnVpbGRlcicpXG59O1xuXG52YXIgcGFyc2UgPSB7XG5cbiAgICBhY3Rpb246ICcnLFxuXG4gICAgcmVuZGVySW5wdXRzOiBmdW5jdGlvbiAodGhlX2lucHV0cykge1xuICAgICAgICByZXR1cm4gbWV0aG9kcy5yZW5kZXJJbnB1dHModGhlX2lucHV0cyk7XG4gICAgfSxcblxuICAgIGdldEJyYW5jaElucHV0c0hUTUw6IGZ1bmN0aW9uICh0aGVfaW5wdXQsIHRoZV9pbmRleCkge1xuICAgICAgICByZXR1cm4gbWV0aG9kcy5nZXRCcmFuY2hJbnB1dHNIVE1MKHRoZV9pbnB1dCwgdGhlX2luZGV4KTtcbiAgICB9LFxuICAgIC8vYnJhbmNoIGluZGV4IGlzIHNldCB3aGVuIGl0IGlzIGEgbmVzdGVkIGdyb3VwIG9ubHlcbiAgICBnZXRHcm91cElucHV0c0hUTUw6IGZ1bmN0aW9uICh0aGVfaW5wdXQsIHRoZV9pbmRleCwgdGhlX2JyYW5jaF9pbmRleCkge1xuICAgICAgICByZXR1cm4gbWV0aG9kcy5nZXRHcm91cElucHV0c0hUTUwodGhlX2lucHV0LCB0aGVfaW5kZXgsIHRoZV9icmFuY2hfaW5kZXgpO1xuICAgIH0sXG5cbiAgICByZW5kZXJQcm9qZWN0OiBmdW5jdGlvbiAocHJvamVjdF9kZWZpbml0aW9uLCBhY3Rpb24pIHtcbiAgICAgICAgcmV0dXJuIG1ldGhvZHMucmVuZGVyUHJvamVjdChwcm9qZWN0X2RlZmluaXRpb24sIGFjdGlvbik7XG4gICAgfSxcblxuICAgIGluaXRGb3JtYnVpbGRlcjogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbWV0aG9kcy5pbml0Rm9ybWJ1aWxkZXIoKTtcbiAgICB9LFxuXG4gICAgLy9yZW5kZXIgY2hpbGRyZW4gZm9ybXMgcmVjdXJzaXZlbHlcbiAgICByZW5kZXJDaGlsZEZvcm06IGZ1bmN0aW9uICh0aGVfY2hpbGRfZm9ybXMpIHtcbiAgICAgICAgcmV0dXJuIG1ldGhvZHMucmVuZGVyQ2hpbGRGb3Jtcyh0aGVfY2hpbGRfZm9ybXMpO1xuICAgIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gcGFyc2U7XG5cbiIsIid1c2Ugc3RyaWN0JztcbnZhciB1aSA9IHJlcXVpcmUoJ2hlbHBlcnMvdWknKTtcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJ2NvbmZpZy9mb3JtYnVpbGRlcicpO1xudmFyIHRlbXBsYXRlID0gcmVxdWlyZSgndGVtcGxhdGUnKTtcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG5cbnZhciBnZXRCcmFuY2hJbnB1dHNIVE1MID0gZnVuY3Rpb24gKHRoZV9pbnB1dCwgdGhlX2luZGV4KSB7XG5cbiAgICB2YXIgaW5wdXRfZmFjdG9yeSA9IHJlcXVpcmUoJ2ZhY3RvcnkvaW5wdXQtZmFjdG9yeScpO1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB2YXIgaW5wdXQgPSB0aGVfaW5wdXQ7XG4gICAgdmFyIGluZGV4ID0gdGhlX2luZGV4O1xuICAgIHZhciBicmFuY2hfcHJvcGVydGllcztcbiAgICB2YXIgaHRtbDtcbiAgICB2YXIgYnJhbmNoX3NvcnRhYmxlX2h0bWwgPSB1aS5pbnB1dHNfY29sbGVjdGlvbi5nZXRFbXB0eUNvbGxlY3Rpb25Tb3J0YWJsZUhUTUwoY29uc3RzLkJSQU5DSF9UWVBFKTtcbiAgICB2YXIgYnJhbmNoX2lucHV0X2NvbGxlY3Rpb25faHRtbCA9ICcnO1xuICAgIHZhciBicmFuY2hfcHJvcGVydGllc19wYW5lbF9odG1sID0gJyc7XG4gICAgdmFyIHByb3BlcnRpZXNfcGFuZWxfaHRtbCA9ICcnO1xuXG4gICAgZm9ybWJ1aWxkZXIuY3VycmVudF9pbnB1dF9yZWYgPSBpbnB1dC5yZWY7XG5cbiAgICAvL2lmIG5vIGJyYW5jaCBpbnB1dHMsIHNob3cgXCJubyBicmFuY2ggaW5wdXRzIG1lc3NhZ2VcIlxuXG4gICAgJC5lYWNoKGlucHV0LmJyYW5jaCwgZnVuY3Rpb24gKGJyYW5jaF9pbmRleCwgYnJhbmNoX2lucHV0KSB7XG5cbiAgICAgICAgLy9jcmVhdGUgaHRtbCBicmFuY2ggZWxlbWVudCBmb3IgaW5wdXQgY29sbGVjdGlvbiAobWlkZGxlIGNvbHVtbilcbiAgICAgICAgaHRtbCA9IGlucHV0X2ZhY3RvcnkuY3JlYXRlSW5wdXRUb29sSFRNTChicmFuY2hfaW5wdXQpO1xuICAgICAgICBicmFuY2hfaW5wdXRfY29sbGVjdGlvbl9odG1sICs9IGh0bWw7XG5cbiAgICAgICAgLy9jb3B5IGlucHV0IHByb3BlcnRpZXMgZnJvbSBzdG9yZWQgYnJhbmNoIGlucHV0XG4gICAgICAgIGJyYW5jaF9wcm9wZXJ0aWVzID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShicmFuY2hfaW5wdXQpKTtcblxuICAgICAgICAvL2dlbmVyYXRlIG5ldyBicmFuY2ggaW5wdXQgd2l0aCBhdHRhY2hlZCBwcm90b3R5cGVcbiAgICAgICAgYnJhbmNoX2lucHV0ID0gaW5wdXRfZmFjdG9yeS5jcmVhdGVJbnB1dChicmFuY2hfcHJvcGVydGllcy50eXBlLCBicmFuY2hfcHJvcGVydGllcy5yZWYpO1xuXG4gICAgICAgIC8vc2V0IGJyYW5jaCBpbnB1dCBwcm9wZXJ0aWVzIHRvIHN0b3JlZCBwcm9wZXJ0aWVzIChvbmx5IHRoZSBvbmUgc2F2ZWQgaW4gdGhlIHByb2plY3QgZGVmaW5pdGlvbiwgbGVhdmUgdGhlIG90aGVycyBpbnRhY3QpXG4gICAgICAgIGZvciAodmFyIHByb3BlcnR5IGluIGJyYW5jaF9pbnB1dCkge1xuICAgICAgICAgICAgaWYgKGJyYW5jaF9wcm9wZXJ0aWVzLmhhc093blByb3BlcnR5KHByb3BlcnR5KSkge1xuICAgICAgICAgICAgICAgIGJyYW5jaF9pbnB1dFtwcm9wZXJ0eV0gPSBicmFuY2hfcHJvcGVydGllc1twcm9wZXJ0eV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy9zZXQgYnJhbmNoIGlucHV0IGFzIHZhbGlkLCBhcyBieSBkZWZhdWx0IGl0IGlzIGdlbmVyYXRlZCBhcyBpbnZhbGlkXG4gICAgICAgIGJyYW5jaF9pbnB1dC5kb20uaXNfdmFsaWQgPSB0cnVlO1xuXG4gICAgICAgIC8vb3ZlcnJpZGUgJ2dsb2JhbCcgYnJhbmNoIGlucHV0IG9iaiBsaXRlcmFsIHdpdGggbmV3bHkgY3JlYXRlZFxuICAgICAgICBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0LmZvcm1zW2Zvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleF0uaW5wdXRzW2luZGV4XS5icmFuY2hbYnJhbmNoX2luZGV4XSA9IGJyYW5jaF9pbnB1dDtcblxuICAgICAgICAvL2lmIGl0IGlzIGEgZ3JvdXAsIGxvb3AgYWxsIHRoZSBuZXN5ZWQgZ3JvdXAgaW5wdXRzICh0aGVyZSBtdXN0IGJlIGF0IGxlYXN0IGEgZ3JvdXAgaW5wdXQpXG4gICAgICAgIGlmIChicmFuY2hfaW5wdXQudHlwZSA9PT0gY29uc3RzLkdST1VQX1RZUEUpIHtcblxuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19ncm91cCA9IHRydWU7XG5cbiAgICAgICAgICAgIC8vcGFzcyBpbiBicmFuY2hfaW5kZXggYXMgdGhpcyBpcyBhIG5lc3RlZCBncm91cFxuICAgICAgICAgICAgdmFyIG5lc3RlZF9ncm91cF9pbnB1dHNfaHRtbCA9IHNlbGYuZ2V0R3JvdXBJbnB1dHNIVE1MKGJyYW5jaF9pbnB1dCwgaW5kZXgsIGJyYW5jaF9pbmRleCk7XG4gICAgICAgICAgICBicmFuY2hfaW5wdXRfY29sbGVjdGlvbl9odG1sID0gYnJhbmNoX2lucHV0X2NvbGxlY3Rpb25faHRtbC5yZXBsYWNlKCd7e2dyb3VwLWNvbnRlbnR9fScsIG5lc3RlZF9ncm91cF9pbnB1dHNfaHRtbC5jb2xsZWN0aW9uKTtcbiAgICAgICAgICAgIGJyYW5jaF9wcm9wZXJ0aWVzX3BhbmVsX2h0bWwgKz0gbmVzdGVkX2dyb3VwX2lucHV0c19odG1sLnBhbmVscztcblxuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19ncm91cCA9IGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9wZXIgZWFjaCBicmFuY2ggaW5wdXQgd2l0aCBwb3NzaWJsZSBhbnN3ZXJzIGtlZXAgdHJhY2sgb2YgcGFnaW5hdGlvblxuICAgICAgICBpZiAoY29uc3RzLk1VTFRJUExFX0FOU1dFUl9UWVBFUy5pbmRleE9mKGJyYW5jaF9pbnB1dC50eXBlKSA+IC0xKSB7XG4gICAgICAgICAgICAvL3dlIGhhdmUgcG9zc2libGUgYW5zd2Vyc1xuICAgICAgICAgICAgZm9ybWJ1aWxkZXIucG9zc2libGVfYW5zd2Vyc19wYWdpbmF0aW9uW2JyYW5jaF9pbnB1dC5yZWZdID0ge307XG4gICAgICAgICAgICBmb3JtYnVpbGRlci5wb3NzaWJsZV9hbnN3ZXJzX3BhZ2luYXRpb25bYnJhbmNoX2lucHV0LnJlZl0ucGFnZSA9IDE7XG4gICAgICAgIH1cblxuICAgICAgICAvL2dldCBwcm9wZXJ0aWVzIHBhbmVsIGZvciBicmFuY2ggaW5wdXRcbiAgICAgICAgcHJvcGVydGllc19wYW5lbF9odG1sID0gdGVtcGxhdGUuZ2V0SW5wdXRQcm9wZXJ0aWVzUGFuZWxIVE1MKGJyYW5jaF9pbnB1dCk7XG4gICAgICAgIGJyYW5jaF9wcm9wZXJ0aWVzX3BhbmVsX2h0bWwgKz0gcHJvcGVydGllc19wYW5lbF9odG1sO1xuXG4gICAgfSk7XG5cbiAgICBicmFuY2hfc29ydGFibGVfaHRtbCA9IGJyYW5jaF9zb3J0YWJsZV9odG1sLnJlcGxhY2UoJ3t7YnJhbmNoLWlucHV0c319JywgYnJhbmNoX2lucHV0X2NvbGxlY3Rpb25faHRtbCk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBjb2xsZWN0aW9uOiBicmFuY2hfc29ydGFibGVfaHRtbCxcbiAgICAgICAgcGFuZWxzOiBicmFuY2hfcHJvcGVydGllc19wYW5lbF9odG1sXG4gICAgfTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gZ2V0QnJhbmNoSW5wdXRzSFRNTDtcbiIsIid1c2Ugc3RyaWN0JztcbnZhciB1aSA9IHJlcXVpcmUoJ2hlbHBlcnMvdWknKTtcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJ2NvbmZpZy9mb3JtYnVpbGRlcicpO1xudmFyIHRlbXBsYXRlID0gcmVxdWlyZSgndGVtcGxhdGUnKTtcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG5cbnZhciBnZXRHcm91cHNJbnB1dHNIVE1MID0gZnVuY3Rpb24gKHRoZV9pbnB1dCwgdGhlX2luZGV4LCB0aGVfYnJhbmNoX2luZGV4KSB7XG5cbiAgICB2YXIgaW5wdXRfZmFjdG9yeSA9IHJlcXVpcmUoJ2ZhY3RvcnkvaW5wdXQtZmFjdG9yeScpO1xuICAgIHZhciBpbnB1dCA9IHRoZV9pbnB1dDtcbiAgICB2YXIgaW5kZXggPSB0aGVfaW5kZXg7XG4gICAgdmFyIGJyYW5jaF9pbmRleCA9IHRoZV9icmFuY2hfaW5kZXg7XG4gICAgdmFyIGdyb3VwX3Byb3BlcnRpZXM7XG4gICAgdmFyIGh0bWw7XG4gICAgdmFyIGdyb3VwX3NvcnRhYmxlX2h0bWwgPSB1aS5pbnB1dHNfY29sbGVjdGlvbi5nZXRFbXB0eUNvbGxlY3Rpb25Tb3J0YWJsZUhUTUwoY29uc3RzLkdST1VQX1RZUEUpO1xuICAgIHZhciBncm91cF9pbnB1dF9jb2xsZWN0aW9uX2h0bWwgPSAnJztcbiAgICB2YXIgcHJvcGVydGllc19wYW5lbF9odG1sID0gJyc7XG4gICAgdmFyIGdyb3VwX3Byb3BlcnRpZXNfcGFuZWxfaHRtbCA9ICcnO1xuXG4gICAgZm9ybWJ1aWxkZXIuY3VycmVudF9pbnB1dF9yZWYgPSBpbnB1dC5yZWY7XG5cbiAgICAkLmVhY2goaW5wdXQuZ3JvdXAsIGZ1bmN0aW9uIChncm91cF9pbmRleCwgZ3JvdXBfaW5wdXQpIHtcblxuICAgICAgICAvL2NyZWF0ZSBodG1sIGdyb3VwIGVsZW1lbnQgZm9yIGlucHV0IGNvbGxlY3Rpb24gKG1pZGRsZSBjb2x1bW4pXG4gICAgICAgIGh0bWwgPSBpbnB1dF9mYWN0b3J5LmNyZWF0ZUlucHV0VG9vbEhUTUwoZ3JvdXBfaW5wdXQpO1xuICAgICAgICBncm91cF9pbnB1dF9jb2xsZWN0aW9uX2h0bWwgKz0gaHRtbDtcblxuICAgICAgICAvL2NvcHkgaW5wdXQgcHJvcGVydGllcyBmcm9tIHN0b3JlZCBncm91cCBpbnB1dFxuICAgICAgICBncm91cF9wcm9wZXJ0aWVzID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShncm91cF9pbnB1dCkpO1xuXG4gICAgICAgIC8vZ2VuZXJhdGUgbmV3IGdyb3VwIGlucHV0IHdpdGggYXR0YWNoZWQgcHJvdG90eXBlXG4gICAgICAgIGdyb3VwX2lucHV0ID0gaW5wdXRfZmFjdG9yeS5jcmVhdGVJbnB1dChncm91cF9wcm9wZXJ0aWVzLnR5cGUsIGdyb3VwX3Byb3BlcnRpZXMucmVmKTtcblxuICAgICAgICAvL3NldCBncm91cCBpbnB1dCBwcm9wZXJ0aWVzIHRvIHN0b3JlZCBwcm9wZXJ0aWVzIChvbmx5IHRoZSBvbmUgc2F2ZWQgaW4gdGhlIHByb2plY3QgZGVmaW5pdGlvbiwgbGVhdmUgdGhlIG90aGVycyBpbnRhY3QpXG4gICAgICAgIGZvciAodmFyIHByb3BlcnR5IGluIGdyb3VwX2lucHV0KSB7XG4gICAgICAgICAgICBpZiAoZ3JvdXBfcHJvcGVydGllcy5oYXNPd25Qcm9wZXJ0eShwcm9wZXJ0eSkpIHtcbiAgICAgICAgICAgICAgICBncm91cF9pbnB1dFtwcm9wZXJ0eV0gPSBncm91cF9wcm9wZXJ0aWVzW3Byb3BlcnR5XTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vc2V0IGdyb3VwIGlucHV0IGFzIHZhbGlkLCBhcyBieSBkZWZhdWx0IGl0IGlzIGdlbmVyYXRlZCBhcyBpbnZhbGlkXG4gICAgICAgIGdyb3VwX2lucHV0LmRvbS5pc192YWxpZCA9IHRydWU7XG5cbiAgICAgICAgLy9vdmVycmlkZSAnZ2xvYmFsJyBncm91cCBpbnB1dCBvYmogbGl0ZXJhbCB3aXRoIG5ld2x5IGNyZWF0ZWRcbiAgICAgICAgaWYgKGJyYW5jaF9pbmRleCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgLy90aGlzIGlzIGEgZmlyc3QgbGV2ZWwgZ3JvdXBcbiAgICAgICAgICAgIGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbi5kYXRhLnByb2plY3QuZm9ybXNbZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4XS5pbnB1dHNbaW5kZXhdLmdyb3VwW2dyb3VwX2luZGV4XSA9IGdyb3VwX2lucHV0O1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy90aGlzIGlzIGEgbmVzdGVkIGdyb3VwXG4gICAgICAgICAgICBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0XG4gICAgICAgICAgICAgICAgLmZvcm1zW2Zvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleF1cbiAgICAgICAgICAgICAgICAuaW5wdXRzW2luZGV4XVxuICAgICAgICAgICAgICAgIC5icmFuY2hbYnJhbmNoX2luZGV4XVxuICAgICAgICAgICAgICAgIC5ncm91cFtncm91cF9pbmRleF0gPSBncm91cF9pbnB1dDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vcGVyIGVhY2ggZ3JvdXAgaW5wdXQgd2l0aCBwb3NzaWJsZSBhbnN3ZXJzIGtlZXAgdHJhY2sgb2YgcGFnaW5hdGlvblxuICAgICAgICBpZiAoY29uc3RzLk1VTFRJUExFX0FOU1dFUl9UWVBFUy5pbmRleE9mKGdyb3VwX2lucHV0LnR5cGUpID4gLTEpIHtcbiAgICAgICAgICAgIC8vd2UgaGF2ZSBwb3NzaWJsZSBhbnN3ZXJzXG4gICAgICAgICAgICBmb3JtYnVpbGRlci5wb3NzaWJsZV9hbnN3ZXJzX3BhZ2luYXRpb25bZ3JvdXBfaW5wdXQucmVmXSA9IHt9O1xuICAgICAgICAgICAgZm9ybWJ1aWxkZXIucG9zc2libGVfYW5zd2Vyc19wYWdpbmF0aW9uW2dyb3VwX2lucHV0LnJlZl0ucGFnZSA9IDE7XG4gICAgICAgIH1cblxuICAgICAgICBwcm9wZXJ0aWVzX3BhbmVsX2h0bWwgPSB0ZW1wbGF0ZS5nZXRJbnB1dFByb3BlcnRpZXNQYW5lbEhUTUwoZ3JvdXBfaW5wdXQpO1xuICAgICAgICBncm91cF9wcm9wZXJ0aWVzX3BhbmVsX2h0bWwgKz0gcHJvcGVydGllc19wYW5lbF9odG1sO1xuICAgIH0pO1xuXG4gICAgZ3JvdXBfc29ydGFibGVfaHRtbCA9IGdyb3VwX3NvcnRhYmxlX2h0bWwucmVwbGFjZSgne3tncm91cC1pbnB1dHN9fScsIGdyb3VwX2lucHV0X2NvbGxlY3Rpb25faHRtbCk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBjb2xsZWN0aW9uOiBncm91cF9zb3J0YWJsZV9odG1sLFxuICAgICAgICBwYW5lbHM6IGdyb3VwX3Byb3BlcnRpZXNfcGFuZWxfaHRtbFxuICAgIH07XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGdldEdyb3Vwc0lucHV0c0hUTUw7XG4iLCIndXNlIHN0cmljdCc7XG52YXIgY29uc3RzID0gcmVxdWlyZSgnY29uZmlnL2NvbnN0cycpO1xudmFyIHVpID0gcmVxdWlyZSgnaGVscGVycy91aScpO1xudmFyIHV0aWxzID0gcmVxdWlyZSgnaGVscGVycy91dGlscycpO1xudmFyIGZvcm1idWlsZGVyID0gcmVxdWlyZSgnY29uZmlnL2Zvcm1idWlsZGVyJyk7XG52YXIgaW5wdXRfZmFjdG9yeSA9IHJlcXVpcmUoJ2ZhY3RvcnkvaW5wdXQtZmFjdG9yeScpO1xudmFyIGZvcm1fZmFjdG9yeSA9IHJlcXVpcmUoJ2ZhY3RvcnkvZm9ybS1mYWN0b3J5Jyk7XG52YXIgSW5wdXQgPSByZXF1aXJlKCdmYWN0b3J5L2lucHV0LXByb3RvdHlwZScpO1xudmFyIHRlbXBsYXRlID0gcmVxdWlyZSgndGVtcGxhdGUnKTtcbnZhciB2YWxpZGF0aW9uID0gcmVxdWlyZSgnYWN0aW9ucy92YWxpZGF0aW9uJyk7XG52YXIgaW5wdXRfY29sbGVjdGlvbl9icmFuY2hfc29ydGFibGVfbW91c2Vkb3duX2NhbGxiYWNrID0gcmVxdWlyZSgndWktaGFuZGxlcnMvZXZlbnQtaGFuZGxlci1jYWxsYmFja3MvaW5wdXQtY29sbGVjdGlvbi1icmFuY2gtc29ydGFibGUtbW91c2Vkb3duLWNhbGxiYWNrJyk7XG5cbnZhciBpbml0Rm9ybWJ1aWxkZXIgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgdmFyIHByb2plY3Q7XG4gICAgdmFyIGZvcm1zO1xuICAgIHZhciBzdGF0ZTtcbiAgICAvLyB2YXIgcHJvamVjdF9kZWZpbml0aW9uO1xuICAgIHZhciBhY3RpdmVfYnJhbmNoO1xuICAgIHZhciBhY3RpdmVfYnJhbmNoX2lucHV0O1xuICAgIHZhciBhY3RpdmVfbmVzdGVkX2dyb3VwO1xuXG5cbiAgICAvL2Ryb3AgYW55IHJlZmVyZW5jZSB0byBpbnB1dCByZWYsIGFzIHdlIHN0YXJ0IHdpdGggbm8gaW5wdXQgc2VsZWN0ZWRcbiAgICBmb3JtYnVpbGRlci5jdXJyZW50X2lucHV0X3JlZiA9IHVuZGVmaW5lZDtcbiAgICBmb3JtYnVpbGRlci5pc19lZGl0aW5nX2JyYW5jaCA9IGZhbHNlO1xuICAgIGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfZ3JvdXAgPSBmYWxzZTtcblxuICAgIC8vcmUtZW5hYmxlIGJyYW5jaCBpbnB1dCB0b29sIGluIGxlZnQgc2lkZWJhclxuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfdG9vbHNfZHJhZ2dhYmxlLmZpbHRlcignLmlucHV0LWJyYW5jaCcpLnNob3coKTtcbiAgICAvL3JlLWVuYWJsZSBncm91cCBpbnB1dCB0b29sIGluIGxlZnQgc2lkZWJhclxuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfdG9vbHNfZHJhZ2dhYmxlLmZpbHRlcignLmlucHV0LWdyb3VwJykuc2hvdygpO1xuXG4gICAgaWYodXRpbHMuZ2V0U2VhcmNoSW5wdXRzVG90YWwoKSA+PSBjb25zdHMuTElNSVRTLnNlYXJjaF9pbnB1dHNfbWF4KSB7XG4gICAgICAgIHVpLmlucHV0X3Rvb2xzLmhpZGVTZWFyY2hJbnB1dCgpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdWkuaW5wdXRfdG9vbHMuc2hvd1NlYXJjaElucHV0KCk7XG4gICAgfVxuXG4gICAgLy9kaXNhYmxlIHNhdmUgcHJvamVjdCBidXR0b24sIGFzIHRoZXJlIGlzIG5vIHBvaW50IHNhdmluZyBhIHByb2plY3Qgd2l0aCBubyBjaGFuZ2VzXG4gICAgLy9pdCB3aWxsIGJlIHJlLWVuYWJsZSBhcyBzb29uIHRoZSB1c2VyIG1ha2UgYSBjaGFuZ2VcbiAgICBmb3JtYnVpbGRlci5kb20uc2F2ZV9wcm9qZWN0X2J0bi5vZmYoJ2NsaWNrJyk7XG5cbiAgICAvL3doZW4gdW5kb2luZ1xuICAgIGlmIChmb3JtYnVpbGRlci5yZW5kZXJfYWN0aW9uID09PSBjb25zdHMuUkVOREVSX0FDVElPTl9VTkRPKSB7XG5cbiAgICAgICAgLy9nZXQgY3VycmVudCBwcm9qZWN0IGRlZmluaXRpb24gYXMgd2UgaGF2ZSBhbGwgdGhlIG1ldGhvZHMgYXR0YWNoZWQgdG8gaW5wdXRzIChpdCBpcyB0aGUgcHJldmlvdXMgc3RhdGUganVzdCByZW5kZXJlZCBvbiBzY3JlZW4pXG4gICAgICAgIC8vcHJvamVjdF9kZWZpbml0aW9uID0gZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uO1xuICAgICAgICBzdGF0ZSA9IGZvcm1idWlsZGVyLnByZXZpb3VzX3N0YXRlO1xuICAgICAgICBwcm9qZWN0ID0gZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uLmRhdGEucHJvamVjdDtcbiAgICAgICAgZm9ybXMgPSBwcm9qZWN0LmZvcm1zLnNsaWNlKCk7XG5cbiAgICAgICAgLy9sZXQncyBzZXQgYWxsIGlucHV0cyBhcyBkaXNhYmxlZCB0byBzdGFydCB3aXRoXG4gICAgICAgIGZvcm1idWlsZGVyLmN1cnJlbnRfaW5wdXRfcmVmID0gdW5kZWZpbmVkO1xuXG4gICAgICAgIC8vcnVuIHZhbGlkYXRpb24gb24gZWFjaCBmb3JtXG4gICAgICAgICQoZm9ybXMpLmVhY2goZnVuY3Rpb24gKGluZGV4LCBmb3JtKSB7XG5cbiAgICAgICAgICAgIC8vc2V0IGZvcm0gZG9tIHJlZmVyZW5jZXMgKGZvciB0aGUgdmFsaWRhdGlvbiBhbmQgZG9tIGNoYW5nZXMpXG4gICAgICAgICAgICBmb3JtX2ZhY3RvcnkudXBkYXRlRm9ybWJ1aWxkZXJEb21SZWZlcmVuY2VzKGZvcm0ucmVmKTtcblxuICAgICAgICAgICAgLy9zZXQgZm9ybWJ1aWxkZXIgc3RldCBmb3IgdmFsaWRhdGlvblxuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4ID0gaW5kZXg7XG4gICAgICAgICAgICBmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1fcmVmID0gZm9ybS5yZWY7XG5cbiAgICAgICAgICAgIC8vdG9kbyBjaGVjayB0aGlzIGZvciBicmFuY2hlcywgZ3JvdXBzIGFuZCBuZXN0ZWQgZ3JvdXBzXG4gICAgICAgICAgICAkKGZvcm0uaW5wdXRzKS5lYWNoKGZ1bmN0aW9uIChpbmRleCwgaW5wdXQpIHtcblxuICAgICAgICAgICAgICAgIC8vY2hlY2sgaWYgd2UgaGF2ZSBhbiBhY3RpdmUgaW5wdXQgYWZ0ZXIgdW5kb2luZ1xuICAgICAgICAgICAgICAgIGlmIChpbnB1dC5yZWYgPT09IHN0YXRlLmFjdGl2ZV9pbnB1dF9yZWYpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIuY3VycmVudF9pbnB1dF9yZWYgPSBzdGF0ZS5hY3RpdmVfaW5wdXRfcmVmO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICghaW5wdXQuZG9tLmlzX3ZhbGlkKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vcnVuIGEgdmFsaWRhdGlvbiBhZnRlciB0aGUgZG9tIGlzIGNyZWF0ZWQgbG9vcGluZyBhbGwgdGhlIGlucHV0cyB3aGljaCBhcmUgc2V0IGFzIGZhbHNlLCBhbmQgc2V0IGRvbSBhY2NvcmRpbmdseVxuICAgICAgICAgICAgICAgICAgICB2YWxpZGF0aW9uLnBlcmZvcm1WYWxpZGF0aW9uKGlucHV0LCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGlmICh2YWxpZGF0aW9uLmFyZUZvcm1JbnB1dHNWYWxpZChpbmRleCkpIHtcbiAgICAgICAgICAgICAgICAvL3NldCB2YWxpZCBpY29uIG9uIGZvcm1cbiAgICAgICAgICAgICAgICB1aS5mb3Jtc190YWJzLnNob3dGb3JtVmFsaWRJY29uKGluZGV4KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vc2V0IGludmFsaWQgaWNvbiBvbiBmb3JtXG4gICAgICAgICAgICAgICAgdWkuZm9ybXNfdGFicy5zaG93Rm9ybUludmFsaWRJY29uKGluZGV4KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy9zZXQgZm9ybWJ1aWxkZXIgaW50ZXJmYWNlIHRvIHByZXZpb3VzIHN0YXRlXG4gICAgICAgIGZvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleCA9IHN0YXRlLmFjdGl2ZV9mb3JtX2luZGV4O1xuICAgICAgICBmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1fcmVmID0gc3RhdGUuYWN0aXZlX2Zvcm1fcmVmO1xuICAgICAgICBmb3JtX2ZhY3RvcnkudXBkYXRlRm9ybWJ1aWxkZXJEb21SZWZlcmVuY2VzKGZvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9yZWYpO1xuICAgICAgICBmb3JtYnVpbGRlci5pc19lZGl0aW5nX2JyYW5jaCA9IHN0YXRlLndhc19lZGl0aW5nX2JyYW5jaDtcbiAgICAgICAgZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19ncm91cCA9IHN0YXRlLndhc19lZGl0aW5nX2dyb3VwO1xuXG4gICAgICAgIGlmIChmb3JtYnVpbGRlci5pc19lZGl0aW5nX2JyYW5jaCAmJiBmb3JtYnVpbGRlci5pc19lZGl0aW5nX2dyb3VwKSB7XG4gICAgICAgICAgICAvL3RvZG8gcmUtZW5hYmxlIHRoZSBuZXN0ZWQgZ3JvdXAgdGhhdCB3YXMgYmVpbmcgZWRpdGVkXG5cblxuICAgICAgICAgICAgY29uc29sZS5sb2coZm9ybWJ1aWxkZXIpO1xuXG4gICAgICAgICAgICBhY3RpdmVfYnJhbmNoID0gdXRpbHMuZ2V0SW5wdXRPYmplY3RCeVJlZihzdGF0ZS5hY3RpdmVfYnJhbmNoX3JlZik7XG4gICAgICAgICAgICBhY3RpdmVfbmVzdGVkX2dyb3VwID0gdXRpbHMuZ2V0TmVzdGVkR3JvdXBPYmplY3RCeVJlZihhY3RpdmVfYnJhbmNoLCBzdGF0ZS5hY3RpdmVfZ3JvdXBfcmVmKTtcbiAgICAgICAgICAgIGFjdGl2ZV9icmFuY2guZW50ZXJCcmFuY2hTb3J0YWJsZSgpO1xuXG4gICAgICAgICAgICBmb3JtYnVpbGRlci5jdXJyZW50X2lucHV0X3JlZiA9IHN0YXRlLmFjdGl2ZV9icmFuY2hfcmVmOy8vdGhlIGJyYW5jaCB0aGF0IHdhcyBhY3RpdmUgd2hlbiB1bmRvaW5nXG4gICAgICAgICAgICBmb3JtYnVpbGRlci5icmFuY2guY3VycmVudF9pbnB1dF9yZWYgPSBzdGF0ZS5hY3RpdmVfZ3JvdXBfcmVmOy8vdGhlIG5lc3RlZCBncm91cCB0aGF0IHdhcyBhY3RpdmUgd2hlbiB1bmRvaW5nXG4gICAgICAgICAgICBmb3JtYnVpbGRlci5ncm91cC5hY3RpdmVfZ3JvdXBfcmVmID0gc3RhdGUuYWN0aXZlX2dyb3VwX3JlZjsvL3RoZSBuZXN0ZWQgZ3JvdXAgdGhhdCB3YXMgYWN0aXZlIHdoZW4gdW5kb2luZ1xuXG4gICAgICAgICAgICBhY3RpdmVfbmVzdGVkX2dyb3VwLmVudGVyR3JvdXBTb3J0YWJsZSh0cnVlKTtcblxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaWYgKGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfYnJhbmNoKSB7XG4gICAgICAgICAgICAgICAgLy9yZS1lbmFibGUgdGhlIGJyYW5jaCB0aGF0IHdhcyBiZWluZyBlZGl0ZWRcbiAgICAgICAgICAgICAgICBhY3RpdmVfYnJhbmNoID0gdXRpbHMuZ2V0SW5wdXRPYmplY3RCeVJlZihzdGF0ZS5hY3RpdmVfYnJhbmNoX3JlZik7XG4gICAgICAgICAgICAgICAgYWN0aXZlX2JyYW5jaC5lbnRlckJyYW5jaFNvcnRhYmxlKCk7XG5cbiAgICAgICAgICAgICAgICAvL3NldCB0aGUgYWN0aXZlIGJyYW5jaCBpbnB1dCBpZiB0aGVyZSB3YXMgb25lIHNlbGVjdGVkXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmFjdGl2ZV9icmFuY2hfaW5wdXRfcmVmKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vdHJpZ2dlciBhIHN5bnRoZXRpYyBjbGljayBvbiB0aGUgYnJhbmNoIHNvcnRhYmxlIChkb20pXG4gICAgICAgICAgICAgICAgICAgIC8vYWN0aXZlX2JyYW5jaF9pbnB1dCA9IHV0aWxzLmdldEJyYW5jaElucHV0T2JqZWN0QnlSZWYoc3RhdGUuYWN0aXZlX2JyYW5jaF9pbnB1dF9yZWYpO1xuICAgICAgICAgICAgICAgICAgICAkKCcuaW5wdXRbZGF0YS1pbnB1dC1yZWY9XCInICsgc3RhdGUuYWN0aXZlX2JyYW5jaF9pbnB1dF9yZWYgKyAnXCJdJykudHJpZ2dlcignbW91c2Vkb3duJyk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9zd2l0Y2ggdG8gcHJldmlvdXNseSBhY3RpdmUgcHJvcGVydGllcyB0YWJcbiAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyXG4gICAgICAgICAgICAgICAgICAgIC5maW5kKCcubmF2LXRhYnMgLm5hdi10YWJzX190YWItYnRuLWl0ZW0gYVtocmVmPVwiJyArIHN0YXRlLmFjdGl2ZV9wcm9wZXJ0aWVzX3RhYiArICdcIl0nKS50YWIoJ3Nob3cnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfZ3JvdXApIHtcbiAgICAgICAgICAgICAgICAvL3JlLWVuYWJsZSB0aGUgYnJhbmNoIHRoYXQgd2FzIGJlaW5nIGVkaXRlZFxuICAgICAgICAgICAgICAgIHZhciBhY3RpdmVfZ3JvdXAgPSB1dGlscy5nZXRJbnB1dE9iamVjdEJ5UmVmKHN0YXRlLmFjdGl2ZV9ncm91cF9yZWYpO1xuICAgICAgICAgICAgICAgIGFjdGl2ZV9ncm91cC5lbnRlckdyb3VwU29ydGFibGUoKTtcblxuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5hY3RpdmVfZ3JvdXBfaW5wdXRfcmVmKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vdHJpZ2dlciBhIHN5bnRoZXRpYyBjbGljayBvbiB0aGUgYnJhbmNoIHNvcnRhYmxlIChkb20pXG4gICAgICAgICAgICAgICAgICAgIC8vYWN0aXZlX2JyYW5jaF9pbnB1dCA9IHV0aWxzLmdldEJyYW5jaElucHV0T2JqZWN0QnlSZWYoc3RhdGUuYWN0aXZlX2JyYW5jaF9pbnB1dF9yZWYpO1xuICAgICAgICAgICAgICAgICAgICAkKCcuaW5wdXRbZGF0YS1pbnB1dC1yZWY9XCInICsgc3RhdGUuYWN0aXZlX2dyb3VwX2lucHV0X3JlZiArICdcIl0nKS50cmlnZ2VyKCdtb3VzZWRvd24nKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL3N3aXRjaCB0byBwcmV2aW91c2x5IGFjdGl2ZSBwcm9wZXJ0aWVzIHRhYlxuICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXJcbiAgICAgICAgICAgICAgICAgICAgLmZpbmQoJy5uYXYtdGFicyAubmF2LXRhYnNfX3RhYi1idG4taXRlbSBhW2hyZWY9XCInICsgc3RhdGUuYWN0aXZlX3Byb3BlcnRpZXNfdGFiICsgJ1wiXScpLnRhYignc2hvdycpO1xuXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvL2lmIHRoZSB1c2VyIHdhcyBlZGl0aW5nIG1haW4gZm9ybXMsIHJlYmluZCBldmVudHNcbiAgICAgICAgaWYgKCFmb3JtYnVpbGRlci5pc19lZGl0aW5nX2JyYW5jaCAmJiAhZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19ncm91cCkge1xuXG4gICAgICAgICAgICAvKiBkbyB0aGlzIGFzIHdlIG1pZ2h0IGhhdmUgaGFkIGFuIGFjdGl2ZSBicmFuY2ggd2hlbiBjbGlja2luZyB1bmRvICoqKioqKioqKioqKioqKi9cbiAgICAgICAgICAgIC8vZW5hYmxlIGZvcm0gdGFiIGJ1dHRvbnNcbiAgICAgICAgICAgIHVpLmZvcm1zX3RhYnMudG9nZ2xlRm9ybVRhYnNCdXR0b25zKHtlbmFibGU6IHRydWV9KTtcbiAgICAgICAgICAgIC8vc2V0IGRyYWdnYWJsZSB0byB3b3JrIHdpdGggbWFpbiBzb3J0YWJsZVxuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c190b29sc19kcmFnZ2FibGUuZHJhZ2dhYmxlKCdvcHRpb24nLCAnY29ubmVjdFRvU29ydGFibGUnLCAnLnNvcnRhYmxlJyk7XG4gICAgICAgICAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAgICAgZm9ybV9mYWN0b3J5LnVuYmluZEZvcm1QYW5lbHNFdmVudHMoKTtcbiAgICAgICAgICAgIGZvcm1fZmFjdG9yeS51cGRhdGVGb3JtYnVpbGRlckRvbVJlZmVyZW5jZXMoZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uLmRhdGEucHJvamVjdC5mb3Jtc1tmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXhdLnJlZik7XG4gICAgICAgICAgICBmb3JtX2ZhY3RvcnkuYmluZEZvcm1QYW5lbHNFdmVudHMoKTtcblxuICAgICAgICAgICAgLy9zd2l0Y2ggdG8gcHJldmlvdXNseSBhY3RpdmUgZm9ybVxuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmZvcm1zX3RhYnMuZmluZCgnYVtkYXRhLWZvcm0taW5kZXg9JyArIHN0YXRlLmFjdGl2ZV9mb3JtX2luZGV4ICsgJ10nKS50YWIoJ3Nob3cnKTtcblxuICAgICAgICAgICAgLy9hY3RpdmF0ZSBwcmV2aW91cyBpbnB1dCBmcm9tIGRvbSBjb2xsZWN0aW9uIChtaWRkbGUgY29sdW1uKSwgaWYgb25lIHdhcyBhY3RpdmUgaW4gdGhlIHByZXZpb3VzIHN0YXRlXG4gICAgICAgICAgICBpZiAoZm9ybWJ1aWxkZXIuY3VycmVudF9pbnB1dF9yZWYpIHtcbiAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25fc29ydGFibGVcbiAgICAgICAgICAgICAgICAgICAgLmZpbmQoJ2Rpdi5pbnB1dFtkYXRhLWlucHV0LXJlZj1cIicgKyBmb3JtYnVpbGRlci5jdXJyZW50X2lucHV0X3JlZiArICdcIl0nKS5hZGRDbGFzcygnYWN0aXZlJyk7XG5cbiAgICAgICAgICAgICAgICAvL3Nob3cgYWN0aXZlIGlucHV0IHByb3BlcnRpZXMgcGFuZWxcbiAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyLmZpbmQoJ2Zvcm1bZGF0YS1pbnB1dC1yZWY9XCInICsgZm9ybWJ1aWxkZXIuY3VycmVudF9pbnB1dF9yZWYgKyAnXCJdJykucmVtb3ZlQ2xhc3MoJ2hpZGRlbicpO1xuXG4gICAgICAgICAgICAgICAgLy9zd2l0Y2ggdG8gcHJldmlvdXNseSBhY3RpdmUgcHJvcGVydGllcyB0YWJcbiAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyXG4gICAgICAgICAgICAgICAgICAgIC5maW5kKCcubmF2LXRhYnMgLm5hdi10YWJzX190YWItYnRuLWl0ZW0gYVtocmVmPVwiJyArIHN0YXRlLmFjdGl2ZV9wcm9wZXJ0aWVzX3RhYiArICdcIl0nKS50YWIoJ3Nob3cnKTtcblxuICAgICAgICAgICAgICAgIC8vaGlkZSBtZXNzYWdlIG5vIGlucHV0IHdhcyBzZWxlY3RlZFxuICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbVxuICAgICAgICAgICAgICAgICAgICAuaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyXG4gICAgICAgICAgICAgICAgICAgIC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fbm8taW5wdXQtc2VsZWN0ZWQnKVxuICAgICAgICAgICAgICAgICAgICAuaGlkZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHNlbGYuZGVmZXJyZWQucmVzb2x2ZSgpO1xuICAgIH1cblxuICAgIGlmIChmb3JtYnVpbGRlci5yZW5kZXJfYWN0aW9uID09PSBjb25zdHMuUkVOREVSX0FDVElPTl9ETykge1xuICAgICAgICAvL3dlIGFyZSByZW5kZXJpbmcgYW4gZXhpc3RpbmcgcHJvamVjdCwgc28gc3dpdGNoIGRvbSByZWZlcmVuY2VzIHRvIHRvcCBsZXZlbCBmb3JtIHdoaWNoIGlzIHNob3duIGJ5IGRlZmF1bHRcbiAgICAgICAgZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4ID0gMDtcbiAgICAgICAgZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX3JlZiA9IGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbi5kYXRhLnByb2plY3QuZm9ybXNbMF0ucmVmO1xuICAgICAgICAvL2Zvcm1fZmFjdG9yeS51bmJpbmRGb3JtUGFuZWxzRXZlbnRzKCk7XG4gICAgICAgIGZvcm1fZmFjdG9yeS51cGRhdGVGb3JtYnVpbGRlckRvbVJlZmVyZW5jZXMoZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uLmRhdGEucHJvamVjdC5mb3Jtc1swXS5yZWYpO1xuXG4gICAgICAgIC8vaGlkZSBhZGQgY2hpbGQgZm9ybSBidXR0b24gaWYgdGhlIGZvcm0gdG90YWwgaXMgTUFYX05VTUJFUl9PRl9ORVNURURfQ0hJTERfRk9STVNcbiAgICAgICAgaWYgKGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbi5kYXRhLnByb2plY3QuZm9ybXMubGVuZ3RoID09PSBjb25zdHMuTUFYX05VTUJFUl9PRl9ORVNURURfQ0hJTERfRk9STVMpIHtcbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5mb3Jtc190YWJzLmZpbmQoJy5tYWluX190YWJzX2FkZC1mb3JtJykucGFyZW50KCkuaGlkZSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgc2VsZi5kZWZlcnJlZC5yZXNvbHZlKCk7XG4gICAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBpbml0Rm9ybWJ1aWxkZXI7XG5cblxuIiwiJ3VzZSBzdHJpY3QnO1xudmFyIGNvbnN0cyA9IHJlcXVpcmUoJ2NvbmZpZy9jb25zdHMnKTtcbnZhciB1aSA9IHJlcXVpcmUoJ2hlbHBlcnMvdWknKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoJ2hlbHBlcnMvdXRpbHMnKTtcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJ2NvbmZpZy9mb3JtYnVpbGRlcicpO1xudmFyIGlucHV0X2ZhY3RvcnkgPSByZXF1aXJlKCdmYWN0b3J5L2lucHV0LWZhY3RvcnknKTtcbnZhciBJbnB1dCA9IHJlcXVpcmUoJ2ZhY3RvcnkvaW5wdXQtcHJvdG90eXBlJyk7XG52YXIgZm9ybV9mYWN0b3J5ID0gcmVxdWlyZSgnZmFjdG9yeS9mb3JtLWZhY3RvcnknKTtcbnZhciB0ZW1wbGF0ZSA9IHJlcXVpcmUoJ3RlbXBsYXRlJyk7XG5cbnZhciByZW5kZXJDaGlsZEZvcm1zID0gZnVuY3Rpb24gKHRoZV9jaGlsZF9mb3Jtcykge1xuXG4gICAgdmFyIGNoaWxkX2Zvcm1zID0gdGhlX2NoaWxkX2Zvcm1zO1xuICAgIHZhciBjaGlsZF9mb3JtID0gY2hpbGRfZm9ybXMuc2hpZnQoKTtcbiAgICB2YXIgY2hpbGRfaW5wdXRzO1xuICAgIHZhciBzZWxmID0gdGhpcztcblxuICAgIGZvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleCsrO1xuXG4gICAgLy9yZW5kZXIgY2hpbGQgZm9ybVxuICAgICQud2hlbihmb3JtX2ZhY3RvcnkuY3JlYXRlQ2hpbGRGb3JtKGNoaWxkX2Zvcm0ubmFtZSwgY2hpbGRfZm9ybS5yZWYsIGZvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleCwgZmFsc2UpKS50aGVuKGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAvL2FwcGVuZCBpbnB1dHMgYW5kIHRoZWlyIHByb3BlcnRpZXMgcGFuZWxzXG4gICAgICAgIGNoaWxkX2lucHV0cyA9IHNlbGYucmVuZGVySW5wdXRzKGNoaWxkX2Zvcm0uaW5wdXRzKTtcbiAgICAgICAgLy9yZXBsYWNlIG9iamVjdCBsaXRlcmFsIGlucHV0cyB3aXRoIG5ld2x5IGdlbmVyYXRlZCBvbmVzIHZpYSBmYWN0b3J5IChpLmUuIHVzaW5nIG5ldykgc28gdGhleSBnZXQgdGhlIHByb3RvdHlwZVxuICAgICAgICBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0LmZvcm1zW2Zvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleF0uaW5wdXRzID0gY2hpbGRfaW5wdXRzLnNsaWNlKCk7XG5cbiAgICAgICAgLy9yZW1vdmUgbm8gcXVlc3Rpb25zIG1lc3NhZ2VcbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19uby1xdWVzdGlvbnMtbWVzc2FnZScpLmFkZENsYXNzKCdoaWRkZW4nKTtcblxuICAgICAgICAvL2hpZGUgcHJvcGVydGllcyBwYW5lbCBidXR0b25zIGFzIG5vIGlucHV0IGlzIHNlbGVjdGVkXG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2J1dHRvbnMuZmFkZU91dCgpO1xuXG4gICAgICAgIC8vcmVuZGVyIG5leHQgY2hpbGQgZm9ybSByZWN1cnNpdmVseVxuICAgICAgICBpZiAoY2hpbGRfZm9ybXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgc2VsZi5yZW5kZXJDaGlsZEZvcm1zKGNoaWxkX2Zvcm1zKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHNlbGYuaW5pdEZvcm1idWlsZGVyKCk7XG4gICAgICAgIH1cbiAgICB9KTtcblxufTtcblxubW9kdWxlLmV4cG9ydHMgPSByZW5kZXJDaGlsZEZvcm1zO1xuIiwiJ3VzZSBzdHJpY3QnO1xudmFyIGNvbnN0cyA9IHJlcXVpcmUoJ2NvbmZpZy9jb25zdHMnKTtcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJ2NvbmZpZy9mb3JtYnVpbGRlcicpO1xudmFyIHRlbXBsYXRlID0gcmVxdWlyZSgndGVtcGxhdGUnKTtcblxudmFyIHJlbmRlcklucHV0cyA9IGZ1bmN0aW9uICh0aGVfaW5wdXRzKSB7XG5cbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgdmFyIGlucHV0cyA9IHRoZV9pbnB1dHM7XG4gICAgdmFyIGh0bWw7XG4gICAgdmFyIHByb3BlcnRpZXM7XG4gICAgdmFyIHByb3BlcnRpZXNfcGFuZWxfaHRtbDtcbiAgICB2YXIgZ2VuZXJhdGVkX2lucHV0cyA9IFtdO1xuICAgIHZhciBpbnB1dF9jb2xsZWN0aW9uX2h0bWwgPSAnJztcbiAgICB2YXIgaW5wdXRfcHJvcGVydGllc19wYW5lbF9odG1sID0gJyc7XG5cblxuICAgICQuZWFjaChpbnB1dHMsIGZ1bmN0aW9uIChpbmRleCwgaW5wdXQpIHtcblxuICAgICAgICB2YXIgaW5wdXRfZmFjdG9yeSA9IHJlcXVpcmUoJ2ZhY3RvcnkvaW5wdXQtZmFjdG9yeScpO1xuXG4gICAgICAgIC8vLyoqXG4gICAgICAgIC8vICogTG9vcCBhbGwganVtcHMgdG8gcmVtb3ZlIGFueSBcImhhc192YWxpZF9kZXN0aW5hdGlvblwiIHByb3BlcnR5XG4gICAgICAgIC8vICogdGhpcyB3YXMgY2F1c2VkIGJ5IGEgYnVnIHNvIGEgZmV3IHByb2plY3RzIGhhdmUgaXQuXG4gICAgICAgIC8vICogSW5zdGVhZCBvZiBoYWNraW5nIHRoZSBkYiwgd2Ugc2FuaXRpc2UgdGhhdCBoZXJlXG4gICAgICAgIC8vICogc28gdGhlIG5leHQgdGltZSB0aGV5IHNhdmUgdGhlIHByb2plY3QgaXMgb2tcbiAgICAgICAgLy8gKi9cbiAgICAgICAgLy8kKGlucHV0Lmp1bXBzKS5lYWNoKGZ1bmN0aW9uKGp1bXBJbmRleCwganVtcCl7XG4gICAgICAgIC8vICAgIGRlbGV0ZSBqdW1wLmhhc192YWxpZF9kZXN0aW5hdGlvbjtcbiAgICAgICAgLy99KTtcblxuICAgICAgICAvL2NyZWF0ZSBodG1sIGVsZW1lbnQgZm9yIGlucHV0IGNvbGxlY3Rpb24gKG1pZGRsZSBjb2x1bW4pXG4gICAgICAgIGh0bWwgPSBpbnB1dF9mYWN0b3J5LmNyZWF0ZUlucHV0VG9vbEhUTUwoaW5wdXQpO1xuICAgICAgICBpbnB1dF9jb2xsZWN0aW9uX2h0bWwgKz0gaHRtbDtcblxuICAgICAgICAvL2NvcHkgaW5wdXQgcHJvcGVydGllcyBmcm9tIHN0b3JlZCBpbnB1dFxuICAgICAgICBwcm9wZXJ0aWVzID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShpbnB1dCkpO1xuXG4gICAgICAgIC8vZ2VuZXJhdGUgbmV3IGlucHV0IHdpdGggYXR0YWNoZWQgcHJvdG90eXBlXG4gICAgICAgIGlucHV0ID0gaW5wdXRfZmFjdG9yeS5jcmVhdGVJbnB1dChwcm9wZXJ0aWVzLnR5cGUsIHByb3BlcnRpZXMucmVmKTtcblxuICAgICAgICAvL29uIGxvYWQgKHdoZW4gbG9hZGluZyBhbiBleGlzdGluZyBwcm9qZWN0KVxuICAgICAgICBpZiAoZm9ybWJ1aWxkZXIucmVuZGVyX2FjdGlvbiA9PT0gY29uc3RzLlJFTkRFUl9BQ1RJT05fRE8pIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyZW5kZXIgb24gbG9hZCcpO1xuICAgICAgICAgICAgLy9zZXQgaW5wdXQgYXMgdmFsaWQsIGFzIGl0IGlzIGdlbmVyYXRlZCBhcyBpbnZhbGlkIGJ5IGRlZmF1bHRcbiAgICAgICAgICAgIGlucHV0LmRvbS5pc192YWxpZCA9IHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICAvL3NldCBpbnB1dCBwcm9wZXJ0aWVzIHRvIHN0b3JlZCBpbnB1dCBwcm9wZXJ0aWVzIChvbmx5IHRoZSBvbmUgc2F2ZWQgaW4gdGhlIHByb2plY3QgZGVmaW5pdGlvbiwgbGVhdmUgdGhlIG90aGVycyBpbnRhY3QpXG4gICAgICAgIGZvciAodmFyIHByb3BlcnR5IGluIGlucHV0KSB7XG4gICAgICAgICAgICBpZiAocHJvcGVydGllcy5oYXNPd25Qcm9wZXJ0eShwcm9wZXJ0eSkpIHtcbiAgICAgICAgICAgICAgICBpbnB1dFtwcm9wZXJ0eV0gPSBwcm9wZXJ0aWVzW3Byb3BlcnR5XTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vb3ZlcnJpZGUgJ2dsb2JhbCcgaW5wdXQgb2JqIGxpdGVyYWwgd2l0aCBuZXdseSBjcmVhdGVkXG4gICAgICAgIGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbi5kYXRhLnByb2plY3QuZm9ybXNbZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4XS5pbnB1dHNbaW5kZXhdID0gaW5wdXQ7XG5cbiAgICAgICAgLy9pZiBpdCBpcyBhIGJyYW5jaCwgbG9vcCBhbGwgdGhlIGJyYW5jaCBpbnB1dHMgKHRoZXJlIG11c3QgYmUgYXQgbGVhc3QgYSBicmFuY2ggaW5wdXQpXG4gICAgICAgIGlmIChpbnB1dC50eXBlID09PSBjb25zdHMuQlJBTkNIX1RZUEUpIHtcblxuICAgICAgICAgICAgLy9zZXQgZWRpdCBicmFuY2ggdG8gdHJ1ZSB3aGVuIHJlbmRlcmluZyBmcm9tIGEgc2F2ZWQgcHJvamVjdCxcbiAgICAgICAgICAgIC8vYmVjYXVzZSB3ZSBhcmUgcmUtdXNpbmcgZnVuY3Rpb25zIHRoYXQgZXhwZWN0cyB0aGlzIGZsYWcgdG8gYmUgdHJ1ZVxuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19icmFuY2ggPSB0cnVlO1xuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuYnJhbmNoLmFjdGl2ZV9icmFuY2hfaGVhZGVyID0gaW5wdXQucXVlc3Rpb247XG4gICAgICAgICAgICBmb3JtYnVpbGRlci5icmFuY2guYWN0aXZlX2JyYW5jaF9yZWYgPSBpbnB1dC5yZWY7XG5cbiAgICAgICAgICAgIHZhciBicmFuY2hfaW5wdXRzX2h0bWwgPSBzZWxmLmdldEJyYW5jaElucHV0c0hUTUwoaW5wdXQsIGluZGV4KTtcbiAgICAgICAgICAgIGlucHV0X2NvbGxlY3Rpb25faHRtbCA9IGlucHV0X2NvbGxlY3Rpb25faHRtbC5yZXBsYWNlKCd7e2JyYW5jaC1jb250ZW50fX0nLCBicmFuY2hfaW5wdXRzX2h0bWwuY29sbGVjdGlvbik7XG4gICAgICAgICAgICBpbnB1dF9wcm9wZXJ0aWVzX3BhbmVsX2h0bWwgKz0gYnJhbmNoX2lucHV0c19odG1sLnBhbmVscztcblxuICAgICAgICAgICAgLy9yZXNldCBlZGl0IGJyYW5jaCBmbGFnXG4gICAgICAgICAgICBmb3JtYnVpbGRlci5pc19lZGl0aW5nX2JyYW5jaCA9IGZhbHNlO1xuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuYnJhbmNoLmFjdGl2ZV9icmFuY2hfcmVmID0gbnVsbDtcbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmJyYW5jaC5hY3RpdmVfYnJhbmNoX3JlZiA9IG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICAvL2lmIGl0IGlzIGEgZ3JvdXAsIGxvb3AgYWxsIHRoZSBncm91cCBpbnB1dHMgKHRoZXJlIG11c3QgYmUgYXQgbGVhc3QgYSBncm91cCBpbnB1dClcbiAgICAgICAgaWYgKGlucHV0LnR5cGUgPT09IGNvbnN0cy5HUk9VUF9UWVBFKSB7XG5cbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfZ3JvdXAgPSB0cnVlO1xuICAgICAgICAgICAgLy90b2RvIHNob3VsZCBJIHNldCBhY3RpdmUgZ3JvdXAgaGVhZGVyIGFuZCBhY3RpdmUgZ3JvdXAgcmVmP1xuICAgICAgICAgICAgLy90b2RvIG1heWJlIGJlY2F1c2UgSSBkbyBuaXQgaGF2ZSBqdW1wcyBpbiBncm91cHM/XG5cbiAgICAgICAgICAgIHZhciBncm91cF9pbnB1dHNfaHRtbCA9IHNlbGYuZ2V0R3JvdXBJbnB1dHNIVE1MKGlucHV0LCBpbmRleCwgbnVsbCk7XG4gICAgICAgICAgICBpbnB1dF9jb2xsZWN0aW9uX2h0bWwgPSBpbnB1dF9jb2xsZWN0aW9uX2h0bWwucmVwbGFjZSgne3tncm91cC1jb250ZW50fX0nLCBncm91cF9pbnB1dHNfaHRtbC5jb2xsZWN0aW9uKTtcbiAgICAgICAgICAgIGlucHV0X3Byb3BlcnRpZXNfcGFuZWxfaHRtbCArPSBncm91cF9pbnB1dHNfaHRtbC5wYW5lbHM7XG5cbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfZ3JvdXAgPSBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vcGVyIGVhY2ggaW5wdXQgd2l0aCBwb3NzaWJsZSBhbnN3ZXJzIGtlZXAgdHJhY2sgb2YgcGFnaW5hdGlvblxuICAgICAgICBpZiAoY29uc3RzLk1VTFRJUExFX0FOU1dFUl9UWVBFUy5pbmRleE9mKGlucHV0LnR5cGUpID4gLTEpIHtcbiAgICAgICAgICAgIC8vd2UgaGF2ZSBwb3NzaWJsZSBhbnN3ZXJzXG4gICAgICAgICAgICBmb3JtYnVpbGRlci5wb3NzaWJsZV9hbnN3ZXJzX3BhZ2luYXRpb25baW5wdXQucmVmXSA9IHt9O1xuICAgICAgICAgICAgZm9ybWJ1aWxkZXIucG9zc2libGVfYW5zd2Vyc19wYWdpbmF0aW9uW2lucHV0LnJlZl0ucGFnZSA9IDE7XG4gICAgICAgIH1cbiAgICAgICAgLy9jcmVhdGUgcHJvcGVydGllcyBwYW5lbCBmb3IgY3VycmVudCBpbnB1dFxuICAgICAgICBwcm9wZXJ0aWVzX3BhbmVsX2h0bWwgPSB0ZW1wbGF0ZS5nZXRJbnB1dFByb3BlcnRpZXNQYW5lbEhUTUwoaW5wdXQpO1xuICAgICAgICBpbnB1dF9wcm9wZXJ0aWVzX3BhbmVsX2h0bWwgKz0gcHJvcGVydGllc19wYW5lbF9odG1sO1xuXG4gICAgICAgIC8vaGlkZSBwYW5lbHMgYXMgYnkgZGVmYXVsdCBubyBpbnB1dHMgYXJlIHNlbGVjdGVkXG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzLmZpbmQoJy5wYW5lbC1ib2R5IGZvcm0nKS5oaWRlKCk7XG5cbiAgICAgICAgLy9zYXZlIG5ld2x5IGdlbmVyYXRlZCBpbnB1dFxuICAgICAgICBnZW5lcmF0ZWRfaW5wdXRzLnB1c2goaW5wdXQpO1xuICAgIH0pO1xuXG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uX3NvcnRhYmxlLmFwcGVuZChpbnB1dF9jb2xsZWN0aW9uX2h0bWwpO1xuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXIuYXBwZW5kKGlucHV0X3Byb3BlcnRpZXNfcGFuZWxfaHRtbCk7XG5cbiAgICByZXR1cm4gZ2VuZXJhdGVkX2lucHV0cztcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gcmVuZGVySW5wdXRzO1xuIiwiJ3VzZSBzdHJpY3QnO1xudmFyIGNvbnN0cyA9IHJlcXVpcmUoJ2NvbmZpZy9jb25zdHMnKTtcbnZhciB1aSA9IHJlcXVpcmUoJ2hlbHBlcnMvdWknKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoJ2hlbHBlcnMvdXRpbHMnKTtcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJ2NvbmZpZy9mb3JtYnVpbGRlcicpO1xudmFyIGlucHV0X2ZhY3RvcnkgPSByZXF1aXJlKCdmYWN0b3J5L2lucHV0LWZhY3RvcnknKTtcbnZhciBmb3JtX2ZhY3RvcnkgPSByZXF1aXJlKCdmYWN0b3J5L2Zvcm0tZmFjdG9yeScpO1xudmFyIElucHV0ID0gcmVxdWlyZSgnZmFjdG9yeS9pbnB1dC1wcm90b3R5cGUnKTtcbnZhciB0ZW1wbGF0ZSA9IHJlcXVpcmUoJ3RlbXBsYXRlJyk7XG52YXIgdmFsaWRhdGlvbiA9IHJlcXVpcmUoJ2FjdGlvbnMvdmFsaWRhdGlvbicpO1xuXG52YXIgcmVuZGVyUHJvamVjdCA9IGZ1bmN0aW9uIChwcm9qZWN0X2RlZmluaXRpb24pIHtcblxuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB2YXIgZm9ybXMgPSBwcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0LmZvcm1zLnNsaWNlKCk7Ly9uZWVkIGEgZGVlcCBjb3B5XG4gICAgdmFyIGlucHV0cztcblxuICAgIHNlbGYuZGVmZXJyZWQgPSBuZXcgJC5EZWZlcnJlZCgpO1xuXG4gICAgLy9pZiB1bmRvaW5nLCByZXNldCBmb3JtYnVpbGRlciBvbiB0b3AgcGFyZW50IGZvcm1cbiAgICBpZiAoZm9ybWJ1aWxkZXIucmVuZGVyX2FjdGlvbiA9PT0gY29uc3RzLlJFTkRFUl9BQ1RJT05fVU5ETykge1xuICAgICAgICBjb25zb2xlLmxvZygncmVzZXR0aW5nIHJlZmVyZW5jZXMgdG8gdG9wIHBhcmVudCBmb3JtJyk7XG4gICAgICAgIGZvcm1fZmFjdG9yeS51cGRhdGVGb3JtYnVpbGRlckRvbVJlZmVyZW5jZXMoZm9ybXNbMF0ucmVmKTtcbiAgICB9XG5cbiAgICAvL3JlbmRlciB0b3AgcGFyZW50IGZvcm0gYnkgZGVmYXVsdCBhcyB0aGUgZm9ybWJ1aWxkZXIgbG9hZHMuXG4gICAgZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4ID0gMDtcbiAgICBpbnB1dHMgPSBzZWxmLnJlbmRlcklucHV0cyhmb3Jtc1swXS5pbnB1dHMpO1xuXG4gICAgLy9yZW1vdmUgbm8gcXVlc3Rpb25zIG1lc3NhZ2UgKGlmIGFueSBpbnB1dHMpXG4gICAgaWYgKGlucHV0cy5sZW5ndGggPiAwKSB7XG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbi5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fbm8tcXVlc3Rpb25zLW1lc3NhZ2UnKS5hZGRDbGFzcygnaGlkZGVuJyk7XG4gICAgfVxuXG4gICAgLy9zaG93IG5vIHRpdGxlIHdhcm5pbmcgKGlmIG5vIHRpdGxlIHNldCBmb3IgdGhlIGZpcnN0IGZvcm0gYW5kIHdlIGhhdmUgaW5wdXRzKVxuICAgIGlmICh1dGlscy5nZXRUaXRsZUNvdW50KGlucHV0cykgPT09IDAgJiYgaW5wdXRzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgdWkuaW5wdXRzX2NvbGxlY3Rpb24udG9nZ2xlVGl0bGVXYXJuaW5nKDAsIGZhbHNlKTtcbiAgICB9XG5cbiAgICAvL3RvZ2dsZSBmb3JtIGljb24gdG8gYSBncmVlbiBjaGNrIGlmIHRoZSB0b3AgcGFyZW50IGZvcm0gaXMgdmFsaWRcbiAgICBpZiAodmFsaWRhdGlvbi5hcmVGb3JtSW5wdXRzVmFsaWQoMCkpIHtcbiAgICAgICAgdWkuZm9ybXNfdGFicy5zaG93Rm9ybVZhbGlkSWNvbigwKTtcblxuICAgICAgICAvL2VuYWJsZSBkb3dubG9hZCBmb3JtIGJ1dHRvblxuICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25cbiAgICAgICAgICAgIC5maW5kKCcuaW5wdXRzLWNvbGxlY3Rpb25fX2V4cG9ydC1mb3JtJykucmVtb3ZlQ2xhc3MoJ2Rpc2FibGVkJyk7XG5cbiAgICAgICAgLy9lbmFibGUgcHJpbnQgYXMgcGRmIGZvcm0gYnV0dG9uXG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvblxuICAgICAgICAgICAgLmZpbmQoJy5pbnB1dHMtY29sbGVjdGlvbl9fcHJpbnQtYXMtcGRmJykucmVtb3ZlQ2xhc3MoJ2Rpc2FibGVkJyk7XG4gICAgfVxuXG4gICAgLy9pZiBubyBpbnB1dHMsIGRpc2FibGUgZG93bmxvYWQgZm9ybSBidXR0b25cbiAgICBpZiAoaW5wdXRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25cbiAgICAgICAgICAgIC5maW5kKCcuaW5wdXRzLWNvbGxlY3Rpb25fX2V4cG9ydC1mb3JtJykuYWRkQ2xhc3MoJ2Rpc2FibGVkJyk7XG5cbiAgICAgICAgLy9kaXNhYmxlIHByaW50IGFzIHBkZlxuICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25cbiAgICAgICAgICAgIC5maW5kKCcuaW5wdXRzLWNvbGxlY3Rpb25fX3ByaW50LWFzLXBkZicpLmFkZENsYXNzKCdkaXNhYmxlZCcpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uXG4gICAgICAgICAgICAuZmluZCgnLmlucHV0cy1jb2xsZWN0aW9uX19leHBvcnQtZm9ybScpLnJlbW92ZUNsYXNzKCdkaXNhYmxlZCcpO1xuXG4gICAgICAgIC8vZW5hYmxlIHByaW50IGFzIHBkZiBmb3JtIGJ1dHRvblxuICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25cbiAgICAgICAgICAgIC5maW5kKCcuaW5wdXRzLWNvbGxlY3Rpb25fX3ByaW50LWFzLXBkZicpLnJlbW92ZUNsYXNzKCdkaXNhYmxlZCcpO1xuICAgIH1cblxuICAgIC8vcmVwbGFjZSBvYmplY3QgbGl0ZXJhbCBpbnB1dHMgd2l0aCBuZXdseSBnZW5lcmF0ZWQgb25lcyB2aWEgZmFjdG9yeSAoaS5lLiB1c2luZyBuZXcpIHNvIHRoZXkgZ2V0IHRoZSBwcm90b3R5cGVcbiAgICBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0LmZvcm1zWzBdLmlucHV0cyA9IGlucHV0cy5zbGljZSgpO1xuXG4gICAgLy9yZW1vdmUgZmlyc3QgZm9ybSBhcyBpdCBpcyBhbHJlYWR5IHJlbmRlcmVkXG4gICAgZm9ybXMuc2hpZnQoKTtcblxuICAgIC8vcmVuZGVyIGNoaWxkIGZvcm1zIHJlY3Vyc2l2ZWx5IChpZiBhbnkpXG4gICAgaWYgKGZvcm1zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgc2VsZi5yZW5kZXJDaGlsZEZvcm1zKGZvcm1zKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHNlbGYuaW5pdEZvcm1idWlsZGVyKCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHNlbGYuZGVmZXJyZWQucHJvbWlzZSgpO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSByZW5kZXJQcm9qZWN0O1xuIiwiLyogZ2xvYmFsICQsIHRvYXN0ciwgUGFwYSovXG4ndXNlIHN0cmljdCc7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcbnZhciB0b2FzdCA9IHJlcXVpcmUoJ2NvbmZpZy90b2FzdCcpO1xudmFyIGNvbnN0cyA9IHJlcXVpcmUoJ2NvbmZpZy9jb25zdHMnKTtcbnZhciBtZXNzYWdlcyA9IHJlcXVpcmUoJ2NvbmZpZy9tZXNzYWdlcycpO1xudmFyIGdldFBvc3NpYmxlQW5zd2VyUGFnZSA9IHJlcXVpcmUoJ3RlbXBsYXRlL21ldGhvZHMvZ2V0UG9zc2libGVBbnN3ZXJzUGFnZScpO1xuXG52YXIgcG9zc2libGVfYW5zd2Vyc19wYWdlciA9IHtcblxuICAgIGluaXQ6IGZ1bmN0aW9uIChpbnB1dCkge1xuXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdmFyIHBhZ2VyID0gZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNcbiAgICAgICAgICAgIC5maW5kKCcucGFuZWwtYm9keSBmb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIGlucHV0LnJlZiArICdcIl0nKVxuICAgICAgICAgICAgLmZpbmQoJy5wb3NzaWJsZS1hbnN3ZXJzX19saXN0X3BhZ2VyJyk7XG4gICAgICAgIHZhciBwYWdlID0gZm9ybWJ1aWxkZXIucG9zc2libGVfYW5zd2Vyc19wYWdpbmF0aW9uW2lucHV0LnJlZl0ucGFnZTtcbiAgICAgICAgdmFyIHRvdGFsID0gTWF0aC5jZWlsKGlucHV0LnBvc3NpYmxlX2Fuc3dlcnMubGVuZ3RoIC8gY29uc3RzLkxJTUlUUy5wb3NzaWJsZV9hbnN3ZXJzX3Blcl9wYWdlKTtcblxuICAgICAgICBwYWdlci5yZW1vdmVDbGFzcygnaGlkZGVuJyk7XG4gICAgICAgIHBhZ2VyLmZpbmQoJy5wb3NzaWJsZS1hbnN3ZXJzX19saXN0X3BhZ2VyX19jdXJyZW50JylcbiAgICAgICAgICAgIC5odG1sKHBhZ2UpO1xuICAgICAgICBwYWdlci5maW5kKCcucG9zc2libGUtYW5zd2Vyc19fbGlzdF9wYWdlcl9fdG90YWwnKVxuICAgICAgICAgICAgLmh0bWwodG90YWwpO1xuXG4gICAgICAgIC8vYXR0YWNoIGhhbmRsZXJzIHRvIHBhZ2luYXRpb24gYnV0dG9uc1xuICAgICAgICB2YXIgcHJldl9idG4gPSBwYWdlci5maW5kKCcucG9zc2libGUtYW5zd2Vyc19fbGlzdF9wYWdlcl9fcHJldicpO1xuICAgICAgICB2YXIgbmV4dF9idG4gPSBwYWdlci5maW5kKCcucG9zc2libGUtYW5zd2Vyc19fbGlzdF9wYWdlcl9fbmV4dCcpO1xuXG4gICAgICAgIC8vd2hlbiB0aGUgcGFnZXIgaXMgc2hvd24sIHNldCBtaW4taGVpZ2h0IG9uIHBhcmVudCBjb250YWluZXJcbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNcbiAgICAgICAgICAgIC5maW5kKCcucGFuZWwtYm9keSBmb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIGlucHV0LnJlZiArICdcIl0nKVxuICAgICAgICAgICAgLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19wb3NzaWJsZS1hbnN3ZXJzX19saXN0JylcbiAgICAgICAgICAgIC5wYXJlbnQoKS5jc3MoJ21pbi1oZWlnaHQnLCAnMzI1cHgnKTtcblxuICAgICAgICB2YXIgd2FzX2NsaWNrZWQgPSBmYWxzZTtcbiAgICAgICAgbmV4dF9idG4ub2ZmKCkub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnbmV4dCBidXR0b24gY2xpY2tlZCcpO1xuICAgICAgICAgICAgdmFyIG5leHRfcGFnZTtcblxuICAgICAgICAgICAgLy92YWxpZGF0ZSBhbnN3ZXJzIGN1cnJlbnRseSBpbiB0aGUgZG9tXG4gICAgICAgICAgICAvL2lmIGFueSBlcnJvciwgd2FybiB1c2VyIGluc3RlYWQgb2YgY2hhbmdpbmcgcGFnZVxuICAgICAgICAgICAgLy9zbyB0aGUgdXNlciBoYXMgdGhlIGNoYW5jZSB0byBmaXggdGhlbVxuICAgICAgICAgICAgaWYgKCFzZWxmLmFyZVZhbGlkUG9zc2libGVBbnN3ZXJzSW5ET00oaW5wdXQpKSB7XG4gICAgICAgICAgICAgICAgLy9zaG93IGVycm9yXG4gICAgICAgICAgICAgICAgdG9hc3Quc2hvd0Vycm9yKG1lc3NhZ2VzLmVycm9yLlBPU1NJQkxFX0FOU1dFUlNfSU5WQUxJRCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoIXdhc19jbGlja2VkKSB7XG4gICAgICAgICAgICAgICAgd2FzX2NsaWNrZWQgPSB0cnVlO1xuXG4gICAgICAgICAgICAgICAgLy9zYXZlIHBvc3NpYmxlIGFuc3dlcnMgY3VycmVudGx5IG9uIHRoZSBkb21cbiAgICAgICAgICAgICAgICBpbnB1dC5zYXZlUG9zc2libGVBbnN3ZXJzKCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoZm9ybWJ1aWxkZXIucG9zc2libGVfYW5zd2Vyc19wYWdpbmF0aW9uW2lucHV0LnJlZl0ucGFnZSA8IHRvdGFsKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vc2hvdyBuZXh0IHBvc3NpYmxlIGFuc3dlcnMgcGFnZSBpbiBkb21cbiAgICAgICAgICAgICAgICAgICAgbmV4dF9wYWdlID0gZm9ybWJ1aWxkZXIucG9zc2libGVfYW5zd2Vyc19wYWdpbmF0aW9uW2lucHV0LnJlZl0ucGFnZSArIDE7XG4gICAgICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLnBvc3NpYmxlX2Fuc3dlcnNfcGFnaW5hdGlvbltpbnB1dC5yZWZdLnBhZ2UgPSBuZXh0X3BhZ2U7XG5cbiAgICAgICAgICAgICAgICAgICAgZ2V0UG9zc2libGVBbnN3ZXJQYWdlKGlucHV0LCBuZXh0X3BhZ2UpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vdXBkYXRlIGRvbSB3aXRoIGN1cnJlbnQgcGFnZVxuICAgICAgICAgICAgICAgICAgICBwYWdlci5maW5kKCcucG9zc2libGUtYW5zd2Vyc19fbGlzdF9wYWdlcl9fY3VycmVudCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAuaHRtbChuZXh0X3BhZ2UpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vcmVzdG9yZSBidXR0b24gZnVuY3Rpb25hbGl0eVxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3YXNfY2xpY2tlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9LCBjb25zdHMuQU5JTUFUSU9OX1NMT1cpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB3YXNfY2xpY2tlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgcHJldl9idG4ub2ZmKCkub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ3ByZXYgYnV0dG9uIGNsaWNrZWQnKTtcbiAgICAgICAgICAgIC8vc2hvdyBuZXh0IHBvc3NpYmxlIGFuc3dlcnMgcGFnZSBpbiBkb21cbiAgICAgICAgICAgIHZhciBwcmV2X3BhZ2U7XG5cbiAgICAgICAgICAgIGlmICghc2VsZi5hcmVWYWxpZFBvc3NpYmxlQW5zd2Vyc0luRE9NKGlucHV0KSkge1xuICAgICAgICAgICAgICAgIC8vc2hvdyBlcnJvclxuICAgICAgICAgICAgICAgIHRvYXN0LnNob3dFcnJvcihtZXNzYWdlcy5lcnJvci5QT1NTSUJMRV9BTlNXRVJTX0lOVkFMSUQpO1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCF3YXNfY2xpY2tlZCkge1xuICAgICAgICAgICAgICAgIHdhc19jbGlja2VkID0gdHJ1ZTtcblxuICAgICAgICAgICAgICAgIC8vc2F2ZSBwb3NzaWJsZSBhbnN3ZXJzIGN1cnJlbnRseSBvbiB0aGUgZG9tXG4gICAgICAgICAgICAgICAgaW5wdXQuc2F2ZVBvc3NpYmxlQW5zd2VycygpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGZvcm1idWlsZGVyLnBvc3NpYmxlX2Fuc3dlcnNfcGFnaW5hdGlvbltpbnB1dC5yZWZdLnBhZ2UgPiAxKSB7XG4gICAgICAgICAgICAgICAgICAgIHByZXZfcGFnZSA9IGZvcm1idWlsZGVyLnBvc3NpYmxlX2Fuc3dlcnNfcGFnaW5hdGlvbltpbnB1dC5yZWZdLnBhZ2UgLSAxO1xuICAgICAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5wb3NzaWJsZV9hbnN3ZXJzX3BhZ2luYXRpb25baW5wdXQucmVmXS5wYWdlID0gcHJldl9wYWdlO1xuXG4gICAgICAgICAgICAgICAgICAgIGdldFBvc3NpYmxlQW5zd2VyUGFnZShpbnB1dCwgcHJldl9wYWdlKTtcblxuICAgICAgICAgICAgICAgICAgICAvL3VwZGF0ZSBkb20gd2l0aCBjdXJyZW50IHBhZ2VcbiAgICAgICAgICAgICAgICAgICAgcGFnZXIuZmluZCgnLnBvc3NpYmxlLWFuc3dlcnNfX2xpc3RfcGFnZXJfX2N1cnJlbnQnKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmh0bWwocHJldl9wYWdlKTtcblxuICAgICAgICAgICAgICAgICAgICAvL3Jlc3RvcmUgYnV0dG9uIGZ1bmN0aW9uYWxpdHlcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgd2FzX2NsaWNrZWQgPSBmYWxzZVxuICAgICAgICAgICAgICAgICAgICB9LCBjb25zdHMuQU5JTUFUSU9OX1NMT1cpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHdhc19jbGlja2VkID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICAvL2hpZGUgcGFnZXIgYW5kIHJlc3RvcmUgcG9zc2libGUgYW5zd2VycyBjb250YWluZXIgaGVpZ2h0XG4gICAgdGVhckRvd246IGZ1bmN0aW9uIChpbnB1dCkge1xuXG4gICAgICAgIHZhciBwYWdlciA9IGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzXG4gICAgICAgICAgICAuZmluZCgnLnBhbmVsLWJvZHkgZm9ybVtkYXRhLWlucHV0LXJlZj1cIicgKyBpbnB1dC5yZWYgKyAnXCJdJylcbiAgICAgICAgICAgIC5maW5kKCcucG9zc2libGUtYW5zd2Vyc19fbGlzdF9wYWdlcicpO1xuXG4gICAgICAgIC8vcmVzdG9yZSBoZWlnaHRcbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNcbiAgICAgICAgICAgIC5maW5kKCcucGFuZWwtYm9keSBmb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIGlucHV0LnJlZiArICdcIl0nKVxuICAgICAgICAgICAgLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19wb3NzaWJsZS1hbnN3ZXJzX19saXN0JylcbiAgICAgICAgICAgIC5wYXJlbnQoKS5jc3MoJ21pbi1oZWlnaHQnLCAnYXV0bycpO1xuXG4gICAgICAgIHBhZ2VyLmFkZENsYXNzKCdoaWRkZW4nKTtcblxuICAgICAgICBmb3JtYnVpbGRlci5wb3NzaWJsZV9hbnN3ZXJzX3BhZ2luYXRpb25baW5wdXQucmVmXS5wYWdlID0gMTtcbiAgICB9LFxuXG4gICAgYXJlVmFsaWRQb3NzaWJsZUFuc3dlcnNJbkRPTTogZnVuY3Rpb24gKGlucHV0KSB7XG4gICAgICAgIHZhciBhcmVfcG9zc2libGVfYW5zd2Vyc192YWxpZCA9IHRydWU7XG4gICAgICAgIHZhciBwcm9wZXJ0aWVzX3BhbmVsID0gZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlci5maW5kKCdmb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIGlucHV0LnJlZiArICdcIl0nKTtcbiAgICAgICAgdmFyIHBvc3NpYmxlX2Fuc3dlcnMgPSBwcm9wZXJ0aWVzX3BhbmVsLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19wb3NzaWJsZS1hbnN3ZXJzIGRpdiB1bC5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19wb3NzaWJsZS1hbnN3ZXJzX19saXN0IGxpJyk7XG5cbiAgICAgICAgcG9zc2libGVfYW5zd2Vycy5lYWNoKGZ1bmN0aW9uIChpbmRleCwgcG9zc2libGVfYW5zd2VyKSB7XG5cbiAgICAgICAgICAgIHZhciBjdXJyZW50X2lucHV0ID0gJChwb3NzaWJsZV9hbnN3ZXIpLmZpbmQoJ2RpdiBpbnB1dCcpO1xuICAgICAgICAgICAgdmFyIGFuc3dlciA9IGN1cnJlbnRfaW5wdXQudmFsKCk7XG5cbiAgICAgICAgICAgIC8vc3RyaXAgaHRtbCB0YWdzIChhbmdsZSBicmFja2V0cylcbiAgICAgICAgICAgIGFuc3dlciA9IGFuc3dlci5yZXBsYWNlKC9bPD5dL2lnLCAnJyk7XG5cbiAgICAgICAgICAgIGlmIChhbnN3ZXIgPT09ICcnKSB7XG4gICAgICAgICAgICAgICAgYXJlX3Bvc3NpYmxlX2Fuc3dlcnNfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIGFyZV9wb3NzaWJsZV9hbnN3ZXJzX3ZhbGlkO1xuICAgIH0sXG5cbiAgICByZWNhbGN1bGF0ZVBhZ2luYXRpb246IGZ1bmN0aW9uIChpbnB1dCkge1xuXG4gICAgICAgIC8vZ2V0IGN1cnJlbnQgcGFnZSBhbmQgdG90YWwgb2YgcG9zc2liZSBhbnN3ZXJzXG4gICAgICAgIHZhciBwYWdlID0gZm9ybWJ1aWxkZXIucG9zc2libGVfYW5zd2Vyc19wYWdpbmF0aW9uW2lucHV0LnJlZl0ucGFnZTtcbiAgICAgICAgdmFyIHRvdGFsID0gTWF0aC5jZWlsKGlucHV0LnBvc3NpYmxlX2Fuc3dlcnMubGVuZ3RoIC8gY29uc3RzLkxJTUlUUy5wb3NzaWJsZV9hbnN3ZXJzX3Blcl9wYWdlKTtcblxuICAgICAgICB2YXIgcGFnZXIgPSBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc1xuICAgICAgICAgICAgLmZpbmQoJy5wYW5lbC1ib2R5IGZvcm1bZGF0YS1pbnB1dC1yZWY9XCInICsgaW5wdXQucmVmICsgJ1wiXScpXG4gICAgICAgICAgICAuZmluZCgnLnBvc3NpYmxlLWFuc3dlcnNfX2xpc3RfcGFnZXInKTtcblxuICAgICAgICBwYWdlci5maW5kKCcucG9zc2libGUtYW5zd2Vyc19fbGlzdF9wYWdlcl9fY3VycmVudCcpXG4gICAgICAgICAgICAuaHRtbChwYWdlKTtcbiAgICAgICAgcGFnZXIuZmluZCgnLnBvc3NpYmxlLWFuc3dlcnNfX2xpc3RfcGFnZXJfX3RvdGFsJylcbiAgICAgICAgICAgIC5odG1sKHRvdGFsKTtcblxuICAgICAgICAvL2hpZGUgcGFnZXIgaWYgbm90IG5lZWRlZFxuICAgICAgICBpZiAoaW5wdXQucG9zc2libGVfYW5zd2Vycy5sZW5ndGggPD0gY29uc3RzLkxJTUlUUy5wb3NzaWJsZV9hbnN3ZXJzX3Blcl9wYWdlKSB7XG4gICAgICAgICAgICBwYWdlci5hZGRDbGFzcygnaGlkZGVuJyk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgcmVjYWxjdWxhdGVQb3NzaWJsZUFuc3dlcnNET006IGZ1bmN0aW9uIChpbnB1dCkge1xuXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdmFyIHBvc3NpYmxlX2Fuc3dlcnNfbGlzdCA9IGlucHV0LmRvbS5wcm9wZXJ0aWVzX3BhbmVsXG4gICAgICAgICAgICAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX3Bvc3NpYmxlLWFuc3dlcnMgZGl2IHVsLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX3Bvc3NpYmxlLWFuc3dlcnNfX2xpc3QnKTtcbiAgICAgICAgdmFyIHBvc3NpYmxlX2Fuc3dlcnMgPSBwb3NzaWJsZV9hbnN3ZXJzX2xpc3QuZmluZCgnbGknKTtcbiAgICAgICAgdmFyIGxvb2t1cF9pbmRleDtcbiAgICAgICAgdmFyIHBvc3NpYmxlX2Fuc3dlcl90b19hcHBlbmQ7XG4gICAgICAgIHZhciBsaXN0X2l0ZW07XG4gICAgICAgIHZhciBwcmV2X3BhZ2U7XG4gICAgICAgIHZhciBjdXJyZW50X3BhZ2UgPSBmb3JtYnVpbGRlci5wb3NzaWJsZV9hbnN3ZXJzX3BhZ2luYXRpb25baW5wdXQucmVmXS5wYWdlO1xuXG4gICAgICAgIC8qYWRkIG9uZSBhbnN3ZXIgdG8gdGhlIGJvdHRvbSB0byBmaWxsIHRoZSBwYWdlIChpZiBhbnkpXG4gICAgICAgIGhlcmUgd2UgYXJlIGNoZWNraW5nIHRoZSBwb3NzaWJsZSBhbnN3ZXJzIGN1cnJlbnRseSBvbiB0aGUgZG9tXG4gICAgICAgIHRoaXMgaXMgdGhlIGNhc2Ugd2hlcmUgdGhlIHVzZXIgcmVtb3ZlIHRoZSAxMDB0aCBhbnN3ZXIgZnJvbSB0aGUgZG9tIGFuZCB3ZSBoYXZlIG1vcmUgYW5zd2Vyc1xuICAgICAgICB0byBzaG93XG4gICAgICAgICogKi9cbiAgICAgICAgaWYgKHBvc3NpYmxlX2Fuc3dlcnMubGVuZ3RoID09PSAoY29uc3RzLkxJTUlUUy5wb3NzaWJsZV9hbnN3ZXJzX3Blcl9wYWdlIC0gMSkpIHtcblxuICAgICAgICAgICAgaWYgKGlucHV0LnBvc3NpYmxlX2Fuc3dlcnMubGVuZ3RoID4gcG9zc2libGVfYW5zd2Vycy5sZW5ndGgpIHtcblxuICAgICAgICAgICAgICAgIC8vYXBwZW5kIGFuc3dlciB0byB0aGUgYm90dG9tIG9mIGN1cnJlbnQgcGFnZVxuICAgICAgICAgICAgICAgIGxvb2t1cF9pbmRleCA9IChjb25zdHMuTElNSVRTLnBvc3NpYmxlX2Fuc3dlcnNfcGVyX3BhZ2UgKiBjdXJyZW50X3BhZ2UpIC0gMTtcbiAgICAgICAgICAgICAgICBwb3NzaWJsZV9hbnN3ZXJfdG9fYXBwZW5kID0gaW5wdXQucG9zc2libGVfYW5zd2Vyc1tsb29rdXBfaW5kZXhdO1xuXG4gICAgICAgICAgICAgICAgLy9idWlsZCBtYXJrdXBcbiAgICAgICAgICAgICAgICBsaXN0X2l0ZW0gPSBmb3JtYnVpbGRlci5kb20ucGFydGlhbHMucG9zc2libGVfYW5zd2VyX2xpc3RfaXRlbTtcbiAgICAgICAgICAgICAgICBsaXN0X2l0ZW0gPSBsaXN0X2l0ZW0ucmVwbGFjZSgne3thbnN3ZXJ9fScsIHBvc3NpYmxlX2Fuc3dlcl90b19hcHBlbmQuYW5zd2VyKTtcbiAgICAgICAgICAgICAgICBsaXN0X2l0ZW0gPSBsaXN0X2l0ZW0ucmVwbGFjZSgne3thbnN3ZXItcmVmfX0nLCBwb3NzaWJsZV9hbnN3ZXJfdG9fYXBwZW5kLmFuc3dlcl9yZWYpO1xuXG4gICAgICAgICAgICAgICAgLy9hcHBlbmQgdG8gZG9tXG4gICAgICAgICAgICAgICAgcG9zc2libGVfYW5zd2Vyc19saXN0LmFwcGVuZChsaXN0X2l0ZW0pO1xuXG4gICAgICAgICAgICAgICAgLy91cGRhdGUgcGFnaW5hdGlvblxuICAgICAgICAgICAgICAgIHNlbGYucmVjYWxjdWxhdGVQYWdpbmF0aW9uKGlucHV0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8qXG4gICAgICAgIGlmIHRoZSBwb3NzaWJsZSBhbnN3ZXJzIGluIHRoZSBkb20gaXMgMCwgaXQgbWVhbnMgdGhlIHVzZXIgcmVtb3ZlZCBhbGwgdGhlIGFuc3dlcnNcbiAgICAgICAgZnJvbSB0aGUgZG9tLCB0aGVyZWZvcmUgd2UgaGF2ZSB0b1xuICAgICAgICAqICovXG4gICAgICAgIGlmIChwb3NzaWJsZV9hbnN3ZXJzLmxlbmd0aCA9PT0gMCkge1xuXG4gICAgICAgICAgICAvL2dvIHRvIHByZXZpb3VzIHBhZ2VcbiAgICAgICAgICAgIGZvcm1idWlsZGVyLnBvc3NpYmxlX2Fuc3dlcnNfcGFnaW5hdGlvbltpbnB1dC5yZWZdLnBhZ2UtLTtcbiAgICAgICAgICAgIHByZXZfcGFnZSA9IGZvcm1idWlsZGVyLnBvc3NpYmxlX2Fuc3dlcnNfcGFnaW5hdGlvbltpbnB1dC5yZWZdLnBhZ2U7XG4gICAgICAgICAgICBnZXRQb3NzaWJsZUFuc3dlclBhZ2UoaW5wdXQsIHByZXZfcGFnZSk7XG5cbiAgICAgICAgICAgIC8vdXBkYXRlIHBhZ2luYXRpb24gYnV0dG9uc1xuICAgICAgICAgICAgc2VsZi5yZWNhbGN1bGF0ZVBhZ2luYXRpb24oaW5wdXQpO1xuICAgICAgICB9XG4gICAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBwb3NzaWJsZV9hbnN3ZXJzX3BhZ2VyO1xuIiwiLyogZ2xvYmFsICQsIHRvYXN0ciwgUGFwYSovXG4ndXNlIHN0cmljdCc7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcbnZhciB1aSA9IHJlcXVpcmUoJ2hlbHBlcnMvdWknKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoJ2hlbHBlcnMvdXRpbHMnKTtcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgdmFsaWRhdGlvbiA9IHJlcXVpcmUoJ2FjdGlvbnMvdmFsaWRhdGlvbicpO1xudmFyIGltcG9ydF9mb3JtX3ZhbGlkYXRpb24gPSByZXF1aXJlKCdoZWxwZXJzL2ltcG9ydC1mb3JtLXZhbGlkYXRpb24nKTtcbnZhciBtZXNzYWdlcyA9IHJlcXVpcmUoJ2NvbmZpZy9tZXNzYWdlcycpO1xudmFyIHRvYXN0ID0gcmVxdWlyZSgnY29uZmlnL3RvYXN0Jyk7XG52YXIgY29uZmlybV9pbXBvcnRfY2FsbGJhY2sgPSByZXF1aXJlKCd1aS1oYW5kbGVycy9ldmVudC1oYW5kbGVyLWNhbGxiYWNrcy9jb25maXJtLWltcG9ydC1wb3NzaWJsZS1hbnN3ZXJzLWNhbGxiYWNrJyk7XG52YXIgZ2V0UG9zc2libGVBbnN3ZXJQYWdlID0gcmVxdWlyZSgndGVtcGxhdGUvbWV0aG9kcy9nZXRQb3NzaWJsZUFuc3dlcnNQYWdlJyk7XG52YXIgcG9zc2libGVfYW5zd2Vyc19wYWdlciA9IHJlcXVpcmUoJ2FjdGlvbnMvcG9zc2libGUtYW5zd2Vycy1wYWdlcicpO1xudmFyIHNhdmVfcHJvamVjdF9jbGlja19jYWxsYmFjayA9IHJlcXVpcmUoJ3VpLWhhbmRsZXJzL2V2ZW50LWhhbmRsZXItY2FsbGJhY2tzL3NhdmUtcHJvamVjdC1jbGljay1jYWxsYmFjaycpO1xudmFyIGdldFBvc3NpYmxlQW5zd2Vyc0xpc3QgPSByZXF1aXJlKCd0ZW1wbGF0ZS9tZXRob2RzL2dldFBvc3NpYmxlQW5zd2Vyc0xpc3QnKTtcbnZhciB1bmRvID0gcmVxdWlyZSgnYWN0aW9ucy91bmRvJyk7XG5cbnZhciBwb3NzaWJsZV9hbnN3ZXJzID0ge1xuXG4gICAgYWRkUG9zc2libGVBbnN3ZXI6IGZ1bmN0aW9uICh0aGVfaW5wdXQpIHtcblxuICAgICAgICB2YXIgaW5wdXQgPSB0aGVfaW5wdXQ7XG4gICAgICAgIHZhciBwb3NzaWJsZV9hbnN3ZXJzX2xpc3Q7XG4gICAgICAgIHZhciBhbnN3ZXJfcmVmO1xuICAgICAgICB2YXIgbGlzdF9pdGVtID0gZm9ybWJ1aWxkZXIuZG9tLnBhcnRpYWxzLnBvc3NpYmxlX2Fuc3dlcl9saXN0X2l0ZW07XG4gICAgICAgIHZhciBwcm9wZXJ0aWVzX3BhbmVsID0gZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlci5maW5kKCdmb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIGlucHV0LnJlZiArICdcIl0nKTtcbiAgICAgICAgdmFyIHBvc3NpYmxlX2Fuc3dlcnM7XG4gICAgICAgIHZhciBhcmVBbGxQT3NzaWJsZUFuc3dlcnNWYWxpZGluRG9tID0gdHJ1ZTtcblxuICAgICAgICBwb3NzaWJsZV9hbnN3ZXJzX2xpc3QgPSBwcm9wZXJ0aWVzX3BhbmVsXG4gICAgICAgICAgICAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX3Bvc3NpYmxlLWFuc3dlcnMgZGl2IHVsLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX3Bvc3NpYmxlLWFuc3dlcnNfX2xpc3QnKTtcblxuICAgICAgICAvL1ZhbGlkYXRlIGFuc3dlcnMgY3VycmVudGx5IGluIGRvbVxuICAgICAgICBwb3NzaWJsZV9hbnN3ZXJzID0gcG9zc2libGVfYW5zd2Vyc19saXN0LmZpbmQoJ2xpIGRpdiBpbnB1dCcpO1xuICAgICAgICBwb3NzaWJsZV9hbnN3ZXJzLmVhY2goZnVuY3Rpb24gKGluZGV4LCBwb3NzaWJsZV9hbnN3ZXIpIHtcbiAgICAgICAgICAgIGlmICghdmFsaWRhdGlvbi5pc1Bvc3NpYmxlQW5zd2VyVmFsaWQoJChwb3NzaWJsZV9hbnN3ZXIpLnZhbCgpKS5pc192YWxpZCkge1xuICAgICAgICAgICAgICAgIGFyZUFsbFBPc3NpYmxlQW5zd2Vyc1ZhbGlkaW5Eb20gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vd2FybiB1c2VyIGlmIHRoZXJlIGlzIGFueSBlcnJvciB0byBmaXgsIGFuZCBleGl0XG4gICAgICAgIGlmICghYXJlQWxsUE9zc2libGVBbnN3ZXJzVmFsaWRpbkRvbSkge1xuICAgICAgICAgICAgdG9hc3Quc2hvd0Vycm9yKG1lc3NhZ2VzLmVycm9yLlBPU1NJQkxFX0FOU1dFUl9FTVBUWSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvL3doZW4gdGhlcmUgaXMgbW9yZSB0aGFuIDEgcG9zc2libGUgYW5zd2VycywgZW5hYmxlIGFsbCByZW1vdmUgYnV0dG9uc1xuICAgICAgICBwb3NzaWJsZV9hbnN3ZXJzX2xpc3QuZmluZCgnbGkgZGl2IHNwYW4gYnV0dG9uJykucHJvcCgnZGlzYWJsZWQnLCBmYWxzZSk7XG5cbiAgICAgICAgLy9wcmVwYXJlIGRvbSBmb3IgcG9zc2libGUgYW5zd2VyIGxpc3QgaXRlbVxuICAgICAgICAvL2dlbmVyYXRlIHVuaXFpZCBoZXJlIGFuZCBhcHBlbmQgaXQgdG8gdGhlIGRvbSB0byBiZSB1c2VkIGxhdGVyXG4gICAgICAgIGFuc3dlcl9yZWYgPSB1dGlscy5nZW5lcmF0ZVVuaXFJRCgpO1xuXG4gICAgICAgIGxpc3RfaXRlbSA9IGxpc3RfaXRlbS5yZXBsYWNlKCd7e2Fuc3dlcn19JywgY29uc3RzLlBPU1NJQklMRV9BTlNXRVJfUExBQ0VIT0xERVIpO1xuICAgICAgICBsaXN0X2l0ZW0gPSBsaXN0X2l0ZW0ucmVwbGFjZSgne3thbnN3ZXItcmVmfX0nLCBhbnN3ZXJfcmVmKTtcblxuICAgICAgICAvL2xvYWQgaHRtbCBzbmlwcGV0IGJhc2VkIG9uIGlucHV0IHR5cGVcblxuICAgICAgICAvL2RvIHdlIGhhdmUgcGFnaW5hdGlvbj9cbiAgICAgICAgaWYgKGlucHV0LnBvc3NpYmxlX2Fuc3dlcnMubGVuZ3RoID49IGNvbnN0cy5MSU1JVFMucG9zc2libGVfYW5zd2Vyc19wZXJfcGFnZSkge1xuXG4gICAgICAgICAgICAvL29rLCBzbyBnbyB0byBsYXN0IHBvc3NpYmxlIGFuc3dlcnMgcGFnZVxuICAgICAgICAgICAgLy90b2RvIGNoZWNrIHVzZXIgaXMgbm90IHRoZXJlIGFscmVhZHlcbiAgICAgICAgICAgIHZhciBsYXN0X3BhZ2UgPSBNYXRoLmNlaWwoKGlucHV0LnBvc3NpYmxlX2Fuc3dlcnMubGVuZ3RoICsgMSkgLyAoY29uc3RzLkxJTUlUUy5wb3NzaWJsZV9hbnN3ZXJzX3Blcl9wYWdlKSk7XG5cbiAgICAgICAgICAgIC8vc2F2ZSBhbnN3ZXJzIGN1cnJlbnRseSBpbiB0aGUgZG9tXG4gICAgICAgICAgICBpbnB1dC5zYXZlUG9zc2libGVBbnN3ZXJzKCk7XG5cbiAgICAgICAgICAgIC8vdXBkYXRlIGdsb2JhbCBmbGFnIHRvIGtlZXAgdHJhY2sgb2YgcGFnaW5hdGlvblxuICAgICAgICAgICAgZm9ybWJ1aWxkZXIucG9zc2libGVfYW5zd2Vyc19wYWdpbmF0aW9uW2lucHV0LnJlZl0ucGFnZSA9IGxhc3RfcGFnZTtcbiAgICAgICAgICAgIGdldFBvc3NpYmxlQW5zd2VyUGFnZShpbnB1dCwgbGFzdF9wYWdlKTtcblxuICAgICAgICAgICAgLy9HZXQgdXBkYXRlZCBsaXN0XG4gICAgICAgICAgICBwb3NzaWJsZV9hbnN3ZXJzID0gcHJvcGVydGllc19wYW5lbFxuICAgICAgICAgICAgICAgIC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fcG9zc2libGUtYW5zd2VycyBkaXYgdWwuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fcG9zc2libGUtYW5zd2Vyc19fbGlzdCBsaScpO1xuXG4gICAgICAgICAgICAvL0FwcGVuZCBhbnN3ZXIgdG8gY3VycmVudCBsaXN0IGlmIHRoZXJlIGlzIGFueSByb29tLFxuICAgICAgICAgICAgLy9vdGhlcndpc2UgY3JlYXRlIG5ldyBwYWdlXG4gICAgICAgICAgICBpZiAocG9zc2libGVfYW5zd2Vycy5sZW5ndGggPiAoY29uc3RzLkxJTUlUUy5wb3NzaWJsZV9hbnN3ZXJzX3Blcl9wYWdlIC0gMSkpIHtcbiAgICAgICAgICAgICAgICAvL2dvIHRvIGEgYnJhbmQgbmV3IHBhZ2VcbiAgICAgICAgICAgICAgICBnZXRQb3NzaWJsZUFuc3dlclBhZ2UoaW5wdXQsIChsYXN0X3BhZ2UgKyAxKSk7XG4gICAgICAgICAgICAgICAgcG9zc2libGVfYW5zd2VycyA9IHByb3BlcnRpZXNfcGFuZWxcbiAgICAgICAgICAgICAgICAgICAgLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19wb3NzaWJsZS1hbnN3ZXJzIGRpdiB1bC5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19wb3NzaWJsZS1hbnN3ZXJzX19saXN0IGxpICcpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBwb3NzaWJsZV9hbnN3ZXJzX2xpc3QuYXBwZW5kKGxpc3RfaXRlbSkuZmFkZUluKGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG5cbiAgICAgICAgICAgIC8vc2F2ZSB0aGUgbmV3IGFuc3dlciAoYm90aCBkb20gYW5kIGlucHV0IG9iamVjdClcbiAgICAgICAgICAgIGlucHV0LnBvc3NpYmxlX2Fuc3dlcnMucHVzaCh7XG4gICAgICAgICAgICAgICAgYW5zd2VyOiBjb25zdHMuUE9TU0lCSUxFX0FOU1dFUl9QTEFDRUhPTERFUixcbiAgICAgICAgICAgICAgICBhbnN3ZXJfcmVmOiBhbnN3ZXJfcmVmXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlucHV0LnNhdmVQb3NzaWJsZUFuc3dlcnMoKTtcblxuICAgICAgICAgICAgLy9zaG93IHBhZ2VyXG4gICAgICAgICAgICBwb3NzaWJsZV9hbnN3ZXJzX3BhZ2VyLmluaXQoaW5wdXQpO1xuXG4gICAgICAgICAgICAvL3VwZGF0ZSBwYWdpbmF0aW9uXG4gICAgICAgICAgICBwb3NzaWJsZV9hbnN3ZXJzX3BhZ2VyLnJlY2FsY3VsYXRlUGFnaW5hdGlvbihpbnB1dCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBwb3NzaWJsZV9hbnN3ZXJzX2xpc3QuYXBwZW5kKGxpc3RfaXRlbSkuZmFkZUluKGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG4gICAgICAgICAgICBpbnB1dC5zYXZlUG9zc2libGVBbnN3ZXJzKCk7XG4gICAgICAgIH1cblxuICAgICAgICAvL2lmIG1heCBudW1iZXIgb2YgYWxsb3dlZCBwb3NzaWJsZSBhbnN3ZXJzIHJlYWNoZWQsIGRpc2FibGUgXCJBZGQgYW5zd2VyXCIgYnV0dG9uXG4gICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkge1xuICAgICAgICAgICAgY2FzZSBjb25zdHMuU0VBUkNIX1NJTkdMRV9UWVBFOlxuICAgICAgICAgICAgY2FzZSBjb25zdHMuU0VBUkNIX01VTFRJUExFX1RZUEU6XG4gICAgICAgICAgICAgICAgLy91cCB0byAxMDAwXG4gICAgICAgICAgICAgICAgaWZcbiAgICAgICAgICAgICAgICAoaW5wdXQucG9zc2libGVfYW5zd2Vycy5sZW5ndGggPj0gY29uc3RzLkxJTUlUUy5wb3NzaWJsZV9hbnN3ZXJzX21heF9zZWFyY2gpIHtcbiAgICAgICAgICAgICAgICAgICAgdWkuaW5wdXRfcHJvcGVydGllc19wYW5lbC50b2dnbGVBZGRBbnN3ZXJCdG4odHJ1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBjb25zdHMuQ0hFQ0tCT1hfVFlQRTpcbiAgICAgICAgICAgIGNhc2UgY29uc3RzLlJBRElPX1RZUEU6XG4gICAgICAgICAgICBjYXNlIGNvbnN0cy5EUk9QRE9XTl9UWVBFOlxuICAgICAgICAgICAgICAgIC8vdXAgdG8gMzAwXG5cbiAgICAgICAgICAgICAgICBpZlxuICAgICAgICAgICAgICAgIChpbnB1dC5wb3NzaWJsZV9hbnN3ZXJzLmxlbmd0aCA+PSBjb25zdHMuTElNSVRTLnBvc3NpYmxlX2Fuc3dlcnNfbWF4KSB7XG4gICAgICAgICAgICAgICAgICAgIHVpLmlucHV0X3Byb3BlcnRpZXNfcGFuZWwudG9nZ2xlQWRkQW5zd2VyQnRuKHRydWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAvL2RvIG5vdGhpbmdcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICByZW1vdmVQb3NzaWJsZUFuc3dlcjogZnVuY3Rpb24gKHRoZV9pbnB1dCwgdGhlX2Fuc3dlcl9pbmRleF9kb20pIHtcblxuICAgICAgICB2YXIgaW5wdXQgPSB0aGVfaW5wdXQ7XG4gICAgICAgIHZhciBhbnN3ZXJfaW5kZXhfZG9tID0gdGhlX2Fuc3dlcl9pbmRleF9kb207XG4gICAgICAgIHZhciBwb3NzaWJsZV9hbnN3ZXJzX2xpc3Q7XG4gICAgICAgIHZhciBwb3NzaWJsZV9hbnN3ZXJzO1xuICAgICAgICB2YXIgY3VycmVudF9wYWdlID0gZm9ybWJ1aWxkZXIucG9zc2libGVfYW5zd2Vyc19wYWdpbmF0aW9uW2lucHV0LnJlZl0ucGFnZTtcblxuICAgICAgICBpbnB1dC5kb20ucHJvcGVydGllc19wYW5lbCA9IGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXIuZmluZCgnZm9ybVtkYXRhLWlucHV0LXJlZj1cIicgKyBpbnB1dC5yZWYgKyAnXCJdJyk7XG5cbiAgICAgICAgcG9zc2libGVfYW5zd2Vyc19saXN0ID0gaW5wdXQuZG9tLnByb3BlcnRpZXNfcGFuZWxcbiAgICAgICAgICAgIC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fcG9zc2libGUtYW5zd2VycyBkaXYgdWwuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fcG9zc2libGUtYW5zd2Vyc19fbGlzdCcpO1xuICAgICAgICBwb3NzaWJsZV9hbnN3ZXJzID0gcG9zc2libGVfYW5zd2Vyc19saXN0LmZpbmQoJ2xpJyk7XG5cbiAgICAgICAgLyogY2hlY2sgaWYgdGhlIHBvc3NpYmxlIGFuc3dlciBoYXMgZ290IGEganVtcCBhdHRhY2hlZFxuICAgICAgICAgaWYgc28sIHRoZSBqdW1wIHdpbGwgYmUgZHJvcHBlZCBzbyBhc2sgdGhlIHVzZXIgdG8gY29uZmlybSBhY3Rpb25cbiAgICAgICAgICovXG4gICAgICAgIC8vdG9kbyBjaGVjayBpZiB0aGUganVtcCBpcyBqdXN0IGRyb3BwZWRcblxuICAgICAgICAvL2RvIG5vdCBkbyBhbnl0aGluZyBpZiB0aGVyZSBpcyBvbmx5IDEgcG9zc2libGUgYW5zd2VyXG4gICAgICAgIGlmIChpbnB1dC5wb3NzaWJsZV9hbnN3ZXJzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9pZiAncG9zc2libGVfYW5zd2VycycgbGVuZ3RoIGlzIDIsIGFmdGVyIHJlbW92aW5nIHRoZSBlbGVtZW50IGRpc2FibGUgdGhlIG9uZSBsZWZ0LCBzbyB3ZSBoYXZlIGF0IGxlYXN0IDEgcG9zc2libGUgYW5zd2VyXG4gICAgICAgIHBvc3NpYmxlX2Fuc3dlcnMuZXEoYW5zd2VyX2luZGV4X2RvbSkuZmFkZU91dCgyMDAsIGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgLy9nZXQgcG9zc2libGUgYW5zd2VyIGluZGV4IG9mZnNldCBiYXNlZCBvbiB3aGF0IHBhZ2Ugd2UgYXJlIHNob3dpbmcgaW4gdGhlIERPTVxuICAgICAgICAgICAgdmFyIG9mZnNldCA9IChjdXJyZW50X3BhZ2UgLSAxKSAqIGNvbnN0cy5MSU1JVFMucG9zc2libGVfYW5zd2Vyc19wZXJfcGFnZTtcblxuICAgICAgICAgICAgLy9yZW1vdmUgZnJvbSBkb21cbiAgICAgICAgICAgICQodGhpcykucmVtb3ZlKCk7XG5cbiAgICAgICAgICAgIC8vcmVtb3ZlIGFuc3dlciBmcm9tIHByb2plY3QgZGVmaW5pdGlvblxuICAgICAgICAgICAgaW5wdXQucG9zc2libGVfYW5zd2Vycy5zcGxpY2Uob2Zmc2V0ICsgYW5zd2VyX2luZGV4X2RvbSwgMSk7XG5cbiAgICAgICAgICAgIGlmIChpbnB1dC5wb3NzaWJsZV9hbnN3ZXJzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgICAgIHBvc3NpYmxlX2Fuc3dlcnNfbGlzdC5maW5kKCdsaSBkaXYgc3BhbiBidXR0b24nKS5wcm9wKCdkaXNhYmxlZCcsIHRydWUpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL2lmIG1heCBudW1iZXIgb2YgYWxsb3dlZCBwb3NzaWJsZSBhbnN3ZXJzIHJlYWNoZWQsIGRpc2FibGUgXCJBZGQgYW5zd2VyXCIgYnV0dG9uXG4gICAgICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHtcbiAgICAgICAgICAgICAgICBjYXNlIGNvbnN0cy5TRUFSQ0hfU0lOR0xFX1RZUEU6XG4gICAgICAgICAgICAgICAgY2FzZSBjb25zdHMuU0VBUkNIX01VTFRJUExFX1RZUEU6XG4gICAgICAgICAgICAgICAgICAgIC8vdXAgdG8gMTAwMFxuICAgICAgICAgICAgICAgICAgICBpZlxuICAgICAgICAgICAgICAgICAgICAoaW5wdXQucG9zc2libGVfYW5zd2Vycy5sZW5ndGggPCBjb25zdHMuTElNSVRTLnBvc3NpYmxlX2Fuc3dlcnNfbWF4X3NlYXJjaCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdWkuaW5wdXRfcHJvcGVydGllc19wYW5lbC50b2dnbGVBZGRBbnN3ZXJCdG4oZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vdXBkYXRlIHBvc3NpYmxlIGFuc3dlcnMgaW4gZG9tICh3aGVuIG5lZWRlZClcbiAgICAgICAgICAgICAgICAgICAgcG9zc2libGVfYW5zd2Vyc19wYWdlci5yZWNhbGN1bGF0ZVBvc3NpYmxlQW5zd2Vyc0RPTShpbnB1dCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgY29uc3RzLkNIRUNLQk9YX1RZUEU6XG4gICAgICAgICAgICAgICAgY2FzZSBjb25zdHMuUkFESU9fVFlQRTpcbiAgICAgICAgICAgICAgICBjYXNlIGNvbnN0cy5EUk9QRE9XTl9UWVBFOlxuICAgICAgICAgICAgICAgICAgICAvL3VwIHRvIDMwMFxuICAgICAgICAgICAgICAgICAgICBpZlxuICAgICAgICAgICAgICAgICAgICAoaW5wdXQucG9zc2libGVfYW5zd2Vycy5sZW5ndGggPCBjb25zdHMuTElNSVRTLnBvc3NpYmxlX2Fuc3dlcnNfbWF4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB1aS5pbnB1dF9wcm9wZXJ0aWVzX3BhbmVsLnRvZ2dsZUFkZEFuc3dlckJ0bihmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy91cGRhdGUgcG9zc2libGUgYW5zd2VycyBpbiBkb20gKHdoZW4gbmVlZGVkKVxuICAgICAgICAgICAgICAgICAgICBwb3NzaWJsZV9hbnN3ZXJzX3BhZ2VyLnJlY2FsY3VsYXRlUG9zc2libGVBbnN3ZXJzRE9NKGlucHV0KTtcblxuICAgICAgICAgICAgICAgICAgICBpbnB1dC51cGRhdGVQb3NzaWJsZUluaXRpYWxBbnN3ZXJzKCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgLy9kbyBub3RoaW5nXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vdG9kbyBjaGVjayB3aGF0IHRoaXMgZG9lcyBoZXJlLCB3aGVuIHJlbW92aW5nIGFuIGFuc3dlcj9cbiAgICAgICAgICAgIC8vIGlucHV0LnNhdmVQb3NzaWJsZUFuc3dlcnMoKTtcblxuICAgICAgICB9KTtcbiAgICB9LFxuXG4gICAgdXBkYXRlSnVtcFBvc3NpYmxlQW5zd2VyczogZnVuY3Rpb24gKHRoZV9pbnB1dCwgdGhlX2p1bXBfcGFuZWwpIHtcblxuICAgICAgICB2YXIgaW5wdXQgPSB0aGVfaW5wdXQ7XG4gICAgICAgIHZhciBqdW1wX3BhbmVsID0gdGhlX2p1bXBfcGFuZWw7XG4gICAgICAgIHZhciBpO1xuICAgICAgICB2YXIgaUxlbmd0aCA9IGlucHV0LnBvc3NpYmxlX2Fuc3dlcnMubGVuZ3RoO1xuXG4gICAgICAgIC8vZmluZCBhbnN3ZXIgPHNlbGVjdD4ocylcbiAgICAgICAgdmFyIHNlbGVjdHNfdG9fdGFyZ2V0ID0ganVtcF9wYW5lbFxuICAgICAgICAgICAgLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19qdW1wc19fbGlzdCAuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fanVtcHNfX2xpc3QtaXRlbSAuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fanVtcHNfX2xvZ2ljLS1hbnN3ZXIgc2VsZWN0Jyk7XG5cbiAgICAgICAgc2VsZWN0c190b190YXJnZXQuZWFjaChmdW5jdGlvbiAoaW5kZXgpIHtcblxuICAgICAgICAgICAgdmFyIHRhcmdldCA9ICQodGhpcyk7XG4gICAgICAgICAgICB2YXIgc2VsZWN0ZWRfb3B0aW9uID0gdGFyZ2V0LmZpbmQoJ29wdGlvbjpzZWxlY3RlZCcpO1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRfc2VsZWN0ZWRfYW5zd2VyX2lkID0gd2luZG93LnBhcnNlSW50KHNlbGVjdGVkX29wdGlvbi52YWwoKSwgMTApO1xuXG4gICAgICAgICAgICAvL2dldCB0aGUgdXBkYXRlZCBhbnN3ZXIgdGV4dCBmcm9tIFwicG9zc2libGUgYW5zd2Vyc1wiXG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgaUxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRfc2VsZWN0ZWRfYW5zd2VyX2lkID09PSBpbnB1dC5wb3NzaWJsZV9hbnN3ZXJzW2ldLmFuc3dlcl9pZCkge1xuICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZF9vcHRpb24udGV4dChjdXJyZW50X3NlbGVjdGVkX2Fuc3dlcl9pZCArICcgLSAnICsgaW5wdXQucG9zc2libGVfYW5zd2Vyc1tpXS5hbnN3ZXIpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc29sZS5sb2coJCh0aGlzKS5hdHRyKCdpZCcpKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCQodGhpcykuZmluZCgnb3B0aW9uOnNlbGVjdGVkJykudmFsKCkpO1xuICAgICAgICB9KTtcbiAgICB9LFxuXG4gICAgLy9nZXQgc2VsZWN0ZWQgcG9zc2libGUgYW5zd2VyIGFuZCBzYXZlIGl0IGluIHRoZSBpbnB1dCBvYmplY3QgYXMgdGhlIGRlZmF1bHQgYW5zd2VyXG4gICAgdXBkYXRlUG9zc2libGVJbml0aWFsQW5zd2VyczogZnVuY3Rpb24gKHRoZV9pbnB1dCkge1xuICAgICAgICB2YXIgaW5wdXQgPSB0aGVfaW5wdXQ7XG4gICAgICAgIHZhciBwb3NzaWJsZV9pbml0aWFsX2Fuc3dlcnNfbGlzdDtcbiAgICAgICAgdmFyIHNlbGVjdGVkX2Fuc3dlcjtcblxuICAgICAgICBpbnB1dC5kb20uYWR2YW5jZWRfcHJvcGVydGllc193cmFwcGVyID0gZm9ybWJ1aWxkZXJcbiAgICAgICAgICAgIC5kb21cbiAgICAgICAgICAgIC5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXJcbiAgICAgICAgICAgIC5maW5kKCdmb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIGlucHV0LnJlZiArICdcIl0nKVxuICAgICAgICAgICAgLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19hZHZhbmNlZC1wcm9wZXJ0aWVzJyk7XG5cbiAgICAgICAgcG9zc2libGVfaW5pdGlhbF9hbnN3ZXJzX2xpc3QgPSBpbnB1dC5kb20uYWR2YW5jZWRfcHJvcGVydGllc193cmFwcGVyLmZpbmQoJ2Rpdi5wYW5lbC1ib2R5IGRpdi5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19hZHZhbmNlZC1wcm9wZXJ0aWVzX19kZWZhdWx0IHNlbGVjdCcpO1xuXG4gICAgICAgIHNlbGVjdGVkX2Fuc3dlciA9IHBvc3NpYmxlX2luaXRpYWxfYW5zd2Vyc19saXN0LmZpbmQoJ29wdGlvbjpzZWxlY3RlZCcpO1xuXG4gICAgICAgIGlucHV0LmRlZmF1bHQgPSBzZWxlY3RlZF9hbnN3ZXIudmFsKCk7XG5cbiAgICB9LFxuXG4gICAgbGlzdFBvc3NpYmxlSW5pdGlhbEFuc3dlcnM6IGZ1bmN0aW9uICh0aGVfaW5wdXQpIHtcblxuICAgICAgICB2YXIgaW5wdXQgPSB0aGVfaW5wdXQ7XG4gICAgICAgIHZhciBwb3NzaWJsZV9hbnN3ZXJzO1xuICAgICAgICB2YXIgcG9zc2libGVfaW5pdGlhbF9hbnN3ZXJzX2xpc3Q7XG4gICAgICAgIHZhciB2YWx1ZTtcbiAgICAgICAgdmFyIGFuc3dlcl9yZWY7XG4gICAgICAgIHZhciBzZWxlY3RlZCA9ICcnO1xuXG4gICAgICAgIGlucHV0LmRvbS5wcm9wZXJ0aWVzX3BhbmVsID0gZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlci5maW5kKCdmb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIGlucHV0LnJlZiArICdcIl0nKTtcbiAgICAgICAgcG9zc2libGVfYW5zd2VycyA9IGlucHV0LmRvbVxuICAgICAgICAgICAgLnByb3BlcnRpZXNfcGFuZWxcbiAgICAgICAgICAgIC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fcG9zc2libGUtYW5zd2VycyAucGFuZWwtYm9keSB1bC5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19wb3NzaWJsZS1hbnN3ZXJzX19saXN0IGxpJyk7XG5cblxuICAgICAgICBpbnB1dC5kb20uYWR2YW5jZWRfcHJvcGVydGllc193cmFwcGVyID0gZm9ybWJ1aWxkZXJcbiAgICAgICAgICAgIC5kb21cbiAgICAgICAgICAgIC5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXJcbiAgICAgICAgICAgIC5maW5kKCdmb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIGlucHV0LnJlZiArICdcIl0nKVxuICAgICAgICAgICAgLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19hZHZhbmNlZC1wcm9wZXJ0aWVzJyk7XG5cbiAgICAgICAgcG9zc2libGVfaW5pdGlhbF9hbnN3ZXJzX2xpc3QgPSBpbnB1dC5kb20uYWR2YW5jZWRfcHJvcGVydGllc193cmFwcGVyLmZpbmQoJ2Rpdi5wYW5lbC1ib2R5IGRpdi5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19hZHZhbmNlZC1wcm9wZXJ0aWVzX19kZWZhdWx0IHNlbGVjdCcpO1xuXG4gICAgICAgIC8vZW1wdHkgbGlzdCBhbmQgcmUtYXBwZW5kIGl0ZW1zIHRvZG8gbWF5YmUgdG9vIGV4cGVuc2l2ZSwgZmluZCBhIGJldHRlciB3YXlcbiAgICAgICAgcG9zc2libGVfaW5pdGlhbF9hbnN3ZXJzX2xpc3QuZW1wdHkoKTtcblxuICAgICAgICAvL2FwcGVuZCAnbm9uZScgc2VsZWN0aW9uLCB1c2luZyBpbmRleCAwIGFzIG5vdGhpbmcgaGFzIGJlZW4gc2VsZWN0ZWRcbiAgICAgICAgcG9zc2libGVfaW5pdGlhbF9hbnN3ZXJzX2xpc3QuYXBwZW5kKCc8b3B0aW9uIHZhbHVlPVwiXCI+Tm9uZTwvb3B0aW9uPicpO1xuXG4gICAgICAgIHBvc3NpYmxlX2Fuc3dlcnMuZWFjaChmdW5jdGlvbiAoaW5kZXgpIHtcblxuICAgICAgICAgICAgdmFsdWUgPSAkKHRoaXMpLmZpbmQoJ2RpdiBpbnB1dCcpLnZhbCgpO1xuXG4gICAgICAgICAgICAvL2dldCBhbnN3ZXIgcmVmIGJhc2VkIG9uIHRoZSBpbmRleCBvZiBvcHRpb24gaW4gdGhlIGRvbSB0b2RvIGRvZXMgaXQgd29yaz9cbiAgICAgICAgICAgIGFuc3dlcl9yZWYgPSBpbnB1dC5wb3NzaWJsZV9hbnN3ZXJzW2luZGV4XS5hbnN3ZXJfcmVmO1xuXG4gICAgICAgICAgICAvL3ByZSBzZWxlY3QgcHJldmlvdXNseSBzYXZlZCBvcHRpb25cbiAgICAgICAgICAgIHNlbGVjdGVkID0gKGFuc3dlcl9yZWYgPT09IGlucHV0LmRlZmF1bHQpID8gJ3NlbGVjdGVkJyA6ICcnO1xuXG4gICAgICAgICAgICBwb3NzaWJsZV9pbml0aWFsX2Fuc3dlcnNfbGlzdC5hcHBlbmQoJzxvcHRpb24gdmFsdWU9XCInICsgYW5zd2VyX3JlZiArICdcIiAnICsgc2VsZWN0ZWQgKyAnID4nICsgdmFsdWUgKyAnPC9vcHRpb24+Jyk7XG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICBleHBvcnRQb3NzaWJsZUFuc3dlcnNDU1Y6IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICB2YXIgaW5wdXQ7XG4gICAgICAgIHZhciBhbnN3ZXJzID0gW107XG4gICAgICAgIHZhciBmaWxlbmFtZTtcblxuICAgICAgICBpbnB1dCA9IHV0aWxzLmdldEFjdGl2ZUlucHV0KCk7XG5cbiAgICAgICAgLy9hYm9ydCBpZiBubyBwb3NzaWJsZSBhbnN3ZXJzXG4gICAgICAgIGlmIChpbnB1dC5wb3NzaWJsZV9hbnN3ZXJzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9hYm9ydCBpZiBwb3NzaWJsZSBhbnN3ZXJzIGFyZSBpbnZhbGlkXG4gICAgICAgIGlmICghaW1wb3J0X2Zvcm1fdmFsaWRhdGlvbi5hcmVQb3NzaWJsZUFuc3dlcnNWYWxpZChpbnB1dC5wb3NzaWJsZV9hbnN3ZXJzLCBpbnB1dC50eXBlKSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9maWxlbmFtZSBnZXRzIHZlcnkgbG9uZyBpZiB3ZSB1c2UgdGhlIGlucHV0IHJlZi4uLnNvIHdlIGRvIG5vdFxuICAgICAgICBmaWxlbmFtZSA9IGlucHV0LnF1ZXN0aW9uLnRydW5jKDIwKSArICdfX3Bvc3NpYmxlX2Fuc3dlcnMuY3N2JztcblxuICAgICAgICAkKGlucHV0LnBvc3NpYmxlX2Fuc3dlcnMpLmVhY2goZnVuY3Rpb24gKGluZGV4LCBwb3NzaWJsZV9hbnN3ZXIpIHtcbiAgICAgICAgICAgIGFuc3dlcnNbaW5kZXhdID0gW3Bvc3NpYmxlX2Fuc3dlci5hbnN3ZXJdO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBTcGVjaWZ5aW5nIGZpZWxkcyBhbmQgZGF0YSBleHBsaWNpdGx5XG4gICAgICAgIHZhciBjc3YgPSBQYXBhLnVucGFyc2Uoe1xuICAgICAgICAgICAgZmllbGRzOiBbaW5wdXQucXVlc3Rpb25dLFxuICAgICAgICAgICAgZGF0YTogYW5zd2Vyc1xuICAgICAgICB9LCB7XG4gICAgICAgICAgICBxdW90ZXM6IGZhbHNlLFxuICAgICAgICAgICAgcXVvdGVDaGFyOiAnJyxcbiAgICAgICAgICAgIGRlbGltaXRlcjogJywnLFxuICAgICAgICAgICAgaGVhZGVyOiB0cnVlLFxuICAgICAgICAgICAgbmV3bGluZTogJ1xcclxcbidcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGRhdGE6IGNzdixcbiAgICAgICAgICAgIGZpbGVuYW1lOiBmaWxlbmFtZVxuICAgICAgICB9O1xuICAgIH0sXG5cbiAgICBpbXBvcnRDU1ZGaWxlOiBmdW5jdGlvbiAoZmlsZXMpIHtcblxuICAgICAgICB2YXIgZmlsZSA9IGZpbGVzWzBdO1xuICAgICAgICB2YXIgZmlsZV9wYXJ0cztcbiAgICAgICAgdmFyIGZpbGVfZXh0O1xuICAgICAgICB2YXIgZ2V0UG9zc2libGVBbnN3ZXJzSFRNTCA9IHJlcXVpcmUoJ3RlbXBsYXRlL21ldGhvZHMvZ2V0UG9zc2libGVBbnN3ZXJzSFRNTCcpO1xuXG4gICAgICAgIC8vc2hvdyBvdmVybGF5IGFuZCBjdXJzb3JcbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLm92ZXJsYXkuZmFkZUluKDApO1xuXG4gICAgICAgIGZvcm1idWlsZGVyLmlzT3BlbmluZ0ZpbGVCcm93c2VyID0gZmFsc2U7XG5cbiAgICAgICAgLy9pZiB0aGUgdXNlciBjYW5jZWxzIHRoZSBhY3Rpb25cbiAgICAgICAgaWYgKCFmaWxlKSB7XG4gICAgICAgICAgICAvL2hpZGUgb3ZlcmxheVxuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLm92ZXJsYXkuZmFkZU91dChjb25zdHMuQU5JTUFUSU9OX0ZBU1QpO1xuICAgICAgICAgICAgdG9hc3RyLmVycm9yKG1lc3NhZ2VzLmVycm9yLkNTVl9GSUxFX0lOVkFMSUQpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgZmlsZV9wYXJ0cyA9IGZpbGUubmFtZS5zcGxpdCgnLicpO1xuICAgICAgICBmaWxlX2V4dCA9IGZpbGVfcGFydHNbZmlsZV9wYXJ0cy5sZW5ndGggLSAxXTtcblxuICAgICAgICAvL2l0IG11c3QgYmUgY3N2XG4gICAgICAgIGlmIChmaWxlX2V4dCAhPT0gY29uc3RzLkNTVl9GSUxFX0VYVEVOU0lPTikge1xuICAgICAgICAgICAgLy9oaWRlIG92ZXJsYXlcbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5vdmVybGF5LmZhZGVPdXQoY29uc3RzLkFOSU1BVElPTl9GQVNUKTtcbiAgICAgICAgICAgIHRvYXN0ci5lcnJvcihtZXNzYWdlcy5lcnJvci5DU1ZfRklMRV9JTlZBTElEKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICAvL2ZpbGUgaXMgdmFsaWQsIGxldCdzIHBhcnNlIGl0XG4gICAgICAgIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xuXG4gICAgICAgIHJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbiAoZSkge1xuXG4gICAgICAgICAgICB2YXIgY29udGVudCA9IGUudGFyZ2V0LnJlc3VsdDtcbiAgICAgICAgICAgIHZhciBqc29uID0gUGFwYS5wYXJzZShjb250ZW50LCB7IGhlYWRlcjogdHJ1ZSwgZGVsaW1pdGVyOiAnLCcgfSk7XG4gICAgICAgICAgICB2YXIgaGVhZGVycyA9IGpzb24ubWV0YS5maWVsZHM7XG4gICAgICAgICAgICB2YXIgdW5kbyA9IHJlcXVpcmUoJ2FjdGlvbnMvdW5kbycpOy8vaXQgaXMgaGVyZSBvdGhlcndpc2UgaXQgYnJlYWtzIHdoZW4gY29tcGlsaW5nLi4uZ28gZmlndXJlPz9cbiAgICAgICAgICAgIHZhciBtb2RhbCA9ICQoJyNjc3YtaW1wb3J0LXBvc3NpYmxlX2Fuc3dlcnMnKTtcblxuICAgICAgICAgICAgaWYgKGpzb24uZGF0YS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAvL2VtcHR5IGNzdiBmaWxlLCBzaG93IGVycm9yXG4gICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLm92ZXJsYXkuZmFkZU91dChjb25zdHMuQU5JTUFUSU9OX0ZBU1QpO1xuICAgICAgICAgICAgICAgIHRvYXN0ci5lcnJvcihtZXNzYWdlcy5lcnJvci5DU1ZfRklMRV9JTlZBTElEKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vdG9kbyBzaG93IG1vZGFsIGFza2luZyB3aGljaCBjb2x1bXMgYW5kIHdoZXRoZXIgdG8gcmVwbGFjZSBvciBub3QgdGhlIGV4aXN0aW5nIHBvc3NpYmxlIGFuc3dlcnNcbiAgICAgICAgICAgIG1vZGFsLm1vZGFsKCk7XG5cbiAgICAgICAgICAgIG1vZGFsLm9mZigpLm9uKCdzaG93bi5icy5tb2RhbCcsIGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgIHZhciBjb2x1bW5fcGlja2VyID0gJCgnI2Nzdi1pbXBvcnQtcG9zc2libGVfYW5zd2VycycpLmZpbmQoJy5wb3NzaWJsZS1hbnN3ZXJzLWNvbHVtbi1waWNrZXInKTtcbiAgICAgICAgICAgICAgICB2YXIgY29sdW1uX2l0ZW1zID0gJyc7XG4gICAgICAgICAgICAgICAgdmFyIHNlbGVjdGVkSGVhZGVySW5kZXggPSBudWxsO1xuICAgICAgICAgICAgICAgIHZhciBwYXJhbXM7XG4gICAgICAgICAgICAgICAgdmFyIHVzZXJXYW50c3RvUmVwbGFjZUFuc3dlcnM7XG4gICAgICAgICAgICAgICAgdmFyIGRvZXNGaXJzdFJvd0NvbnRhaW5zSGVhZGVycztcbiAgICAgICAgICAgICAgICB2YXIgcG9zc2libGVfYW5zd2Vyc19tYXggPSBjb25zdHMuTElNSVRTLnBvc3NpYmxlX2Fuc3dlcnNfbWF4O1xuICAgICAgICAgICAgICAgIHZhciBpbnB1dCA9IHV0aWxzLmdldEFjdGl2ZUlucHV0KCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudHlwZSA9PT0gY29uc3RzLlNFQVJDSF9TSU5HTEVfVFlQRSB8fCBpbnB1dC50eXBlID09PSBjb25zdHMuU0VBUkNIX01VTFRJUExFX1RZUEUpIHtcbiAgICAgICAgICAgICAgICAgICAgcG9zc2libGVfYW5zd2Vyc19tYXggPSBjb25zdHMuTElNSVRTLnBvc3NpYmxlX2Fuc3dlcnNfbWF4X3NlYXJjaDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL3Jlc2V0IGNvbHVtbiBwaWNrZXJcbiAgICAgICAgICAgICAgICBjb2x1bW5fcGlja2VyLmZpbmQoJy5idG4nKS5odG1sKCdQaWNrIGNvbHVtbicgKyAnIDxzcGFuIGNsYXNzPVwiY2FyZXRcIj48L3NwYW4+Jyk7XG4gICAgICAgICAgICAgICAgY29sdW1uX3BpY2tlci5maW5kKCcuYnRuJykudmFsKCcnKTtcblxuICAgICAgICAgICAgICAgIC8vcmVzZXQgb3RoZXIgY29udHJvbHNcbiAgICAgICAgICAgICAgICBtb2RhbC5maW5kKCcucG9zc2libGVfYW5zd2Vyc19fZmlyc3Qtcm93LWhlYWRlcnMgaW5wdXQnKS5wcm9wKCdjaGVja2VkJywgdHJ1ZSk7XG5cbiAgICAgICAgICAgICAgICBtb2RhbC5maW5kKCcucG9zc2libGVfYW5zd2Vyc19fYXBwZW5kLW9yLXJlcGxhY2UgaW5wdXQjcmVwbGFjZScpLnByb3AoJ2NoZWNrZWQnLCB0cnVlKTtcblxuICAgICAgICAgICAgICAgIC8vZGlzYWJsZSBpbXBvcnQgYnV0dG9uXG4gICAgICAgICAgICAgICAgbW9kYWwuZmluZCgnLnBvc3NpYmxlX2Fuc3dlcnMtcGVyZm9ybS1pbXBvcnQnKS5hdHRyKCdkaXNhYmxlZCcsIHRydWUpO1xuXG4gICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLm92ZXJsYXkuZmFkZU91dChjb25zdHMuQU5JTUFUSU9OX0ZBU1QpO1xuXG4gICAgICAgICAgICAgICAgLy9zaG93IGxpc3Qgb2YgaGVhZGVycyBzbyB0aGUgdXNlciBjYW4gc2VsZWN0IHdoaWNoIGNvbHVtbiB0byB1c2VcbiAgICAgICAgICAgICAgICAvL2dlbmVyYXRlIGxpc3QgaXRlbXNcbiAgICAgICAgICAgICAgICAkKGhlYWRlcnMpLmVhY2goZnVuY3Rpb24gKGhlYWRlckluZGV4LCBoZWFkZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uX2l0ZW1zICs9ICc8bGk+JztcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uX2l0ZW1zICs9ICc8YSBocmVmPVwiI1wiPicgKyBoZWFkZXIudHJ1bmMoMjUpICsgJzwvYT4nO1xuICAgICAgICAgICAgICAgICAgICBjb2x1bW5faXRlbXMgKz0gJzwvbGk+JztcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIC8vYXBwZW5kIGl0ZW1zXG4gICAgICAgICAgICAgICAgY29sdW1uX3BpY2tlci5maW5kKCcuZHJvcGRvd24tbWVudScpLmVtcHR5KCkuYXBwZW5kKGNvbHVtbl9pdGVtcyk7XG5cbiAgICAgICAgICAgICAgICAvL3Nob3cgc2VsZWN0ZWQgY29sdW4gaW4gZHJvcGRvd24gcGlja2VyXG4gICAgICAgICAgICAgICAgY29sdW1uX3BpY2tlci5maW5kKCcuZHJvcGRvd24tbWVudSBsaScpLm9mZigpLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5wYXJlbnRzKCcucG9zc2libGUtYW5zd2Vycy1jb2x1bW4tcGlja2VyJykuZmluZCgnLmJ0bicpLmh0bWwoJCh0aGlzKS50ZXh0KCkgKyAnIDxzcGFuIGNsYXNzPVwiY2FyZXRcIj48L3NwYW4+Jyk7XG4gICAgICAgICAgICAgICAgICAgICQodGhpcykucGFyZW50cygnLnBvc3NpYmxlLWFuc3dlcnMtY29sdW1uLXBpY2tlcicpLmZpbmQoJy5idG4nKS52YWwoJCh0aGlzKS5kYXRhKCd2YWx1ZScpKTtcblxuICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZEhlYWRlckluZGV4ID0gJCh0aGlzKS5pbmRleCgpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vZW5hYmxlIGltcG9ydCBidXR0b25cbiAgICAgICAgICAgICAgICAgICAgbW9kYWwuZmluZCgnLnBvc3NpYmxlX2Fuc3dlcnMtcGVyZm9ybS1pbXBvcnQnKS5hdHRyKCdkaXNhYmxlZCcsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuXG4gICAgICAgICAgICAgICAgJCgnLnBvc3NpYmxlX2Fuc3dlcnMtcGVyZm9ybS1pbXBvcnQnKS5vZmYoKS5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgLy9zaG93IG92ZXJsYXkgYW5kIGN1cnNvclxuICAgICAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5kb20ub3ZlcmxheS5mYWRlSW4oMCk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy9nZXQgcGFyYW1ldGVycyBmcm9tIG1vZGFsXG4gICAgICAgICAgICAgICAgICAgIHVzZXJXYW50c3RvUmVwbGFjZUFuc3dlcnMgPSBtb2RhbC5maW5kKCcucG9zc2libGVfYW5zd2Vyc19fYXBwZW5kLW9yLXJlcGxhY2UnKS5maW5kKCcjcmVwbGFjZScpLmlzKCc6Y2hlY2tlZCcpO1xuICAgICAgICAgICAgICAgICAgICBkb2VzRmlyc3RSb3dDb250YWluc0hlYWRlcnMgPSBtb2RhbC5maW5kKCcucG9zc2libGVfYW5zd2Vyc19fZmlyc3Qtcm93LWhlYWRlcnMnKS5maW5kKCcuY2hlY2tib3ggaW5wdXQnKS5pcygnOmNoZWNrZWQnKTtcblxuICAgICAgICAgICAgICAgICAgICAvL2FkZCBjYWxsYmFjayB0byBoYW5kbGUgdGhlIGltcG9ydFxuICAgICAgICAgICAgICAgICAgICBwYXJhbXMgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VyV2FudHN0b1JlcGxhY2VBbnN3ZXJzOiB1c2VyV2FudHN0b1JlcGxhY2VBbnN3ZXJzLFxuICAgICAgICAgICAgICAgICAgICAgICAgZG9lc0ZpcnN0Um93Q29udGFpbnNIZWFkZXJzOiBkb2VzRmlyc3RSb3dDb250YWluc0hlYWRlcnMsXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnB1dDogaW5wdXQsXG4gICAgICAgICAgICAgICAgICAgICAgICBpbXBvcnRlZEpzb246IGpzb24sXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZEhlYWRlckluZGV4OiBzZWxlY3RlZEhlYWRlckluZGV4XG4gICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbmZpcm1faW1wb3J0X2NhbGxiYWNrKHBhcmFtcykpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgbW9kYWwubW9kYWwoJ2hpZGUnKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy9pZiBtYXggbnVtYmVyIG9mIGFsbG93ZWQgcG9zc2libGUgYW5zd2VycyByZWFjaGVkLCBkaXNhYmxlIFwiQWRkIGFuc3dlclwiIGJ1dHRvblxuICAgICAgICAgICAgICAgICAgICAgICAgdWkuaW5wdXRfcHJvcGVydGllc19wYW5lbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50b2dnbGVBZGRBbnN3ZXJCdG4oaW5wdXQucG9zc2libGVfYW5zd2Vycy5sZW5ndGggPj0gcG9zc2libGVfYW5zd2Vyc19tYXgpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvL3JlY2FsY3VsYXRlIHBhZ2luYXRpb25cbiAgICAgICAgICAgICAgICAgICAgICAgIHBvc3NpYmxlX2Fuc3dlcnNfcGFnZXIucmVjYWxjdWxhdGVQYWdpbmF0aW9uKGlucHV0KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy9lbmFibGUgc2F2ZSBwcm9qZWN0IGJ1dHRvbiBpZiBhbGwgaW5wdXRzIGFyZSB2YWxpZFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZhbGlkYXRpb24uYXJlQWxsSW5wdXRzVmFsaWQoZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vZW5hYmxlIHNhdmUgcHJvamVjdCBidXR0b24gKGlmIGRpc2FibGVkKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpLm5hdmJhci50b2dnbGVTYXZlUHJvamVjdEJ0bihjb25zdHMuQlROX0VOQUJMRUQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5zYXZlX3Byb2plY3RfYnRuLm9mZigpLm9uKCdjbGljaycsIHNhdmVfcHJvamVjdF9jbGlja19jYWxsYmFjayk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vaGlkZSBvdmVybGF5XG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLm92ZXJsYXkuZmFkZU91dChjb25zdHMuQU5JTUFUSU9OX0ZBU1QpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9zaG93IHRvYXN0IGNvbmZpcm1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b2FzdC5zaG93U3VjY2VzcyhtZXNzYWdlcy5zdWNjZXNzLlBPU1NJQkxFX0FOU1dFUlNfSU1QT1JURUQpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9wdXNoIHN0YXRlIHRvIGVuYWJsZSB1bmRvaW5nIHRoZSBhY3Rpb24gKHR5cGluZykgcGFzc2luZyBcInRydWVcIiBzbyBpdCBnZXRzIGEgYml0IG9mIHRocm90dGxpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bmRvLnB1c2hTdGF0ZShmYWxzZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGNvbnN0cy5BTklNQVRJT05fU1VQRVJfU0xPVyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9oaWRlIG92ZXJsYXlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5kb20ub3ZlcmxheS5mYWRlT3V0KGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9zaG93IGVycm9yL3dhcm5pbmdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b2FzdC5zaG93RXJyb3IobWVzc2FnZXMuZXJyb3IuUE9TU0lCTEVfQU5TV0VSU19JTlZBTElEKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGNvbnN0cy5BTklNQVRJT05fU1VQRVJfU0xPVyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvL2FkZCBldmVudHMgdG8gaGlkZSB0aGUgbW9kYWwgbWFudWFsbHkgKHdhcyBudCB3b3JraW5nLCBnbyBmaWd1cmUpXG4gICAgICAgICAgICBtb2RhbC5maW5kKCdidXR0b25bZGF0YS1kaXNtaXNzPVwibW9kYWxcIl0nKS5vbmUoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIG1vZGFsLm1vZGFsKCdoaWRlJyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICByZWFkZXIucmVhZEFzVGV4dChmaWxlKTtcbiAgICB9LFxuXG4gICAgb3JkZXJQb3NzaWJsZUFuc3dlcnM6IGZ1bmN0aW9uIChvcmRlcl90eXBlKSB7XG4gICAgICAgIC8vZ2V0IGN1cnJlbnQgaW5wdXQgb2JqZWN0XG4gICAgICAgIHZhciBpbnB1dCA9IHV0aWxzLmdldEFjdGl2ZUlucHV0KCk7XG4gICAgICAgIHZhciBwb3NzaWJsZV9hbnN3ZXJzID0gaW5wdXQucG9zc2libGVfYW5zd2VycztcblxuICAgICAgICBmb3JtYnVpbGRlci5wb3NzaWJsZV9hbnN3ZXJzX3BhZ2luYXRpb25baW5wdXQucmVmXS5wYWdlID0gMTtcbiAgICAgICAgLy9zaG93IG92ZXJsYXkgYW5kIGN1cnNvclxuICAgICAgICBmb3JtYnVpbGRlci5kb20ub3ZlcmxheS5mYWRlSW4oMCk7XG5cbiAgICAgICAgc3dpdGNoKG9yZGVyX3R5cGUpIHtcbiAgICAgICAgICAgIC8vb3JkZXIgQSAtIFogZm9yIFVURi04IGxhbmd1YWdlc1xuICAgICAgICAgICAgY2FzZSBjb25zdHMuUE9TU0lCTEVfQU5TV0VSU19PUkRFUi5BWjpcbiAgICAgICAgICAgICAgICBwb3NzaWJsZV9hbnN3ZXJzID0gcG9zc2libGVfYW5zd2Vycy5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhLmFuc3dlci5sb2NhbGVDb21wYXJlKGIuYW5zd2VyLCB1bmRlZmluZWQsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlnbm9yZVB1bmN0dWF0aW9uOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgbnVtZXJpYzp0cnVlXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgLy9vcmRlciBaIC0gQSBmb3IgVVRGLTggbGFuZ3VhZ2VzXG4gICAgICAgICAgICBjYXNlIGNvbnN0cy5QT1NTSUJMRV9BTlNXRVJTX09SREVSLlpBOlxuICAgICAgICAgICAgICAgIHBvc3NpYmxlX2Fuc3dlcnMgPSBwb3NzaWJsZV9hbnN3ZXJzLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGIuYW5zd2VyLmxvY2FsZUNvbXBhcmUoYS5hbnN3ZXIsIHVuZGVmaW5lZCwge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWdub3JlUHVuY3R1YXRpb246IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBudW1lcmljOnRydWVcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGNvbnN0cy5QT1NTSUJMRV9BTlNXRVJTX09SREVSLlNIVUZGTEU6XG4gICAgICAgICAgICAgICAgcG9zc2libGVfYW5zd2VycyA9IHV0aWxzLnNodWZmbGVBcnJheShwb3NzaWJsZV9hbnN3ZXJzKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBvcmRlcmVkX2xpc3RfaHRtbCA9IGdldFBvc3NpYmxlQW5zd2Vyc0xpc3QocG9zc2libGVfYW5zd2Vycyk7XG4gICAgICAgIHZhciBwb3NzaWJsZV9hbnN3ZXJzX2xpc3Q7XG4gICAgICAgIHZhciBwcm9wZXJ0aWVzX3BhbmVsID0gZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlci5maW5kKCdmb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIGlucHV0LnJlZiArICdcIl0nKTtcblxuICAgICAgICBwb3NzaWJsZV9hbnN3ZXJzX2xpc3QgPSBwcm9wZXJ0aWVzX3BhbmVsXG4gICAgICAgICAgICAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX3Bvc3NpYmxlLWFuc3dlcnMgZGl2IHVsLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX3Bvc3NpYmxlLWFuc3dlcnNfX2xpc3QnKTtcblxuICAgICAgICAvL3JlbW92ZSBjdXJyZW50IGFuc3dlcnMgZnJvbSBkb20gYW5kIGFwcGVuZCBvcmRlcmVkIG9uZXNcbiAgICAgICAgcG9zc2libGVfYW5zd2Vyc19saXN0XG4gICAgICAgICAgICAuZW1wdHkoKVxuICAgICAgICAgICAgLmhpZGUoKVxuICAgICAgICAgICAgLmFwcGVuZChvcmRlcmVkX2xpc3RfaHRtbClcbiAgICAgICAgICAgIC5mYWRlSW4oY29uc3RzLkFOSU1BVElPTl9GQVNUKTtcblxuICAgICAgICAvL3JlY2FsY3VsYXRlIHBhZ2luYXRpb25cbiAgICAgICAgcG9zc2libGVfYW5zd2Vyc19wYWdlci5yZWNhbGN1bGF0ZVBhZ2luYXRpb24oaW5wdXQpO1xuXG4gICAgICAgIC8vcHVzaCBzdGF0ZSB0byBlbmFibGUgdW5kb2luZyB0aGUgYWN0aW9uICh0eXBpbmcpIHBhc3NpbmcgXCJ0cnVlXCIgc28gaXQgZ2V0cyBhIGJpdCBvZiB0aHJvdHRsaW5nXG4gICAgICAgIHVuZG8ucHVzaFN0YXRlKGZhbHNlKTtcblxuICAgICAgICAvL2VuYWJsZSBzYXZlIHByb2plY3QgYnV0dG9uIGFzIHVzZXIgbWFkZSBhIGNoYW5nZVxuICAgICAgICB1aS5uYXZiYXIudG9nZ2xlU2F2ZVByb2plY3RCdG4oY29uc3RzLkJUTl9FTkFCTEVEKTtcbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLnNhdmVfcHJvamVjdF9idG4ub2ZmKCkub24oJ2NsaWNrJywgc2F2ZV9wcm9qZWN0X2NsaWNrX2NhbGxiYWNrKTtcblxuICAgICAgICAvL2hpZGUgb3ZlcmxheVxuICAgICAgICB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20ub3ZlcmxheS5mYWRlT3V0KGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG4gICAgICAgIH0sIGNvbnN0cy5BTklNQVRJT05fU1VQRVJfU0xPVyk7XG5cbiAgICB9LFxuXG4gICAgZGVsZXRlQWxsQW5zd2VyczogZnVuY3Rpb24gKCkge1xuXG4gICAgICAgIHZhciBpbnB1dDtcbiAgICAgICAgdmFyIGFuc3dlcl9yZWYgPSB1dGlscy5nZW5lcmF0ZVVuaXFJRCgpO1xuICAgICAgICB2YXIgdW5kbyA9IHJlcXVpcmUoJ2FjdGlvbnMvdW5kbycpOy8vaXQgaXMgaGVyZSBvdGhlcndpc2UgaXQgYnJlYWtzIHdoZW4gY29tcGlsaW5nLi4uZ28gZmlndXJlPz9cblxuICAgICAgICAvL3Nob3cgb3ZlcmxheSBhbmQgY3Vyc29yXG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5vdmVybGF5LmZhZGVJbigwKTtcblxuICAgICAgICAvL2dldCBjdXJyZW50IGlucHV0IG9iamVjdFxuICAgICAgICBpbnB1dCA9IHV0aWxzLmdldEFjdGl2ZUlucHV0KCk7XG5cbiAgICAgICAgdmFyIHBvc3NpYmxlX2Fuc3dlcnNfbGlzdDtcbiAgICAgICAgdmFyIGxpc3RfaXRlbSA9IGZvcm1idWlsZGVyLmRvbS5wYXJ0aWFscy5wb3NzaWJsZV9hbnN3ZXJfbGlzdF9pdGVtO1xuICAgICAgICB2YXIgcHJvcGVydGllc19wYW5lbCA9IGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXIuZmluZCgnZm9ybVtkYXRhLWlucHV0LXJlZj1cIicgKyBpbnB1dC5yZWYgKyAnXCJdJyk7XG5cbiAgICAgICAgcG9zc2libGVfYW5zd2Vyc19saXN0ID0gcHJvcGVydGllc19wYW5lbFxuICAgICAgICAgICAgLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19wb3NzaWJsZS1hbnN3ZXJzIGRpdiB1bC5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19wb3NzaWJsZS1hbnN3ZXJzX19saXN0Jyk7XG5cbiAgICAgICAgbGlzdF9pdGVtID0gbGlzdF9pdGVtLnJlcGxhY2UoJ3t7YW5zd2VyfX0nLCBjb25zdHMuUE9TU0lCSUxFX0FOU1dFUl9QTEFDRUhPTERFUik7XG4gICAgICAgIGxpc3RfaXRlbSA9IGxpc3RfaXRlbS5yZXBsYWNlKCd7e2Fuc3dlci1yZWZ9fScsIGFuc3dlcl9yZWYpO1xuICAgICAgICBsaXN0X2l0ZW0gPSBsaXN0X2l0ZW0ucmVwbGFjZSgne3tkaXNhYmxlZH19JywgY29uc3RzLkRJU0FCTEVEX1NUQVRFKTtcblxuXG4gICAgICAgIC8vbG9hZCBodG1sIHNuaXBwZXQgYmFzZWQgb24gaW5wdXQgdHlwZVxuICAgICAgICBwb3NzaWJsZV9hbnN3ZXJzX2xpc3QuZW1wdHkoKS5oaWRlKCkuYXBwZW5kKGxpc3RfaXRlbSkuZmFkZUluKGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG5cbiAgICAgICAgLy9yZXNldCBhcnJheSBvZiBwb3NzaWJsZSBhbnN3ZXJzIHRvIDEgc2luZ2xlIGRlZmF1bHQgZWxlbWVudFxuICAgICAgICBpbnB1dC5wb3NzaWJsZV9hbnN3ZXJzID0gW3tcbiAgICAgICAgICAgIGFuc3dlcl9yZWY6IHV0aWxzLmdlbmVyYXRlVW5pcUlEKCksXG4gICAgICAgICAgICBhbnN3ZXI6IGNvbnN0cy5QT1NTSUJJTEVfQU5TV0VSX1BMQUNFSE9MREVSXG4gICAgICAgIH1dO1xuXG4gICAgICAgIC8vcHVzaCBzdGF0ZSB0byBlbmFibGUgdW5kb2luZyB0aGUgYWN0aW9uICh0eXBpbmcpIHBhc3NpbmcgXCJ0cnVlXCIgc28gaXQgZ2V0cyBhIGJpdCBvZiB0aHJvdHRsaW5nXG4gICAgICAgIHVuZG8ucHVzaFN0YXRlKGZhbHNlKTtcblxuICAgICAgICAvL2VuYWJsZSBzYXZlIHByb2plY3QgYnV0dG9uIChpZiBkaXNhYmxlZClcbiAgICAgICAgdWkubmF2YmFyLnRvZ2dsZVNhdmVQcm9qZWN0QnRuKGNvbnN0cy5CVE5fRU5BQkxFRCk7XG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5zYXZlX3Byb2plY3RfYnRuLm9mZigpLm9uKCdjbGljaycsIHNhdmVfcHJvamVjdF9jbGlja19jYWxsYmFjayk7XG5cbiAgICAgICAgLy9lbmFibGUgYWRkIGFuc3dlciBidXR0b25cbiAgICAgICAgdWkuaW5wdXRfcHJvcGVydGllc19wYW5lbC50b2dnbGVBZGRBbnN3ZXJCdG4oZmFsc2UpO1xuXG4gICAgICAgIC8vcmVzZXQgcGFnaW5hdGlvblxuICAgICAgICBwb3NzaWJsZV9hbnN3ZXJzX3BhZ2VyLnRlYXJEb3duKGlucHV0KTtcblxuICAgICAgICAvL2hpZGUgb3ZlcmxheVxuICAgICAgICB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20ub3ZlcmxheS5mYWRlT3V0KGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG4gICAgICAgIH0sIGNvbnN0cy5BTklNQVRJT05fU1VQRVJfU0xPVyk7XG4gICAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBwb3NzaWJsZV9hbnN3ZXJzO1xuIiwiLyogZ2xvYmFsICQqL1xuJ3VzZSBzdHJpY3QnO1xudmFyIHNhdmVBbGxJbnB1dFByb3BlcnRpZXMgPSByZXF1aXJlKCdhY3Rpb25zL3NhdmUvbW9kdWxlLnNhdmVBbGxJbnB1dFByb3BlcnRpZXMnKTtcbnZhciBzYXZlUHJvcGVydGllcyA9IHJlcXVpcmUoJ2FjdGlvbnMvc2F2ZS9tb2R1bGUuc2F2ZVByb3BlcnRpZXMnKTtcbnZhciBzYXZlUG9zc2libGVBbnN3ZXJzID0gcmVxdWlyZSgnYWN0aW9ucy9zYXZlL21vZHVsZS5zYXZlUG9zc2libGVBbnN3ZXJzJyk7XG52YXIgc2F2ZUFkdmFuY2VkUHJvcGVydGllcyA9IHJlcXVpcmUoJ2FjdGlvbnMvc2F2ZS9tb2R1bGUuc2F2ZUFkdmFuY2VkUHJvcGVydGllcycpO1xudmFyIHNhdmVKdW1wcyA9IHJlcXVpcmUoJ2FjdGlvbnMvc2F2ZS9tb2R1bGUuc2F2ZUp1bXBzJyk7XG52YXIgc2F2ZVVuaXF1ZW5lc3MgPSByZXF1aXJlKCdhY3Rpb25zL3NhdmUvbW9kdWxlLnNhdmVVbmlxdWVuZXNzJyk7XG52YXIgZG9DbGVhbmluZ0JlZm9yZVNhdmluZyA9IHJlcXVpcmUoJ2FjdGlvbnMvc2F2ZS9tb2R1bGUuZG9DbGVhbmluZ0JlZm9yZVNhdmluZycpO1xuXG52YXIgc2F2ZSA9IHtcblxuICAgIHNhdmVVbmlxdWVuZXNzOiBmdW5jdGlvbiAodGhlX2lucHV0KSB7XG4gICAgICAgIHJldHVybiBzYXZlVW5pcXVlbmVzcyh0aGVfaW5wdXQpO1xuICAgIH0sXG4gICAgc2F2ZUFsbElucHV0UHJvcGVydGllczogZnVuY3Rpb24gKHRoZV9pbnB1dCkge1xuICAgICAgICByZXR1cm4gc2F2ZUFsbElucHV0UHJvcGVydGllcyh0aGVfaW5wdXQpO1xuICAgIH0sXG4gICAgc2F2ZVByb3BlcnRpZXM6IGZ1bmN0aW9uICh0aGVfaW5wdXQpIHtcbiAgICAgICAgcmV0dXJuIHNhdmVQcm9wZXJ0aWVzKHRoZV9pbnB1dCk7XG4gICAgfSxcbiAgICBzYXZlUG9zc2libGVBbnN3ZXJzOiBmdW5jdGlvbiAodGhlX2lucHV0KSB7XG4gICAgICAgIHJldHVybiBzYXZlUG9zc2libGVBbnN3ZXJzKHRoZV9pbnB1dCk7XG4gICAgfSxcbiAgICBzYXZlQWR2YW5jZWRQcm9wZXJ0aWVzOiBmdW5jdGlvbiAodGhlX2lucHV0KSB7XG4gICAgICAgIHJldHVybiBzYXZlQWR2YW5jZWRQcm9wZXJ0aWVzKHRoZV9pbnB1dCk7XG4gICAgfSxcbiAgICBzYXZlSnVtcHM6IGZ1bmN0aW9uICh0aGVfaW5wdXQpIHtcbiAgICAgICAgcmV0dXJuIHNhdmVKdW1wcyh0aGVfaW5wdXQpO1xuICAgIH0sXG4gICAgZG9DbGVhbmluZ0JlZm9yZVNhdmluZzogZnVuY3Rpb24gKHRoZV9mb3Jtcykge1xuICAgICAgICByZXR1cm4gZG9DbGVhbmluZ0JlZm9yZVNhdmluZyh0aGVfZm9ybXMpO1xuICAgIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gc2F2ZTtcbiIsIi8qIGdsb2JhbCAkKi9cbid1c2Ugc3RyaWN0JztcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoJ2hlbHBlcnMvdXRpbHMnKTtcblxuXG52YXIgZG9DbGVhbmluZ0JlZm9yZVNhdmluZyA9IGZ1bmN0aW9uIChmb3Jtcykge1xuXG4gICAgdmFyIGludmFsaWRfanVtcHNfcXVlc3Rpb24gPSAnJztcbiAgICB2YXIgYWxsX2p1bXBzX3ZhbGlkID0gdHJ1ZTtcblxuICAgICQoZm9ybXMpLmVhY2goZnVuY3Rpb24gKGluZGV4LCBmb3JtKSB7XG4gICAgICAgICQoZm9ybS5pbnB1dHMpLmVhY2goZnVuY3Rpb24gKGlucHV0SW5kZXgsIGlucHV0KSB7XG5cbiAgICAgICAgICAgIC8vcmVtb3ZlIFdvcmQgVW5pY29kZSBjaGFycyBmcm9tIHF1ZXN0aW9uIChpZiBhbnkpXG4gICAgICAgICAgICBmb3JtLmlucHV0c1tpbnB1dEluZGV4XS5xdWVzdGlvbiA9IHV0aWxzLnJlcGxhY2VXb3JkQ2hhcnMoaW5wdXQucXVlc3Rpb24pO1xuXG4gICAgICAgICAgICAvL2dldCB2YWxpZCBqdW1wIGRlc3RpbmF0aW9uc1xuICAgICAgICAgICAgdmFyIGp1bXBfZGVzdGluYXRpb25zID0gdXRpbHMuZ2V0SnVtcEF2YWlsYWJsZURlc3RpbmF0aW9uc0FzS2V5cyhpbnB1dEluZGV4LCBpbnB1dCwgZm9ybS5pbnB1dHMsIGZhbHNlKTtcblxuICAgICAgICAgICAgLy9leHRyYSB2YWxpZGF0aW9uIGZvciBqdW1wcywgY2hlY2sgaWYgdGhlIGRlc3RpbmF0aW9uIHN0aWxsIGV4aXN0cyBhbmQgaXQgaXMgdmFsaWRcbiAgICAgICAgICAgICQoaW5wdXQuanVtcHMpLmVhY2goZnVuY3Rpb24gKGp1bXBJbmRleCwganVtcCkge1xuICAgICAgICAgICAgICAgIC8vZG9lcyB0aGUganVtcCBcInRvXCIgcHJvcGVydHkgcmVmZXJlbmNlIGEgdmFsaWQgZGVzdGluYXRpb24gaW5wdXQ/XG4gICAgICAgICAgICAgICAgLy8vL3Rlc3Q6IHNjcmV3IHVwIHRoZSBqdW1wLnRvXG4gICAgICAgICAgICAgICAgLy8ganVtcC50byA9ICdzZmRnZyc7XG5cbiAgICAgICAgICAgICAgICBpZiAoIWp1bXBfZGVzdGluYXRpb25zW2p1bXAudG9dKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vaW52YWxpZCBkZXN0aW5hdGlvbiBmb3VuZFxuICAgICAgICAgICAgICAgICAgICBpbnZhbGlkX2p1bXBzX3F1ZXN0aW9uID0gaW5wdXQucXVlc3Rpb247XG4gICAgICAgICAgICAgICAgICAgIGFsbF9qdW1wc192YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vcmVtb3ZlIGFueSBsZWZ0b3ZlciBleHRyYSBwcm9wZXJ0eSBmcm9tIGp1bXAgKGlmIGFueSlcbiAgICAgICAgICAgICAgICAvL2hhY2sgdG8gYXZvaWQgaHVnZSByZWZhY3RvcmluZyBhbmQgdGVzdGluZyA7KVxuICAgICAgICAgICAgICAgIGlucHV0Lmp1bXBzW2p1bXBJbmRleF0gPSB7XG4gICAgICAgICAgICAgICAgICAgIHRvOiBqdW1wLnRvLFxuICAgICAgICAgICAgICAgICAgICB3aGVuOiBqdW1wLndoZW4sXG4gICAgICAgICAgICAgICAgICAgIGFuc3dlcl9yZWY6IGp1bXAuYW5zd2VyX3JlZlxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgJChpbnB1dC5icmFuY2gpLmVhY2goZnVuY3Rpb24gKGJyYW5jaElucHV0SW5kZXgsIGJyYW5jaF9pbnB1dCkge1xuICAgICAgICAgICAgICAgIGRlbGV0ZSBicmFuY2hfaW5wdXQuZG9tO1xuXG4gICAgICAgICAgICAgICAgLy9yZW1vdmUgV29yZCBVbmljb2RlIGNoYXJzIGZyb20gcXVlc3Rpb24gKGlmIGFueSlcbiAgICAgICAgICAgICAgICBpbnB1dC5icmFuY2hbYnJhbmNoSW5wdXRJbmRleF0ucXVlc3Rpb24gPSB1dGlscy5yZXBsYWNlV29yZENoYXJzKGJyYW5jaF9pbnB1dC5xdWVzdGlvbik7XG5cbiAgICAgICAgICAgICAgICAvL3RvZG8gdmFsaWRhdGUgYnJhbmNoIGp1bXBzXG4gICAgICAgICAgICAgICAganVtcF9kZXN0aW5hdGlvbnMgPSB1dGlscy5nZXRKdW1wQXZhaWxhYmxlRGVzdGluYXRpb25zQXNLZXlzKGJyYW5jaElucHV0SW5kZXgsIGJyYW5jaF9pbnB1dCwgaW5wdXQuYnJhbmNoLCB0cnVlKTtcblxuICAgICAgICAgICAgICAgIC8vZXh0cmEgdmFsaWRhdGlvbiBmb3IganVtcHMsIGNoZWNrIGlmIHRoZSBkZXN0aW5hdGlvbiBzdGlsbCBleGlzdHMgYW5kIGl0IGlzIHZhbGlkXG4gICAgICAgICAgICAgICAgJChicmFuY2hfaW5wdXQuanVtcHMpLmVhY2goZnVuY3Rpb24gKGJyYW5jaEp1bXBJbmRleCwgYnJhbmNoSnVtcCkge1xuICAgICAgICAgICAgICAgICAgICAvL2RvZXMgdGhlIGp1bXAgXCJ0b1wiIHByb3BlcnR5IHJlZmVyZW5jZSBhIHZhbGlkIGRlc3RpbmF0aW9uIGlucHV0P1xuICAgICAgICAgICAgICAgICAgICAvLy8vdGVzdDogc2NyZXcgdXAgdGhlIGp1bXAudG9cbiAgICAgICAgICAgICAgICAgICAgLy8gYnJhbmNoSnVtcC50byA9ICdzZmRnZyc7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCFqdW1wX2Rlc3RpbmF0aW9uc1ticmFuY2hKdW1wLnRvXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9pbnZhbGlkIGRlc3RpbmF0aW9uIGZvdW5kXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnZhbGlkX2p1bXBzX3F1ZXN0aW9uID0gJyAoYnJhbmNoKSAnICsgYnJhbmNoX2lucHV0LnF1ZXN0aW9uO1xuICAgICAgICAgICAgICAgICAgICAgICAgYWxsX2p1bXBzX3ZhbGlkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvL3JlbW92ZSBhbnkgbGVmdG92ZXIgZXh0cmEgcHJvcGVydHkgZnJvbSBqdW1wIChpZiBhbnkpXG4gICAgICAgICAgICAgICAgICAgIC8vaGFjayB0byBhdm9pZCBodWdlIHJlZmFjdG9yaW5nIGFuZCB0ZXN0aW5nIDspXG4gICAgICAgICAgICAgICAgICAgIGJyYW5jaF9pbnB1dC5qdW1wc1ticmFuY2hKdW1wSW5kZXhdID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdG86IGJyYW5jaEp1bXAudG8sXG4gICAgICAgICAgICAgICAgICAgICAgICB3aGVuOiBicmFuY2hKdW1wLndoZW4sXG4gICAgICAgICAgICAgICAgICAgICAgICBhbnN3ZXJfcmVmOiBicmFuY2hKdW1wLmFuc3dlcl9yZWZcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICQoYnJhbmNoX2lucHV0Lmdyb3VwKS5lYWNoKGZ1bmN0aW9uIChpbmRleCwgZ3JvdXBfaW5wdXQpIHtcblxuICAgICAgICAgICAgICAgICAgICAvL3JlbW92ZSBXb3JkIFVuaWNvZGUgY2hhcnMgZnJvbSBxdWVzdGlvbiAoaWYgYW55KVxuICAgICAgICAgICAgICAgICAgICBicmFuY2hfaW5wdXQuZ3JvdXBbaW5kZXhdLnF1ZXN0aW9uID0gdXRpbHMucmVwbGFjZVdvcmRDaGFycyhncm91cF9pbnB1dC5xdWVzdGlvbik7XG5cbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGdyb3VwX2lucHV0LmRvbTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgJChpbnB1dC5ncm91cCkuZWFjaChmdW5jdGlvbiAoaW5kZXgsIGdyb3VwX2lucHV0KSB7XG5cbiAgICAgICAgICAgICAgICAvL3JlbW92ZSBXb3JkIFVuaWNvZGUgY2hhcnMgZnJvbSBxdWVzdGlvbiAoaWYgYW55KVxuICAgICAgICAgICAgICAgIGlucHV0Lmdyb3VwW2luZGV4XS5xdWVzdGlvbiA9IHV0aWxzLnJlcGxhY2VXb3JkQ2hhcnMoZ3JvdXBfaW5wdXQucXVlc3Rpb24pO1xuXG4gICAgICAgICAgICAgICAgZGVsZXRlIGdyb3VwX2lucHV0LmRvbTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJyBkZWxldGUgaW5wdXQuZG9tOyBjYWxsZWQgKioqKioqKicpO1xuICAgICAgICAgICAgZGVsZXRlIGlucHV0LmRvbTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBpbnZhbGlkX2p1bXBzX3F1ZXN0aW9uOiBpbnZhbGlkX2p1bXBzX3F1ZXN0aW9uLFxuICAgICAgICBhbGxfanVtcHNfdmFsaWQ6IGFsbF9qdW1wc192YWxpZFxuICAgIH07XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGRvQ2xlYW5pbmdCZWZvcmVTYXZpbmc7XG4iLCIvKiBnbG9iYWwgJCovXG4ndXNlIHN0cmljdCc7XG52YXIgY29uc3RzID0gcmVxdWlyZSgnY29uZmlnL2NvbnN0cycpO1xudmFyIGZvcm1idWlsZGVyID0gcmVxdWlyZSgnY29uZmlnL2Zvcm1idWlsZGVyJyk7XG5cblxudmFyIHNhdmVBZHZhbmNlZFByb3BlcnRpZXMgPSBmdW5jdGlvbiAoaW5wdXQpIHtcblxuICAgIHZhciBzYXZlID0gcmVxdWlyZSgnYWN0aW9ucy9zYXZlJyk7XG4gICAgdmFyIGluaXRpYWxfYW5zd2VyX3ZhbGlkYXRpb247XG5cbiAgICBpbnB1dC5kb20uYWR2YW5jZWRfcHJvcGVydGllc193cmFwcGVyID0gZm9ybWJ1aWxkZXJcbiAgICAgICAgLmRvbVxuICAgICAgICAuaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyXG4gICAgICAgIC5maW5kKCdmb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIGlucHV0LnJlZiArICdcIl0nKVxuICAgICAgICAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2FkdmFuY2VkLXByb3BlcnRpZXMnKTtcblxuICAgIC8vY2xlYXIgYWxsIGFkdmFuY2VkIHByb3BlcnRpZXMgZXJyb3JzIGZyb20gZG9tXG4gICAgaW5wdXQuaGlkZUFkdmFuY2VkUHJvcGVydGllc0Vycm9ycygpO1xuXG5cbiAgICAvL3NldCBwcm9wZXJ0aWVzIGJ1dCBza2lwIGlmIGl0IGlzIGEgcmVhZG1lXG4gICAgaWYgKGlucHV0LnR5cGUgIT09IGNvbnN0cy5SRUFETUVfVFlQRSkge1xuICAgICAgICAvL3NldCBkZWZhdWx0XG4gICAgICAgIGlucHV0LmRlZmF1bHQgPSBpbnB1dC5kb20uYWR2YW5jZWRfcHJvcGVydGllc193cmFwcGVyLmZpbmQoJ2Rpdi5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19hZHZhbmNlZC1wcm9wZXJ0aWVzX19kZWZhdWx0IGlucHV0JykudmFsKCk7XG4gICAgICAgIGlucHV0LmRlZmF1bHQgPSBpbnB1dC5kZWZhdWx0ID09PSAnJyA/IG51bGwgOiBpbnB1dC5kZWZhdWx0O1xuXG4gICAgICAgIC8vc3RyaXAgaHRtbCB0YWdzIGFuZCByZXNldCBpbnB1dCB0byBzYW5pdGlzZWQgdmFsdWVcbiAgICAgICAgaWYgKGlucHV0LmRlZmF1bHQpIHtcbiAgICAgICAgICAgIGlucHV0LmRlZmF1bHQgPSBpbnB1dC5kZWZhdWx0LnJlcGxhY2UoLyg8KFtePl0rKT4pL2lnLCAnJyk7XG4gICAgICAgICAgICBpbnB1dC5kb20uYWR2YW5jZWRfcHJvcGVydGllc193cmFwcGVyLmZpbmQoJ2Rpdi5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19hZHZhbmNlZC1wcm9wZXJ0aWVzX19kZWZhdWx0IGlucHV0JykudmFsKGlucHV0LmRlZmF1bHQpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9zZXQgcmVnZXhcbiAgICAgICAgaW5wdXQucmVnZXggPSBpbnB1dC5kb20uYWR2YW5jZWRfcHJvcGVydGllc193cmFwcGVyLmZpbmQoJ2Rpdi5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19hZHZhbmNlZC1wcm9wZXJ0aWVzX19yZWdleCBpbnB1dCcpLnZhbCgpO1xuICAgICAgICBpbnB1dC5yZWdleCA9IGlucHV0LnJlZ2V4ID09PSAnJyA/IG51bGwgOiBpbnB1dC5yZWdleDtcblxuICAgICAgICAvL3N0cmlwIGh0bWwgdGFncyBhbmQgcmVzZXQgaW5wdXQgdG8gc2FuaXRpc2VkIHZhbHVlXG4gICAgICAgIGlmIChpbnB1dC5yZWdleCkge1xuICAgICAgICAgICAgaW5wdXQucmVnZXggPSBpbnB1dC5yZWdleC5yZXBsYWNlKC8oPChbXj5dKyk+KS9pZywgJycpO1xuICAgICAgICAgICAgaW5wdXQuZG9tLmFkdmFuY2VkX3Byb3BlcnRpZXNfd3JhcHBlci5maW5kKCdkaXYuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fYWR2YW5jZWQtcHJvcGVydGllc19fcmVnZXggaW5wdXQnKS52YWwoaW5wdXQucmVnZXgpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9zZXQgdmVyaWZpY2F0aW9uIGZsYWdcbiAgICAgICAgaW5wdXQudmVyaWZ5ID0gaW5wdXQuZG9tLmFkdmFuY2VkX3Byb3BlcnRpZXNfd3JhcHBlci5maW5kKCdkaXYuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fYWR2YW5jZWQtcHJvcGVydGllc19fZG91YmxlLWVudHJ5IGlucHV0JykuaXMoJzpjaGVja2VkJyk7XG5cbiAgICAgICAgLyogZ2V0IHVuaXF1ZW5lc3MgZmxhZyAqL1xuICAgICAgICBzYXZlLnNhdmVVbmlxdWVuZXNzKGlucHV0KTtcblxuICAgIH1cblxuICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgLy92YWxpZGF0ZSBpbml0aWFsIGFuc3dlclxuICAgIGluaXRpYWxfYW5zd2VyX3ZhbGlkYXRpb24gPSBpbnB1dC5pc0luaXRpYWxBbnN3ZXJWYWxpZCgpO1xuICAgIGlmICghaW5pdGlhbF9hbnN3ZXJfdmFsaWRhdGlvbi5pc192YWxpZCkge1xuICAgICAgICBpbnB1dC5kb20uaXNfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgLy9oaWdobGlnaHQgd3JvbmcgaW5wdXRcbiAgICAgICAgaW5wdXQuc2hvd0FkdmFuY2VkUHJvcGVydGllc0Vycm9ycyhjb25zdHMuREVGQVVMVF9QUk9QRVJUWSwgaW5pdGlhbF9hbnN3ZXJfdmFsaWRhdGlvbi5lcnJvci5tZXNzYWdlKTtcbiAgICB9XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IHNhdmVBZHZhbmNlZFByb3BlcnRpZXM7XG4iLCIvKiBnbG9iYWwgJCovXG4ndXNlIHN0cmljdCc7XG52YXIgY29uc3RzID0gcmVxdWlyZSgnY29uZmlnL2NvbnN0cycpO1xudmFyIGZvcm1idWlsZGVyID0gcmVxdWlyZSgnY29uZmlnL2Zvcm1idWlsZGVyJyk7XG52YXIgdWkgPSByZXF1aXJlKCdoZWxwZXJzL3VpJyk7XG5cbnZhciBzYXZlQWxsSW5wdXRQcm9wZXJ0aWVzID0gZnVuY3Rpb24gKHRoZV9pbnB1dCkge1xuXG4gICAgdmFyIGlucHV0ID0gdGhlX2lucHV0O1xuICAgIHZhciB1aSA9IHJlcXVpcmUoJ2hlbHBlcnMvdWknKTtcbiAgICB2YXIgdXRpbHMgPSByZXF1aXJlKCdoZWxwZXJzL3V0aWxzJyk7XG4gICAgdmFyIHZhbGlkYXRpb24gPSByZXF1aXJlKCdhY3Rpb25zL3ZhbGlkYXRpb24nKTtcbiAgICB2YXIgYWN0aXZlX2JyYW5jaDtcbiAgICB2YXIgYWN0aXZlX2dyb3VwO1xuICAgIHZhciBicmFuY2hfaW5wdXRzX3ZhbGlkYXRpb247XG4gICAgdmFyIGdyb3VwX2lucHV0c192YWxpZGF0aW9uO1xuICAgIHZhciBuZXN0ZWRfZ3JvdXBfb3duZXJfYnJhbmNoX3ZhbGlkYXRpb247XG5cbiAgICAvL3NhdmUgYmFzaWMgcHJvcGVydGllc1xuICAgIGlucHV0LnNhdmVQcm9wZXJ0aWVzKCk7XG5cbiAgICAvL2lmIHRoZSBzZWxlY3RlZCBpbnB1dCBpcyBhIG11bHRpcGxlIGNob2ljZSBpbnB1dCwgc2F2ZSBwb3NzaWJsZSBhbnN3ZXJzXG4gICAgaWYgKGNvbnN0cy5NVUxUSVBMRV9BTlNXRVJfVFlQRVMuaW5kZXhPZihpbnB1dC50eXBlKSAhPT0gLTEpIHtcbiAgICAgICAgLy90b2RvIHdlIGFyZSB0ZXN0aW5nIHBlcmZvcm1hbmNlXG4gICAgICAgIGlucHV0LnNhdmVQb3NzaWJsZUFuc3dlcnMoKTtcbiAgICB9XG4gICAgLy9zYXZlIGFkdmFuY2VkIHByb3BlcnRpZXMgKG5vdCBmb3IgbWVkaWEgb3IgYnJhbmNoIG9yIGdyb3VwIHR5cGVzKVxuICAgIGlmIChjb25zdHMuTUVESUFfQU5TV0VSX1RZUEVTLmluZGV4T2YoaW5wdXQudHlwZSkgPT09IC0xICYmIGlucHV0LnR5cGUgIT09IGNvbnN0cy5CUkFOQ0hfVFlQRSAmJiBpbnB1dC50eXBlICE9PSBjb25zdHMuR1JPVVBfVFlQRSkge1xuICAgICAgICBpbnB1dC5zYXZlQWR2YW5jZWRQcm9wZXJ0aWVzKCk7XG4gICAgfVxuXG4gICAgLy9zYXZlIGp1bXBzXG4gICAgLy8gaWYgKGlucHV0LnR5cGUgIT09IGNvbnN0cy5HUk9VUF9UWVBFKSB7XG4gICAgaWYgKGlucHV0Lmp1bXBzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgaW5wdXQuc2F2ZUp1bXBzKCk7XG4gICAgfVxuXG4gICAgLy9zYXZlIGJyYW5jaCBpbnB1dHMgaWYgdGhlIGJyYW5jaCBpbnB1dCBvd25lciBpcyB2YWxpZCAoaGVhZGVyIGlzIG5vdCBlbXB0eSlcbiAgICBpZiAoaW5wdXQudHlwZSA9PT0gY29uc3RzLkJSQU5DSF9UWVBFICYmIGlucHV0LmRvbS5pc192YWxpZCkge1xuXG4gICAgICAgIC8vc2V0IGhlYWRlciBwcmV2aWV3XG4gICAgICAgIHVpLmlucHV0c19jb2xsZWN0aW9uLnNob3dJbnB1dFF1ZXN0aW9uUHJldmlldyhpbnB1dC5yZWYsIGlucHV0LnF1ZXN0aW9uLnRydW5jKDUwKSk7XG5cbiAgICAgICAgLy9icmFuY2ggaW5wdXRzIGFyZSBhbHJlYWR5IGF0dGFjaGVkIHRvIHRoZSBicmFuY2ggcHJvcGVydHksIGp1c3QgdmFsaWRhdGUgdGhlbVxuICAgICAgICAvL3RvZG8gY2hlY2sgdGhpcyBhcyBJIHNob3VsZCBkbyBzb21ldGhpbmcgaWYgdGhlcmUgaXMgYSB2YWxpZC9pbnZhbGlkIG9uZT9cbiAgICAgICAgaW5wdXQudmFsaWRhdGVCcmFuY2hJbnB1dHMoKTtcbiAgICB9XG5cbiAgICAvL3NhdmUgYnJhbmNoIGlucHV0cyBpZiB0aGUgYnJhbmNoIGlucHV0IG93bmVyIGlzIHZhbGlkIChoZWFkZXIgaXMgbm90IGVtcHR5KVxuICAgIGlmIChpbnB1dC50eXBlID09PSBjb25zdHMuR1JPVVBfVFlQRSAmJiBpbnB1dC5kb20uaXNfdmFsaWQpIHtcblxuICAgICAgICAvL3NldCBoZWFkZXIgcHJldmlld1xuICAgICAgICB1aS5pbnB1dHNfY29sbGVjdGlvbi5zaG93SW5wdXRRdWVzdGlvblByZXZpZXcoaW5wdXQucmVmLCBpbnB1dC5xdWVzdGlvbi50cnVuYyg1MCkpO1xuXG4gICAgICAgIC8vYnJhbmNoIGlucHV0cyBhcmUgYWxyZWFkeSBhdHRhY2hlZCB0byB0aGUgYnJhbmNoIHByb3BlcnR5LCBqdXN0IHZhbGlkYXRlIHRoZW1cbiAgICAgICAgaW5wdXQudmFsaWRhdGVHcm91cElucHV0cygpO1xuICAgIH1cblxuICAgIC8vaWYgd2UgYXJlIGVkaXRpbmcgYSBuZXN0ZWQgZ3JvdXBcbiAgICBpZiAoZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19icmFuY2ggJiYgZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19ncm91cCkge1xuXG4gICAgICAgIC8vIGlmIHdlIGFyZSBlZGl0aW5nIGEgbmVzdGVkIGdyb3VwLCBhbmQgYWxsIHRoZSBuZXN0ZWQgZ3JvdXAgaW5wdXRzIGFyZSB2YWxpZCxcbiAgICAgICAgLy8gc2V0IHRoZSBuZXN0ZWQgZ3JvdXAgaW5wdXQgb3duZXIgYXMgdmFsaWQgYW5kIHRvZ2dsZSB2YWxpZCBpY29uIGZvciB0aGUgb3duZXIgZ3JvdXAgaW5wdXRcbiAgICAgICAgYWN0aXZlX2JyYW5jaCA9IHV0aWxzLmdldElucHV0T2JqZWN0QnlSZWYoZm9ybWJ1aWxkZXIuYnJhbmNoLmFjdGl2ZV9icmFuY2hfcmVmKTtcbiAgICAgICAgYWN0aXZlX2dyb3VwID0gdXRpbHMuZ2V0TmVzdGVkR3JvdXBPYmplY3RCeVJlZihhY3RpdmVfYnJhbmNoLCBmb3JtYnVpbGRlci5ncm91cC5hY3RpdmVfZ3JvdXBfcmVmKTtcbiAgICAgICAgZ3JvdXBfaW5wdXRzX3ZhbGlkYXRpb24gPSB2YWxpZGF0aW9uLnZhbGlkYXRlR3JvdXBJbnB1dHMoYWN0aXZlX2dyb3VwKTtcblxuICAgICAgICBpZiAoZ3JvdXBfaW5wdXRzX3ZhbGlkYXRpb24uaXNfdmFsaWQpIHtcbiAgICAgICAgICAgIGFjdGl2ZV9ncm91cC5kb20uaXNfdmFsaWQgPSB0cnVlO1xuICAgICAgICAgICAgdWkuaW5wdXRzX2NvbGxlY3Rpb24uc2hvd0lucHV0VmFsaWRJY29uKGFjdGl2ZV9ncm91cC5yZWYpO1xuXG4gICAgICAgICAgICAvL2lmIHRoZSBuZXN0ZWQgZ3JvdXAgaXMgdmFsaWQsIGlzIHRoZSBvd25lciBicmFuY2ggdmFsaWQgdGhlbj9cbiAgICAgICAgICAgIG5lc3RlZF9ncm91cF9vd25lcl9icmFuY2hfdmFsaWRhdGlvbiA9IGFjdGl2ZV9icmFuY2gudmFsaWRhdGVCcmFuY2hJbnB1dHMoKTtcblxuICAgICAgICAgICAgLy90b2RvIGRvIGkgbmVlZCB0byBkbyBzb21ldGhpbmcgaGVyZSAgYmFzZWQgb24gdGhlIGFib3ZlIHJlc3VsdD9cblxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdWkuaW5wdXRzX2NvbGxlY3Rpb24uc2hvd0lucHV0SW52YWxpZEljb24oYWN0aXZlX2dyb3VwLnJlZik7XG4gICAgICAgICAgICBhY3RpdmVfZ3JvdXAuZG9tLmlzX3ZhbGlkID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSB7XG5cblxuICAgICAgICAvLyBpZiB3ZSBhcmUgZWRpdGluZyBhIGJyYW5jaCwgYW5kIGFsbCB0aGUgYWN0aXZlIGJyYW5jaCBpbnB1dHMgYXJlIHZhbGlkLFxuICAgICAgICAvLyBzZXQgdGhlIGJyYW5jaCBpbnB1dCBvd25lciBhcyB2YWxpZCBhbmQgdG9nZ2xlIHZhbGlkIGljb24gZm9yIHRoZSBvd25lciBicmFuY2ggaW5wdXRcbiAgICAgICAgaWYgKGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfYnJhbmNoKSB7XG5cbiAgICAgICAgICAgIC8vZ2V0IGN1cnJlbnQgYWN0aXZlIGJyYW5jaCBhbmQgdmFsaWRhdGVcbiAgICAgICAgICAgIGFjdGl2ZV9icmFuY2ggPSB1dGlscy5nZXRJbnB1dE9iamVjdEJ5UmVmKGZvcm1idWlsZGVyLmJyYW5jaC5hY3RpdmVfYnJhbmNoX3JlZik7XG4gICAgICAgICAgICBicmFuY2hfaW5wdXRzX3ZhbGlkYXRpb24gPSB2YWxpZGF0aW9uLnZhbGlkYXRlQnJhbmNoSW5wdXRzKGFjdGl2ZV9icmFuY2gpO1xuXG4gICAgICAgICAgICBpZiAoYnJhbmNoX2lucHV0c192YWxpZGF0aW9uLmlzX3ZhbGlkKSB7XG5cbiAgICAgICAgICAgICAgICB1aS5pbnB1dHNfY29sbGVjdGlvbi5zaG93SW5wdXRWYWxpZEljb24oYWN0aXZlX2JyYW5jaC5yZWYpO1xuICAgICAgICAgICAgICAgIGFjdGl2ZV9icmFuY2guZG9tLmlzX3ZhbGlkID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHVpLmlucHV0c19jb2xsZWN0aW9uLnNob3dJbnB1dEludmFsaWRJY29uKGFjdGl2ZV9icmFuY2gucmVmKTtcbiAgICAgICAgICAgICAgICBhY3RpdmVfYnJhbmNoLmRvbS5pc192YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gaWYgd2UgYXJlIGVkaXRpbmcgYSBncm91cCwgYW5kIGFsbCB0aGUgYWN0aXZlIGdyb3VwIGlucHV0cyBhcmUgdmFsaWQsXG4gICAgICAgIC8vIHNldCB0aGUgZ3JvdXAgaW5wdXQgb3duZXIgYXMgdmFsaWQgYW5kIHRvZ2dsZSB2YWxpZCBpY29uIGZvciB0aGUgb3duZXIgYnJhbmNoIGlucHV0XG4gICAgICAgIGlmIChmb3JtYnVpbGRlci5pc19lZGl0aW5nX2dyb3VwKSB7XG5cbiAgICAgICAgICAgIC8vZ2V0IGN1cnJlbnQgYWN0aXZlIGdyb3VwIGFuZCB2YWxpZGF0ZVxuICAgICAgICAgICAgYWN0aXZlX2dyb3VwID0gdXRpbHMuZ2V0SW5wdXRPYmplY3RCeVJlZihmb3JtYnVpbGRlci5ncm91cC5hY3RpdmVfZ3JvdXBfcmVmKTtcbiAgICAgICAgICAgIGdyb3VwX2lucHV0c192YWxpZGF0aW9uID0gdmFsaWRhdGlvbi52YWxpZGF0ZUdyb3VwSW5wdXRzKGFjdGl2ZV9ncm91cCk7XG5cbiAgICAgICAgICAgIGlmIChncm91cF9pbnB1dHNfdmFsaWRhdGlvbi5pc192YWxpZCkge1xuXG4gICAgICAgICAgICAgICAgYWN0aXZlX2dyb3VwLmRvbS5pc192YWxpZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgdWkuaW5wdXRzX2NvbGxlY3Rpb24uc2hvd0lucHV0VmFsaWRJY29uKGFjdGl2ZV9ncm91cC5yZWYpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdWkuaW5wdXRzX2NvbGxlY3Rpb24uc2hvd0lucHV0SW52YWxpZEljb24oYWN0aXZlX2dyb3VwLnJlZik7XG4gICAgICAgICAgICAgICAgYWN0aXZlX2dyb3VwLmRvbS5pc192YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBzYXZlQWxsSW5wdXRQcm9wZXJ0aWVzO1xuIiwiLyogZ2xvYmFsICQqL1xuJ3VzZSBzdHJpY3QnO1xudmFyIGNvbnN0cyA9IHJlcXVpcmUoJ2NvbmZpZy9jb25zdHMnKTtcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJ2NvbmZpZy9mb3JtYnVpbGRlcicpO1xuXG52YXIgc2F2ZUp1bXBzID0gZnVuY3Rpb24gKGlucHV0KSB7XG5cbiAgICB2YXIgdWkgPSByZXF1aXJlKCdoZWxwZXJzL3VpJyk7XG4gICAgdmFyIHVuZG8gPSByZXF1aXJlKCdhY3Rpb25zL3VuZG8nKTtcbiAgICB2YXIganVtcHNfbGlzdF93cmFwcGVyID0gZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlclxuICAgICAgICAuZmluZCgnZm9ybVtkYXRhLWlucHV0LXJlZj1cIicgKyBpbnB1dC5yZWYgKyAnXCJdJylcbiAgICAgICAgLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19qdW1wcyAuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fanVtcHNfX2xpc3QnKTtcblxuICAgIHZhciBqdW1wcyA9IGp1bXBzX2xpc3Rfd3JhcHBlci5maW5kKCdsaScpO1xuICAgIHZhciBqdW1wX3Byb3BlcnRpZXMgPSB7XG4gICAgICAgIGFyZV92YWxpZDogbnVsbCxcbiAgICAgICAgd2hlbjogbnVsbCxcbiAgICAgICAgdG86IG51bGwsXG4gICAgICAgIGFuc3dlcl9yZWY6IG51bGwsXG4gICAgICAgIHR5cGU6IG51bGxcbiAgICB9O1xuXG4gICAgaW5wdXQuaGlkZUp1bXBzRXJyb3JzKGp1bXBzKTtcblxuICAgIC8vcmVzZXQgYWxsIGp1bXBzXG4gICAgaW5wdXQuanVtcHMgPSBbXTtcbiAgICBqdW1wcy5lYWNoKGZ1bmN0aW9uIChpKSB7XG4gICAgICAgICAgICBqdW1wX3Byb3BlcnRpZXMuaGFzX3ZhbGlkX2Rlc3RpbmF0aW9uID0gdHJ1ZTtcbiAgICAgICAgICAgIGp1bXBfcHJvcGVydGllcy50eXBlID0gaW5wdXQudHlwZTtcblxuICAgICAgICAgICAgLy9nZXQganVtcCBwcm9wZXJ0aWVzXG4gICAgICAgICAgICBqdW1wX3Byb3BlcnRpZXMud2hlbiA9ICQodGhpcykuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2p1bXBzX19sb2dpYy0td2hlbiBzZWxlY3Qgb3B0aW9uOnNlbGVjdGVkJykudmFsKCk7XG4gICAgICAgICAgICBqdW1wX3Byb3BlcnRpZXMudG8gPSAkKHRoaXMpLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19qdW1wc19fbG9naWMtLWdvdG8gc2VsZWN0IG9wdGlvbjpzZWxlY3RlZCcpLnZhbCgpO1xuICAgICAgICAgICAganVtcF9wcm9wZXJ0aWVzLmFuc3dlcl9yZWYgPSAkKHRoaXMpLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19qdW1wc19fbG9naWMtLWFuc3dlciBzZWxlY3Qgb3B0aW9uOnNlbGVjdGVkJykudmFsKCk7XG5cbiAgICAgICAgICAgIC8vdmFsaWRhdGUganVtcCBwcm9wZXJ0aWVzXG4gICAgICAgICAgICBqdW1wX3Byb3BlcnRpZXMuYXJlX3ZhbGlkID0gaW5wdXQuaXNKdW1wVmFsaWQoanVtcF9wcm9wZXJ0aWVzKTtcblxuICAgICAgICAgICAgaWYgKCFqdW1wX3Byb3BlcnRpZXMuYXJlX3ZhbGlkKSB7XG5cbiAgICAgICAgICAgICAgICAvL3Nob3cgZXJyb3JzXG4gICAgICAgICAgICAgICAgaW5wdXQuc2hvd1NpbmdsZUp1bXBFcnJvcnMoJCh0aGlzKSwganVtcF9wcm9wZXJ0aWVzKTtcblxuICAgICAgICAgICAgICAgIC8vc2V0IGlucHV0IGFzIGludmFsaWRcbiAgICAgICAgICAgICAgICBpbnB1dC5kb20uaXNfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy9zYXZlIGp1bXAgYW55d2F5LCBhcyBpdCBpcyBmbGFnIGFzIGludmFsaWQgYW5kIGl0IHdpbGwga2VlcCB0aGUgcHJvamVjdCBpbnZhbGlkIHVudGlsIGl0IGlzIGVpdGhlciByZW1vdmVkIG9yIHNldCBwcm9wZXJseVxuICAgICAgICAgICAgaW5wdXQuanVtcHNbaV0gPSB7XG4gICAgICAgICAgICAgICAgdG86IGp1bXBfcHJvcGVydGllcy50byxcbiAgICAgICAgICAgICAgICAvL3RoaXMgd2lsbCBiZSBhbHdheXMgJ0FMTCcgZm9yIHRoaXMgdHlwZSBvZiBpbnB1dFxuICAgICAgICAgICAgICAgIHdoZW46IGp1bXBfcHJvcGVydGllcy53aGVuLFxuICAgICAgICAgICAgICAgIC8vdGhpcyB3aWxsIGJlIG51bGwgZm9yIHNpbmdsZSBhbnN3ZXIgb3B0aW9ucy4gdmFsKCkgaXMgc2V0IHRvIGFuc3dlcl9yZWYgb2YgcG9zc2libGUgYW5zd2VyIG90aGVyd2lzZVxuICAgICAgICAgICAgICAgIGFuc3dlcl9yZWY6IGp1bXBfcHJvcGVydGllcy5hbnN3ZXJfcmVmIHx8IG51bGxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICApO1xuICAgIHVuZG8ucHVzaFN0YXRlKCk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IHNhdmVKdW1wcztcbiIsIi8qIGdsb2JhbCAkKi9cbid1c2Ugc3RyaWN0JztcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcblxudmFyIHNhdmVQb3NzaWJsZUFuc3dlcnM7XG5zYXZlUG9zc2libGVBbnN3ZXJzID0gZnVuY3Rpb24gKHRoZV9pbnB1dCkge1xuXG4gICAgdmFyIGlucHV0ID0gdGhlX2lucHV0O1xuICAgIHZhciBhbnN3ZXI7XG4gICAgdmFyIGFuc3dlcl9yZWY7XG4gICAgdmFyIHByb3BlcnRpZXNfcGFuZWwgPSBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyLmZpbmQoJ2Zvcm1bZGF0YS1pbnB1dC1yZWY9XCInICsgaW5wdXQucmVmICsgJ1wiXScpO1xuICAgIHZhciBwb3NzaWJsZV9hbnN3ZXJzID0gcHJvcGVydGllc19wYW5lbC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fcG9zc2libGUtYW5zd2VycyBkaXYgdWwuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fcG9zc2libGUtYW5zd2Vyc19fbGlzdCBsaScpO1xuICAgIHZhciBpc19wb3NzaWJsZV9hc3dlcl92YWxpZDtcblxuICAgIHZhciBjdXJyZW50X3BhZ2UgPSBmb3JtYnVpbGRlci5wb3NzaWJsZV9hbnN3ZXJzX3BhZ2luYXRpb25baW5wdXQucmVmXS5wYWdlO1xuICAgIHZhciBmcm9tX2luZGV4ID0gKGN1cnJlbnRfcGFnZSAtIDEpICogY29uc3RzLkxJTUlUUy5wb3NzaWJsZV9hbnN3ZXJzX3Blcl9wYWdlO1xuXG4gICAgaW5wdXQuZG9tLnByb3BlcnRpZXNfcGFuZWwgPSBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyLmZpbmQoJ2Zvcm1bZGF0YS1pbnB1dC1yZWY9XCInICsgaW5wdXQucmVmICsgJ1wiXScpO1xuXG4gICAgLy9yZXNldCB2YWxpZGF0aW9uIGRvbSBmZWVkYmFjayAoaGlkZSBhbGwgZXJyb3JzIGZyb20gZG9tKVxuICAgIGlucHV0LmhpZGVQb3NzaWJsZUFuc3dlcnNFcnJvcnMocG9zc2libGVfYW5zd2Vycyk7XG5cbiAgICAvKlxuICAgICBQb3NzaWJsZSBhbnN3ZXJzIGFyZSBncmFiYmVkIGZyb20gdGhlIGRvbSwgc28gd2UganVzdCB1cGRhdGUgdGhlIHRleHQgd2l0aCB3aGF0ZXZlciBpcyBzZXRcbiAgICAgKi9cbiAgICBwb3NzaWJsZV9hbnN3ZXJzLmVhY2goZnVuY3Rpb24gKGluZGV4LCBwb3NzaWJsZV9hbnN3ZXIpIHtcblxuICAgICAgICB2YXIgY3VycmVudF9pbnB1dCA9ICQocG9zc2libGVfYW5zd2VyKS5maW5kKCdkaXYgaW5wdXQnKTtcblxuICAgICAgICBhbnN3ZXIgPSBjdXJyZW50X2lucHV0LnZhbCgpO1xuXG4gICAgICAgIC8vc3RyaXAgaHRtbCB0YWdzIChhbmdsZSBicmFja2V0cylcbiAgICAgICAgYW5zd2VyID0gYW5zd2VyLnJlcGxhY2UoL1s8Pl0vaWcsICcnKTtcblxuICAgICAgICAvL3JlZmxlY3QgY2hhbmdlcyBpbiBkb21cbiAgICAgICAgY3VycmVudF9pbnB1dC5hdHRyKCd2YWx1ZScsIGFuc3dlcik7XG4gICAgICAgIGN1cnJlbnRfaW5wdXQudmFsKGFuc3dlcik7XG5cbiAgICAgICAgYW5zd2VyX3JlZiA9IGN1cnJlbnRfaW5wdXQuYXR0cignZGF0YS1hbnN3ZXItcmVmJyk7XG5cbiAgICAgICAgLy9hZGQgZWxlbWVudCB0byB0aGUgY29ycmVjdCBwb3NpdGlvbiBpbiB0aGUgYXJyYXlcbiAgICAgICAgLy9iYXNlZCBvbiBwYWdpbmF0aW9uXG4gICAgICAgIGlucHV0LnBvc3NpYmxlX2Fuc3dlcnNbZnJvbV9pbmRleCArIGluZGV4XSA9IHtcbiAgICAgICAgICAgIGFuc3dlcjogYW5zd2VyLFxuICAgICAgICAgICAgYW5zd2VyX3JlZjogYW5zd2VyX3JlZlxuICAgICAgICB9O1xuXG4gICAgICAgIGlzX3Bvc3NpYmxlX2Fzd2VyX3ZhbGlkID0gaW5wdXQuaXNQb3NzaWJsZUFuc3dlclZhbGlkKGFuc3dlcik7XG5cbiAgICAgICAgLy92YWxpZGF0ZSBlYWNoIHBvc3NpYmxlIGFuc3dlciBhbmQgc2hvdyBlbWJlZGRlZCBlcnJvcnMgaWYgYW55XG4gICAgICAgIGlmICghaXNfcG9zc2libGVfYXN3ZXJfdmFsaWQuaXNfdmFsaWQpIHtcbiAgICAgICAgICAgIC8vIHdhcm4gdXNlciBxdWVzdGlvbiB0ZXh0IGlzIHdyb25nXG4gICAgICAgICAgICBpbnB1dC5kb20uaXNfdmFsaWQgPSBmYWxzZTtcblxuICAgICAgICAgICAgLy9oaWdobGlnaHQgd3JvbmcgYW5zd2VyIGFuZCBzaG93IGVycm9yIG1lc3NhZ2VcbiAgICAgICAgICAgIGlucHV0LnNob3dQb3NzaWJsZUFuc3dlckVycm9ycygkKHBvc3NpYmxlX2Fuc3dlciksIGlzX3Bvc3NpYmxlX2Fzd2VyX3ZhbGlkLmVycm9yLm1lc3NhZ2UpO1xuICAgICAgICB9XG4gICAgfSk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IHNhdmVQb3NzaWJsZUFuc3dlcnM7XG5cbiIsIi8qIGdsb2JhbCAkKi9cbid1c2Ugc3RyaWN0JztcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoJ2hlbHBlcnMvdXRpbHMnKTtcblxudmFyIHNhdmVQcm9wZXJ0aWVzID0gZnVuY3Rpb24gKHRoZV9pbnB1dCkge1xuXG4gICAgdmFyIHF1ZXN0aW9uX3RleHRfdmFsaWRhdGlvbjtcbiAgICB2YXIgaW5wdXQgPSB0aGVfaW5wdXQ7XG5cbiAgICBpbnB1dC5kb20ucHJvcGVydGllc19wYW5lbCA9IGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXIuZmluZCgnZm9ybVtkYXRhLWlucHV0LXJlZj1cIicgKyBpbnB1dC5yZWYgKyAnXCJdJyk7XG4gICAgaW5wdXQuZG9tLmlzX3ZhbGlkID0gdHJ1ZTtcblxuICAgIC8vcmVzZXQgdmFsaWRhdGlvbiBkb20gZmVlZGJhY2sgKGhpZGUgYWxsIGVycm9ycyBmcm9tIGRvbSlcbiAgICBpbnB1dC5oaWRlUHJvcGVydGllc0Vycm9ycygpO1xuXG4gICAgLy9zZXQgcXVlc3Rpb24gdGV4dCAocmVhZG1lIGlzIHRoZSBvbmx5IG9uZSB3aXRoIGEgdGV4dGFyZWEgaW4gdGhlIG1hcmt1cClcbiAgICBpZiAoaW5wdXQudHlwZSA9PT0gY29uc3RzLlJFQURNRV9UWVBFKSB7XG5cbiAgICAgICAgaW5wdXQucXVlc3Rpb24gPSBpbnB1dC5kb20ucHJvcGVydGllc19wYW5lbC5maW5kKCdkaXYuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fcXVlc3Rpb24gdGV4dGFyZWEnKS52YWwoKS50cmltKCk7XG5cbiAgICAgICAgLy9yZW1vdmUgZG91YmxlIHdoaXRlIHNwYWNlcywgdGFicyBhbmQgbmV3IGxpbmVzIGFuZCAmbmJzcDtcbiAgICAgICAgaW5wdXQucXVlc3Rpb24gPSBpbnB1dC5xdWVzdGlvbi5yZXBsYWNlKC9cXHNcXHMrL2csICcgJykucmVwbGFjZSgvJm5ic3A7L2csICcnKTtcblxuICAgICAgICAvL2NvbnZlcnQgaHRtbCB0YWdzIHRvIGh0bWwgZW50aXRpZXNcbiAgICAgICAgaW5wdXQucXVlc3Rpb24gPSB1dGlscy5lbmNvZGVIdG1sKGlucHV0LnF1ZXN0aW9uKVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgaW5wdXQucXVlc3Rpb24gPSBpbnB1dC5kb20ucHJvcGVydGllc19wYW5lbC5maW5kKCdkaXYuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fcXVlc3Rpb24gaW5wdXQnKS52YWwoKTtcblxuICAgICAgICAvL3JlbW92ZSBhbmdsZSBicmFja2V0c1xuICAgICAgICBpbnB1dC5xdWVzdGlvbiA9IGlucHV0LnF1ZXN0aW9uLnJlcGxhY2UoL1s8Pl0vZywgJycpO1xuICAgICAgICBpbnB1dC5kb20ucHJvcGVydGllc19wYW5lbC5maW5kKCdkaXYuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fcXVlc3Rpb24gaW5wdXQnKS52YWwoaW5wdXQucXVlc3Rpb24pO1xuXG5cbiAgICAgICAgLy9zZXQgcmVxdWlyZWQgZmxhZ1xuICAgICAgICBpbnB1dC5pc19yZXF1aXJlZCA9IGlucHV0LmRvbS5wcm9wZXJ0aWVzX3BhbmVsLmZpbmQoJ2Rpdi5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19yZXF1aXJlZC1mbGFnIGlucHV0JykuaXMoJzpjaGVja2VkJyk7XG5cbiAgICAgICAgLy9zZXQgdGl0bGUgZmxhZ1xuICAgICAgICBpbnB1dC5pc190aXRsZSA9IGlucHV0LmRvbS5wcm9wZXJ0aWVzX3BhbmVsLmZpbmQoJ2Rpdi5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX190aXRsZS1mbGFnIGlucHV0JykuaXMoJzpjaGVja2VkJyk7XG4gICAgfVxuXG4gICAgLy92YWxpZGF0ZSBxdWVzdGlvbiB0ZXh0XG4gICAgcXVlc3Rpb25fdGV4dF92YWxpZGF0aW9uID0gaW5wdXQuaXNRdWVzdGlvblRleHRWYWxpZCgpO1xuXG4gICAgaWYgKCFxdWVzdGlvbl90ZXh0X3ZhbGlkYXRpb24uaXNfdmFsaWQpIHtcbiAgICAgICAgLy8gd2FybiB1c2VyIHF1ZXN0aW9uIHRleHQgaXMgd3JvbmdcbiAgICAgICAgaW5wdXQuZG9tLmlzX3ZhbGlkID0gZmFsc2U7XG4gICAgICAgIGlucHV0LmRvbS5lcnJvciA9IHF1ZXN0aW9uX3RleHRfdmFsaWRhdGlvbi5lcnJvci5tZXNzYWdlO1xuXG4gICAgICAgIC8vaGlnaGxpZ2h0IHdyb25nIGlucHV0IGFuZCBzaG93IGVycm9yIG1lc3NhZ2VcbiAgICAgICAgaW5wdXQuc2hvd1Byb3BlcnRpZXNFcnJvcnMocXVlc3Rpb25fdGV4dF92YWxpZGF0aW9uLmVycm9yLm1lc3NhZ2UpO1xuXG4gICAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBzYXZlUHJvcGVydGllcztcbiIsIi8qIGdsb2JhbCAkKi9cbid1c2Ugc3RyaWN0JztcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcblxudmFyIHNhdmVVbmlxdWVuZXNzID0gZnVuY3Rpb24gKGlucHV0KSB7XG5cbiAgICAvKiBnZXQgdW5pcXVlbmVzcyBmbGFnICovXG4gICAgdmFyIHVuaXF1ZW5lc3MgPSBpbnB1dC5kb20uYWR2YW5jZWRfcHJvcGVydGllc193cmFwcGVyLmZpbmQoJ2Rpdi5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19hZHZhbmNlZC1wcm9wZXJ0aWVzX191bmlxdWVuZXNzIGlucHV0OmNoZWNrZWQnKTtcbiAgICAvL3RvcCBwYXJlbnQgZm9ybVxuICAgIGlmIChmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXggPT09IDApIHtcbiAgICAgICAgLy90aGlzIGlzIHRoZSB0b3AgbGV2ZWwgZm9ybSwgZ2V0IHNpbmdsZSBjaGVja2JveCBzdGF0ZVxuICAgICAgICBpbnB1dC51bmlxdWVuZXNzID0gKHVuaXF1ZW5lc3MubGVuZ3RoID4gMCkgPyBjb25zdHMuVU5JUVVFU1NfRk9STSA6IGNvbnN0cy5VTklRVUVTU19OT05FO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgLy9kbyB3ZSBoYXZlIHNvbWUgY2hlY2tib3hlcyBzZWxlY3RlZD9cbiAgICAgICAgaWYgKHVuaXF1ZW5lc3MubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgLy9jaGlsZCBmb3JtIGNhbiBoYXZlIGVpdGhlciBoaWVyYXJjaHkgb3IgZm9ybSB1bmlxdWVuZXNzXG4gICAgICAgICAgICBpbnB1dC51bmlxdWVuZXNzID0gdW5pcXVlbmVzcy5oYXNDbGFzcygndW5pcXVlbmVzcy1oaWVyYXJjaHknKSA/IGNvbnN0cy5VTklRVUVTU19ISUVSQVJDSFkgOiBjb25zdHMuVU5JUVVFU1NfRk9STTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlucHV0LnVuaXF1ZW5lc3MgPSBjb25zdHMuVU5JUVVFU1NfTk9ORTtcbiAgICAgICAgfVxuICAgIH1cblxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBzYXZlVW5pcXVlbmVzcztcbiIsIi8qIGdsb2JhbCBGbGF0dGVkKi9cbid1c2Ugc3RyaWN0JztcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJ2NvbmZpZy9mb3JtYnVpbGRlcicpO1xudmFyIHBhcnNlID0gcmVxdWlyZSgnYWN0aW9ucy9wYXJzZScpO1xudmFyIGNvbnN0cyA9IHJlcXVpcmUoJ2NvbmZpZy9jb25zdHMnKTtcbnZhciB1aSA9IHJlcXVpcmUoJ2hlbHBlcnMvdWknKTtcbnZhciBmb3JtX2ZhY3RvcnkgPSByZXF1aXJlKCdmYWN0b3J5L2Zvcm0tZmFjdG9yeScpO1xudmFyIHV0aWxzID0gcmVxdWlyZSgnaGVscGVycy91dGlscycpO1xudmFyIHB1c2hfc3RhdGVfdGltZW91dDtcblxudmFyIHVuZG8gPSB7XG5cbiAgICBleGVjdXRlOiBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgLy9zZXQgcmVuZGVyIGFjdGlvbiBmbGFnIHNvIHdlIGtub3cgd2UgZG8gbm90IGhhdmUgdG8gcHVzaCBhIHN0YXRlIHdoZW4gd2UgdW5kbyAoc2luY2Ugd2UgYXJlIHJlLXVzaW5nIHRoZSBzYW1lIGZ1bmN0aW9ucylcbiAgICAgICAgZm9ybWJ1aWxkZXIucmVuZGVyX2FjdGlvbiA9IGNvbnN0cy5SRU5ERVJfQUNUSU9OX1VORE87XG5cbiAgICAgICAgLy9zaG93IG92ZXJsYXkgYW5kIGN1cnNvciwgb24gY29tcGxldGUgZXhlY3V0ZSB1bmRvXG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5vdmVybGF5LmZhZGVJbihjb25zdHMuQU5JTUFUSU9OX0ZBU1QsIGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgLy9pZiB0aGVyZSBpcyBvbmx5IDEgZWxlbWVudCBpbiBzdGF0ZSwgdGhhdCBpcyB0aGUgc3RhcnRpbmcgc3RhdGUgYW5kIGl0IGNhbm5vdCBiZSB1bmRvbmVcbiAgICAgICAgICAgIGlmIChmb3JtYnVpbGRlci5zdGF0ZS5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIuc3RhdGUucG9wKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZvcm1idWlsZGVyLnByZXZpb3VzX3N0YXRlID0gQ2lyY3VsYXJKU09OLnBhcnNlKENpcmN1bGFySlNPTi5zdHJpbmdpZnkoZm9ybWJ1aWxkZXIuc3RhdGVbZm9ybWJ1aWxkZXIuc3RhdGUubGVuZ3RoIC0gMV0pKTtcblxuICAgICAgICAgICAgLy9yZW1vdmUgYWxsIGNoaWxkIHRhYi1wYW5lbFxuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmZvcm1zX3RhYnNfY29udGVudC5maW5kKCcubWFpbl9fdGFicy1jb250ZW50LXRhYnBhbmVsJykubm90KCc6Zmlyc3QnKS5yZW1vdmUoKTtcblxuICAgICAgICAgICAgLy9yZW1vdmUgYWxsIGlucHV0cyBmcm9tIHRvcCBsZXZlbCBmb3JtXG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uZm9ybXNfdGFic19jb250ZW50LmZpbmQoJy5pbnB1dHMtY29sbGVjdGlvbiAuc29ydGFibGUgLmlucHV0JykucmVtb3ZlKCk7XG5cbiAgICAgICAgICAgIC8vcmVtb3ZlIGFsbCBwcm9wZXJ0aWVzIHBhbmVscyBmb3IgdG9wIGxldmVsIGZvcm1cbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5mb3Jtc190YWJzX2NvbnRlbnQuZmluZCgnLm1haW5fX3RhYnMtY29udGVudC10YWJwYW5lbCAuaW5wdXQtcHJvcGVydGllcyAuaW5wdXQtcHJvcGVydGllc19fZm9ybScpLnJlbW92ZSgpO1xuXG4gICAgICAgICAgICAvL3JlbW92ZSBmb3JtcyB0YWJzIGJ1dHRvbnMgKG5vdCB0aGUgZmlyc3Qgb25lKVxuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmZvcm1zX3RhYnMuZmluZCgnLm1haW5fX3RhYnNfX2Zvcm0tYnRuJykubm90KCc6Zmlyc3QnKS5yZW1vdmUoKTtcblxuICAgICAgICAgICAgLy9yZW5kZXIgcHJldmlvdXMgc3RhdGVcbiAgICAgICAgICAgIGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbiA9IGZvcm1idWlsZGVyLnByZXZpb3VzX3N0YXRlLnByb2plY3RfZGVmaW5pdGlvbjsvL3RvZG8gdGVzdCBmb3Igc2lkZSBlZmZlY3Qgb2YgdGhpcyBhc3NpZ25tZW50XG5cbiAgICAgICAgICAgICQud2hlbihwYXJzZS5yZW5kZXJQcm9qZWN0KGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbikpLnRoZW4oZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgLy9hbHdheXMgc3dpdGNoIHRhYnMgdG8gZm9ybSBvZiBpbmRleCAwXG4gICAgICAgICAgICAgICAgICAgIC8vdG9kb1xuXG4gICAgICAgICAgICAgICAgLy9oaWRlIG92ZXJsYXkgd2l0aCBhIGJpdCBvZiBkZWxheVxuICAgICAgICAgICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLm92ZXJsYXkuZmFkZU91dChjb25zdHMuQU5JTUFUSU9OX0ZBU1QsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSwgY29uc3RzLkFOSU1BVElPTl9TTE9XKTtcblxuICAgICAgICAgICAgICAgIC8vZGlzYWJsZSB1bmRvIGJ1dHRvbiBpZiB3ZSBkbyBub3QgaGF2ZSBhbnkgbW9yZSBzdGF0ZVxuICAgICAgICAgICAgICAgIGlmIChmb3JtYnVpbGRlci5zdGF0ZS5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgdWkubmF2YmFyLnRvZ2dsZVVuZG9CdG4oY29uc3RzLkJUTl9ESVNBQkxFRCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9yZXNldCBzdGF0ZSB0byByZWdpc3RlciBuZXcgIHVzZXIgYWN0aW9uc1xuICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLnJlbmRlcl9hY3Rpb24gPSBjb25zdHMuUkVOREVSX0FDVElPTl9ETztcblxuICAgICAgICAgICAgICAgIC8vY2xlYXIgcG9zc2libGUgYW5zd2VycyBzb3J0YWJsZSBlbmFibGVkIGFycmF5IVxuICAgICAgICAgICAgICAgIC8vdG8gYmluZCB0aGUgc29ydGFibGUgZXZlbnRzIGFnYWluXG4gICAgICAgICAgICAgICAgLy9pdCBtaWdodCBiaW5kIGl0IHR3aWNlIGZvciBzb21lIGVsZW1lbnRzLCBidXQgdGhlIHVuZG8gYWN0aW9uIGlzIG5vdCBjb21tb25cbiAgICAgICAgICAgICAgICAvL3NvIGl0IGlzIGFjY2VwdGFibGUgaW4gdGVybXMgb2YgbWVtb3J5IHVzYWdlXG4gICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIucG9zc2libGVfYW5zd2Vycy5lbmFibGVkX3NvcnRhYmxlID0gW107XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIHB1c2hTdGF0ZTogZnVuY3Rpb24gKHdpdGhfdGhyb3R0bGUpIHtcblxuICAgICAgICB2YXIgc3RhdGUgPSB7fTtcblxuICAgICAgICAvL3B1c2ggYSBzdGF0ZSBvbmx5IHdoZW4gd2UgYXJlIE5PVCB1bmRvaW5nIDspXG4gICAgICAgIGlmIChmb3JtYnVpbGRlci5yZW5kZXJfYWN0aW9uID09PSBjb25zdHMuUkVOREVSX0FDVElPTl9VTkRPKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBfZG9QdXNoU3RhdGUoKSB7XG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKCdjYWxsZWQgcHVzaFN0YXRlJyk7XG4gICAgICAgICAgICAvL3B1c2ggc3RhdGVcbiAgICAgICAgICAgIGlmIChmb3JtYnVpbGRlci5zdGF0ZS5sZW5ndGggPj0gY29uc3RzLkxJTUlUUy5tYXhfc3RhdGVzKSB7XG4gICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIuc3RhdGUuc2hpZnQoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgIHN0YXRlLnByb2plY3RfZGVmaW5pdGlvbiA9IEZsYXR0ZWQucGFyc2UoRmxhdHRlZC5zdHJpbmdpZnkoZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uKSk7XG4gICAgICAgICAgIC8vIHN0YXRlLnByb2plY3RfZGVmaW5pdGlvbiA9IGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbjtcbiAgICAgICAgICAgIHN0YXRlLmFjdGl2ZV9pbnB1dF9yZWYgPSBmb3JtYnVpbGRlci5jdXJyZW50X2lucHV0X3JlZjtcbiAgICAgICAgICAgIHN0YXRlLmFjdGl2ZV9mb3JtX2luZGV4ID0gZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4O1xuICAgICAgICAgICAgc3RhdGUuYWN0aXZlX2Zvcm1fcmVmID0gZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX3JlZjtcblxuICAgICAgICAgICAgc3RhdGUuYWN0aXZlX3Byb3BlcnRpZXNfdGFiID0gZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlclxuICAgICAgICAgICAgICAgIC5maW5kKCdmb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIHN0YXRlLmFjdGl2ZV9pbnB1dF9yZWYgKyAnXCJdJylcbiAgICAgICAgICAgICAgICAuZmluZCgnLm5hdi10YWJzIC5hY3RpdmUgYScpLmF0dHIoJ2hyZWYnKTtcblxuICAgICAgICAgICAgaWYgKGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfYnJhbmNoICYmIGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfZ3JvdXApIHtcbiAgICAgICAgICAgICAgICAvL3RvZG8gc2F2ZSByZWZlcmVuY2UgdG8gdGhlIG5lc3RlZCBncm91cCB0aGF0IHdhcyBiZWluZyBlZGl0ZWRcblxuICAgICAgICAgICAgICAgIC8vc2F2ZSB0aGUgYnJhbmNoIHRoYXQgd2FzIGJlaW5nIGVkaXRlZFxuICAgICAgICAgICAgICAgIHN0YXRlLmFjdGl2ZV9icmFuY2hfcmVmID0gZm9ybWJ1aWxkZXIuYnJhbmNoLmFjdGl2ZV9icmFuY2hfcmVmO1xuXG4gICAgICAgICAgICAgICAgLy9zYXZlIHRoZSBncm91cCB0aGF0IHdhcyBiZWluZyBlZGl0ZWRcbiAgICAgICAgICAgICAgICBzdGF0ZS5hY3RpdmVfZ3JvdXBfcmVmID0gZm9ybWJ1aWxkZXIuZ3JvdXAuYWN0aXZlX2dyb3VwX3JlZjtcblxuICAgICAgICAgICAgICAgIC8vb3ZlcnJpZGUgaW5wdXQgcmVmIHJlZmVyZW5jZSB0byBnZXQgdGhlIG5lc3RlZCBncm91cCBpbnB1dCB0aGF0IHdhcyBiZWluZyBlZGl0ZWRcbiAgICAgICAgICAgICAgICBzdGF0ZS5hY3RpdmVfaW5wdXRfcmVmID0gZm9ybWJ1aWxkZXIuZ3JvdXAuY3VycmVudF9pbnB1dF9yZWY7XG4gICAgICAgICAgICAgICAgc3RhdGUuYWN0aXZlX3Byb3BlcnRpZXNfdGFiID0gZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlclxuICAgICAgICAgICAgICAgICAgICAuZmluZCgnZm9ybVtkYXRhLWlucHV0LXJlZj1cIicgKyBzdGF0ZS5hY3RpdmVfaW5wdXRfcmVmICsgJ1wiXScpXG4gICAgICAgICAgICAgICAgICAgIC5maW5kKCcubmF2LXRhYnMgLmFjdGl2ZSBhJykuYXR0cignaHJlZicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfYnJhbmNoKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vc2F2ZSB0aGUgYnJhbmNoIHRoYXQgd2FzIGJlaW5nIGVkaXRlZFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5hY3RpdmVfYnJhbmNoX3JlZiA9IGZvcm1idWlsZGVyLmJyYW5jaC5hY3RpdmVfYnJhbmNoX3JlZjtcblxuICAgICAgICAgICAgICAgICAgICAvL3NhdmUgdGhlIGFjdGl2ZSBicmFuY2ggaW5wdXQgKGlmIGFueSlcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZvcm1idWlsZGVyLmJyYW5jaC5jdXJyZW50X2lucHV0X3JlZikge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGUuYWN0aXZlX2JyYW5jaF9pbnB1dF9yZWYgPSBmb3JtYnVpbGRlci5icmFuY2guY3VycmVudF9pbnB1dF9yZWY7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvL3NhdmUgYnJhbmNoIGlucHV0IGFjdGl2ZSB0YWIgaWYgYW55XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmFjdGl2ZV9wcm9wZXJ0aWVzX3RhYiA9IGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5maW5kKCdmb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIHN0YXRlLmFjdGl2ZV9icmFuY2hfaW5wdXRfcmVmICsgJ1wiXScpXG4gICAgICAgICAgICAgICAgICAgICAgICAuZmluZCgnLm5hdi10YWJzIC5hY3RpdmUgYScpLmF0dHIoJ2hyZWYnKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19ncm91cCkge1xuICAgICAgICAgICAgICAgICAgICAvL3NhdmUgdGhlIGdyb3VwIHRoYXQgd2FzIGJlaW5nIGVkaXRlZFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5hY3RpdmVfZ3JvdXBfcmVmID0gZm9ybWJ1aWxkZXIuZ3JvdXAuYWN0aXZlX2dyb3VwX3JlZjtcblxuICAgICAgICAgICAgICAgICAgICAvL3NhdmUgdGhlIGFjdGl2ZSBicmFuY2ggaW5wdXQgKGlmIGFueSlcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZvcm1idWlsZGVyLmdyb3VwLmN1cnJlbnRfaW5wdXRfcmVmKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZS5hY3RpdmVfZ3JvdXBfaW5wdXRfcmVmID0gZm9ybWJ1aWxkZXIuZ3JvdXAuY3VycmVudF9pbnB1dF9yZWY7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvL3NhdmUgYnJhbmNoIGlucHV0IGFjdGl2ZSB0YWIgaWYgYW55XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmFjdGl2ZV9wcm9wZXJ0aWVzX3RhYiA9IGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5maW5kKCdmb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIHN0YXRlLmFjdGl2ZV9ncm91cF9pbnB1dF9yZWYgKyAnXCJdJylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5maW5kKCcubmF2LXRhYnMgLmFjdGl2ZSBhJykuYXR0cignaHJlZicpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgc3RhdGUud2FzX2VkaXRpbmdfYnJhbmNoID0gZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19icmFuY2g7XG4gICAgICAgICAgICBzdGF0ZS53YXNfZWRpdGluZ19ncm91cCA9IGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfZ3JvdXA7XG5cbiAgICAgICAgICAgIGZvcm1idWlsZGVyLnN0YXRlLnB1c2goc3RhdGUpO1xuXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnY3VycmVudCBmb3JtYnVpbGRlciBzdGF0ZScpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coZm9ybWJ1aWxkZXIuc3RhdGUpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9lbmFibGUgdW5kbyBidXR0b24gdGhlIGZpcnN0IHRpamUgYSBzdGF0ZSBpcyBwdXNoZWRcbiAgICAgICAgaWYgKGZvcm1idWlsZGVyLnN0YXRlLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgdWkubmF2YmFyLnRvZ2dsZVVuZG9CdG4oY29uc3RzLkJUTl9FTkFCTEVEKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh3aXRoX3Rocm90dGxlKSB7XG4gICAgICAgICAgICAvLyBUaHJvdHRsZSByZXF1ZXN0c1xuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHB1c2hfc3RhdGVfdGltZW91dCk7XG4gICAgICAgICAgICBwdXNoX3N0YXRlX3RpbWVvdXQgPSB3aW5kb3cuc2V0VGltZW91dChfZG9QdXNoU3RhdGUsIDUwMCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBfZG9QdXNoU3RhdGUoKTtcbiAgICAgICAgfVxuICAgIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gdW5kbztcbiIsIi8qIGdsb2JhbCAkLCB0b2FzdHIqL1xuJ3VzZSBzdHJpY3QnO1xudmFyIGNvbnN0cyA9IHJlcXVpcmUoJ2NvbmZpZy9jb25zdHMnKTtcbnZhciBtZXNzYWdlcyA9IHJlcXVpcmUoJ2NvbmZpZy9tZXNzYWdlcycpO1xudmFyIGZvcm1idWlsZGVyID0gcmVxdWlyZSgnY29uZmlnL2Zvcm1idWlsZGVyJyk7XG52YXIgc2F2ZSA9IHJlcXVpcmUoJ2FjdGlvbnMvc2F2ZScpO1xudmFyIHV0aWxzID0gcmVxdWlyZSgnaGVscGVycy91dGlscycpO1xudmFyIHNhdmVfcHJvamVjdF9jbGlja19jYWxsYmFjayA9IHJlcXVpcmUoJ3VpLWhhbmRsZXJzL2V2ZW50LWhhbmRsZXItY2FsbGJhY2tzL3NhdmUtcHJvamVjdC1jbGljay1jYWxsYmFjaycpO1xudmFyIGltcG9ydF9mb3JtX3ZhbGlkYXRpb24gPSByZXF1aXJlKCdoZWxwZXJzL2ltcG9ydC1mb3JtLXZhbGlkYXRpb24nKTtcbnZhciB0b2FzdCA9IHJlcXVpcmUoJ2NvbmZpZy90b2FzdCcpO1xuXG52YXIgdmFsaWRhdGlvbiA9IHtcblxuICAgIGlzRm9ybU5hbWVWYWxpZDogZnVuY3Rpb24gKHRoZV9uYW1lLCBpc19hZGRpbmdfbmV3X2Zvcm0pIHtcblxuICAgICAgICB2YXIgZm9ybXMgPSBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0LmZvcm1zO1xuICAgICAgICB2YXIgc3RyID0gdGhlX25hbWUudHJpbSgpO1xuICAgICAgICB2YXIgdmFsaWRhdGUgPSB7XG4gICAgICAgICAgICBpc192YWxpZDogdHJ1ZSxcbiAgICAgICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgICAgICAgbWVzc2FnZTogbnVsbCxcbiAgICAgICAgICAgICAgICB0eXBlOiBjb25zdHMuUVVFU1RJT05fUFJPUEVSVFlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgLy9yZWplY3QgYW4gZW1wdHkgc3RyaW5nXG4gICAgICAgIGlmIChzdHIgPT09ICcnKSB7XG4gICAgICAgICAgICB2YWxpZGF0ZS5pc192YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgdmFsaWRhdGUuZXJyb3IubWVzc2FnZSA9IG1lc3NhZ2VzLmVycm9yLkZPUk1fTkFNRV9FTVBUWTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIC8vcmVqZWN0IGlmIG5vdCBhbHBoYW51bWVyaWNcbiAgICAgICAgICAgIGlmICghY29uc3RzLkZPUk1fTkFNRV9SRUdFWC50ZXN0KHN0cikpIHtcbiAgICAgICAgICAgICAgICB2YWxpZGF0ZS5pc192YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHZhbGlkYXRlLmVycm9yLm1lc3NhZ2UgPSBtZXNzYWdlcy5lcnJvci5GT1JNX05BTUVfSU5WQUxJRDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgaWYgKGlzX2FkZGluZ19uZXdfZm9ybSkge1xuICAgICAgICAgICAgICAgICAgICAvL2NoZWNrIGlmIHRoZSBmb3JtIG5hbWUgYWxyZWFkeSBleGlzdHMgKGNhc2UgaW5zZW5zaXRpdmUpXG4gICAgICAgICAgICAgICAgICAgICQoZm9ybXMpLmVhY2goZnVuY3Rpb24gKGluZGV4LCBmb3JtKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZm9ybS5uYW1lLnRvTG93ZXJDYXNlKCkgPT09IHN0ci50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsaWRhdGUuaXNfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWxpZGF0ZS5lcnJvci5tZXNzYWdlID0gbWVzc2FnZXMuZXJyb3IuRk9STV9OQU1FX0VYSVNUO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdmFsaWRhdGU7XG4gICAgfSxcblxuICAgIC8vY2hlY2sgZm9yIGVtcHR5IHN0cmluZyBhbmQgdGhlIHByZXNlbmNlIG9mIGVpdGhlciAnfCcgb3IgJ19za2lwcDNkXycgd2hpY2ggYXJlIHJlc2VydmVkIHdvcmRzL2NoYXJzXG4gICAgaXNRdWVzdGlvblRleHRWYWxpZDogZnVuY3Rpb24gKGlucHV0KSB7XG5cbiAgICAgICAgdmFyIHF1ZXN0aW9uID0gaW5wdXQucXVlc3Rpb247XG4gICAgICAgIHZhciBzdHIgPSBxdWVzdGlvbi50cmltKCk7XG4gICAgICAgIHZhciB2YWxpZGF0ZSA9IHtcbiAgICAgICAgICAgIGlzX3ZhbGlkOiB0cnVlLFxuICAgICAgICAgICAgZXJyb3I6IHtcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiBudWxsLFxuICAgICAgICAgICAgICAgIHR5cGU6IGNvbnN0cy5RVUVTVElPTl9QUk9QRVJUWVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBpZiAoc3RyID09PSAnJykge1xuICAgICAgICAgICAgdmFsaWRhdGUuaXNfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgIHZhbGlkYXRlLmVycm9yLm1lc3NhZ2UgPSBtZXNzYWdlcy5lcnJvci5RVUVTVElPTl9URVhUX0VNUFRZO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9yZWFkbWUgdGV4dCB0b28gbG9uZ1xuICAgICAgICBpZiAoaW5wdXQudHlwZSA9PT0gY29uc3RzLlJFQURNRV9UWVBFICYmIHN0ci5sZW5ndGggPiBjb25zdHMuTElNSVRTLnJlYWRtZV9sZW5ndGgpIHtcbiAgICAgICAgICAgIHZhbGlkYXRlLmlzX3ZhbGlkID0gZmFsc2U7XG4gICAgICAgICAgICB2YWxpZGF0ZS5lcnJvci5tZXNzYWdlID0gbWVzc2FnZXMuZXJyb3IuUVVFU1RJT05fTEVOR1RIX0xJTUlUX0VYQ0VFREVEO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9vdGhlciBxdWVzdGlvbnMgdGV4dCB0b28gbG9uZ1xuICAgICAgICBpZiAoaW5wdXQudHlwZSAhPT0gY29uc3RzLlJFQURNRV9UWVBFICYmIHN0ci5sZW5ndGggPiBjb25zdHMuTElNSVRTLnF1ZXN0aW9uX2xlbmd0aCkge1xuICAgICAgICAgICAgdmFsaWRhdGUuaXNfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgIHZhbGlkYXRlLmVycm9yLm1lc3NhZ2UgPSBtZXNzYWdlcy5lcnJvci5RVUVTVElPTl9MRU5HVEhfTElNSVRfRVhDRUVERUQ7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdmFsaWRhdGU7XG4gICAgfSxcblxuICAgIGlzUG9zc2libGVBbnN3ZXJWYWxpZDogZnVuY3Rpb24gKHRoZV9wb3NzaWJsZV9hbnN3ZXIpIHtcblxuICAgICAgICB2YXIgc3RyID0gdGhlX3Bvc3NpYmxlX2Fuc3dlci50cmltKCk7XG4gICAgICAgIHZhciB2YWxpZGF0ZSA9IHtcbiAgICAgICAgICAgIGlzX3ZhbGlkOiB0cnVlLFxuICAgICAgICAgICAgZXJyb3I6IHtcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiBudWxsLFxuICAgICAgICAgICAgICAgIHR5cGU6IGNvbnN0cy5RVUVTVElPTl9QUk9QRVJUWVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIGlmIChzdHIgPT09ICcnKSB7XG4gICAgICAgICAgICB2YWxpZGF0ZS5pc192YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgdmFsaWRhdGUuZXJyb3IubWVzc2FnZSA9IG1lc3NhZ2VzLmVycm9yLlBPU1NJQkxFX0FOU1dFUl9FTVBUWTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmFsaWRhdGU7XG4gICAgfSxcblxuICAgIC8vY2hlY2sgaWYgdGhpcyBpcyB2YWxpZCBhZ2FpbnN0IHRoZSBpbnB1dCB0eXBlIG9yIHRoZSByZWdleFxuICAgIGlzSW5pdGlhbEFuc3dlclZhbGlkOiBmdW5jdGlvbiAodGhlX3R5cGUsIHRoZV9kZWZhdWx0LCB0aGVfcmVnZXgpIHtcblxuICAgICAgICB2YXIgc3RyID0gdGhlX2RlZmF1bHQgfHwgJyc7XG4gICAgICAgIHZhciByZWdleCA9IHRoZV9yZWdleDtcbiAgICAgICAgdmFyIHR5cGUgPSB0aGVfdHlwZTtcbiAgICAgICAgdmFyIHZhbGlkYXRlID0ge1xuICAgICAgICAgICAgaXNfdmFsaWQ6IHRydWUsXG4gICAgICAgICAgICBlcnJvcjoge1xuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IG51bGwsXG4gICAgICAgICAgICAgICAgdHlwZTogY29uc3RzLkRFRkFVTFRfUFJPUEVSVFlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICBzdHIgPSBzdHIudHJpbSgpO1xuXG4gICAgICAgIC8vZG9lcyB0aGUgaW5pdGlhbCBhbnN3ZXIgcGFzcyB0aGUgcmVnZXg/XG4gICAgICAgIGlmIChyZWdleCAmJiBzdHIpIHtcbiAgICAgICAgICAgIGlmICghc3RyLm1hdGNoKHJlZ2V4KSkge1xuICAgICAgICAgICAgICAgIHZhbGlkYXRlLmlzX3ZhbGlkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdmFsaWRhdGUuZXJyb3IubWVzc2FnZSA9IG1lc3NhZ2VzLmVycm9yLklOSVRJQUxfQU5TV0VSX05PVF9NQVRDSElOR19SRUdFWDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0eXBlID09PSBjb25zdHMuUEhPTkVfVFlQRSkge1xuICAgICAgICAgICAgLy9pcyB0aGUgaW5pdGlhbCBhbnN3ZXIgYSB2YWxpZCBwaG9uZSBudW1iZXIgZm9ybWF0P1xuICAgICAgICAgICAgLy90b2RvIHRoaXMgaXMgaGFpcnksIHRvbyBtYW55IG9wdGlvbnNcbiAgICAgICAgICAgIC8vdmFsaWRhdGUuaXNfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgIC8vdmFsaWRhdGUuZXJyb3IubWVzc2FnZSA9IG1lc3NhZ2VzLmVycm9yLklOSVRJQUxfQU5TV0VSX05PVF9QSE9ORV9OVU1CRVI7XG4gICAgICAgIH1cblxuXG4gICAgICAgIHJldHVybiB2YWxpZGF0ZTtcbiAgICB9LFxuICAgIC8vY29udmVydCB2YWx1ZSB0byBhIGZsb2F0IGFuZCBjaGVjayBpZiBpdCBpcyBhbiBpbnRlZ2VyXG4gICAgaXNWYWx1ZUludDogZnVuY3Rpb24gKG4pIHtcbiAgICAgICAgbiA9IHBhcnNlRmxvYXQobik7XG4gICAgICAgIHJldHVybiBOdW1iZXIobikgPT09IG4gJiYgbiAlIDEgPT09IDA7XG4gICAgfSxcbiAgICAvL2NvbnZlcnQgdmFsdWUgdG8gYSBmbG9hdCBhbmQgY2hlY2sgaWYgaXQgaXMgYSBkZWNpbWFsIG9yXG4gICAgaXNWYWx1ZUZsb2F0OiBmdW5jdGlvbiAobikge1xuICAgICAgICBuID0gcGFyc2VGbG9hdChuKTtcbiAgICAgICAgcmV0dXJuIG4gPT09IE51bWJlcihuKSAmJiBuICUgMSAhPT0gMDtcbiAgICB9LFxuXG4gICAgLy9pcyB0aGlzIHJpZ2h0PyB0b2RvIGRvdWJsZSBjaGVjayB0aGlzIGFuZCBtYXliZSByZWZhY3RvciBpbnRlZ2VyL2RlY2ltYWwgdmFsaWRhdGlvbiBpbiBpbnRlZ2VyLmpzXG4gICAgaXNNaW5NYXhWYWx1ZVZhbGlkOiBmdW5jdGlvbiAodHlwZSwgdmFsdWUpIHtcblxuICAgICAgICB2YXIgbWlubWF4X3ZhbHVlID0gdmFsdWU7XG4gICAgICAgIHZhciB2YWxpZGF0ZSA9IHtcbiAgICAgICAgICAgIGlzX3ZhbGlkOiB0cnVlLFxuICAgICAgICAgICAgZXJyb3I6IHtcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiBudWxsLFxuICAgICAgICAgICAgICAgIHR5cGU6IGNvbnN0cy5NQVhfVkFMVUVfUFJPUEVSVFlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICBpZiAodHlwZSA9PT0gY29uc3RzLklOVEVHRVJfVFlQRSAmJiBtaW5tYXhfdmFsdWUgIT09ICcnKSB7XG4gICAgICAgICAgICAvL21pbiBtdXN0IGJlIGFuIGludGVnZXIsIG5vdCBhIGZsb2F0XG4gICAgICAgICAgICBpZiAoIXRoaXMuaXNWYWx1ZUludChtaW5tYXhfdmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgdmFsaWRhdGUuaXNfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB2YWxpZGF0ZS5lcnJvci5tZXNzYWdlID0gbWVzc2FnZXMuZXJyb3IuVkFMVUVfTVVTVF9CRV9JTlRFR0VSO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2YWxpZGF0ZTtcbiAgICB9LFxuXG4gICAgaXNKdW1wVmFsaWQ6IGZ1bmN0aW9uICh0aGVfanVtcCwgdGhlX2lucHV0KSB7XG5cbiAgICAgICAgdmFyIGp1bXAgPSB0aGVfanVtcDtcbiAgICAgICAgdmFyIGlucHV0ID0gdGhlX2lucHV0O1xuICAgICAgICB2YXIgaXNfdmFsaWQgPSB0cnVlO1xuICAgICAgICB2YXIgaW5wdXRzO1xuICAgICAgICB2YXIganVtcF9kZXN0aW5hdGlvbnM7XG5cbiAgICAgICAgLy9pZiBlZGl0aW5nIGEgYnJhbmNoLCBnZXQganVtcHMgZGVzdGluYXRpb25zIHdpdGhpbiB0aGUgYWN0aXZlIGJyYW5jaFxuICAgICAgICBpZiAoZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19icmFuY2gpIHtcbiAgICAgICAgICAgIGlucHV0cyA9IHV0aWxzLmdldElucHV0T2JqZWN0QnlSZWYoZm9ybWJ1aWxkZXIuYnJhbmNoLmFjdGl2ZV9icmFuY2hfcmVmKS5icmFuY2g7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpbnB1dHMgPSBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0LmZvcm1zW2Zvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleF0uaW5wdXRzO1xuICAgICAgICB9XG5cbiAgICAgICAganVtcF9kZXN0aW5hdGlvbnMgPSB1dGlscy5nZXRKdW1wQXZhaWxhYmxlRGVzdGluYXRpb25zKGlucHV0LCBpbnB1dHMpO1xuXG4gICAgICAgIGlmIChjb25zdHMuTVVMVElQTEVfQU5TV0VSX1RZUEVTLmluZGV4T2YoanVtcC50eXBlKSAhPT0gLTEpIHtcbiAgICAgICAgICAgIC8vbXVsdGlwbGUgYW5zd2VycyB2YWxpZGF0aW9uXG4gICAgICAgICAgICBpZiAoanVtcC50byA9PT0gdW5kZWZpbmVkIHx8IGp1bXAud2hlbiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgaXNfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy9hbnN3ZXJfcmVmIGluIG5lZWRlZCB3aGVuIElTIGFucyBJUyBOT1Qgb25seVxuICAgICAgICAgICAgaWYgKGp1bXAuYW5zd2VyX3JlZiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgaWYgKGp1bXAud2hlbiA9PT0gJ0lTJyB8fCBqdW1wLndoZW4gPT09ICdJU19OT1QnKSB7XG4gICAgICAgICAgICAgICAgICAgIGlzX3ZhbGlkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy9zaW5nbGUgYW5zd2VyIHZhbGlkYXRpb24gKGl0IHdpbGwgYWx3YXlzIGp1bXAsIHNvIGNoZWNrIGlmIGRlc3RpbmF0aW9uIGlzIHNldClcbiAgICAgICAgICAgIGlmIChqdW1wLnRvID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBpc192YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy9jaGVjayB0aGUgZGVzdGluYXRpb24gaXMgdmFsaWQgKHRoZSB1c2VyIG1pZ2h0IGhhdmUgZHJhZ2dlZCB0aGUgaW5wdXQgYXJvdW5kKVxuICAgICAgICBpZiAoaXNfdmFsaWQpIHtcblxuICAgICAgICAgICAgdmFyIHJlZnMgPSBqdW1wX2Rlc3RpbmF0aW9ucy5tYXAoZnVuY3Rpb24gKGRlc3RpbmF0aW9uKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlc3RpbmF0aW9uLnJlZjtcbiAgICAgICAgICAgIH0pO1xuXG5cbiAgICAgICAgICAgIGlmIChyZWZzLmluZGV4T2YoanVtcC50bykgPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgaXNfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBqdW1wLmhhc192YWxpZF9kZXN0aW5hdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgLy9yZW1vdmUganVtcC5oYXNfdmFsaWRfZGVzdGluYXRpb24ganVzdCBpbiBjYXNlIGl0IHdhcyB0aGVyZSBmcm9tIGEgcHJldmlvdXMgZXJyb3JcbiAgICAgICAgICAgICAgICAvL3RoaXMgaGFwcGVucyBiZWNhdXNlIEkgYW0gbXV0YXRpbmcgdGhlIG9iamVjdCEgc2hhbWUgb24gbWUsIHRvbyBtdWNoIHdvcmsgcmVmYWN0b3JpbmcgOylcbiAgICAgICAgICAgICAgICBkZWxldGUganVtcC5oYXNfdmFsaWRfZGVzdGluYXRpb247XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGlzX3ZhbGlkO1xuICAgIH0sXG5cbiAgICAvL3RvZG8gSSBkbyBub3QgdGhpbmsgdGhpcyBpcyB1c2VkIGFueW1vcmVcbiAgICBpc1Bvc3NpYmxlQW5zd2VybGlua2VkVG9KdW1wOiBmdW5jdGlvbiAodGhlX3Bvc3NpYmxlX2Fuc3dlciwgdGhlX2p1bXBzKSB7XG5cbiAgICAgICAgdmFyIHBvc3NpYmxlX2Fuc3dlciA9IHRoZV9wb3NzaWJsZV9hbnN3ZXI7XG4gICAgICAgIHZhciBqdW1wcyA9IHRoZV9qdW1wcztcbiAgICAgICAgdmFyIGk7XG4gICAgICAgIHZhciBpTGVuZ3RoID0ganVtcHMubGVuZ3RoO1xuICAgICAgICB2YXIgaGFzX2xpbmtlZF9qdW1wID0gZmFsc2U7XG5cbiAgICAgICAgZm9yIChpID0gMDsgaSA8IGlMZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKGp1bXBzW2ldLmFuc3dlcl9pZCA9PT0gcG9zc2libGVfYW5zd2VyLmFuc3dlcl9pZCkge1xuICAgICAgICAgICAgICAgIGhhc19saW5rZWRfanVtcCA9IHRydWU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGhhc19saW5rZWRfanVtcDtcbiAgICB9LFxuXG4gICAgLy9wZXJmb3JtIHZhbGlkYXRpb24gb24gYW4gaW5wdXQgYW5kIG9wdGlvbmFsbHkgc2hvdyB0b2FzdCBub3RpZmljYXRpb25cbiAgICBwZXJmb3JtVmFsaWRhdGlvbjogZnVuY3Rpb24gKHRoZV9pbnB1dCwgc2hvd190b2FzdCkge1xuXG4gICAgICAgIHZhciBpbnB1dCA9IHRoZV9pbnB1dDtcbiAgICAgICAgdmFyIG1lc3NhZ2U7XG4gICAgICAgIHZhciB1aSA9IHJlcXVpcmUoJ2hlbHBlcnMvdWknKTtcbiAgICAgICAgdmFyIHV0aWxzID0gcmVxdWlyZSgnaGVscGVycy91dGlscycpO1xuICAgICAgICB2YXIgdW5kbyA9IHJlcXVpcmUoJ2FjdGlvbnMvdW5kbycpO1xuICAgICAgICB2YXIgcXVlc3Rpb247XG4gICAgICAgIHZhciBjb3B5X2J0bl9zdGF0ZSA9IGlucHV0LmRvbS5pc192YWxpZCA/IGNvbnN0cy5CVE5fRU5BQkxFRCA6IGNvbnN0cy5CVE5fRElTQUJMRUQ7XG4gICAgICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgICAgIFNhdmUgd2lsbCBpbXBsaWNpdGx5IHJ1biB0aGUgdmFsaWRhdGlvbiFcbiAgICAgICAgICovXG4gICAgICAgIHNhdmUuc2F2ZUFsbElucHV0UHJvcGVydGllcyhpbnB1dCk7XG4gICAgICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8vc2hvdyB2aXN1YWwgZmVlZGJhY2sgaWYgdGhlIHByb3BlcnRpZXMgYXJlIHZhbGlkXG4gICAgICAgIGlmIChpbnB1dC5kb20uaXNfdmFsaWQpIHtcblxuICAgICAgICAgICAgLy91cGRhdGUgdGhlIGp1c3Qgc2F2ZWQgaW5wdXQgc2hvd2luZyBhIHByZXZpZXcgb2YgdGhlIHF1ZXN0aW9uIHRleHQgKGxpbWl0IHRvIDUwIGNoYXJzKVxuICAgICAgICAgICAgLy9zdHJpcCBodG1sIHRhZ3MgZnJvbSByZWFkbWUgdHlwZSBpZiBhbnlcbiAgICAgICAgICAgIGlmIChpbnB1dC50eXBlID09PSBjb25zdHMuUkVBRE1FX1RZUEUpIHtcblxuICAgICAgICAgICAgICAgIC8vc3RhcnQgd2l0aCBkZWNvbmRpbmcgdGhlIGh0bWxcbiAgICAgICAgICAgICAgICBxdWVzdGlvbiA9IHV0aWxzLmRlY29kZUh0bWwoaW5wdXQucXVlc3Rpb24pO1xuXG4gICAgICAgICAgICAgICAgLy9yZW1vdmUgJzwnIGFuZCAnPicgZnJvbSBkZWNvZGVkIHN0cmluZyAoYXMgaHRtbCBlbnRpdGllcylcbiAgICAgICAgICAgICAgICAvL3RhZ3MgYWxyZWFkeSBwYXJzZWQgKDxiPiwgPGk+LCA8dT4pIHNob3VsZCBnbyB0aHJvdWdoXG4gICAgICAgICAgICAgICAgLy90b2RvIHRlc3QgdGhpcyB3ZWxsXG4gICAgICAgICAgICAgICAgdmFyIHB1cmlmaWVkSHRtbCA9IHV0aWxzLnJlcGxhY2VBbGxPY2N1cnJlbmNlcyhxdWVzdGlvbiwgJyZsdDsnLCAnJyk7XG4gICAgICAgICAgICAgICAgcHVyaWZpZWRIdG1sID0gdXRpbHMucmVwbGFjZUFsbE9jY3VycmVuY2VzKHB1cmlmaWVkSHRtbCwgJyZndDsnLCAnJyk7XG5cbiAgICAgICAgICAgICAgICAvL3JlbW92ZSBsaW5rIHByb3RvY29sXG4gICAgICAgICAgICAgICAgcHVyaWZpZWRIdG1sID0gdXRpbHMucmVwbGFjZUFsbE9jY3VycmVuY2VzKHB1cmlmaWVkSHRtbCwgJ2h0dHA6Ly8nLCAnJyk7XG4gICAgICAgICAgICAgICAgcHVyaWZpZWRIdG1sID0gdXRpbHMucmVwbGFjZUFsbE9jY3VycmVuY2VzKHB1cmlmaWVkSHRtbCwgJ2h0dHBzOi8vJywgJycpO1xuXG4gICAgICAgICAgICAgICAgLy9yZW1vdmUgbm90IGFsbG93ZWQgdGFnc1xuICAgICAgICAgICAgICAgIHB1cmlmaWVkSHRtbCA9IHV0aWxzLnN0cmlwVGFncyhwdXJpZmllZEh0bWwsIGNvbnN0cy5SRUFETUVfQUxMT1dFRF9UQUdTKTtcblxuICAgICAgICAgICAgICAgIC8vc2F2ZSBwdXJpZmllZCBxdWVzdGlvblxuICAgICAgICAgICAgICAgIGlucHV0LnF1ZXN0aW9uID0gdXRpbHMuZW5jb2RlSHRtbChwdXJpZmllZEh0bWwpO1xuXG4gICAgICAgICAgICAgICAgLy9yZW1vdmUgQUxMIHRhZ3MgZm9yIHByZXZpZXcgb25seVxuICAgICAgICAgICAgICAgIHF1ZXN0aW9uID0gcHVyaWZpZWRIdG1sLnJlcGxhY2UoLyg8KFtePl0rKT4pL2lnLCAnICcpO1xuICAgICAgICAgICAgICAgIC8vd3JhcCBpbiBkb3VibGUgcXVvdGVzIHRvIGVzY2FwZSBodG1sIGluIHRoZSBwcmV2aWV3IHNvIDxicj4gZG8gbm90IGdldCByZW5kZXJlZFxuICAgICAgICAgICAgICAgIHVpLmlucHV0c19jb2xsZWN0aW9uLnNob3dJbnB1dFF1ZXN0aW9uUHJldmlldyhpbnB1dC5yZWYsICdcIicgKyBxdWVzdGlvbi50cnVuYyhjb25zdHMuTElNSVRTLnF1ZXN0aW9uX3ByZXZpZXdfbGVuZ3RoKSArICdcIicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdWkuaW5wdXRzX2NvbGxlY3Rpb24uc2hvd0lucHV0UXVlc3Rpb25QcmV2aWV3KGlucHV0LnJlZiwgaW5wdXQucXVlc3Rpb24udHJ1bmMoY29uc3RzLkxJTUlUUy5xdWVzdGlvbl9wcmV2aWV3X2xlbmd0aCkpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL3JlcGxhY2Ugd2FybmluZyBpY29uIHdpdGggZ3JlZW4gY2hlY2tcbiAgICAgICAgICAgIHVpLmlucHV0c19jb2xsZWN0aW9uLnNob3dJbnB1dFZhbGlkSWNvbihpbnB1dC5yZWYpO1xuXG4gICAgICAgICAgICAvL3Nob3cgcXVlc3Rpb24gcHJldmlldyBvbiBpbnB1dCBwcm9wZXJ0aWVzIHBhbmVsXG4gICAgICAgICAgICAvL3N0cmlwIGh0bWwgdGFncyBmcm9tIHJlYWRtZSB0eXBlIGlmIGFueVxuICAgICAgICAgICAgaWYgKGlucHV0LnR5cGUgPT09IGNvbnN0cy5SRUFETUVfVFlQRSkge1xuICAgICAgICAgICAgICAgIHF1ZXN0aW9uID0gdXRpbHMuZGVjb2RlSHRtbChpbnB1dC5xdWVzdGlvbik7XG4gICAgICAgICAgICAgICAgcXVlc3Rpb24gPSBxdWVzdGlvbi5yZXBsYWNlKC8oPChbXj5dKyk+KS9pZywgJyAnKTtcbiAgICAgICAgICAgICAgICAvL3dyYXAgaW4gZG91YmxlIHF1b3RlcyB0byBlc2NhcGUgaHRtbCByZW5kZXJpbmcgaW4gcHJldmlld1xuICAgICAgICAgICAgICAgIHVpLmlucHV0X3Byb3BlcnRpZXNfcGFuZWwuc2hvd0lucHV0UXVlc3Rpb25QcmV2aWV3KCdcIicgKyBxdWVzdGlvbi50cnVuYygyMCkgKyBcIlwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHVpLmlucHV0X3Byb3BlcnRpZXNfcGFuZWwuc2hvd0lucHV0UXVlc3Rpb25QcmV2aWV3KGlucHV0LnF1ZXN0aW9uLnRydW5jKDIwKSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChzaG93X3RvYXN0KSB7XG4gICAgICAgICAgICAgICAgdG9hc3Quc2hvd1N1Y2Nlc3MobWVzc2FnZXMuc3VjY2Vzcy5JTlBVVF9WQUxJRCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvL2VuYWJsZSBzYXZlIHByb2plY3QgYnV0dG9uIGlmIGFsbCBpbnB1dHMgYXJlIHZhbGlkXG4gICAgICAgICAgICBpZiAodGhpcy5hcmVBbGxJbnB1dHNWYWxpZChmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24pKSB7XG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnKiogYWxsIGdvb2QgKionKTtcbiAgICAgICAgICAgICAgICAvL2VuYWJsZSBzYXZlIHByb2plY3QgYnV0dG9uXG4gICAgICAgICAgICAgICAgdWkubmF2YmFyLnRvZ2dsZVNhdmVQcm9qZWN0QnRuKGNvbnN0cy5CVE5fRU5BQkxFRCk7XG4gICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLnNhdmVfcHJvamVjdF9idG4ub2ZmKCkub24oJ2NsaWNrJywgc2F2ZV9wcm9qZWN0X2NsaWNrX2NhbGxiYWNrKTtcblxuICAgICAgICAgICAgICAgIC8vcmVwbGFjZSB3YXJuaW5nIGljb24gd2l0aCBncmVlbiBjaGVjayBvbiBjdXJyZW50IGZvcm0gdGFiXG4gICAgICAgICAgICAgICAgdWkuZm9ybXNfdGFicy5zaG93Rm9ybVZhbGlkSWNvbihmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXgpO1xuXG4gICAgICAgICAgICAgICAgLy9lbmFibGUgZG93bmxvYWQgZm9ybSBidXR0b24gb24gY3VycmVudCBmb3JtXG4gICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uXG4gICAgICAgICAgICAgICAgICAgIC5maW5kKCcuaW5wdXRzLWNvbGxlY3Rpb25fX2V4cG9ydC1mb3JtJykucmVtb3ZlQ2xhc3MoJ2Rpc2FibGVkJyk7XG5cbiAgICAgICAgICAgICAgICAvL2VuYWJsZSBwcm50IGFzIHBkZiBidXR0b25cbiAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25cbiAgICAgICAgICAgICAgICAgICAgLmZpbmQoJy5pbnB1dHMtY29sbGVjdGlvbl9fcHJpbnQtYXMtcGRmJykucmVtb3ZlQ2xhc3MoJ2Rpc2FibGVkJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcblxuICAgICAgICAgICAgICAgIC8vY2hlY2sgaWYgaW5wdXRzIGFyZSBhbGwgdmFsaWQgZm9yIGN1cnJlbnQgZm9ybSBvbmx5XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuYXJlRm9ybUlucHV0c1ZhbGlkKGZvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleCkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9yZXBsYWNlIHdhcm5pbmcgaWNvbiB3aXRoIGdyZWVuIGNoZWNrIG9uIGN1cnJlbnQgZm9ybSB0YWJcbiAgICAgICAgICAgICAgICAgICAgdWkuZm9ybXNfdGFicy5zaG93Rm9ybVZhbGlkSWNvbihmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXgpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vZW5hYmxlIGRvd25sb2FkIGZvcm0gYnV0dG9uXG4gICAgICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgLmZpbmQoJy5pbnB1dHMtY29sbGVjdGlvbl9fZXhwb3J0LWZvcm0nKS5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTtcblxuICAgICAgICAgICAgICAgICAgICAvL2VuYWJsZSBwcmludCBhcyBwZGYgZm9ybSBidXR0b25cbiAgICAgICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICAuZmluZCgnLmlucHV0cy1jb2xsZWN0aW9uX19wcmludC1hcy1wZGYnKS5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vZGlzYWJsZSBkb3dubG9hZCBmb3JtIGJ1dHRvblxuICAgICAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25cbiAgICAgICAgICAgICAgICAgICAgICAgIC5maW5kKCcuaW5wdXRzLWNvbGxlY3Rpb25fX2V4cG9ydC1mb3JtJykuYWRkQ2xhc3MoJ2Rpc2FibGVkJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy9kaXNhYmxlIHByaW50IGFzIHBkZiBmb3JtIGJ1dHRvblxuICAgICAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25cbiAgICAgICAgICAgICAgICAgICAgICAgIC5maW5kKCcuaW5wdXRzLWNvbGxlY3Rpb25fX3ByaW50LWFzLXBkZicpLmFkZENsYXNzKCdkaXNhYmxlZCcpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmIChpbnB1dC5xdWVzdGlvbikge1xuICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSBpbnB1dC5kb20uZXJyb3IgPyBpbnB1dC5kb20uZXJyb3IgOiBpbnB1dC5xdWVzdGlvbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIGNvbnN0cy5CUkFOQ0hfVFlQRTpcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSBtZXNzYWdlcy5lcnJvci5OT19CUkFOQ0hfSEVBREVSX1lFVDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIGNvbnN0cy5HUk9VUF9UWVBFOlxuICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZSA9IG1lc3NhZ2VzLmVycm9yLk5PX0dST1VQX0hFQURFUl9ZRVQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSBtZXNzYWdlcy5lcnJvci5OT19RVUVTVElPTl9URVhUX1lFVDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy91cGRhdGUgcXVlc3Rpb24gcHJldmlld1xuICAgICAgICAgICAgdWkuaW5wdXRzX2NvbGxlY3Rpb24uc2hvd0lucHV0SW52YWxpZEljb24oaW5wdXQucmVmKTtcbiAgICAgICAgICAgIHVpLmlucHV0c19jb2xsZWN0aW9uLnNob3dJbnB1dFF1ZXN0aW9uUHJldmlldyhpbnB1dC5yZWYsIG1lc3NhZ2UpO1xuICAgICAgICAgICAgdWkuaW5wdXRfcHJvcGVydGllc19wYW5lbC5zaG93SW5wdXRRdWVzdGlvblByZXZpZXcobWVzc2FnZSk7XG5cbiAgICAgICAgICAgIGlmIChzaG93X3RvYXN0KSB7XG4gICAgICAgICAgICAgICAgdG9hc3Quc2hvd0Vycm9yKG1lc3NhZ2VzLmVycm9yLklOUFVUX05PVF9WQUxJRCwgMjAwMCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vZGlzYWJsZSBzYXZlIHByb2plY3QgYnV0dG9uXG4gICAgICAgICAgICB1aS5uYXZiYXIudG9nZ2xlU2F2ZVByb2plY3RCdG4oY29uc3RzLkJUTl9ESVNBQkxFRCk7XG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uc2F2ZV9wcm9qZWN0X2J0bi5vZmYoJ2NsaWNrJyk7XG5cbiAgICAgICAgICAgIC8vc2hvdyB3YXJuaW5nIGljb24gb24gY3VycmVudCBmb3JtIHRhYlxuICAgICAgICAgICAgdWkuZm9ybXNfdGFicy5zaG93Rm9ybUludmFsaWRJY29uKGZvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleCk7XG5cbiAgICAgICAgICAgIC8vZGlzYWJsZSBkb3dubG9hZCBmb3JtIGJ1dHRvbiBvbiBjdXJyZW50IGZvcm1cbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvblxuICAgICAgICAgICAgICAgIC5maW5kKCcuaW5wdXRzLWNvbGxlY3Rpb25fX2V4cG9ydC1mb3JtJykuYWRkQ2xhc3MoJ2Rpc2FibGVkJyk7XG4gICAgICAgICAgICAvL2Rpc2FibGUgcHJpbnQgYXMgcGRmIGJ1dHRvblxuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uXG4gICAgICAgICAgICAgICAgLmZpbmQoJy5pbnB1dHMtY29sbGVjdGlvbl9fcHJpbnQtYXMtcGRmJykuYWRkQ2xhc3MoJ2Rpc2FibGVkJyk7XG4gICAgICAgIH1cblxuICAgICAgICAvL3RvZ2dsZSBjb3B5IGJ1dHRvbiAodmFsaWQsIGVuYWJsZSBidXR0b24gZWxzZSBkaXNhYmxlKVxuICAgICAgICB1aS5pbnB1dF9wcm9wZXJ0aWVzX3BhbmVsLnRvZ2dsZUNvcHlJbnB1dEJ1dHRvbihpbnB1dC5yZWYsIGNvcHlfYnRuX3N0YXRlKTtcbiAgICB9LFxuXG4gICAgYXJlQWxsSW5wdXRzVmFsaWQ6IGZ1bmN0aW9uIChwcm9qZWN0X2RlZmluaXRpb24pIHtcbiAgICAgICAgdmFyIGFyZV9hbGxfdmFsaWQgPSB0cnVlO1xuICAgICAgICB2YXIgZm9ybXMgPSBwcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0LmZvcm1zO1xuXG4gICAgICAgIGxvb3AxOlxuICAgICAgICBmb3IgKHZhciBpbmRleCA9IDA7IGluZGV4IDwgZm9ybXMubGVuZ3RoOyBpbmRleCsrKSB7XG5cbiAgICAgICAgICAgIC8vZG8gbm90IGFjY2VwdCBmb3JtcyB3aXRoIG5vIGlucHV0c1xuICAgICAgICAgICAgaWYgKGZvcm1zW2luZGV4XS5pbnB1dHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgYXJlX2FsbF92YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmb3IgKHZhciBpbnB1dF9pbmRleCA9IDA7IGlucHV0X2luZGV4IDwgZm9ybXNbaW5kZXhdLmlucHV0cy5sZW5ndGg7IGlucHV0X2luZGV4KyspIHtcblxuICAgICAgICAgICAgICAgIGlmICghZm9ybXNbaW5kZXhdLmlucHV0c1tpbnB1dF9pbmRleF0uZG9tLmlzX3ZhbGlkKSB7XG4gICAgICAgICAgICAgICAgICAgIGFyZV9hbGxfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWsgbG9vcDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhcmVfYWxsX3ZhbGlkO1xuICAgIH0sXG5cbiAgICBhcmVGb3JtSW5wdXRzVmFsaWQ6IGZ1bmN0aW9uIChmb3JtX2luZGV4KSB7XG5cbiAgICAgICAgdmFyIGFyZV92YWxpZCA9IHRydWU7XG4gICAgICAgIHZhciBmb3JtID0gZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uLmRhdGEucHJvamVjdC5mb3Jtc1tmb3JtX2luZGV4XTtcblxuICAgICAgICAvL2RvIG5vdCBhY2NlcHQgZm9ybXMgd2l0aCBubyBpbnB1dHNcbiAgICAgICAgaWYgKGZvcm0uaW5wdXRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgYXJlX3ZhbGlkID0gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICAvL2xvb3AgYWxsIGlucHV0cyB0byBzZWUgaWYgdGhleSBhcmUgYWxsIHZhbGlkXG4gICAgICAgICQoZm9ybS5pbnB1dHMpLmVhY2goZnVuY3Rpb24gKGluZGV4LCBpbnB1dCkge1xuICAgICAgICAgICAgaWYgKCFpbnB1dC5kb20uaXNfdmFsaWQpIHtcbiAgICAgICAgICAgICAgICBhcmVfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBhcmVfdmFsaWQ7XG4gICAgfSxcblxuICAgIC8vIGEgYnJhbmNoIGlzIHZhbGlkIHdoZW4gdGhlIGJyYW5jaCBoZWFkZXIgaXMgbm90IGVtcHR5IGFuZCB0aGVyZSBpcyBhdCBsZWFzdCBhIHZhbGlkIGJyYW5jaCBxdWVzdGlvblxuICAgIC8vIGFsc28sIGFsbCB0aGUgYnJhbmNoIHF1ZXN0aW9ucyBuZWVkIHRvIHBhc3MgdmFsaWRhdGlvbiB0byBtYWtlIGEgYnJhbmNoIHZhbGlkXG4gICAgdmFsaWRhdGVCcmFuY2hJbnB1dHM6IGZ1bmN0aW9uICh0aGVfYnJhbmNoX293bmVyKSB7XG5cbiAgICAgICAgdmFyIHZhbGlkYXRlID0ge1xuICAgICAgICAgICAgaXNfdmFsaWQ6IHRydWUsXG4gICAgICAgICAgICBlcnJvcjoge1xuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IG51bGwsXG4gICAgICAgICAgICAgICAgdHlwZTogY29uc3RzLkRFRkFVTFRfUFJPUEVSVFlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgYnJhbmNoX293bmVyID0gdGhlX2JyYW5jaF9vd25lcjtcblxuICAgICAgICBpZiAoYnJhbmNoX293bmVyLmJyYW5jaC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHZhbGlkYXRlLmlzX3ZhbGlkID0gZmFsc2U7XG4gICAgICAgICAgICB2YWxpZGF0ZS5lcnJvci5tZXNzYWdlID0gbWVzc2FnZXMuZXJyb3IuTk9fQlJBTkNIX0lOUFVUU19GT1VORDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIC8vY2hlY2sgaWYgQUxMIHRoZSBicmFuY2ggaW5wdXRzIGFyZSB2YWxpZCBhbmQgcmV0dXJuIGFzIHNvb24gYXMgdGhlIGZpcnN0IGludmFsaWQgaXMgZm91bmRcbiAgICAgICAgICAgICQoYnJhbmNoX293bmVyLmJyYW5jaCkuZWFjaChmdW5jdGlvbiAoaW5kZXgsIGlucHV0KSB7XG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJyoqIGlucHV0IGRvbSBpc192YWxpZCBmb3IgYnJhbmNoZXMnKTtcbiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhpbnB1dC5kb20uaXNfdmFsaWQpO1xuICAgICAgICAgICAgICAgIGlmICghaW5wdXQuZG9tLmlzX3ZhbGlkKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbGlkYXRlLmlzX3ZhbGlkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIHZhbGlkYXRlLmVycm9yLm1lc3NhZ2UgPSBtZXNzYWdlcy5lcnJvci5JTlZBTElEX0JSQU5DSF9JTlBVVFM7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmFsaWRhdGU7XG4gICAgfSxcblxuICAgIC8vIGEgZ3JvdXAgaXMgdmFsaWQgd2hlbiB0aGUgZ3JvdXAgaGVhZGVyIGlzIG5vdCBlbXB0eSBhbmQgdGhlcmUgaXMgYXQgbGVhc3QgYSB2YWxpZCBncm91cCBxdWVzdGlvblxuICAgIC8vIGFsc28sIGFsbCB0aGUgZ3JvdXAgcXVlc3Rpb25zIG5lZWQgdG8gcGFzcyB2YWxpZGF0aW9uIHRvIG1ha2UgYSBncm91cCB2YWxpZFxuICAgIHZhbGlkYXRlR3JvdXBJbnB1dHM6IGZ1bmN0aW9uICh0aGVfZ3JvdXBfaW5wdXQpIHtcblxuICAgICAgICB2YXIgdmFsaWRhdGUgPSB7XG4gICAgICAgICAgICBpc192YWxpZDogdHJ1ZSxcbiAgICAgICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgICAgICAgbWVzc2FnZTogbnVsbCxcbiAgICAgICAgICAgICAgICB0eXBlOiBjb25zdHMuREVGQVVMVF9QUk9QRVJUWVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBncm91cF9pbnB1dCA9IHRoZV9ncm91cF9pbnB1dDtcblxuICAgICAgICBpZiAoZ3JvdXBfaW5wdXQuZ3JvdXAubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICB2YWxpZGF0ZS5pc192YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgdmFsaWRhdGUuZXJyb3IubWVzc2FnZSA9IG1lc3NhZ2VzLmVycm9yLk5PX0dST1VQX0lOUFVUU19GT1VORDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIC8vY2hlY2sgaWYgQUxMIHRoZSBncm91cCBpbnB1dHMgYXJlIHZhbGlkIGFuZCByZXR1cm4gYXMgc29vbiBhcyB0aGUgZmlyc3QgaW52YWxpZCBpcyBmb3VuZFxuICAgICAgICAgICAgJChncm91cF9pbnB1dC5ncm91cCkuZWFjaChmdW5jdGlvbiAoaW5kZXgsIGlucHV0KSB7XG4gICAgICAgICAgICAgICAgaWYgKCFpbnB1dC5kb20uaXNfdmFsaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsaWRhdGUuaXNfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgdmFsaWRhdGUuZXJyb3IubWVzc2FnZSA9IG1lc3NhZ2VzLmVycm9yLklOVkFMSURfR1JPVVBfSU5QVVRTO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZhbGlkYXRlO1xuICAgIH0sXG5cbiAgICB2YWxpZGF0ZUp1bXBzQWZ0ZXJTb3J0aW5nOiBmdW5jdGlvbiAoaW5wdXRzKSB7XG5cbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB2YXIgdWkgPSByZXF1aXJlKCdoZWxwZXJzL3VpJyk7XG4gICAgICAgIHZhciBpbnB1dHNfdG9fdmFsaWRhdGUgPSBpbnB1dHM7XG4gICAgICAgIHZhciBqdW1wc19saXN0X3dyYXBwZXJfZG9tO1xuICAgICAgICB2YXIganVtcHNfZG9tO1xuICAgICAgICB2YXIganVtcF9kb207XG5cbiAgICAgICAgLy92YWxpZGF0ZSBwcmV2aW91cyBpbnB1dHMgYmFzZWQgYW5kIGN1cnJlbnQgb25lXG4gICAgICAgIGZvciAodmFyIGluZGV4ID0gMDsgaW5kZXggPCBpbnB1dHNfdG9fdmFsaWRhdGUubGVuZ3RoOyBpbmRleCsrKSB7XG5cbiAgICAgICAgICAgIHZhciBpbnB1dCA9IGlucHV0c190b192YWxpZGF0ZVtpbmRleF07XG4gICAgICAgICAgICB2YXIgYXJlX2p1bXBzX3ZhbGlkID0gdHJ1ZTtcblxuICAgICAgICAgICAgLy9oaWRlIGFsbCBlcnJvcnMgZm9yIGEganVtcCBpbiB0aGUgZG9tXG4gICAgICAgICAgICBqdW1wc19saXN0X3dyYXBwZXJfZG9tID0gZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlclxuICAgICAgICAgICAgICAgIC5maW5kKCdmb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIGlucHV0LnJlZiArICdcIl0nKVxuICAgICAgICAgICAgICAgIC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fanVtcHMgLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2p1bXBzX19saXN0Jyk7XG5cbiAgICAgICAgICAgIGp1bXBzX2RvbSA9IGp1bXBzX2xpc3Rfd3JhcHBlcl9kb20uZmluZCgnbGknKTtcblxuICAgICAgICAgICAgLy9oaWRlIGFsbCB0aGUganVtcHMgZXJyb3JcbiAgICAgICAgICAgIGlucHV0LmhpZGVKdW1wc0Vycm9ycyhqdW1wc19kb20pO1xuXG4gICAgICAgICAgICBmb3IgKHZhciBqdW1wX2luZGV4ID0gMDsganVtcF9pbmRleCA8IGlucHV0Lmp1bXBzLmxlbmd0aDsganVtcF9pbmRleCsrKSB7XG5cbiAgICAgICAgICAgICAgICB2YXIganVtcCA9IGlucHV0Lmp1bXBzW2p1bXBfaW5kZXhdO1xuXG4gICAgICAgICAgICAgICAgLy8gQXNzdW1lIHRoZSBpbmRleCBvZiB0aGUgPGxpPiBpbiB0aGUgbGlzdCBpcyB0aGUgc2FtZSBvZiB0aGUgaW5kZXggaW4gdGhlIGp1bXBzIG9iamVjdFxuICAgICAgICAgICAgICAgIGp1bXBfZG9tID0ganVtcHNfZG9tLmVxKGp1bXBfaW5kZXgpO1xuXG4gICAgICAgICAgICAgICAgLy90b2RvIGlmIGFueSBlcnJvciwgaGlnaGxpZ2h0IHRoZSB3cm9uZyBkZXN0aW5hdGlvbiBpbiB0aGUgbWFya3VwXG4gICAgICAgICAgICAgICAgaWYgKCFzZWxmLmlzSnVtcFZhbGlkKGp1bXAsIGlucHV0KSkge1xuXG4gICAgICAgICAgICAgICAgICAgIC8vc2hvdyBlcnJvcnNcbiAgICAgICAgICAgICAgICAgICAgaW5wdXQuc2hvd1NpbmdsZUp1bXBFcnJvcnMoanVtcF9kb20sIGp1bXApO1xuXG4gICAgICAgICAgICAgICAgICAgIC8va2VlcCB0cmFjayB0aGUganVtcHMgbm93IGFyZSBpbnZhbGlkXG4gICAgICAgICAgICAgICAgICAgIGFyZV9qdW1wc192YWxpZCA9IGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vc2V0IGlucHV0IGluIHRoZSBkb20gYXMgaW52YWxpZCwgYW5kIGFsc28gdGhlIGZvcm0gaWYgaXQgaXMgdGhlIG9ubHkgaW52YWxpZCBvbmVcbiAgICAgICAgICAgICAgICAgICAgdWkuaW5wdXRzX2NvbGxlY3Rpb24uc2hvd0lucHV0SW52YWxpZEljb24oaW5wdXQucmVmKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vdG9kbyB3aGF0IGlmIEkgaGF2ZSBtdWx0aXBsZSBqdW1wcyB3aXRoIGVycm9ycz9cbiAgICAgICAgICAgICAgICAgICAgdWkuaW5wdXRfcHJvcGVydGllc19wYW5lbC5oaWRlSnVtcFRhYkVycm9yKGp1bXBfZG9tKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vSXMgdGhlIGlucHV0IHZhbGlkIGFzaWRlIGZyb20gdGhlIGp1bXBzPyBUaGF0IHdvdWxkIG1lYW4gYWxsIHRoZSBqdW1wcyB3ZXJlIG9rLCBidXQgdGhlcmUgbWlnaHQgYmUgb3RoZXIgZXJyb3JzXG4gICAgICAgICAgICAvL3dlIGp1c3QgbmVlZCB0byBjaGVjayB0aGUgb2JqZWN0IHByb3BlcnRpZXMsIGFzIHRoZXkgZG8gbm90IGNoYW5nZSB3aGVuIHNvcnRpbmdcbiAgICAgICAgICAgIGlucHV0LmRvbS5pc192YWxpZCA9IHNlbGYuaXNJbnB1dE9iamVjdFZhbGlkKGlucHV0KSAmJiBhcmVfanVtcHNfdmFsaWQ7XG5cbiAgICAgICAgICAgIC8vc2V0IGlucHV0IHZhbGlkYXRpb24gaWNvbiBhY2NvcmRpbmdseVxuICAgICAgICAgICAgaWYgKGlucHV0LmRvbS5pc192YWxpZCkge1xuICAgICAgICAgICAgICAgIHVpLmlucHV0c19jb2xsZWN0aW9uLnNob3dJbnB1dFZhbGlkSWNvbihpbnB1dC5yZWYpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdWkuaW5wdXRzX2NvbGxlY3Rpb24uc2hvd0lucHV0SW52YWxpZEljb24oaW5wdXQucmVmKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG5cbiAgICAgICAgLy9jaGVjayBpZiB0aGUgZm9ybSBpcyBub3cgdmFsaWRcbiAgICAgICAgaWYgKHNlbGYuYXJlRm9ybUlucHV0c1ZhbGlkKGZvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleCkpIHtcbiAgICAgICAgICAgIHVpLmZvcm1zX3RhYnMuc2hvd0Zvcm1WYWxpZEljb24oZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4KTtcblxuICAgICAgICAgICAgLy9lbmFibGUgZG93bmxvYWQgZm9ybSBidXR0b25cbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvblxuICAgICAgICAgICAgICAgIC5maW5kKCcuaW5wdXRzLWNvbGxlY3Rpb25fX2V4cG9ydC1mb3JtJykucmVtb3ZlQ2xhc3MoJ2Rpc2FibGVkJyk7XG5cbiAgICAgICAgICAgIC8vZW5hYmxlIHByaW50IGFzIHBkZiBmb3JtIGJ1dHRvblxuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uXG4gICAgICAgICAgICAgICAgLmZpbmQoJy5pbnB1dHMtY29sbGVjdGlvbl9fcHJpbnQtYXMtcGRmJykucmVtb3ZlQ2xhc3MoJ2Rpc2FibGVkJyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB1aS5mb3Jtc190YWJzLnNob3dGb3JtSW52YWxpZEljb24oZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4KTtcblxuICAgICAgICAgICAgLy9kaXNhYmxlIGZvcm0gZG93bmxvYWQgYnV0dG9uXG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25cbiAgICAgICAgICAgICAgICAuZmluZCgnLmlucHV0cy1jb2xsZWN0aW9uX19leHBvcnQtZm9ybScpLmFkZENsYXNzKCdkaXNhYmxlZCcpO1xuXG4gICAgICAgICAgICAvL2Rpc2FibGUgcHJpbnQgYXMgcGRmIGRvd25sb2FkIGJ1dHRvblxuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uXG4gICAgICAgICAgICAgICAgLmZpbmQoJy5pbnB1dHMtY29sbGVjdGlvbl9fcHJpbnQtYXMtcGRmJykuYWRkQ2xhc3MoJ2Rpc2FibGVkJyk7XG4gICAgICAgIH1cblxuICAgICAgICAvL2NoZWNrIGlmIGFsbCBpbnB1dHMgYXJlIG5vdyB2YWxpZCB0byBlbmFibGUgc2F2ZSBwcm9qZWN0IGJ1dHRvblxuICAgICAgICBpZiAoc2VsZi5hcmVBbGxJbnB1dHNWYWxpZChmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24pKSB7XG4gICAgICAgICAgICB1aS5uYXZiYXIudG9nZ2xlU2F2ZVByb2plY3RCdG4oY29uc3RzLkJUTl9FTkFCTEVEKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHVpLm5hdmJhci50b2dnbGVTYXZlUHJvamVjdEJ0bihjb25zdHMuQlROX0RJU0FCTEVEKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBpc0lucHV0T2JqZWN0VmFsaWQ6IGZ1bmN0aW9uIChpbnB1dCkge1xuXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdmFyIGlzX3ZhbGlkID0gdHJ1ZTtcblxuICAgICAgICAvL2NoZWNrIHF1ZXN0aW9uIHRleHQgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgICAgaWYgKCFzZWxmLmlzUXVlc3Rpb25UZXh0VmFsaWQoaW5wdXQpLmlzX3ZhbGlkKSB7XG4gICAgICAgICAgICBpc192YWxpZCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIC8vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuXG4gICAgICAgIC8vdGVzdCBtaW4gYW5kIG1heCBmb3IgaW50ZWdlciAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAgICBpZiAoaW5wdXQudHlwZSA9PT0gY29uc3RzLklOVEVHRVJfVFlQRSkge1xuXG4gICAgICAgICAgICAvL2lzIG1pbiBhIGludD9cbiAgICAgICAgICAgIGlmIChpbnB1dC5taW4gIT09ICcnKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFzZWxmLmlzVmFsdWVJbnQoaW5wdXQubWluKSkge1xuICAgICAgICAgICAgICAgICAgICBpc192YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy9pcyBtYXggYSBpbnQ/XG4gICAgICAgICAgICBpZiAoaW5wdXQubWF4ICE9PSAnJykge1xuICAgICAgICAgICAgICAgIGlmICghc2VsZi5pc1ZhbHVlSW50KGlucHV0Lm1heCkpIHtcbiAgICAgICAgICAgICAgICAgICAgaXNfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vSWYgYm90aCBhcmUgc2V0LCBhcmUgdGhleSB2YWxpZD9cbiAgICAgICAgICAgIGlmIChpc192YWxpZCAmJiAoaW5wdXQubWluICE9PSAnJyAmJiBpbnB1dC5tYXggIT09ICcnKSkge1xuICAgICAgICAgICAgICAgIGlmIChwYXJzZUZsb2F0KGlucHV0Lm1pbikgPiBwYXJzZUZsb2F0KGlucHV0Lm1heCkpIHtcbiAgICAgICAgICAgICAgICAgICAgaXNfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vaWYgdGhlIGRlZmF1bHQgYW5zd2VyIGlzIHNldCwgaXMgaXQgdmFsaWQ/XG4gICAgICAgICAgICBpZiAoaW5wdXQuZGVmYXVsdCAhPT0gJycpIHtcbiAgICAgICAgICAgICAgICBpZiAoIXNlbGYuaXNWYWx1ZUludChpbnB1dC5kZWZhdWx0KSkge1xuICAgICAgICAgICAgICAgICAgICBpc192YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy9kZWZhdWx0IGFuc3dlciBpcyBhIHZhbGlkIGludCwgaXMgaXQgd2l0aGluIHJhbmdlP1xuICAgICAgICAgICAgICAgICAgICBpZiAoaW5wdXQubWluICE9PSAnJyAmJiBwYXJzZUludChpbnB1dC5kZWZhdWx0LCAwKSA8IGlucHV0Lm1pbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaXNfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoaW5wdXQubWluICE9PSAnJyAmJiBwYXJzZUludChpbnB1dC5kZWZhdWx0LCAwKSA+IGlucHV0Lm1heCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaXNfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcblxuICAgICAgICAvL3Rlc3QgbWluIGFuZCBtYXggZm9yIGRlY2ltYWwgKGZsb2F0KSAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgICAgaWYgKGlucHV0LnR5cGUgPT09IGNvbnN0cy5ERUNJTUFMX1RZUEUpIHtcbiAgICAgICAgICAgIC8vaXMgbWluIGEgZmxvYXQgb3IgYW4gaW50ZWdlcj9cbiAgICAgICAgICAgIGlmIChpbnB1dC5taW4gIT09ICcnKSB7XG4gICAgICAgICAgICAgICAgaWYgKCEoc2VsZi5pc1ZhbHVlRmxvYXQoaW5wdXQubWluKSB8fCBzZWxmLmlzVmFsdWVJbnQoaW5wdXQubWluKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgaXNfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vaXMgbWF4IGEgZmxvYXQgb3IgaW50ZWdlcj9cbiAgICAgICAgICAgIGlmIChpbnB1dC5tYXggIT09ICcnKSB7XG4gICAgICAgICAgICAgICAgaWYgKCEoc2VsZi5pc1ZhbHVlRmxvYXQoaW5wdXQubWF4KSB8fCBzZWxmLmlzVmFsdWVJbnQoaW5wdXQubWF4KSkpIHtcbiAgICAgICAgICAgICAgICAgICAgaXNfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vSWYgYm90aCBhcmUgc2V0LCBhcmUgdGhleSB2YWxpZD9cbiAgICAgICAgICAgIGlmIChpc192YWxpZCAmJiAoaW5wdXQubWluICE9PSAnJyAmJiBpbnB1dC5tYXggIT09ICcnKSkge1xuICAgICAgICAgICAgICAgIGlmIChwYXJzZUZsb2F0KGlucHV0Lm1pbikgPiBwYXJzZUZsb2F0KGlucHV0Lm1heCkpIHtcbiAgICAgICAgICAgICAgICAgICAgaXNfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vaWYgdGhlIGRlZmF1bHQgYW5zd2VyIGlzIHNldCwgaXMgaXQgdmFsaWQ/XG4gICAgICAgICAgICBpZiAoaW5wdXQuZGVmYXVsdCAhPT0gJycpIHtcbiAgICAgICAgICAgICAgICBpZiAoIShzZWxmLmlzVmFsdWVGbG9hdChpbnB1dC5kZWZhdWx0KSB8fCBzZWxmLmlzVmFsdWVJbnQoaW5wdXQuZGVmYXVsdCkpKSB7XG4gICAgICAgICAgICAgICAgICAgIGlzX3ZhbGlkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvL2RlZmF1bHQgYW5zd2VyIGlzIGEgdmFsaWQgbnVtYmVyLCBpcyBpdCB3aXRoaW4gcmFuZ2U/XG4gICAgICAgICAgICAgICAgICAgIGlmIChpbnB1dC5taW4gIT09ICcnICYmIHBhcnNlRmxvYXQoaW5wdXQuZGVmYXVsdCkgPCBpbnB1dC5taW4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzX3ZhbGlkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGlucHV0Lm1pbiAhPT0gJycgJiYgcGFyc2VGbG9hdChpbnB1dC5kZWZhdWx0KSA+IGlucHV0Lm1heCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaXNfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcblxuICAgICAgICAvL2NoZWNrIHBvc3NpYmxlIGFuc3dlcnMgZm9yIG11bHRpcGxlIGFuc3dlciB0eXBlcyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgICAgaWYgKGNvbnN0cy5NVUxUSVBMRV9BTlNXRVJfVFlQRVMuaW5kZXhPZihpbnB1dC50eXBlICE9PSAtMSkpIHtcbiAgICAgICAgICAgICQoaW5wdXQucG9zc2libGVfYW5zd2VycykuZWFjaChmdW5jdGlvbiAoaW5kZXgsIHBvc3NpYmxlX2Fuc3dlcikge1xuICAgICAgICAgICAgICAgIGlmICghc2VsZi5pc1Bvc3NpYmxlQW5zd2VyVmFsaWQocG9zc2libGVfYW5zd2VyLmFuc3dlcikuaXNfdmFsaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgaXNfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICAvLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcblxuICAgICAgICAvL2dyb3VwIHR5cGUgYnV0IGVtcHR5PyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgICAgaWYgKGlucHV0LnR5cGUgPT09IGNvbnN0cy5HUk9VUF9UWVBFICYmIGlucHV0Lmdyb3VwLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgaXNfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICAvLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcblxuICAgICAgICAvL2JyYW5jaCB0eXBlIGJ1dCBlbXB0eT8gKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgICAgaWYgKGlucHV0LnR5cGUgPT09IGNvbnN0cy5CUkFOQ0hfVFlQRSAmJiBpbnB1dC5icmFuY2gubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBpc192YWxpZCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIC8vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuXG4gICAgICAgIHJldHVybiBpc192YWxpZDtcbiAgICB9XG4gICAgLFxuXG4gICAgdmFsaWRhdGVCZWZvcmVTYXZpbmc6IGZ1bmN0aW9uIChmb3JtX3JlZiwgaW5wdXRzKSB7XG5cbiAgICAgICAgdmFyIHZhbGlkYXRlID0ge1xuICAgICAgICAgICAgaXNfdmFsaWQ6IHRydWUsXG4gICAgICAgICAgICBlcnJvcjoge1xuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IG51bGxcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgdmFyIGludmFsaWRfcXVlc3Rpb24gPSAnJztcbiAgICAgICAgdmFyIGFyZV9pbnB1dHNfdmFsaWQgPSB0cnVlO1xuICAgICAgICB2YXIgYXJlX2JyYW5jaF9pbnB1dHNfdmFsaWQgPSB0cnVlO1xuICAgICAgICAkKGlucHV0cykuZWFjaChmdW5jdGlvbiAoaW5kZXgsIGlucHV0KSB7XG4gICAgICAgICAgICBpZiAoIWltcG9ydF9mb3JtX3ZhbGlkYXRpb24uaXNWYWxpZElucHV0KGZvcm1fcmVmLCBpbnB1dCwgZmFsc2UsIGZhbHNlKSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKEpTT04uc3RyaW5naWZ5KGlucHV0KSk7XG4gICAgICAgICAgICAgICAgaW52YWxpZF9xdWVzdGlvbiA9IGlucHV0LnF1ZXN0aW9uLnRydW5jKDUwKTtcbiAgICAgICAgICAgICAgICBhcmVfaW5wdXRzX3ZhbGlkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOy8vZXhpdCBsb29wIG9ubHlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHZhciBxdWVzdGlvbnNfdG90YWw7XG5cbiAgICAgICAgaWYgKCFhcmVfaW5wdXRzX3ZhbGlkKSB7XG4gICAgICAgICAgICB2YWxpZGF0ZSA9IHtcbiAgICAgICAgICAgICAgICBpc192YWxpZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6IHtcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogaW52YWxpZF9xdWVzdGlvblxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXR1cm4gdmFsaWRhdGU7XG4gICAgICAgIH1cblxuICAgICAgICAvL2NoZWNrIHRvdGFsIG51bWJlciBvZiBxdWVzdGlvbnMvYnJhbmNoZXNcbiAgICAgICAgcXVlc3Rpb25zX3RvdGFsID0gdXRpbHMuZ2V0SW5wdXRzVG90YWwoaW5wdXRzKTtcbiAgICAgICAgaWYgKHF1ZXN0aW9uc190b3RhbCA+IGNvbnN0cy5JTlBVVFNfTUFYX0FMTE9XRUQpIHtcbiAgICAgICAgICAgIHZhbGlkYXRlID0ge1xuICAgICAgICAgICAgICAgIGlzX3ZhbGlkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjoge1xuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiBtZXNzYWdlcy5lcnJvci5UT09fTUFOWV9RVUVTVElPTlNfRk9SX0NVUlJFTlRfRk9STSArIHF1ZXN0aW9uc190b3RhbCArICcsIGxpbWl0IGlzICcgKyBjb25zdHMuSU5QVVRTX01BWF9BTExPV0VEICsgJyEnXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiB2YWxpZGF0ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vY2hlY2sgdG90YWwgbnVtYmVyIG9mIHRpdGxlcyAobWFpbiBmb3JtKVxuICAgICAgICBpZiAodXRpbHMuaXNNYXhUaXRsZUxpbWl0RXhjZWVkZWQoaW5wdXRzKSkge1xuICAgICAgICAgICAgdmFsaWRhdGUgPSB7XG4gICAgICAgICAgICAgICAgaXNfdmFsaWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2VzLmVycm9yLlRPT19NQU5ZX1RJVExFU1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXR1cm4gdmFsaWRhdGU7XG4gICAgICAgIH1cbiAgICAgICAgLy9jaGVjayB0b3RhbCBudW1iZXIgb2YgdGl0bGVzIChicmFuY2hlcylcbiAgICAgICAgJChpbnB1dHMpLmVhY2goZnVuY3Rpb24gKGluZGV4LCBpbnB1dCkge1xuICAgICAgICAgICAgaWYgKHV0aWxzLmlzTWF4VGl0bGVMaW1pdEV4Y2VlZGVkKGlucHV0LmJyYW5jaCkpIHtcbiAgICAgICAgICAgICAgICBhcmVfYnJhbmNoX2lucHV0c192YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKCFhcmVfYnJhbmNoX2lucHV0c192YWxpZCkge1xuICAgICAgICAgICAgdmFsaWRhdGUgPSB7XG4gICAgICAgICAgICAgICAgaXNfdmFsaWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2VzLmVycm9yLlRPT19NQU5ZX1RJVExFUyArICcgKGJyYW5jaCknXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiB2YWxpZGF0ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vY2hlY2sganVtcHMgZGVzdGluYXRpb25zXG4gICAgICAgIGlmICghaW1wb3J0X2Zvcm1fdmFsaWRhdGlvbi5hcmVKdW1wc0Rlc3RpbmF0aW9uc1ZhbGlkKGlucHV0cykpIHtcbiAgICAgICAgICAgIHZhbGlkYXRlID0ge1xuICAgICAgICAgICAgICAgIGlzX3ZhbGlkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBlcnJvcjoge1xuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiBtZXNzYWdlcy5lcnJvci5KVU1QU19JTlZBTElEXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiB2YWxpZGF0ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vY2hlY2sgdG90YWwgbnVtYmVyIG9mIHNlYXJjaCBpbnB1dHNcbiAgICAgICAgaWYgKHV0aWxzLmdldFNlYXJjaElucHV0c1RvdGFsKCkgPiBjb25zdHMuTElNSVRTLnNlYXJjaF9pbnB1dHNfbWF4KSB7XG4gICAgICAgICAgICB2YWxpZGF0ZSA9IHtcbiAgICAgICAgICAgICAgICBpc192YWxpZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6IHtcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogbWVzc2FnZXMuZXJyb3IuVE9PX01BTllfU0VBUkNIX1FVRVNUSU9OU1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXR1cm4gdmFsaWRhdGU7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdmFsaWRhdGU7XG4gICAgfVxufVxuICAgIDtcblxubW9kdWxlLmV4cG9ydHMgPSB2YWxpZGF0aW9uO1xuXG4iLCIvKlxuIHNldCBvZiBjb25zdGFudHMgYW5kIHZhbHVlcyB0byB1c2UgYWNyb3NzIHRoZSBhcHBsaWNhdGlvblxuIHdlIHVzZSBgY29uc3RzYCBhcyBjb25zdCBpcyBhIHJlc2VydmVkIHdvcmQgYW5kIGBjb25zdGFudGAgaXMgYSB3aW5kb3cgZ2xvYmFsIG9iamVjdFxuICovXG4ndXNlIHN0cmljdCc7XG5cbmNvbnNvbGUubG9nKHdpbmRvdy5sb2NhdGlvbi5ocmVmKTtcblxudmFyIGNvbnN0cyA9IHtcblxuICAgIFBST0pFQ1RfVVJMOiAnJyxcbiAgICBQUk9KRUNUX0xPR09fVVJMOiAnJyxcbiAgICBCQUNLX1VSTDogJycsXG4gICAgQVBJX0RFVkVMT1BNRU5UX0dFVF9QQVRIOiAnLi4vcHJvamVjdC8nLFxuICAgIEFQSV9ERVZFTE9QTUVOVF9QT1NUX1BBVEg6ICcuLi9wb3N0ZHVtcC8nLFxuICAgIEFQSV9ERVZFTE9QTUVOVF9QUk9KRUNUOiAncHJvamVjdC5qc29uJyxcblxuICAgIEFQSV9QUk9EVUNUSU9OX1BBVEg6ICdhcGkvaW50ZXJuYWwvZm9ybWJ1aWxkZXIvJyxcbiAgICBBUElfTUVESUFfUEFUSDogJ2FwaS9pbnRlcm5hbC9tZWRpYS8nLFxuICAgIEFQSV9QUk9KRUNUX0xPR09fUVVFUllfU1RSSU5HOiAnP3R5cGU9cGhvdG8mbmFtZT1sb2dvLmpwZyZmb3JtYXQ9cHJvamVjdF9tb2JpbGVfbG9nbycsXG4gICAgQVBJX0RFVkVMT1BNRU5UX1NFUlZFUjogJ2h0dHA6Ly9sb2NhbGhvc3QvZGV2L2VwaWNvbGxlY3Q1LXZwcy1hbnQtbmV3LycsLy90byBiZSBjaGFuZ2VkIGFjY29yZGluZ2x5XG5cbiAgICBQUk9KRUNUX05BTUVfTUFYX0xFTkdIVDogMTAwLFxuICAgIEZPUk1fTkFNRV9NQVhfTEVOR0hUOiA1MCxcbiAgICBJTlBVVFNfTUFYX0FMTE9XRUQ6IDMwMCxcbiAgICBUQUJfRk9STV9OQU1FX01BWF9ESVNQTEFZX0xFTkdIVDogMjIsXG4gICAgSU5QVVRTX0NPTExFQ1RJT05fRk9STV9OQU1FX01BWF9ESVNQTEFZX0xFTkdIVDogMjIsXG4gICAgSU5QVVRTX0NPTExFQ1RJT05fQlJBTkNIX05BTUVfTUFYX0RJU1BMQVlfTEVOR0hUOiAyNSxcbiAgICBJTlBVVFNfQ09MTEVDVElPTl9HUk9VUF9OQU1FX01BWF9ESVNQTEFZX0xFTkdIVDogMjUsXG4gICAgTUFYX05VTUJFUl9PRl9ORVNURURfQ0hJTERfRk9STVM6IDUsXG4gICAgQU5JTUFUSU9OX0ZBU1Q6IDEwMCwvL21pbGxpc2Vjb25kc1xuICAgIEFOSU1BVElPTl9OT1JNQUw6IDE1MCxcbiAgICBBTklNQVRJT05fU0xPVzogNTAwLFxuICAgIEFOSU1BVElPTl9TVVBFUl9TTE9XOiAxMDAwLFxuXG4gICAgRk9STV9OQU1FX1JFR0VYOiAvXltcXHdcXC1cXHNdKyQvLCAvL2FsbG93IG9ubHkgYWxwaGFudW1lcmljIGNoYXJzIGFuZCAnLScsICdfJ1xuICAgIEZPUk1fSElFUkFSQ0hZX1RZUEU6ICdoaWVyYXJjaHknLFxuICAgIEZPUk1fVFlQRTogJ2Zvcm0nLFxuXG4gICAgVU5JUVVFU1NfTk9ORTogJ25vbmUnLFxuICAgIFVOSVFVRVNTX0ZPUk06ICdmb3JtJyxcbiAgICBVTklRVUVTU19ISUVSQVJDSFk6ICdoaWVyYXJjaHknLFxuXG4gICAgLy9hcHAgaWRzIG5hbWVzcGFjZVxuICAgIE5BTUVTUEFDRV9QUkVGSVg6ICdlYzVfJyxcblxuICAgIC8vaW5wdXQgdHlwZXMgaWNvbnNcbiAgICBURVhUX1RZUEVfSUNPTjogJ2ZhLXRleHQtd2lkdGgnLCAvL1xuICAgIFRFWFRBUkVBX1RZUEVfSUNPTjogJ2ZhLXN0aWNreS1ub3RlLW8nLFxuICAgIE5VTUVSSUNfVFlQRV9JQ09OOiAnZmEtaGFzaHRhZycsXG4gICAgSU5URUdFUl9UWVBFX0lDT046ICdmYS1oYXNodGFnJyxcbiAgICBERUNJTUFMX1RZUEVfSUNPTjogJ2ZhLWhhc2h0YWcnLFxuICAgIERBVEVfVFlQRV9JQ09OOiAnZmEtY2FsZW5kYXInLFxuICAgIFRJTUVfVFlQRV9JQ09OOiAnZmEtY2xvY2stbycsXG4gICAgUkFESU9fVFlQRV9JQ09OOiAnZmEtZG90LWNpcmNsZS1vJyxcbiAgICBSRUFETUVfVFlQRV9JQ09OOiAnZmEtZmlsZS10ZXh0LW8nLFxuICAgIENIRUNLQk9YX1RZUEVfSUNPTjogJ2ZhLWNoZWNrLXNxdWFyZS1vJyxcbiAgICBEUk9QRE9XTl9UWVBFX0lDT046ICdmYS1jYXJldC1zcXVhcmUtby1kb3duJyxcbiAgICBCQVJDT0RFX1RZUEVfSUNPTjogJ2ZhLWJhcmNvZGUnLFxuICAgIExPQ0FUSU9OX1RZUEVfSUNPTjogJ2ZhLW1hcC1tYXJrZXInLFxuICAgIEFVRElPX1RZUEVfSUNPTjogJ2ZhLW1pY3JvcGhvbmUnLFxuICAgIFZJREVPX1RZUEVfSUNPTjogJ2ZhLXZpZGVvLWNhbWVyYScsXG4gICAgUEhPVE9fVFlQRV9JQ09OOiAnZmEtY2FtZXJhLXJldHJvJyxcbiAgICBQSE9ORV9UWVBFX0lDT046ICdmYS1waG9uZScsXG4gICAgQlJBTkNIX1RZUEVfSUNPTjogJ2ZhLWNsb25lJyxcbiAgICBHUk9VUF9UWVBFX0lDT046ICdmYS1hbGlnbi1qdXN0aWZ5JyxcbiAgICBTRUFSQ0hfU0lOR0xFX1RZUEVfSUNPTjogJ2ZhLXNlYXJjaCcsXG4gICAgU0VBUkNIX01VTFRJUExFX1RZUEVfSUNPTjogJ2ZhLXNlYXJjaCcsXG5cbiAgICAvL2lucHV0IHR5cGVzXG4gICAgVEVYVF9UWVBFOiAndGV4dCcsIC8vXG4gICAgVEVYVEFSRUFfVFlQRTogJ3RleHRhcmVhJyxcbiAgICBJTlRFR0VSX1RZUEU6ICdpbnRlZ2VyJyxcbiAgICBERUNJTUFMX1RZUEU6ICdkZWNpbWFsJyxcbiAgICBEQVRFX1RZUEU6ICdkYXRlJyxcbiAgICBUSU1FX1RZUEU6ICd0aW1lJyxcbiAgICBSQURJT19UWVBFOiAncmFkaW8nLFxuICAgIENIRUNLQk9YX1RZUEU6ICdjaGVja2JveCcsXG4gICAgRFJPUERPV05fVFlQRTogJ2Ryb3Bkb3duJyxcbiAgICBCQVJDT0RFX1RZUEU6ICdiYXJjb2RlJyxcbiAgICBMT0NBVElPTl9UWVBFOiAnbG9jYXRpb24nLFxuICAgIEFVRElPX1RZUEU6ICdhdWRpbycsXG4gICAgVklERU9fVFlQRTogJ3ZpZGVvJyxcbiAgICBQSE9UT19UWVBFOiAncGhvdG8nLFxuICAgIEJSQU5DSF9UWVBFOiAnYnJhbmNoJyxcbiAgICBHUk9VUF9UWVBFOiAnZ3JvdXAnLFxuICAgIFJFQURNRV9UWVBFOiAncmVhZG1lJyxcbiAgICBQSE9ORV9UWVBFOiAncGhvbmUnLFxuICAgIFNFQVJDSF9TSU5HTEVfVFlQRTogJ3NlYXJjaHNpbmdsZScsXG4gICAgU0VBUkNIX01VTFRJUExFX1RZUEU6ICdzZWFyY2htdWx0aXBsZScsXG5cbiAgICAvL2RhdGUgZm9ybWF0c1xuICAgIERBVEVfRk9STUFUXzE6ICdkZC9NTS9ZWVlZJyxcbiAgICBEQVRFX0ZPUk1BVF8yOiAnTU0vZGQvWVlZWScsXG4gICAgREFURV9GT1JNQVRfMzogJ1lZWVkvTU0vZGQnLFxuICAgIERBVEVfRk9STUFUXzQ6ICdNTS9ZWVlZJyxcbiAgICBEQVRFX0ZPUk1BVF81OiAnZGQvTU0nLFxuXG4gICAgLy90aW1lIGZvcm1hdHNcbiAgICBUSU1FX0ZPUk1BVF8xOiAnSEg6bW06c3MnLFxuICAgIFRJTUVfRk9STUFUXzI6ICdoaDptbTpzcycsXG4gICAgVElNRV9GT1JNQVRfMzogJ0hIOm1tJyxcbiAgICBUSU1FX0ZPUk1BVF80OiAnaGg6bW0nLFxuICAgIFRJTUVfRk9STUFUXzU6ICdtbTpzcycsXG5cbiAgICAvL3Jlc2VydmVyZCB3b3Jkcy9jaGFyc1xuICAgIC8vUkVTRVJWRURfV09SRF9TS0lQUDNEOiAnX3NraXBwM2RfJyxcbiAgICAvL1BBVEhfU0VQQVJBVE9SX01PQklMRV9DTElFTlQ6ICd8JyxcblxuICAgIC8vaW5wdXQgcHJvcGVydGllcyBuYW1lc1xuICAgIERFRkFVTFRfUFJPUEVSVFk6ICdkZWZhdWx0JyxcbiAgICBRVUVTVElPTl9QUk9QRVJUWTogJ3F1ZXN0aW9uJyxcbiAgICBNSU5fVkFMVUVfUFJPUEVSVFk6ICdtaW4nLFxuICAgIE1BWF9WQUxVRV9QUk9QRVJUWTogJ21heCcsXG5cbiAgICAvL2J1dHRvbiBsYWJlbHNcbiAgICBTSE9XX0pVTVBTOiAnU2hvdyBqdW1wcycsXG4gICAgSElERV9KVU1QUzogJ0hpZGUganVtcHMnLFxuICAgIEpVTVBfVE9fRU5EX09GX0ZPUk1fUkVGOiAnRU5EJyxcbiAgICBKVU1QX1RPX0VORF9PRl9GT1JNX0xBQkVMOiAnRW5kIG9mIGZvcm0nLFxuXG4gICAgLy9wb3NzaWJsZSBhbnN3ZXJzXG4gICAgUE9TU0lCSUxFX0FOU1dFUlNfQ1VTVE9NX0lEOiAncGFfY3VzdG9tX2lkJyxcbiAgICBQT1NTSUJJTEVfQU5TV0VSX1BMQUNFSE9MREVSOiAnSSBhbSBhIHBsYWNlaG9sZGVyIGFuc3dlcicsXG4gICAgVVNFX0FOU1dFUl9BU19USVRMRTogJ1VzZSBhbnN3ZXIgYXMgdGl0bGUnLFxuICAgIE1BWF9USVRMRV9MSU1JVF9SRUFDSEVEOiAnTGltaXQgb2YgMyB0aXRsZXMgcmVhY2hlZCcsXG5cbiAgICAvL3BhdGhzXG4gICAgVklFV1NfUEFUSDogJ3ZpZXdzLycsXG5cbiAgICAvL2J1dHRvbnMgc3RhdHVzXG4gICAgQlROX0VOQUJMRUQ6ICdidG4tZW5hYmxlZCcsXG4gICAgQlROX0RJU0FCTEVEOiAnYnRuLWRpc2FibGVkJyxcblxuICAgIEVOQUJMRURfU1RBVEU6ICdlbmFibGVkJyxcbiAgICBESVNBQkxFRF9TVEFURTogJ2Rpc2FibGVkJyxcblxuICAgIC8vYWN0aW9uXG4gICAgUkVOREVSX0FDVElPTl9VTkRPOiAndW5kbycsXG4gICAgUkVOREVSX0FDVElPTl9ETzogJ2RvJyxcbiAgICBSRU5ERVJfQUNUSU9OX1ZBTElEQVRFOiAndmFsaWRhdGUnLFxuXG4gICAgLy9mb3JtIGV4cG9ydC9pbXBvcnRcbiAgICBGT1JNX0ZJTEVfQUNDRVBURURfVFlQRTogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgIEZPUk1fRklMRV9FWFRFTlNJT046ICdqc29uJyxcblxuICAgIC8vcG9zc2libGUgYW5zd2VycyBjc3YgaW1wb3J0L2V4cG9ydFxuICAgIENTVl9GSUxFX0FDQ0VQVEVEX1RZUEVTOiBbJ3RleHQvY3N2JywgJ2FwcGxpY2F0aW9uL3ZuZC5tcy1leGNlbCddLCAvL01JTUUgdHlwZXNcbiAgICBDU1ZfRklMRV9FWFRFTlNJT046ICdjc3YnXG59O1xuXG4vL211bHRpcGxlIGFuc3dlcnMgdHlwZXNcbmNvbnN0cy5NVUxUSVBMRV9BTlNXRVJfVFlQRVMgPSBbXG4gICAgY29uc3RzLlJBRElPX1RZUEUsXG4gICAgY29uc3RzLkNIRUNLQk9YX1RZUEUsXG4gICAgY29uc3RzLkRST1BET1dOX1RZUEUsXG4gICAgY29uc3RzLlNFQVJDSF9NVUxUSVBMRV9UWVBFLFxuICAgIGNvbnN0cy5TRUFSQ0hfU0lOR0xFX1RZUEVcbl07XG5cblxuY29uc3RzLlNJTkdMRV9BTlNXRVJfVFlQRVMgPSBbXG4gICAgY29uc3RzLlRFWFRfVFlQRSxcbiAgICBjb25zdHMuVEVYVEFSRUFfVFlQRSxcbiAgICBjb25zdHMuREFURV9UWVBFLFxuICAgIGNvbnN0cy5USU1FX1RZUEUsXG4gICAgY29uc3RzLklOVEVHRVJfVFlQRSxcbiAgICBjb25zdHMuREVDSU1BTF9UWVBFLFxuICAgIGNvbnN0cy5CQVJDT0RFX1RZUEUsXG4gICAgY29uc3RzLlJFQURNRV9UWVBFLFxuICAgIGNvbnN0cy5QSE9ORV9UWVBFXG5dO1xuXG4vL3RoZXNlIHR5cGVzIGRvIG5vdCBoYXZlIHRoZSByZXF1aXJlZC91bmlxdWVuZXNzIG9wdGlvblxuY29uc3RzLk1FRElBX0FOU1dFUl9UWVBFUyA9IFtcbiAgICBjb25zdHMuQVVESU9fVFlQRSxcbiAgICBjb25zdHMuUEhPVE9fVFlQRSxcbiAgICBjb25zdHMuVklERU9fVFlQRSxcbiAgICBjb25zdHMuTE9DQVRJT05fVFlQRVxuXTtcblxuLy90eXBlcyB0aGF0IGhhdmUgdGhlIHZlcmlmeSBvcHRpb25cbmNvbnN0cy5WRVJJRllfQUxMT1dFRF9UWVBFUyA9IFtcbiAgICBjb25zdHMuVEVYVF9UWVBFLFxuICAgIGNvbnN0cy5URVhUQVJFQV9UWVBFLFxuICAgIGNvbnN0cy5JTlRFR0VSX1RZUEUsXG4gICAgY29uc3RzLkRFQ0lNQUxfVFlQRSxcbiAgICBjb25zdHMuQkFSQ09ERV9UWVBFLFxuICAgIGNvbnN0cy5QSE9ORV9UWVBFXG5dO1xuXG4vL3R5cGVzIHRoYXQgaGF2ZSB0aGUgdW5pcXVlc3Mgb3B0aW9uXG5jb25zdHMuVU5JUVVFTkVTU19BTExPV0VEX1RZUEVTID0gW1xuICAgIGNvbnN0cy5URVhUX1RZUEUsXG4gICAgY29uc3RzLlRFWFRBUkVBX1RZUEUsXG4gICAgY29uc3RzLkRBVEVfVFlQRSxcbiAgICBjb25zdHMuVElNRV9UWVBFLFxuICAgIGNvbnN0cy5JTlRFR0VSX1RZUEUsXG4gICAgY29uc3RzLkRFQ0lNQUxfVFlQRSxcbiAgICBjb25zdHMuQkFSQ09ERV9UWVBFLFxuICAgIGNvbnN0cy5SQURJT19UWVBFLFxuICAgIGNvbnN0cy5EUk9QRE9XTl9UWVBFLFxuICAgIGNvbnN0cy5QSE9ORV9UWVBFLFxuICAgIGNvbnN0cy5TRUFSQ0hfTVVMVElQTEVfVFlQRSxcbiAgICBjb25zdHMuU0VBUkNIX1NJTkdMRV9UWVBFXG5dO1xuXG4vL3RoZXNlIHR5cGVzIERPIGhhdmUgdGhlIHJlcXVpcmVkIG9wdGlvblxuY29uc3RzLlJFUVVJUkVEX0FMTE9XRURfVFlQRVMgPSBbXG4gICAgY29uc3RzLlRFWFRfVFlQRSxcbiAgICBjb25zdHMuVEVYVEFSRUFfVFlQRSxcbiAgICBjb25zdHMuREFURV9UWVBFLFxuICAgIGNvbnN0cy5USU1FX1RZUEUsXG4gICAgY29uc3RzLklOVEVHRVJfVFlQRSxcbiAgICBjb25zdHMuREVDSU1BTF9UWVBFLFxuICAgIGNvbnN0cy5CQVJDT0RFX1RZUEUsXG4gICAgY29uc3RzLlBIT05FX1RZUEUsXG4gICAgY29uc3RzLlJBRElPX1RZUEUsXG4gICAgY29uc3RzLkNIRUNLQk9YX1RZUEUsXG4gICAgY29uc3RzLkRST1BET1dOX1RZUEUsXG4gICAgY29uc3RzLlNFQVJDSF9NVUxUSVBMRV9UWVBFLFxuICAgIGNvbnN0cy5TRUFSQ0hfU0lOR0xFX1RZUEVcbl07XG5cblxuLy9qdW1wIGNvbmRpdGlvbnNcbmNvbnN0cy5KVU1QX0NPTkRJVElPTlMgPSBbXG4gICAgeyBrZXk6ICdOT19BTlNXRVJfR0lWRU4nLCB0ZXh0OiAnbm8gYW5zd2VyIGdpdmVuJyB9LFxuICAgIHsga2V5OiAnSVMnLCB0ZXh0OiAnYW5zd2VyIGlzJyB9LFxuICAgIHsga2V5OiAnSVNfTk9UJywgdGV4dDogJ2Fuc3dlciBpcyBOT1QnIH0sXG4gICAgeyBrZXk6ICdBTEwnLCB0ZXh0OiAnYWx3YXlzJyB9XG5dO1xuXG5jb25zdHMuTElNSVRTID0ge1xuICAgIHF1ZXN0aW9uX2xlbmd0aDogMjU1LFxuICAgIHJlYWRtZV9sZW5ndGg6IDEwMDAsXG4gICAgZGVmYXVsdF9hbnN3ZXJfbGVuZ3RoOiAyNTUsXG4gICAgcmVnZXhfbGVuZ3RoOiA1MCxcbiAgICBtaW5fdmFsdWVfbGVuZ3RoOiA1MCxcbiAgICBtYXhfdmFsdWVfbGVuZ3RoOiA1MCxcbiAgICBwb3NzaWJsZV9hbnN3ZXJzX21heDogMzAwLFxuICAgIHBvc3NpYmxlX2Fuc3dlcnNfbWF4X3NlYXJjaDogMTAwMCxcbiAgICB0aXRsZXNfbWF4OiAzLFxuICAgIG1heF9zdGF0ZXM6IDEwLFxuICAgIHBvc3NpYmxlX2Fuc3dlcl9yZWZfbGVuZ3RoOiAxMyxcbiAgICBwb3NzaWJsZV9hbnN3ZXJfbWF4X2xlbmd0aDogMTUwLFxuICAgIHBvc3NpYmxlX2Fuc3dlcnNfcGVyX3BhZ2U6IDEwMCxcbiAgICBzZWFyY2hfaW5wdXRzX21heDogNSxcbiAgICBxdWVzdGlvbl9wcmV2aWV3X2xlbmd0aDogODBcbn07XG5cbmNvbnN0cy5TVU1NRVJOT1RFX09QVElPTlMgPSB7XG4gICAgcGxhY2Vob2xkZXI6ICdUeXBlIGhlcmUuLi4nLFxuICAgIHRvb2xiYXI6IFtcbiAgICAgICAgLy8gW2dyb3VwTmFtZSwgW2xpc3Qgb2YgYnV0dG9uXV1cbiAgICAgICAgWydzdHlsZScsIFsnYm9sZCcsICdpdGFsaWMnLCAndW5kZXJsaW5lJ11dXG4gICAgXVxufTtcblxuY29uc3RzLlJFR0VYID0ge1xuICAgIG9ubHlfbGV0dGVyczogJ15bYS16QS1aXSokJyxcbiAgICBvbmx5X2RpZ2l0czogJ15bMC05XSskJyxcbiAgICBsaW1pdF9sZW5ndGhfMjA6ICdeLnsxLDIwfSQnLFxuICAgIHBvc3NpYmxlX2Fuc3dlcl9yZWY6ICdeW2EtekEtWjAtOV17MTN9JCcsXG4gICAgaW5wdXRfcmVmOiAnXlthLXpBLVowLTktX117NjB9JCdcbn07XG5cbmNvbnN0cy5SRUFETUVfQUxMT1dFRF9UQUdTID0gW1xuICAgICc8YnI+JyxcbiAgICAnPHA+JyxcbiAgICAnPGI+JyxcbiAgICAnPHN0cm9uZz4nLFxuICAgICc8aT4nLFxuICAgICc8ZW0+JyxcbiAgICAnPHU+J1xuXTtcblxuY29uc3RzLlBPU1NJQkxFX0FOU1dFUlNfT1JERVIgPSB7XG4gICAgQVo6ICdheicsXG4gICAgWkE6ICd6YScsXG4gICAgU0hVRkZMRTogJ3NodWZmbGUnXG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGNvbnN0cztcbiIsIid1c2Ugc3RyaWN0JztcblxudmFyIGV4dGVuZF9uYXRpdmVzID0gZnVuY3Rpb24gKCkge1xuXG4gICAgLy9mcm9tIGh0dHA6Ly93d3cucmVkaXBzLm5ldC9qYXZhc2NyaXB0L2FycmF5LW1vdmUvXG4gICAgLy9tb3ZlIGFuIGVsZW1lbnQgd2l0aGluIHNhbWUgYXJyYXkgYW5kIHNoaWZ0IG90aGVyIGVsZW1lbnRzXG4gICAgQXJyYXkucHJvdG90eXBlLm1vdmUgPSBmdW5jdGlvbiAoZnJvbSwgdG8pIHtcbiAgICAgICAgLy8gbG9jYWwgdmFyaWFibGVzXG4gICAgICAgIHZhciBpLCB0bXA7XG4gICAgICAgIC8vIGNhc3QgaW5wdXQgcGFyYW1ldGVycyB0byBpbnRlZ2Vyc1xuICAgICAgICBmcm9tID0gcGFyc2VJbnQoZnJvbSwgMTApO1xuICAgICAgICB0byA9IHBhcnNlSW50KHRvLCAxMCk7XG4gICAgICAgIC8vIGlmIHBvc2l0aW9ucyBhcmUgZGlmZmVyZW50IGFuZCBpbnNpZGUgYXJyYXlcbiAgICAgICAgaWYgKGZyb20gIT09IHRvICYmIGZyb20gPj0gMCAmJiBmcm9tIDw9IHRoaXMubGVuZ3RoICYmIHRvID49IDAgJiYgdG8gPD0gdGhpcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIC8vIHNhdmUgZWxlbWVudCAnZnJvbSdcbiAgICAgICAgICAgIHRtcCA9IHRoaXNbZnJvbV07XG4gICAgICAgICAgICAvLyBtb3ZlIGVsZW1lbnQgZG93biBhbmQgc2hpZnQgb3RoZXIgZWxlbWVudHMgdXBcbiAgICAgICAgICAgIGlmIChmcm9tIDwgdG8pIHtcbiAgICAgICAgICAgICAgICBmb3IgKGkgPSBmcm9tOyBpIDwgdG87IGkrKykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzW2ldID0gdGhpc1tpICsgMV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gbW92ZSBlbGVtZW50IHVwIGFuZCBzaGlmdCBvdGhlciBlbGVtZW50cyBkb3duXG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBmb3IgKGkgPSBmcm9tOyBpID4gdG87IGktLSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzW2ldID0gdGhpc1tpIC0gMV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gcHV0IGVsZW1lbnQgJ2Zyb20nIHRvIGRlc3RpbmF0aW9uXG4gICAgICAgICAgICB0aGlzW3RvXSA9IHRtcDtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBTdHJpbmcucHJvdG90eXBlLnRydW5jID0gZnVuY3Rpb24gKG4pIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3Vic3RyKDAsIG4gLSAxKSArICh0aGlzLmxlbmd0aCA+PSBuID8gJy4uLicgOiAnJyk7XG4gICAgfTtcblxuICAgIGlmICghU3RyaW5nLnByb3RvdHlwZS5zdGFydHNXaXRoKSB7XG4gICAgICAgIFN0cmluZy5wcm90b3R5cGUuc3RhcnRzV2l0aCA9IGZ1bmN0aW9uIChzdHIpIHtcbiAgICAgICAgICAgIHJldHVybiAhdGhpcy5pbmRleE9mKHN0cik7XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgLy9pbmRleE9mIHBvbHlmaWxsXG4gICAgLy8gUHJvZHVjdGlvbiBzdGVwcyBvZiBFQ01BLTI2MiwgRWRpdGlvbiA1LCAxNS40LjQuMTRcbi8vIFJlZmVyZW5jZTogaHR0cDovL2VzNS5naXRodWIuaW8vI3gxNS40LjQuMTRcbiAgICBpZiAoIUFycmF5LnByb3RvdHlwZS5pbmRleE9mKSB7XG4gICAgICAgIEFycmF5LnByb3RvdHlwZS5pbmRleE9mID0gZnVuY3Rpb24gKHNlYXJjaEVsZW1lbnQsIGZyb21JbmRleCkge1xuXG4gICAgICAgICAgICB2YXIgaztcblxuICAgICAgICAgICAgLy8gMS4gTGV0IE8gYmUgdGhlIHJlc3VsdCBvZiBjYWxsaW5nIFRvT2JqZWN0IHBhc3NpbmdcbiAgICAgICAgICAgIC8vICAgIHRoZSB0aGlzIHZhbHVlIGFzIHRoZSBhcmd1bWVudC5cbiAgICAgICAgICAgIGlmICh0aGlzID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignXCJ0aGlzXCIgaXMgbnVsbCBvciBub3QgZGVmaW5lZCcpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgTyA9IE9iamVjdCh0aGlzKTtcblxuICAgICAgICAgICAgLy8gMi4gTGV0IGxlblZhbHVlIGJlIHRoZSByZXN1bHQgb2YgY2FsbGluZyB0aGUgR2V0XG4gICAgICAgICAgICAvLyAgICBpbnRlcm5hbCBtZXRob2Qgb2YgTyB3aXRoIHRoZSBhcmd1bWVudCBcImxlbmd0aFwiLlxuICAgICAgICAgICAgLy8gMy4gTGV0IGxlbiBiZSBUb1VpbnQzMihsZW5WYWx1ZSkuXG4gICAgICAgICAgICB2YXIgbGVuID0gTy5sZW5ndGggPj4+IDA7XG5cbiAgICAgICAgICAgIC8vIDQuIElmIGxlbiBpcyAwLCByZXR1cm4gLTEuXG4gICAgICAgICAgICBpZiAobGVuID09PSAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyA1LiBJZiBhcmd1bWVudCBmcm9tSW5kZXggd2FzIHBhc3NlZCBsZXQgbiBiZVxuICAgICAgICAgICAgLy8gICAgVG9JbnRlZ2VyKGZyb21JbmRleCk7IGVsc2UgbGV0IG4gYmUgMC5cbiAgICAgICAgICAgIHZhciBuID0gK2Zyb21JbmRleCB8fCAwO1xuXG4gICAgICAgICAgICBpZiAoTWF0aC5hYnMobikgPT09IEluZmluaXR5KSB7XG4gICAgICAgICAgICAgICAgbiA9IDA7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIDYuIElmIG4gPj0gbGVuLCByZXR1cm4gLTEuXG4gICAgICAgICAgICBpZiAobiA+PSBsZW4pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIDcuIElmIG4gPj0gMCwgdGhlbiBMZXQgayBiZSBuLlxuICAgICAgICAgICAgLy8gOC4gRWxzZSwgbjwwLCBMZXQgayBiZSBsZW4gLSBhYnMobikuXG4gICAgICAgICAgICAvLyAgICBJZiBrIGlzIGxlc3MgdGhhbiAwLCB0aGVuIGxldCBrIGJlIDAuXG4gICAgICAgICAgICBrID0gTWF0aC5tYXgobiA+PSAwID8gbiA6IGxlbiAtIE1hdGguYWJzKG4pLCAwKTtcblxuICAgICAgICAgICAgLy8gOS4gUmVwZWF0LCB3aGlsZSBrIDwgbGVuXG4gICAgICAgICAgICB3aGlsZSAoayA8IGxlbikge1xuICAgICAgICAgICAgICAgIC8vIGEuIExldCBQayBiZSBUb1N0cmluZyhrKS5cbiAgICAgICAgICAgICAgICAvLyAgIFRoaXMgaXMgaW1wbGljaXQgZm9yIExIUyBvcGVyYW5kcyBvZiB0aGUgaW4gb3BlcmF0b3JcbiAgICAgICAgICAgICAgICAvLyBiLiBMZXQga1ByZXNlbnQgYmUgdGhlIHJlc3VsdCBvZiBjYWxsaW5nIHRoZVxuICAgICAgICAgICAgICAgIC8vICAgIEhhc1Byb3BlcnR5IGludGVybmFsIG1ldGhvZCBvZiBPIHdpdGggYXJndW1lbnQgUGsuXG4gICAgICAgICAgICAgICAgLy8gICBUaGlzIHN0ZXAgY2FuIGJlIGNvbWJpbmVkIHdpdGggY1xuICAgICAgICAgICAgICAgIC8vIGMuIElmIGtQcmVzZW50IGlzIHRydWUsIHRoZW5cbiAgICAgICAgICAgICAgICAvLyAgICBpLiAgTGV0IGVsZW1lbnRLIGJlIHRoZSByZXN1bHQgb2YgY2FsbGluZyB0aGUgR2V0XG4gICAgICAgICAgICAgICAgLy8gICAgICAgIGludGVybmFsIG1ldGhvZCBvZiBPIHdpdGggdGhlIGFyZ3VtZW50IFRvU3RyaW5nKGspLlxuICAgICAgICAgICAgICAgIC8vICAgaWkuICBMZXQgc2FtZSBiZSB0aGUgcmVzdWx0IG9mIGFwcGx5aW5nIHRoZVxuICAgICAgICAgICAgICAgIC8vICAgICAgICBTdHJpY3QgRXF1YWxpdHkgQ29tcGFyaXNvbiBBbGdvcml0aG0gdG9cbiAgICAgICAgICAgICAgICAvLyAgICAgICAgc2VhcmNoRWxlbWVudCBhbmQgZWxlbWVudEsuXG4gICAgICAgICAgICAgICAgLy8gIGlpaS4gIElmIHNhbWUgaXMgdHJ1ZSwgcmV0dXJuIGsuXG4gICAgICAgICAgICAgICAgaWYgKGsgaW4gTyAmJiBPW2tdID09PSBzZWFyY2hFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBrKys7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgIH07XG4gICAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBleHRlbmRfbmF0aXZlcztcblxuIiwiLyogZ2xvYmFsICQqL1xuJ3VzZSBzdHJpY3QnO1xuXG52YXIgZm9ybWJ1aWxkZXIgPSB7XG4gICAgY3VycmVudF9mb3JtX3JlZjogJycsXG4gICAgY3VycmVudF9mb3JtX2luZGV4OiAnJyxcbiAgICBjdXJyZW50X2lucHV0X3JlZjogJycsXG4gICAgaXNfc29ydGluZzogZmFsc2UsXG4gICAgZnJvbV9pbmRleDogMCxcbiAgICB0b19pbmRleDogMCxcbiAgICBwb3NzaWJsZV9hbnN3ZXJzOiB7XG4gICAgICAgIGVuYWJsZWRfc29ydGFibGU6IFtdLFxuICAgICAgICBmcm9tX2luZGV4OiAwLFxuICAgICAgICB0b19pbmRleDogMFxuICAgIH0sXG4gICAgc3RhdGU6IFtdLFxuICAgIGRvbToge1xuICAgICAgICBpbnB1dF9wcm9wZXJ0aWVzOiAnJyxcbiAgICAgICAgaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyOiAnJyxcbiAgICAgICAgaW5wdXRfcHJvcGVydGllc19idXR0b25zOiAnJyxcbiAgICAgICAgaW5wdXRfcHJvcGVydGllc19ub19pbnB1dF9zZWxlY3RlZDogJycsXG4gICAgICAgIGlucHV0c19jb2xsZWN0aW9uOiAnJyxcbiAgICAgICAgaW5wdXRzX2NvbGxlY3Rpb25fc29ydGFibGU6ICcnLFxuICAgICAgICBwYXJ0aWFsczoge30sXG4gICAgICAgIGlucHV0X3Byb3BlcnRpZXNfdmlld3M6IHt9XG4gICAgfSxcbiAgICBicmFuY2g6IHt9LFxuICAgIHByb2plY3RfZGVmaW5pdGlvbjoge30sLy90aGlzIGdldHMgbG9hZGVkIGR5bmFtaWNhbGx5XG5cbiAgICBzZXR1cDogZnVuY3Rpb24gKHJlZiwgcGFydGlhbHMsIHZpZXdzKSB7XG5cbiAgICAgICAgLy9zZXQgcmVmcyBmb3IgY3VycmVudCBmb3JtIChhbHdheXMgdG9wIHBhcmVudCwgb24gbG9hZClcbiAgICAgICAgZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX3JlZiA9IHJlZjtcbiAgICAgICAgZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4ID0gMDtcbiAgICAgICAgZm9ybWJ1aWxkZXIucG9zc2libGVfYW5zd2Vyc19wYWdpbmF0aW9uID0ge307XG5cbiAgICAgICAgLyogY2FjaGUgc3RhdGljIGRvbSBzZWxlY3RvcnMgdG8gc3BlZWQgdXAgZHluYW1pYyBxdWVyaWVzXG4gICAgICAgICBhbmQgYWxzbyBmb3IgY29uc2lzdGVudCBhbmQgcXVpY2sgYWNjZXNzIHRocm91Z2hvdXQgdGhlIGNvZGUgYXNcbiAgICAgICAgIHdlIGFyZSBhYnN0cmFjdGluZyB0aGUgZG9tIGFjY2VzcyBhd2F5IGEgbGl0dGxlIGJpdFxuXG4gICAgICAgICB0byBnZXQgdGhlIGRvbSBlbGVtZW50LCB3ZSBjb25jYXRlbmF0ZSBmaW5kKCkgY2FsbHMsIGFzIGl0IGlzIGZhc3RlclxuICAgICAgICAgaHR0cDovL2pzcGVyZi5jb20vZmluZC1jaGFpbmluZy8yXG4gICAgICAgICAqL1xuICAgICAgICBmb3JtYnVpbGRlci5kb20gPSB7XG4gICAgICAgICAgICBvdmVybGF5OiAkKCcud2FpdC1vdmVybGF5JyksXG4gICAgICAgICAgICBsb2FkZXI6ICQoJy5sb2FkZXInKSxcbiAgICAgICAgICAgIG5hdmJhcjogJCgnLm5hdmJhcicpLFxuICAgICAgICAgICAgZm9ybXNfdGFiczogJCgnLm1haW4gLm1haW5fX3RhYnMnKSxcbiAgICAgICAgICAgIGZvcm1zX3RhYnNfY29udGVudDogJCgnLm1haW4gLm1haW5fX3RhYnMtY29udGVudCcpLFxuICAgICAgICAgICAgc2F2ZV9wcm9qZWN0X2J0bjogJCgnLm1haW5fX3RhYnMtYnRucyAuYnRuLWdyb3VwIC5tYWluX190YWJzX19zYXZlLXByb2plY3QtYnRuJyksXG4gICAgICAgICAgICB1bmRvX2J0bjogJCgnLm1haW5fX3RhYnMtYnRucyAuYnRuLWdyb3VwIC5tYWluX190YWJzX191bmRvLWJ0bicpLFxuICAgICAgICAgICAgbWFpbl9jb250YWluZXI6ICQoJy5jb250YWluZXItZmx1aWQnKSxcbiAgICAgICAgICAgIGlucHV0X3Byb3BlcnRpZXM6ICQoJyMnICsgcmVmICsgJy1pbnB1dC1wcm9wZXJ0aWVzLmlucHV0LXByb3BlcnRpZXMnKSxcbiAgICAgICAgICAgIGlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlcjogJCgnIycgKyByZWYgKyAnLWlucHV0LXByb3BlcnRpZXMuaW5wdXQtcHJvcGVydGllcyA+IC5wYW5lbCA+IC5wYW5lbC1ib2R5LmlucHV0X3Byb3BlcnRpZXNfX2Zvcm1zX3dyYXBwZXInKSxcbiAgICAgICAgICAgIGlucHV0X3Byb3BlcnRpZXNfYnV0dG9uczogJCgnIycgKyByZWYgKyAnLWlucHV0LXByb3BlcnRpZXMgLmlucHV0LXByb3BlcnRpZXNfX2J1dHRvbnMnKSxcbiAgICAgICAgICAgIGlucHV0X3Byb3BlcnRpZXNfbm9faW5wdXRfc2VsZWN0ZWQ6ICQoJy5pbnB1dC1wcm9wZXJ0aWVzX19uby1pbnB1dC1zZWxlY3RlZCcpLFxuICAgICAgICAgICAgaW5wdXRzX2NvbGxlY3Rpb246ICQoJyMnICsgcmVmICsgJy1pbnB1dHMtY29sbGVjdGlvbi5pbnB1dHMtY29sbGVjdGlvbicpLFxuICAgICAgICAgICAgaW5wdXRzX2NvbGxlY3Rpb25fc29ydGFibGU6ICQoJyMnICsgcmVmICsgJy1pbnB1dHMtY29sbGVjdGlvbi5pbnB1dHMtY29sbGVjdGlvbiAucGFuZWwgLnBhbmVsLWJvZHknKSxcbiAgICAgICAgICAgIGlucHV0c190b29sc19kcmFnZ2FibGU6ICQoJ3VsI2lucHV0cy10b29scy1saXN0IGxpIGRpdi5pbnB1dCcpXG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKCQuaXNFbXB0eU9iamVjdChmb3JtYnVpbGRlci5kb20ucGFydGlhbHMpICYmIHBhcnRpYWxzKSB7XG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20ucGFydGlhbHMgPSBwYXJ0aWFscztcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICgkLmlzRW1wdHlPYmplY3QoZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfdmlld3MpICYmIHZpZXdzKSB7XG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc192aWV3cyA9IHZpZXdzO1xuICAgICAgICB9XG5cbiAgICAgICAgZm9ybWJ1aWxkZXIuaXNPcGVuaW5nRmlsZUJyb3dzZXIgPSBmYWxzZTtcblxuICAgICAgICBjb25zb2xlLmxvZygnZm9ybWJ1aWxkZXIgb2JqZWN0IHJlYWR5Jyk7XG4gICAgfVxufTtcblxuXG5tb2R1bGUuZXhwb3J0cyA9IGZvcm1idWlsZGVyO1xuIiwiLyogZ2xvYmFsIHRvYXN0ciwgJCovXG4ndXNlIHN0cmljdCc7XG52YXIgY29uc3RzID0gcmVxdWlyZSgnY29uZmlnL2NvbnN0cycpO1xudmFyIGZvcm1idWlsZGVyID0gcmVxdWlyZSgnY29uZmlnL2Zvcm1idWlsZGVyJyk7XG52YXIgZHJhZ2dhYmxlID0gcmVxdWlyZSgndWktaGFuZGxlcnMvZHJhZ2dhYmxlJyk7XG52YXIgc29ydGFibGUgPSByZXF1aXJlKCd1aS1oYW5kbGVycy9zb3J0YWJsZScpO1xudmFyIGlucHV0X3Byb3BlcnRpZXNfY2xpY2tfY2FsbGJhY2sgPSByZXF1aXJlKCd1aS1oYW5kbGVycy9ldmVudC1oYW5kbGVyLWNhbGxiYWNrcy9pbnB1dC1wcm9wZXJ0aWVzLWNsaWNrLWNhbGxiYWNrJyk7XG52YXIgaW5wdXRfY29sbGVjdGlvbl9zb3J0YWJsZV9tb3VzZWRvd25fY2FsbGJhY2sgPSByZXF1aXJlKCd1aS1oYW5kbGVycy9ldmVudC1oYW5kbGVyLWNhbGxiYWNrcy9pbnB1dC1jb2xsZWN0aW9uLXNvcnRhYmxlLW1vdXNlZG93bi1jYWxsYmFjaycpO1xudmFyIGlucHV0X3Byb3BlcnRpZXNfZm9jdXNfY2FsbGJhY2sgPSByZXF1aXJlKCd1aS1oYW5kbGVycy9ldmVudC1oYW5kbGVyLWNhbGxiYWNrcy9pbnB1dC1wcm9wZXJ0aWVzLWZvY3VzLWNhbGxiYWNrJyk7XG52YXIgaW5wdXRfcHJvcGVydGllc19jaGFuZ2VfY2FsbGJhY2sgPSByZXF1aXJlKCd1aS1oYW5kbGVycy9ldmVudC1oYW5kbGVyLWNhbGxiYWNrcy9pbnB1dC1wcm9wZXJ0aWVzLWNoYW5nZS1jYWxsYmFjaycpO1xudmFyIGlucHV0X3Byb3BlcnRpZXNfdGl0bGVfY2hlY2tib3hfY2FsbGJhY2sgPSByZXF1aXJlKCd1aS1oYW5kbGVycy9ldmVudC1oYW5kbGVyLWNhbGxiYWNrcy9pbnB1dC1wcm9wZXJ0aWVzLXRpdGxlLWNoZWNrYm94LWNhbGxiYWNrJyk7XG52YXIgZm9ybV90YWJfY2xpY2tfY2FsbGJhY2sgPSByZXF1aXJlKCd1aS1oYW5kbGVycy9ldmVudC1oYW5kbGVyLWNhbGxiYWNrcy9mb3JtLXRhYi1jbGljay1jYWxsYmFjaycpO1xudmFyIG1vZGFsX2VkaXRfZm9ybV9uYW1lX2NhbGxiYWNrID0gcmVxdWlyZSgndWktaGFuZGxlcnMvZXZlbnQtaGFuZGxlci1jYWxsYmFja3MvbW9kYWwtZm9ybS1jYWxsYmFjaycpO1xudmFyIGV4cG9ydF9mb3JtX2NsaWNrX2NhbGxiYWNrID0gcmVxdWlyZSgndWktaGFuZGxlcnMvZXZlbnQtaGFuZGxlci1jYWxsYmFja3MvZXhwb3J0LWZvcm0tY2xpY2stY2FsbGJhY2snKTtcblxudmFyIHByaW50X2FzX3BkZl9jbGlja19jYWxsYmFjayA9IHJlcXVpcmUoJ3VpLWhhbmRsZXJzL2V2ZW50LWhhbmRsZXItY2FsbGJhY2tzL3ByaW50LWFzLXBkZi1jbGljay1jYWxsYmFjaycpO1xuXG52YXIgaW1wb3J0X2Zvcm1fY2xpY2tfY2FsbGJhY2sgPSByZXF1aXJlKCd1aS1oYW5kbGVycy9ldmVudC1oYW5kbGVyLWNhbGxiYWNrcy9pbXBvcnQtZm9ybS1jbGljay1jYWxsYmFjaycpO1xuXG52YXIgZGVsZXRlX2FsbF9xdWVzdGlvbnNfY2FsbGJhY2sgPSByZXF1aXJlKCd1aS1oYW5kbGVycy9ldmVudC1oYW5kbGVyLWNhbGxiYWNrcy9kZWxldGUtYWxsLXF1ZXN0aW9ucy1jbGljay1jYWxsYmFjaycpO1xuXG52YXIgc2F2ZV9wcm9qZWN0X2NsaWNrX2NhbGxiYWNrID0gcmVxdWlyZSgndWktaGFuZGxlcnMvZXZlbnQtaGFuZGxlci1jYWxsYmFja3Mvc2F2ZS1wcm9qZWN0LWNsaWNrLWNhbGxiYWNrJyk7XG52YXIgaW5wdXRfcHJvcGVydGllc19rZXl1cF9jYWxsYmFjayA9IHJlcXVpcmUoJ3VpLWhhbmRsZXJzL2V2ZW50LWhhbmRsZXItY2FsbGJhY2tzL2lucHV0LXByb3BlcnRpZXMta2V5dXAtY2FsbGJhY2snKTtcbnZhciBtb2RhbF9yZWdleF9jYWxsYmFjayA9IHJlcXVpcmUoJ3VpLWhhbmRsZXJzL2V2ZW50LWhhbmRsZXItY2FsbGJhY2tzL21vZGFsLXJlZ2V4LWNhbGxiYWNrJyk7XG52YXIgaW5wdXRfcHJvcGVydGllc19hZHZhbmNlZF90YWJfY2FsbGJhY2sgPSByZXF1aXJlKCd1aS1oYW5kbGVycy9ldmVudC1oYW5kbGVyLWNhbGxiYWNrcy9pbnB1dC1wcm9wZXJ0aWVzLWFkdmFuY2VkLXRhYi1jbGljay1jYWxsYmFjaycpO1xuXG5cbnZhciBtZXNzYWdlcyA9IHJlcXVpcmUoJ2NvbmZpZy9tZXNzYWdlcycpO1xudmFyIHBhcnNlID0gcmVxdWlyZSgnYWN0aW9ucy9wYXJzZScpO1xudmFyIHVpID0gcmVxdWlyZSgnaGVscGVycy91aScpO1xudmFyIHV0aWxzID0gcmVxdWlyZSgnaGVscGVycy91dGlscycpO1xudmFyIHVuZG8gPSByZXF1aXJlKCdhY3Rpb25zL3VuZG8nKTtcblxudmFyIGluaXQgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICB2YXIgcHJvamVjdF9uYW1lID0gZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uLmRhdGEucHJvamVjdC5uYW1lO1xuICAgIHZhciBmaXJzdF9mb3JtX25hbWUgPSBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0LmZvcm1zWzBdLm5hbWU7XG5cbiAgICAvL2NvbmZpZyB0b2FzdCBub3RpZmljYXRpb24gb3B0aW9uc1xuICAgIHdpbmRvdy50b2FzdHIub3B0aW9ucyA9IHtcbiAgICAgICAgY2xvc2VCdXR0b246IHRydWUsXG4gICAgICAgIC8vIHByb2dyZXNzQmFyOiB0cnVlLFxuICAgICAgICBwb3NpdGlvbkNsYXNzOiAndG9hc3QtdG9wLWNlbnRlcicsXG4gICAgICAgIHNob3dEdXJhdGlvbjogJzIwMCcsXG4gICAgICAgIGhpZGVEdXJhdGlvbjogJzMwMCcsXG4gICAgICAgIHRpbWVPdXQ6ICcyMDAwJ1xuICAgIH07XG5cbiAgICAvL29uIFNhZmFyaSA5LCBKU09OLnN0cmluZ2lmeSgpIGNhdXNlcyBhIGJ1Zywgc28gd2Ugb3ZlcnJpZGUgaXQgd2l0aCBhIE1ETiBwb2x5ZmlsbFxuICAgIGlmICh1dGlscy5pc1NhZmFyaSkge1xuICAgICAgICBDaXJjdWxhckpTT04gPSB1dGlscy5KU09OUG9seWZpbGw7XG4gICAgfVxuXG4gICAgLy9zZXQgYmFjayBidXR0b25cbiAgICAkKCcubmF2YmFyLWJhY2stYnV0dG9uJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgICB1dGlscy5nb0JhY2soKTtcbiAgICB9KTtcblxuICAgIC8vc2V0IHVuZG8gYnV0dG9uXG4gICAgJCgnLm1haW5fX3RhYnNfX3VuZG8tYnRuJykub2ZmKCkub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgICB1bmRvLmV4ZWN1dGUoKTtcbiAgICB9KTtcblxuICAgIC8vdG9kbyBkaXNhYmxlIHRleHQgc2VsZWN0aW9uIGlmIGl0IGNhdXNlcyBwcm9ibGVtcyB3aXRoIGRyYWcgYW5kIGRyb3BcblxuICAgIC8vbWFrZSB0ZXh0IG5vdCBzZWxlY3RhYmxlIGZvciBzb3J0YWJsZVxuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbi5kaXNhYmxlU2VsZWN0aW9uKCk7XG5cbiAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuICAgIC8qKioqKioqIGF0dGFjaCBVSSBkb20gZXZlbnRzIGFuZCBldmVudCBoYW5kbGVycyAqKioqKioqKiovXG5cbiAgICBkcmFnZ2FibGUoKTtcblxuICAgIC8vaW5pdCBpbnB1dHMgY29sbGVjdGlvbiBhcyBhIHNvcnRhYmxlIChpdCBpcyBhbHNvIGRyb3BwYWJsZSBieSBkZWZhdWx0KVxuICAgIHNvcnRhYmxlKCk7XG5cbiAgICAvL2hhbmRsZSBjbGljayBhY3Rpb24gb24gaW5wdXQgcHJvcGVydGllcyBwYW5lbCBpbiB0aGUgcmlnaHQgc2lkZWJhciAodXNlIGV2ZW50IGRlbGVnYXRpb24pXG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXMub2ZmKCkub24oJ2NsaWNrJywgJ2J1dHRvbi5idG4sIC5wb3NzaWJsZV9hbnN3ZXItbW9yZS1hY3Rpb24nLCBpbnB1dF9wcm9wZXJ0aWVzX2NsaWNrX2NhbGxiYWNrKTtcblxuICAgIC8vaGFuZGxlIGNsaWNrIG9uIHRoZSBhZHZhbmNlZCB0YWIgYnV0dG9uXG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXMub24oJ2NsaWNrJywgJy5hZHZhbmNlZC10YWInLCBpbnB1dF9wcm9wZXJ0aWVzX2FkdmFuY2VkX3RhYl9jYWxsYmFjayk7XG5cbiAgICAvL2F0dGFjaCBkZWxlZ2F0ZSBldmVudCB0byBtb3VzZWRvd24gc28gd2UgY292ZXIgYm90aCBjbGlja3MgYW5kIGNsaWNrIGhvbGQgKyBkcmFnXG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uX3NvcnRhYmxlLm9uKCdtb3VzZWRvd24nLCAnZGl2LmlucHV0JywgaW5wdXRfY29sbGVjdGlvbl9zb3J0YWJsZV9tb3VzZWRvd25fY2FsbGJhY2spO1xuXG4gICAgLy90cmlnZ2VyZWQgd2hlbiB1c2VycyBmb2N1cyBvbiBhIHNlbGVjdCBvZiB0aGUgaW5wdXQgcHJvcGVydGllcyBwYW5lbFxuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzLm9uKCdmb2N1cycsICdzZWxlY3QnLCBpbnB1dF9wcm9wZXJ0aWVzX2ZvY3VzX2NhbGxiYWNrKTtcblxuICAgIC8vdHJpZ2dlcmVkIHdoZW4gdXNlcnMgY2hhbmdlIHNlbGVjdGVkIG9wdGlvbiBpbiB0aGUgaW5wdXQgcHJvcGVydGllcyBwYW5lbFxuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzLm9uKCdjaGFuZ2UnLCAnc2VsZWN0JywgaW5wdXRfcHJvcGVydGllc19jaGFuZ2VfY2FsbGJhY2spO1xuXG4gICAgLy90cmlnZ2VyZWQgd2hlbiB1c2VycyBjaGVjay91bmNrZWNrIHRpdGxlIGluIHRoZSBpbnB1dCBwcm9wZXJ0aWVzIHBhbmVsXG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXMub24oJ2NoYW5nZScsICcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fdGl0bGUtZmxhZyBpbnB1dCcsIGlucHV0X3Byb3BlcnRpZXNfdGl0bGVfY2hlY2tib3hfY2FsbGJhY2spO1xuXG4gICAgLy90cmlnZ2VyZWQgd2hlbiB1c2VyIG5hdmlnYXRlcyBmb3JtIGhpZXJhcmNoeSB1c2luZyB0aGUgZm9ybXMgdGFic1xuICAgIGZvcm1idWlsZGVyLmRvbS5mb3Jtc190YWJzLm9uKCdjbGljaycsICdhW2RhdGEtdG9nZ2xlPVwidGFiXCJdJywgZm9ybV90YWJfY2xpY2tfY2FsbGJhY2spO1xuXG4gICAgLy90cmlnZ2VyZWQgd2hlbiB1c2VyIG5hdmlnYXRlcyBmb3JtIGhpZXJhcmNoeSB1c2luZyB0aGUgZm9ybXMgdGFic3hcbiAgICBmb3JtYnVpbGRlci5kb20uc2F2ZV9wcm9qZWN0X2J0bi5vZmYoKS5vbignY2xpY2snLCBzYXZlX3Byb2plY3RfY2xpY2tfY2FsbGJhY2spO1xuXG4gICAgLy90cmlnZ2VyZWQgd2hlbiB1c2VyIHdhbnRzIHRvIGV4cG9ydCBhIGZvcm1cbiAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb24ub24oJ2NsaWNrJywgJy5pbnB1dHMtY29sbGVjdGlvbl9fZXhwb3J0LWZvcm0nLCBmdW5jdGlvbiAoZSkge1xuXG4gICAgICAgIC8vYXZvaWQgYW55IGFjdGlvbiBpZiBvcHRpb24gaW4gZHJvcGRvd24gaXMgZGlzYWJsZWRcbiAgICAgICAgaWYgKCQoZS50YXJnZXQpLnBhcmVudCgpLmhhc0NsYXNzKGNvbnN0cy5ESVNBQkxFRF9TVEFURSkpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgICB9XG5cbiAgICAgICAgZXhwb3J0X2Zvcm1fY2xpY2tfY2FsbGJhY2soKTtcbiAgICB9KTtcblxuICAgIC8vdHJpZ2dlcmVkIHdoZW4gdXNlciB3YW50cyB0byBleHBvcnQgYSBmb3JtXG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uLm9uKCdjbGljaycsICcuaW5wdXRzLWNvbGxlY3Rpb25fX3ByaW50LWFzLXBkZicsIGZ1bmN0aW9uIChlKSB7XG5cbiAgICAgICAgLy9hdm9pZCBhbnkgYWN0aW9uIGlmIG9wdGlvbiBpbiBkcm9wZG93biBpcyBkaXNhYmxlZFxuICAgICAgICBpZiAoJChlLnRhcmdldCkucGFyZW50KCkuaGFzQ2xhc3MoY29uc3RzLkRJU0FCTEVEX1NUQVRFKSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICAgIH1cblxuICAgICAgICBwcmludF9hc19wZGZfY2xpY2tfY2FsbGJhY2soKTtcbiAgICB9KTtcblxuICAgIC8vdHJpZ2dlcmVkIHdoZW4gdGhlIHVzZXIgd2FudHMgdG8gaW1wb3J0IGEgZm9ybVxuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbi5maW5kKCcuaW5wdXRzLWNvbGxlY3Rpb25fX2Zvcm0taW1wb3J0IGlucHV0Jykub2ZmKCdjaGFuZ2UnKS5vbignY2hhbmdlJywgZnVuY3Rpb24gKCkge1xuICAgICAgICBpbXBvcnRfZm9ybV9jbGlja19jYWxsYmFjayh0aGlzLmZpbGVzKTtcbiAgICAgICAgJCh0aGlzKS52YWwobnVsbCk7XG4gICAgfSk7XG5cbiAgICAvL3RyaWdnZXJlZCB3aGVuIHRoZSB1c2VyIHdhbnRzIHRvIHJlbW92ZSBhbGwgcXVlc3Rpb25zIGF0IG9uY2VcbiAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb24ub24oJ2NsaWNrJywgJy5pbnB1dHMtY29sbGVjdGlvbl9fZGVsZXRlLWFsbC1xdWVzdGlvbnMnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICBkZWxldGVfYWxsX3F1ZXN0aW9uc19jYWxsYmFjaygpO1xuICAgIH0pO1xuXG4gICAgLy92YWxpZGF0ZSBxdWVzdGlvbiB0ZXh0LyBncm91cCBvciBicmFuY2ggaGVhZGVyLCBwb3NzaWJsZSBhbnN3ZXIgdGV4dCBvbiBrZXl1cFxuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzXG4gICAgICAgIC5vZmYoJ2tleXVwJylcbiAgICAgICAgLm9uKCdrZXl1cCcsICcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fcXVlc3Rpb24gaW5wdXQsIC5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19wb3NzaWJsZS1hbnN3ZXJzX19saXN0X19wb3NzaWJsZV9hbnN3ZXJfaXRlbSBpbnB1dCcsIGlucHV0X3Byb3BlcnRpZXNfa2V5dXBfY2FsbGJhY2spO1xuXG4gICAgLy9ibHVyIGxpbmtzIGFmdGVyIGNsb3NpbmcgbW9kYWxzXG4gICAgJChkb2N1bWVudCkub24oJ2hpZGRlbi5icy5tb2RhbCcsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICQoJ2EnKS5ibHVyKCk7XG4gICAgfSk7XG5cbiAgICAvL3Nob3cgcHJvamVjdCBuYW1lIGluIG5hdmJhclxuICAgIGZvcm1idWlsZGVyLmRvbS5uYXZiYXIuZmluZCgnLm5hdmJhci1wcm9qZWN0LW5hbWUgc3BhbicpLnRleHQocHJvamVjdF9uYW1lKTtcblxuICAgIC8vc2hvdyBwcm9qZWN0IGxvZ28gaW4gc2lkZWJhclxuICAgIC8vJ3ZhciBsb2dvX3VybCA9IGh0dHBzOi8vdGVzdC5lcGljb2xsZWN0Lm5ldC9hcGkvaW50ZXJuYWwvanNvbi9tZWRpYS9hbnRzLXByb2plY3Q/dHlwZT1waG90byZuYW1lPWxvZ28uanBnJmZvcm1hdD1wcm9qZWN0X21vYmlsZV9sb2dvJ1xuICAgIGNvbnNvbGUubG9nKGNvbnN0cy5QUk9KRUNUX1VSTCk7XG4gICAgY29uc29sZS5sb2cod2luZG93LmxvY2F0aW9uLmhyZWYpO1xuXG4gICAgLy9mb3IgbGl2ZSBzZXJ2ZXIgb25seVxuICAgIC8vIGlmICh3aW5kb3cubG9jYXRpb24uaHJlZi5pbmRleE9mKCdsb2NhbGhvc3QvJykgPT09IC0xICYmIHdpbmRvdy5sb2NhdGlvbi5ocmVmLmluZGV4T2YoJ2VwaWNvbGxlY3Q1LWZvcm1idWlsZGVyLycpID09PSAtMSkge1xuICAgIHV0aWxzLnNldFByb2plY3RMb2dvVXJsKCk7XG4gICAgZm9ybWJ1aWxkZXIuZG9tLm5hdmJhci5maW5kKCcubmF2YmFyLXByb2plY3QtbmFtZSBpbWcnKS5hdHRyKCdzcmMnLCBjb25zdHMuUFJPSkVDVF9MT0dPX1VSTCk7XG4gICAgLy8gfVxuICAgIC8vZWxzZSB7XG4gICAgLy8gIGZvcm1idWlsZGVyLmRvbS5uYXZiYXIuZmluZCgnLm5hdmJhci1wcm9qZWN0LW5hbWUgaW1nJykucmVtb3ZlKCk7XG4gICAgLy8gfVxuXG4gICAgLy9zaG93IG5hbWUgb2YgZmlyc3QgZm9ybSBpbiBuYXZiYXIgYW5kIGlucHV0cyBjb2xsZWN0aW9uIGNvbnRhaW5lclxuXG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uLmZpbmQoJy5pbnB1dHMtY29sbGVjdGlvbl9faGVhZGVyX19lZGl0LXN0YXRlJykudGV4dChtZXNzYWdlcy5sYWJlbHMuRURJVElOR19GT1JNKTtcbiAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb24uZmluZCgnLmlucHV0cy1jb2xsZWN0aW9uX19oZWFkZXJfX2VsZW1lbnQtbmFtZScpLnRleHQoZmlyc3RfZm9ybV9uYW1lLnRydW5jKGNvbnN0cy5JTlBVVFNfQ09MTEVDVElPTl9GT1JNX05BTUVfTUFYX0RJU1BMQVlfTEVOR0hUKSk7XG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXMuZmluZCgnLnF1ZXN0aW9uLXByZXZpZXcnKS50ZXh0KCcnKTtcblxuICAgIC8vc2V0IGZvcm0gbmFtZSBpbiBmb3JtIHRhYlxuICAgIHVpLmZvcm1zX3RhYnMuc2V0Rmlyc3RGb3JtVGFiTmFtZShmaXJzdF9mb3JtX25hbWUpO1xuXG4gICAgLy9oaWRlIHByb3BlcnRpZXMgcGFuZWwgYnV0dG9ucyBhcyBubyBpbnB1dCBpcyBzZWxlY3RlZFxuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2J1dHRvbnMuZmFkZU91dCgpO1xuXG4gICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgIC8vaW5pdCBoZWxwIHBvcG92ZXJzIGFuZCB0b29sdGlwc1xuICAgICQoJ1tkYXRhLXRvZ2dsZT1cInBvcG92ZXJcIl0nKS5wb3BvdmVyKCk7XG4gICAgJCgnW2RhdGEtdG9nZ2xlPVwidG9vbHRpcFwiXScpLnRvb2x0aXAoKTtcblxuICAgIC8vZWRpdCBmb3JtIG5hbWUgbW9kYWwgaGFuZGxlclxuICAgICQoJy5tYWluX19tb2RhbC0tZWRpdC1mb3JtLW5hbWUnKS5vbignc2hvdy5icy5tb2RhbCcsIG1vZGFsX2VkaXRfZm9ybV9uYW1lX2NhbGxiYWNrKTtcblxuICAgIC8vcmVnZXggbW9kYWwgaGFuZGxlclxuICAgICQoJyNpbmZvLXJlZ2V4Jykub24oJ3Nob3cuYnMubW9kYWwnLCBtb2RhbF9yZWdleF9jYWxsYmFjayk7XG5cbiAgICAvL3JlbmRlciBwcm9qZWN0IGZyb20gcHJvamVjdCBkZWZpbml0aW9uIGpzb25cbiAgICBmb3JtYnVpbGRlci5yZW5kZXJfYWN0aW9uID0gY29uc3RzLlJFTkRFUl9BQ1RJT05fRE87XG4gICAgJC53aGVuKHBhcnNlLnJlbmRlclByb2plY3QoZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uKSkudGhlbihmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgLy9zZXQgaW5pdGlhbCBzdGF0ZSwgbm93IGFmdGVyIHJlbmRlciBhbGwgdGhlIGlucHV0cyBoYXZlIHRoZSAnZG9tJyBwcm9wZXJ0eVxuICAgICAgICB2YXIgc3RhdGUgPSB7XG4gICAgICAgICAgICBwcm9qZWN0X2RlZmluaXRpb246IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uKSksXG4gICAgICAgICAgICBhY3RpdmVfaW5wdXRfcmVmOiBudWxsLFxuICAgICAgICAgICAgYWN0aXZlX2Zvcm1faW5kZXg6IDAsXG4gICAgICAgICAgICBhY3RpdmVfZm9ybV9yZWY6IGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbi5kYXRhLnByb2plY3QuZm9ybXNbMF0ucmVmXG4gICAgICAgIH07XG5cbiAgICAgICAgLy9zZXQgc3RhdGUgYXMgdGhlIHN0YXJ0aW5nIHN0YXRlIHB1c2hpbmcgYSBkZWVwIGNvcHlcbiAgICAgICAgZm9ybWJ1aWxkZXIuc3RhdGUucHVzaChzdGF0ZSk7XG5cbiAgICAgICAgLy9oaWRlIGxvYWRlciBhbmQgc2hvdyBmb3JtYnVpbGRlciBjb250YWluZXJzXG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5sb2FkZXIuZmFkZU91dChjb25zdHMuQU5JTUFUSU9OX0ZBU1QpO1xuICAgICAgICBmb3JtYnVpbGRlci5kb20ubmF2YmFyLnJlbW92ZUNsYXNzKCdoaWRkZW4nKS5oaWRlKCkuZmFkZUluKGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5tYWluX2NvbnRhaW5lci5yZW1vdmVDbGFzcygnaGlkZGVuJykuaGlkZSgpLmZhZGVJbihjb25zdHMuQU5JTUFUSU9OX0ZBU1QpO1xuICAgIH0pO1xuXG4gICAgJCh3aW5kb3cpLm9uKCdiZWZvcmV1bmxvYWQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAnQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGxlYXZlPyc7XG4gICAgfSk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGluaXQ7XG5cbiIsIid1c2Ugc3RyaWN0JztcblxudmFyIGNvbnN0cyA9IHJlcXVpcmUoJ2NvbmZpZy9jb25zdHMnKTtcblxudmFyIG1lc3NhZ2VzID0ge1xuXG4gICAgbGFiZWxzOiB7XG4gICAgICAgIEVESVRJTkdfRk9STTogJ0Zvcm0gPiAnLFxuICAgICAgICBFRElUSU5HX0JSQU5DSDogJ0JyYW5jaCA+ICcsXG4gICAgICAgIEVESVRJTkdfR1JPVVA6ICdHcm91cCA+ICcsXG4gICAgICAgIEVESVRJTkdfTkVTVEVEX0dST1VQOiAnIEdyb3VwOiAnLFxuICAgICAgICBFWElUX0VESVRJTkc6ICdCYWNrJyxcbiAgICAgICAgQUREX0JSQU5DSF9JTlBVVFNfSEVSRTogJ0FkZCBicmFuY2ggcXVlc3Rpb25zIGhlcmUnLFxuICAgICAgICBBRERfR1JPVVBfSU5QVVRTX0hFUkU6ICdBZGQgZ3JvdXAgcXVlc3Rpb25zIGhlcmUnXG4gICAgfSxcbiAgICBzdWNjZXNzOiB7XG4gICAgICAgIElOUFVUX1ZBTElEOiAnUXVlc3Rpb24gdmFsaWQhJyxcbiAgICAgICAgRk9STV9JTVBPUlRFRDogJ0Zvcm0gaW1wb3J0IHN1Y2NlZWRlZCEnLFxuICAgICAgICBQT1NTSUJMRV9BTlNXRVJTX0lNUE9SVEVEOiAnUG9zc2libGUgYW5zd2VycyBpbXBvcnQgc3VjY2VlZGVkIScsXG4gICAgICAgIFBST0pFQ1RfU0FWRUQ6ICdQcm9qZWN0IHNhdmVkIScsXG4gICAgICAgIEpVTVBfREVMRVRFRDogJ0p1bXAgZGVsZXRlZCEnLC8vdGhpcyBzaG91bGQgYmUgYSB3YXJuaW5nXG4gICAgICAgIElOUFVUX0NPUElFRDogJ1F1ZXN0aW9uIGNvcGllZCEnXG4gICAgfSxcbiAgICBlcnJvcjoge1xuICAgICAgICBGT1JNX0NBTk5PVF9CRV9ERUxFVEVEOiAnRm9ybSBjYW5ub3QgYmUgZGVsZXRlZCcsXG4gICAgICAgIEZPUk1fTkFNRV9FTVBUWTogJ0Zvcm0gbmFtZSBjYW5ub3QgYmUgZW1wdHknLFxuICAgICAgICBGT1JNX05BTUVfSU5WQUxJRDogJ0Zvcm0gbmFtZSBpcyBpbnZhbGlkJyxcbiAgICAgICAgRk9STV9GSUxFX0lOVkFMSUQ6ICdGb3JtIGZpbGUgaXMgaW52YWxpZCcsXG4gICAgICAgIEZPUk1fSVNfSU5WQUxJRDogJ0Zvcm0gaXMgaW52YWxpZCcsXG4gICAgICAgIEZPUk1fTkFNRV9FWElTVDogJ0Zvcm0gbmFtZSBleGlzdHMnLFxuICAgICAgICBJTlBVVF9OT1RfVkFMSUQ6ICdRdWVzdGlvbiBOT1QgdmFsaWQhJyxcbiAgICAgICAgSU5QVVRfTk9UX1NFTEVDVEVEOiAnTm8gcXVlc3Rpb24gc2VsZWN0ZWQnLFxuICAgICAgICBQT1NTSUxFX0FOU1dFUlNfQ1VTVE9NX0lEX0NBTk5PVF9TV0lUQ0hfQkFDSzogJ0Nhbm5vdCBzd2l0Y2ggYmFjayB0byBiYXNpYyBtb2RlJyxcbiAgICAgICAgUVVFU1RJT05fVEVYVF9FTVBUWTogJ1RoaXMgZmllbGQgY2Fubm90IGJlIGVtcHR5JyxcbiAgICAgICAgUE9TU0lCTEVfQU5TV0VSX0VNUFRZOiAnQW5zd2VyIHRleHQgY2Fubm90IGJlIGVtcHR5JyxcbiAgICAgICAgVkFMVUVfTVVTVF9CRV9JTlRFR0VSOiAnVmFsdWUgbXVzdCBiZSBhbiBpbnRlZ2VyJyxcbiAgICAgICAgTUlOX01VU1RfQkVfU01BTExFUl9USEFOX01BWDogJ01pbiB2YWx1ZSBtdXN0IGJlIHNtYWxsZXIgdGhhbiBNYXgnLFxuICAgICAgICBJTklUSUFMX0FOU1dFUl9PVVRfT0ZfUkFOR0U6ICdWYWx1ZSBpcyBvdXQgb2YgcmFuZ2UnLFxuICAgICAgICBJTklUSUFMX0FOU1dFUl9OT1RfTUFUQ0hJTkdfUkVHRVg6ICdWYWx1ZSBkb2VzIG5vdCBtYXRjaCByZWdleCcsXG4gICAgICAgIElOSVRJQUxfQU5TV0VSX05PVF9QSE9ORV9OVU1CRVI6ICdWYWx1ZSBpcyBub3QgYSBwaG9uZSBudW1iZXInLFxuICAgICAgICBOT19RVUVTVElPTl9URVhUX1lFVDogJ05vIHF1ZXN0aW9uIHRleHQgeWV0JyxcbiAgICAgICAgTk9fQlJBTkNIX0hFQURFUl9ZRVQ6ICdObyBicmFuY2ggaGVhZGVyIHlldCcsXG4gICAgICAgIE5PX0dST1VQX0hFQURFUl9ZRVQ6ICdObyBncm91cCBoZWFkZXIgeWV0JyxcbiAgICAgICAgTk9fQlJBTkNIX0lOUFVUU19GT1VORDogJ05vIGJyYW5jaCBxdWVzdGlvbnMgZm91bmQnLFxuICAgICAgICBOT19HUk9VUF9JTlBVVFNfRk9VTkQ6ICdObyBncm91cCBxdWVzdGlvbnMgZm91bmQnLFxuICAgICAgICBJTlZBTElEX0JSQU5DSF9JTlBVVFM6ICdUaGVyZSBhcmUgaW52YWxpZCBicmFuY2ggcXVlc3Rpb25zJyxcbiAgICAgICAgSU5WQUxJRF9HUk9VUF9JTlBVVFM6ICdUaGVyZSBhcmUgaW52YWxpZCBncm91cCBxdWVzdGlvbnMnLFxuICAgICAgICBKVU1QX0NPTkRJVElPTl9OT1RfU0VMRUNURUQ6ICdZb3UgbXVzdCBjaG9vc2UgYSBjb25kaXRpb24nLFxuICAgICAgICBKVU1QX0FOU1dFUl9OT1RfU0VMRUNURUQ6ICdZb3UgbXVzdCBjaG9vc2UgYW4gYW5zd2VyJyxcbiAgICAgICAgSlVNUF9ERVNUSU5BVElPTl9OT1RfU0VMRUNURUQ6ICdZb3UgbXVzdCBjaG9vc2UgYSB2YWxpZCBkZXN0aW5hdGlvbicsXG4gICAgICAgIEpVTVBfREVTVElOQVRJT05fSU5WQUxJRDogJ0ludmFsaWQgZGVzdGluYXRpb24nLFxuICAgICAgICBQUk9KRUNUX05PVF9TQVZFRDogJ1Byb2plY3QgZXJyb3IhJyxcbiAgICAgICAgSlVNUF9JTlZBTElEOiAnSW52YWxpZCBqdW1wIG9uIHF1ZXN0aW9uOicsXG4gICAgICAgIEpVTVBTX0lOVkFMSUQ6ICdTb21lIGp1bXBzIGFyZSBpbnZhbGlkJyxcbiAgICAgICAgUE9TU0lCTEVfQU5TV0VSU19JTlZBTElEOiAnU29tZSBwb3NzaWJsZSBhbnN3ZXJzIGFyZSBpbnZhbGlkJyxcbiAgICAgICAgQ1NWX0ZJTEVfSU5WQUxJRDogJ0NTViBmaWxlIGlzIGludmFsaWQhJyxcbiAgICAgICAgQlJPV1NFUl9OT1RfU1VQUE9SVEVEOiAnQnJvd3NlciBub3Qgc3VwcG9ydGVkJyxcbiAgICAgICAgTUFYX1FVRVNUSU9OU19MSU1JVF9SRUFDSEVEOiAnUXVlc3Rpb25zIGxpbWl0IHJlYWNoZWQgZm9yIHRoaXMgZm9ybSEnLFxuICAgICAgICBUT09fTUFOWV9TRUFSQ0hfUVVFU1RJT05TOiAnVG9vIG1hbnkgc2VhcmNoIHF1ZXN0aW9ucywgb25seSAnICsgY29uc3RzLkxJTUlUUy5zZWFyY2hfaW5wdXRzX21heCArICcgIHBlciBwcm9qZWN0IGFyZSBhbGxvd2VkIScsXG4gICAgICAgIFRPT19NQU5ZX1RJVExFUzogJ1RvbyBtYW55IHRpdGxlcycsXG4gICAgICAgIFRPT19NQU5ZX1FVRVNUSU9OU19GT1JfQ1VSUkVOVF9GT1JNOiAnVG9vIG1hbnkgcXVlc3Rpb25zIGZvciB0aGlzIGZvcm06ICcsXG4gICAgICAgIFFVRVNUSU9OX0xFTkdUSF9MSU1JVF9FWENFRURFRDogJ0NoYXJhY3RlcnMgbGltaXQgZXhjZWVkZWQnXG4gICAgfSxcbiAgICB3YXJuaW5nOiB7XG4gICAgICAgIFBPU1NJQklMRV9BTlNXRVJfSEFTX0xJTktFRF9KVU1QOiAnVGhlcmUgaXMgYSBqdW1wIGxpbmtlZCB0byB0aGlzIGFuc3dlciwgcGxlYXNlIHJlbW92ZSBpdCBmaXJzdCEnLFxuICAgICAgICBJTlBVVF9ERUxFVEVEOiAnUXVlc3Rpb24gZGVsZXRlZCEnLFxuICAgICAgICBGT1JNX0RFTEVURUQ6ICdGb3JtIGRlbGV0ZWQhJyxcbiAgICAgICAgU0VBUkNIX0lOUFVUU19MSU1JVF9SRUFDSEVEOiAnU2VhcmNoIHF1ZXN0aW9ucyBsaW1pdCByZWFjaGVkISdcbiAgICB9XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IG1lc3NhZ2VzO1xuIiwiJ3VzZSBzdHJpY3QnO1xudmFyIG9wdGlvbnMgPSB7XG4gICAgY2xvc2VCdXR0b246IHRydWUsXG4gICAgcG9zaXRpb25DbGFzczogJ3RvYXN0LXRvcC1jZW50ZXInLFxuICAgIHByZXZlbnREdXBsaWNhdGVzOiB0cnVlLFxuICAgIG9uY2xpY2s6IG51bGwsXG4gICAgc2hvd0R1cmF0aW9uOiA1MDAsXG4gICAgaGlkZUR1cmF0aW9uOiA1MDAsXG4gICAgZXh0ZW5kZWRUaW1lT3V0OiAwLFxuICAgIHNob3dNZXRob2Q6ICdmYWRlSW4nLFxuICAgIGhpZGVNZXRob2Q6ICdmYWRlT3V0J1xufTtcblxudmFyIHRvYXN0ID0ge1xuICAgIHNob3dTdWNjZXNzOiBmdW5jdGlvbiAobWVzc2FnZSkge1xuICAgICAgICBvcHRpb25zLnRpbWVPdXQgPSAyMDAwO1xuICAgICAgICB3aW5kb3cudG9hc3RyLm9wdGlvbnMgPSBvcHRpb25zO1xuICAgICAgICB3aW5kb3cudG9hc3RyLnN1Y2Nlc3MobWVzc2FnZSk7XG4gICAgfSxcblxuICAgIHNob3dFcnJvcjogZnVuY3Rpb24gKG1lc3NhZ2UsIHRpbWVvdXQpIHtcbiAgICAgICAgb3B0aW9ucy50aW1lT3V0ID0gdGltZW91dCB8fCAwO1xuICAgICAgICB3aW5kb3cudG9hc3RyLm9wdGlvbnMgPSBvcHRpb25zO1xuICAgICAgICB3aW5kb3cudG9hc3RyLmVycm9yKG1lc3NhZ2UpO1xuICAgIH0sXG5cbiAgICBzaG93V2FybmluZzogZnVuY3Rpb24gKG1lc3NhZ2UsIHRpbWVvdXQpIHtcbiAgICAgICAgb3B0aW9ucy50aW1lT3V0ID0gdGltZW91dCB8fCAwO1xuICAgICAgICB3aW5kb3cudG9hc3RyLm9wdGlvbnMgPSBvcHRpb25zO1xuICAgICAgICB3aW5kb3cudG9hc3RyLndhcm5pbmcobWVzc2FnZSk7XG4gICAgfSxcblxuICAgIGNsZWFyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHdpbmRvdy50b2FzdHIuY2xlYXIoKTtcbiAgICB9XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IHRvYXN0O1xuXG4iLCIndXNlIHN0cmljdCc7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcbnZhciB1aSA9IHJlcXVpcmUoJ2hlbHBlcnMvdWknKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoJ2hlbHBlcnMvdXRpbHMnKTtcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgbWVzc2FnZXMgPSByZXF1aXJlKCdjb25maWcvbWVzc2FnZXMnKTtcbnZhciBpbnB1dF9wcm9wZXJ0aWVzX2NsaWNrX2NhbGxiYWNrID0gcmVxdWlyZSgndWktaGFuZGxlcnMvZXZlbnQtaGFuZGxlci1jYWxsYmFja3MvaW5wdXQtcHJvcGVydGllcy1jbGljay1jYWxsYmFjaycpO1xudmFyIGlucHV0X3Byb3BlcnRpZXNfZm9jdXNfY2FsbGJhY2sgPSByZXF1aXJlKCd1aS1oYW5kbGVycy9ldmVudC1oYW5kbGVyLWNhbGxiYWNrcy9pbnB1dC1wcm9wZXJ0aWVzLWZvY3VzLWNhbGxiYWNrJyk7XG52YXIgZGVsZXRlX2Zvcm1fY2xpY2tfY2FsbGJhY2sgPSByZXF1aXJlKCd1aS1oYW5kbGVycy9ldmVudC1oYW5kbGVyLWNhbGxiYWNrcy9kZWxldGUtZm9ybS1jbGljay1jYWxsYmFjaycpO1xudmFyIGV4cG9ydF9mb3JtX2NsaWNrX2NhbGxiYWNrID0gcmVxdWlyZSgndWktaGFuZGxlcnMvZXZlbnQtaGFuZGxlci1jYWxsYmFja3MvZXhwb3J0LWZvcm0tY2xpY2stY2FsbGJhY2snKTtcbnZhciBwcmludF9hc19wZGZfY2xpY2tfY2FsbGJhY2sgPSByZXF1aXJlKCd1aS1oYW5kbGVycy9ldmVudC1oYW5kbGVyLWNhbGxiYWNrcy9wcmludC1hcy1wZGYtY2xpY2stY2FsbGJhY2snKTtcbnZhciBpbnB1dF9jb2xsZWN0aW9uX3NvcnRhYmxlX21vdXNlZG93bl9jYWxsYmFjayA9IHJlcXVpcmUoJ3VpLWhhbmRsZXJzL2V2ZW50LWhhbmRsZXItY2FsbGJhY2tzL2lucHV0LWNvbGxlY3Rpb24tc29ydGFibGUtbW91c2Vkb3duLWNhbGxiYWNrJyk7XG52YXIgaW5wdXRfcHJvcGVydGllc19rZXl1cF9jYWxsYmFjayA9IHJlcXVpcmUoJ3VpLWhhbmRsZXJzL2V2ZW50LWhhbmRsZXItY2FsbGJhY2tzL2lucHV0LXByb3BlcnRpZXMta2V5dXAtY2FsbGJhY2snKTtcbnZhciBpbnB1dF9wcm9wZXJ0aWVzX3RpdGxlX2NoZWNrYm94X2NhbGxiYWNrID0gcmVxdWlyZSgndWktaGFuZGxlcnMvZXZlbnQtaGFuZGxlci1jYWxsYmFja3MvaW5wdXQtcHJvcGVydGllcy10aXRsZS1jaGVja2JveC1jYWxsYmFjaycpO1xudmFyIGRlbGV0ZV9hbGxfcXVlc3Rpb25zX2NhbGxiYWNrID0gcmVxdWlyZSgndWktaGFuZGxlcnMvZXZlbnQtaGFuZGxlci1jYWxsYmFja3MvZGVsZXRlLWFsbC1xdWVzdGlvbnMtY2xpY2stY2FsbGJhY2snKTtcbnZhciBzYXZlX3Byb2plY3RfY2xpY2tfY2FsbGJhY2sgPSByZXF1aXJlKCd1aS1oYW5kbGVycy9ldmVudC1oYW5kbGVyLWNhbGxiYWNrcy9zYXZlLXByb2plY3QtY2xpY2stY2FsbGJhY2snKTtcbnZhciB2YWxpZGF0aW9uID0gcmVxdWlyZSgnYWN0aW9ucy92YWxpZGF0aW9uJyk7XG52YXIgZm9ybTtcbnZhciBmb3JtcztcblxudmFyIGZvcm1fZmFjdG9yeSA9IHtcblxuICAgIGNyZWF0ZVRhYkJ1dHRvbjogZnVuY3Rpb24gKCkge1xuXG4gICAgICAgIC8vY3JlYXRlIG5ldyB0YWIgYnV0dG9uLCBhcHBlbmQgYWZ0ZXIgbGF0ZXN0IGZvcm0gdGFiIGJ1dHRvblxuICAgICAgICB2YXIgZm9ybV90YWJfYnV0dG9uX2h0bWwgPSB1aS5mb3Jtc190YWJzLmdldEZvcm1UYWJCdXR0b25IVE1MKGZvcm0pO1xuICAgICAgICB2YXIgZm9ybV90YWJfYnV0dG9ucyA9IGZvcm1idWlsZGVyLmRvbS5mb3Jtc190YWJzLmZpbmQoJ2xpLm1haW5fX3RhYnNfX2Zvcm0tYnRuJyk7XG4gICAgICAgIGZvcm1fdGFiX2J1dHRvbnMuZXEoZm9ybV90YWJfYnV0dG9ucy5sZW5ndGggLSAxKS5hZnRlcihmb3JtX3RhYl9idXR0b25faHRtbCk7XG4gICAgfSxcblxuICAgIGNyZWF0ZUNoaWxkRm9ybTogZnVuY3Rpb24gKHRoZV9mb3JtX25hbWUsIHRoZV9mb3JtX3JlZiwgdGhlX2Zvcm1faW5kZXgsIGlzX2NyZWF0aW5nX25ld19jaGlsZF9mb3JtKSB7XG5cbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB2YXIgZGVmZXJyZWQgPSBuZXcgJC5EZWZlcnJlZCgpO1xuICAgICAgICBmb3JtID0ge307XG4gICAgICAgIGZvcm0ubmFtZSA9IHRoZV9mb3JtX25hbWU7XG4gICAgICAgIGZvcm0uc2x1ZyA9IHV0aWxzLnNsdWdpZnkodGhlX2Zvcm1fbmFtZSk7XG4gICAgICAgIGZvcm0ucmVmID0gdGhlX2Zvcm1fcmVmO1xuICAgICAgICBmb3JtLnR5cGUgPSBjb25zdHMuRk9STV9ISUVSQVJDSFlfVFlQRTtcbiAgICAgICAgZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4ID0gdGhlX2Zvcm1faW5kZXg7XG4gICAgICAgIGZvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9yZWYgPSBmb3JtLnJlZjtcbiAgICAgICAgZm9ybXMgPSBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0LmZvcm1zO1xuXG4gICAgICAgIHNlbGYuY3JlYXRlVGFiQnV0dG9uKCk7XG5cbiAgICAgICAgaWYgKGlzX2NyZWF0aW5nX25ld19jaGlsZF9mb3JtKSB7XG4gICAgICAgICAgICBmb3JtLmlucHV0cyA9IFtdO1xuICAgICAgICAgICAgZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uLmRhdGEucHJvamVjdC5mb3Jtc1t0aGVfZm9ybV9pbmRleF0gPSBmb3JtO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy9zZXQgdGhlIGZvcm0gdGFiIGJ1dHRvbiB0byBhIHZhbGlkIGdyZWVuIGNoZWNrIGFzIGEgcGFyc2VkIGZyb20gbXVzdCBiZSB2YWxpZFxuICAgICAgICAgICAgdWkuZm9ybXNfdGFicy5zaG93Rm9ybVZhbGlkSWNvbihmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXgpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9jcmVhdGUgbmV3IHRhYiBjb250ZW50XG4gICAgICAgICQud2hlbih1aS5mb3Jtc190YWJzLmdldEZvcm1UYWJDb250ZW50SFRNTChmb3JtKSkudGhlbihmdW5jdGlvbiAoaHRtbCkge1xuXG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uZm9ybXNfdGFic19jb250ZW50LmFwcGVuZChodG1sKTtcblxuICAgICAgICAgICAgLy91cGRhdGUgZm9ybWJ1aWxkZXIgZG9tIHJlZmVyZW5jZXMgdG8gcG9pbnQgdG8gdGhlIG5ldyBmb3JtIG1hcmt1cFxuICAgICAgICAgICAgc2VsZi51cGRhdGVGb3JtYnVpbGRlckRvbVJlZmVyZW5jZXMoZm9ybS5yZWYpO1xuXG4gICAgICAgICAgICAvL3Nob3cgbmFtZSBvZiBmb3JtIGluIHRhYiBhbmQgaW5wdXRzIGNvbGxlY3Rpb24gY29udGFpbmVyLCB0cnVuY2F0aW5nIGZvcm0gbmFtZSAoPjEwKSBmb3IgVUkgcHVycG9zZXNcbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbi5maW5kKCcuaW5wdXRzLWNvbGxlY3Rpb25fX2hlYWRlcl9fZWRpdC1zdGF0ZScpLnRleHQobWVzc2FnZXMubGFiZWxzLkVESVRJTkdfRk9STSk7XG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb24uZmluZCgnLmlucHV0cy1jb2xsZWN0aW9uX19oZWFkZXJfX2VsZW1lbnQtbmFtZScpLnRleHQoZm9ybS5uYW1lLnRydW5jKGNvbnN0cy5JTlBVVFNfQ09MTEVDVElPTl9GT1JNX05BTUVfTUFYX0RJU1BMQVlfTEVOR0hUIC0gKGZvcm1zLmxlbmd0aCAqIDIpKSk7XG5cbiAgICAgICAgICAgIC8vc2hvdyBlbXB0eSBpbnB1dCBxdWVzdGlvbiBwcmV2aWV3XG4gICAgICAgICAgICB1aS5pbnB1dF9wcm9wZXJ0aWVzX3BhbmVsLnNob3dJbnB1dFF1ZXN0aW9uUHJldmlldygnJyk7XG5cbiAgICAgICAgICAgIC8vZW5hYmxlIGRlbGV0ZSBmb3JtIGJ1dHRvbiBhcyB0aGUgbmV3IGZvcm0gd2lsbCBiZSB0aGUgbGFzdCBjaGlsZFxuICAgICAgICAgICAgLy8gKGl0IGlzIHBvc3NpYmxlIHRvIGRlbGV0ZSBmcm9tIHRoZSBsYXN0IGNoaWxkIHVwIHRvIHRoZSBmaXJzdCBjaGlsZCB1cCB0byB0aGUgdG9wIGZvcm0gd2hpY2ggY2Fubm90IGJlIGRlbGV0ZWQpXG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb24uZmluZCgnLmlucHV0cy1jb2xsZWN0aW9uX19idXR0b25zIC5pbnB1dHMtY29sbGVjdGlvbl9fYnV0dG9ucy0tcmVtb3ZlLWZvcm0nKS5wcm9wKCdkaXNhYmxlZCcsIGZhbHNlKTtcblxuICAgICAgICAgICAgLy9zd2l0Y2ggdG8gbmV3bHkgY3JlYXRlZCBmb3JtL3RhYiB3aGVuIGNyZWF0aW5nIGEgY2hpbGQgZm9ybSBvbmx5LCBub3Qgd2hlbiByZW5kZXJpbmcgYW4gZXhpc3RpbmcgcHJvamVjdCBmb3IgZWRpdGluZ1xuICAgICAgICAgICAgaWYgKGlzX2NyZWF0aW5nX25ld19jaGlsZF9mb3JtKSB7XG5cbiAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uZm9ybXNfdGFicy5maW5kKCdsaSBhW2hyZWY9XCIjJyArIGZvcm0ucmVmICsgJy10YWJwYW5lbFwiXScpLnRhYignc2hvdycpO1xuXG4gICAgICAgICAgICAgICAgLy9iaW5kIGV2ZW50IGhhbmRsZXJzXG4gICAgICAgICAgICAgICAgc2VsZi5iaW5kRm9ybVBhbmVsc0V2ZW50cygpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlKCk7XG4gICAgfSxcblxuICAgIHJlbW92ZUZvcm06IGZ1bmN0aW9uIChwcmV2aW91c19mb3JtX3JlZiwgZm9ybV9yZWYsIGZvcm1fdGFiKSB7XG5cbiAgICAgICAgLy9kZWxldGUgZm9ybSBmcm9tIHByb2plY3QgZGVmaW5pdGlvbiAoaXQgaXMgYWx3YXlzIHRoZSBsYXN0IG9uZSlcbiAgICAgICAgZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uLmRhdGEucHJvamVjdC5mb3Jtcy5wb3AoKTtcblxuICAgICAgICAvL3JlbW92ZSBmb3JtIG1hcmt1cCBmcm9tIGRvbSAoYSBzaW5nbGUgdGFicGFuZWwsIHdoaWNoIGhhcyBnb3QgYm90aCB0aGUgaW5wdXQgY29sbGVjdGlvbiBhbmQgdGhlIGlucHV0cyBwcm9wZXJ0aWVzKVxuICAgICAgICBmb3JtYnVpbGRlci5kb20uZm9ybXNfdGFic19jb250ZW50LmZpbmQoJyMnICsgZm9ybV9yZWYgKyAnLXRhYnBhbmVsJykucmVtb3ZlKCk7XG5cbiAgICAgICAgLy9yZW1vdmUgdGFiXG4gICAgICAgIGZvcm1fdGFiLnJlbW92ZSgpO1xuXG4gICAgICAgIC8vc2V0IGZvcm0gc3RhdGUgdG8gcHJldmlvdXNcbiAgICAgICAgZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4LS07XG5cbiAgICAgICAgLy9zZXQgcmVmIHRvIHByZXZpb3VzIGZvcm1cbiAgICAgICAgZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX3JlZiA9IHByZXZpb3VzX2Zvcm1fcmVmO1xuICAgICAgICBmb3JtX3JlZiA9IHByZXZpb3VzX2Zvcm1fcmVmO1xuXG4gICAgICAgIC8vdXBkYXRlIGZvcm1idWlsZGVyIGRvbSByZWZlcmVuY2VzIHRvIHBvaW50IHRvIHRoZSBzZWxlY3RlZCBmb3JtIG1hcmt1cFxuICAgICAgICBmb3JtX2ZhY3RvcnkudXBkYXRlRm9ybWJ1aWxkZXJEb21SZWZlcmVuY2VzKGZvcm1fcmVmKTtcblxuICAgICAgICAvL2VuYWJsZSBkZWxldGUgZm9ybSBidXR0b24gZm9yIHByZXZpb3VzIGZvcm0gYXMgaXQgYmVjb21lcyB0aGUgbGFzdCAoYXNpZGUgZnJvbSBmaXN0IGZvcm0pXG4gICAgICAgIGlmIChmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXggIT09IDApIHtcbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvblxuICAgICAgICAgICAgICAgIC5maW5kKCcuaW5wdXRzLWNvbGxlY3Rpb25fX2J1dHRvbnMgLmlucHV0cy1jb2xsZWN0aW9uX19idXR0b25zLS1yZW1vdmUtZm9ybScpXG4gICAgICAgICAgICAgICAgLnByb3AoJ2Rpc2FibGVkJywgZmFsc2UpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9zaG93IGFkZCBmb3JtIGJ1dHRvbiBpZiB0b3RhbCBpcyBsZXNzIHRoYW4gbWF4IG51bWJlciBvZiBmb3Jtc1xuICAgICAgICBpZiAoZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uLmRhdGEucHJvamVjdC5mb3Jtcy5sZW5ndGggPCBjb25zdHMuTUFYX05VTUJFUl9PRl9ORVNURURfQ0hJTERfRk9STVMpIHtcbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5mb3Jtc190YWJzLmZpbmQoJy5tYWluX190YWJzX2FkZC1mb3JtJykucGFyZW50KCkuc2hvdygpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9yZXNpemUgZm9ybSB0YWJzXG4gICAgICAgIHVpLmZvcm1zX3RhYnMucmVzaXplRm9ybVRhYnMoKTtcblxuXG4gICAgICAgIC8vZW5hYmxlIHNhdmUgcHJvamVjdCBidXR0b24gaWYgYWxsIGlucHV0cyBhcmUgdmFsaWRcbiAgICAgICAgaWYgKHZhbGlkYXRpb24uYXJlQWxsSW5wdXRzVmFsaWQoZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uKSkge1xuICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnKiogYWxsIGdvb2QgKionKTtcbiAgICAgICAgICAgIC8vZW5hYmxlIHNhdmUgcHJvamVjdCBidXR0b25cbiAgICAgICAgICAgIHVpLm5hdmJhci50b2dnbGVTYXZlUHJvamVjdEJ0bihjb25zdHMuQlROX0VOQUJMRUQpO1xuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLnNhdmVfcHJvamVjdF9idG4ub2ZmKCkub24oJ2NsaWNrJywgc2F2ZV9wcm9qZWN0X2NsaWNrX2NhbGxiYWNrKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICB1cGRhdGVGb3JtYnVpbGRlckRvbVJlZmVyZW5jZXM6IGZ1bmN0aW9uICh0aGVfZm9ybV9yZWYpIHtcblxuICAgICAgICB2YXIgZm9ybV9yZWYgPSB0aGVfZm9ybV9yZWY7XG5cbiAgICAgICAgLy91cGRhdGUgZm9ybWJ1aWxkZXIgZG9tIHJlZmVyZW5jZXMgdG8gcG9pbnQgdG8gdGhlIGN1cnJlbnRseSBhY3RpdmUgZm9ybSBtYXJrdXBcbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXMgPSAkKCcjJyArIGZvcm1fcmVmICsgJy1pbnB1dC1wcm9wZXJ0aWVzLmlucHV0LXByb3BlcnRpZXMnKTtcbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlciA9ICQoJyMnICsgZm9ybV9yZWYgKyAnLWlucHV0LXByb3BlcnRpZXMuaW5wdXQtcHJvcGVydGllcyA+IC5wYW5lbCA+IC5wYW5lbC1ib2R5LmlucHV0X3Byb3BlcnRpZXNfX2Zvcm1zX3dyYXBwZXInKTtcbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfYnV0dG9ucyA9ICQoJyMnICsgZm9ybV9yZWYgKyAnLWlucHV0LXByb3BlcnRpZXMgLmlucHV0LXByb3BlcnRpZXNfX2J1dHRvbnMnKTtcblxuICAgICAgICAvL3RvZG8gY2hlY2sgdGhpc1xuICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc19ub19pbnB1dF9zZWxlY3RlZCA9ICQoJy5pbnB1dC1wcm9wZXJ0aWVzX19uby1pbnB1dC1zZWxlY3RlZCcpO1xuXG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbiA9ICQoJyMnICsgZm9ybV9yZWYgKyAnLWlucHV0cy1jb2xsZWN0aW9uLmlucHV0cy1jb2xsZWN0aW9uJyk7XG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbl9zb3J0YWJsZSA9ICQoJyMnICsgZm9ybV9yZWYgKyAnLWlucHV0cy1jb2xsZWN0aW9uLmlucHV0cy1jb2xsZWN0aW9uIC5wYW5lbCAucGFuZWwtYm9keScpO1xuXG4gICAgfSxcblxuICAgIGJpbmRGb3JtUGFuZWxzRXZlbnRzOiBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgdmFyIHNvcnRhYmxlID0gcmVxdWlyZSgndWktaGFuZGxlcnMvc29ydGFibGUnKTtcbiAgICAgICAgdmFyIGltcG9ydF9mb3JtX2NsaWNrX2NhbGxiYWNrID0gcmVxdWlyZSgndWktaGFuZGxlcnMvZXZlbnQtaGFuZGxlci1jYWxsYmFja3MvaW1wb3J0LWZvcm0tY2xpY2stY2FsbGJhY2snKTtcblxuICAgICAgICBzb3J0YWJsZSgpO1xuXG4gICAgICAgIC8vYXR0YWNoIGRlbGVnYXRlIGV2ZW50IHRvIG1vdXNlZG93biBzbyB3ZSBjb3ZlciBib3RoIGNsaWNrcyBhbmQgY2xpY2sgaG9sZCArIGRyYWdcbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uX3NvcnRhYmxlLm9uKCdtb3VzZWRvd24nLCAnZGl2LmlucHV0JywgaW5wdXRfY29sbGVjdGlvbl9zb3J0YWJsZV9tb3VzZWRvd25fY2FsbGJhY2spO1xuXG4gICAgICAgIC8vaGFuZGxlIGNsaWNrIGFjdGlvbiBvbiBpbnB1dCBwcm9wZXJ0aWVzIHBhbmVsIGluIHRoZSByaWdodCBzaWRlYmFyICh1c2UgZXZlbnQgZGVsZWdhdGlvbilcbiAgICAgICAgLy90b2RvIHRlc3QgdGhpcyBpZiBpdCBpcyB1bmJpbmRpbmcgb3RoZXIgZXZlbnRzXG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzLm9mZignY2xpY2snKS5vbignY2xpY2snLCAnYnV0dG9uLmJ0biwgLnBvc3NpYmxlX2Fuc3dlci1tb3JlLWFjdGlvbicsIGlucHV0X3Byb3BlcnRpZXNfY2xpY2tfY2FsbGJhY2spO1xuICAgICAgICAvL3RyaWdnZXJlZCB3aGVuIHVzZXJzIGZvY3VzIG9uIGEgc2VsZWN0IG9mIHRoZSBpbnB1dCBwcm9wZXJ0aWVzIHBhbmVsXG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzLm9uKCdmb2N1cycsICdzZWxlY3QnLCBpbnB1dF9wcm9wZXJ0aWVzX2ZvY3VzX2NhbGxiYWNrKTtcblxuICAgICAgICAvL3RyaWdnZXJlZCB3aGVuIHVzZXIgd2FudHMgdG8gZGVsZXRlIGEgZm9ybVxuICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb24uZmluZCgnLmlucHV0cy1jb2xsZWN0aW9uX19idXR0b25zLS1yZW1vdmUtZm9ybScpLm9mZignY2xpY2snKS5vbignY2xpY2snLCBkZWxldGVfZm9ybV9jbGlja19jYWxsYmFjayk7XG4gICAgICAgIC8vZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uLm9uKCdjbGljaycsICcuaW5wdXRzLWNvbGxlY3Rpb25fX2J1dHRvbnMtLXJlbW92ZS1mb3JtJywgZGVsZXRlX2Zvcm1fY2xpY2tfY2FsbGJhY2spO1xuXG4gICAgICAgIC8vdHJpZ2dlcmVkIHdoZW4gdXNlciB3YW50cyB0byBleHBvcnQgYSBmb3JtXG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbi5maW5kKCcuaW5wdXRzLWNvbGxlY3Rpb25fX2V4cG9ydC1mb3JtJykub2ZmKCdjbGljaycpLm9uKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XG5cbiAgICAgICAgICAgIC8vYXZvaWQgYW55IGFjdGlvbiBpZiBvcHRpb24gaW4gZHJvcGRvd24gaXMgZGlzYWJsZWRcbiAgICAgICAgICAgIGlmICgkKGUudGFyZ2V0KS5wYXJlbnQoKS5oYXNDbGFzcyhjb25zdHMuRElTQUJMRURfU1RBVEUpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGV4cG9ydF9mb3JtX2NsaWNrX2NhbGxiYWNrKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vdHJpZ2dlcmVkIHdoZW4gdGhlIHVzZXIgd2FudHMgdG8gcmVtb3ZlIGFsbCBxdWVzdGlvbnMgYXQgb25jZVxuICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb24ub24oJ2NsaWNrJywgJy5pbnB1dHMtY29sbGVjdGlvbl9fZGVsZXRlLWFsbC1xdWVzdGlvbnMnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgZGVsZXRlX2FsbF9xdWVzdGlvbnNfY2FsbGJhY2soKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy90cmlnZ2VyZWQgd2hlbiB1c2VyIHdhbnRzIHRvIGV4cG9ydCBhIGZvcm1cbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uLmZpbmQoJy5pbnB1dHMtY29sbGVjdGlvbl9fcHJpbnQtYXMtcGRmJykub2ZmKCdjbGljaycpLm9uKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XG5cbiAgICAgICAgICAgIC8vYXZvaWQgYW55IGFjdGlvbiBpZiBvcHRpb24gaW4gZHJvcGRvd24gaXMgZGlzYWJsZWRcbiAgICAgICAgICAgIGlmICgkKGUudGFyZ2V0KS5wYXJlbnQoKS5oYXNDbGFzcyhjb25zdHMuRElTQUJMRURfU1RBVEUpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBwcmludF9hc19wZGZfY2xpY2tfY2FsbGJhY2soKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy90cmlnZ2VyZWQgd2hlbiB0aGUgdXNlciB3YW50cyB0byBpbXBvcnQgYSBmb3JtXG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbi5maW5kKCcuaW5wdXRzLWNvbGxlY3Rpb25fX2Zvcm0taW1wb3J0IGlucHV0Jykub2ZmKCdjaGFuZ2UnKS5vbignY2hhbmdlJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaW1wb3J0X2Zvcm1fY2xpY2tfY2FsbGJhY2sodGhpcy5maWxlcyk7XG4gICAgICAgICAgICAkKHRoaXMpLnZhbChudWxsKTtcblxuICAgICAgICB9KTtcblxuICAgICAgICAvL3ZhbGlkYXRlIHF1ZXN0aW9uIHRleHQvIGdyb3VwIG9yIGJyYW5jaCBoZWFkZXIgb24ga2V5dXBcbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXMub24oJ2tleXVwJywgJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19xdWVzdGlvbiBpbnB1dCcsIGlucHV0X3Byb3BlcnRpZXNfa2V5dXBfY2FsbGJhY2spO1xuXG4gICAgICAgIC8vdHJpZ2dlcmVkIHdoZW4gdXNlcnMgY2hlY2svdW5ja2VjayB0aXRsZSBpbiB0aGUgaW5wdXQgcHJvcGVydGllcyBwYW5lbFxuICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllcy5vbignY2hhbmdlJywgJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX190aXRsZS1mbGFnIGlucHV0JywgaW5wdXRfcHJvcGVydGllc190aXRsZV9jaGVja2JveF9jYWxsYmFjayk7XG4gICAgfSxcblxuICAgIHVuYmluZEZvcm1QYW5lbHNFdmVudHM6IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllcy5vZmYoKTtcbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uLm9mZigpO1xuXG4gICAgICAgIC8vZGVzdHJveSBzb3J0YWJsZSBvbmx5IGlmIGl0IGlzIHNldCBhbHJlYWR5IChzZWUgaHR0cDovL2dvby5nbC9yaU40WWspXG4gICAgICAgIGlmIChmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25fc29ydGFibGUuZGF0YSgndWktc29ydGFibGUnKSkge1xuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uX3NvcnRhYmxlLnNvcnRhYmxlKCdkZXN0cm95Jyk7Ly9SZW1vdmUgdGhlIHBsdWdpbiBmdW5jdGlvbmFsaXR5XG4gICAgICAgIH1cbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uX3NvcnRhYmxlLm9mZigpO1xuICAgIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gZm9ybV9mYWN0b3J5O1xuIiwiLyogZ2xvYmFsICQqL1xuJ3VzZSBzdHJpY3QnO1xudmFyIGNvbnN0cyA9IHJlcXVpcmUoJ2NvbmZpZy9jb25zdHMnKTtcbnZhciB1aSA9IHJlcXVpcmUoJ2hlbHBlcnMvdWknKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoJ2hlbHBlcnMvdXRpbHMnKTtcbnZhciBBdWRpb0lucHV0ID0gcmVxdWlyZSgnaW5wdXRzL2F1ZGlvJyk7XG52YXIgQmFyY29kZUlucHV0ID0gcmVxdWlyZSgnaW5wdXRzL2JhcmNvZGUnKTtcbnZhciBCcmFuY2hJbnB1dCA9IHJlcXVpcmUoJ2lucHV0cy9icmFuY2gnKTtcbnZhciBDaGVja2JveElucHV0ID0gcmVxdWlyZSgnaW5wdXRzL2NoZWNrYm94Jyk7XG52YXIgRGF0ZUlucHV0ID0gcmVxdWlyZSgnaW5wdXRzL2RhdGUnKTtcbnZhciBEcm9wZG93bklucHV0ID0gcmVxdWlyZSgnaW5wdXRzL2Ryb3Bkb3duJyk7XG52YXIgTG9jYXRpb25JbnB1dCA9IHJlcXVpcmUoJ2lucHV0cy9sb2NhdGlvbicpO1xudmFyIE51bWVyaWNJbnB1dCA9IHJlcXVpcmUoJ2lucHV0cy9pbnRlZ2VyJyk7XG52YXIgUGhvdG9JbnB1dCA9IHJlcXVpcmUoJ2lucHV0cy9waG90bycpO1xudmFyIFBob25lSW5wdXQgPSByZXF1aXJlKCdpbnB1dHMvcGhvbmUnKTtcbnZhciBSYWRpb0lucHV0ID0gcmVxdWlyZSgnaW5wdXRzL3JhZGlvJyk7XG52YXIgVGV4dElucHV0ID0gcmVxdWlyZSgnaW5wdXRzL3RleHQnKTtcbnZhciBUZXh0YXJlYUlucHV0ID0gcmVxdWlyZSgnaW5wdXRzL3RleHRhcmVhJyk7XG52YXIgUmVhZG1lSW5wdXQgPSByZXF1aXJlKCdpbnB1dHMvcmVhZG1lJyk7XG52YXIgVGltZUlucHV0ID0gcmVxdWlyZSgnaW5wdXRzL3RpbWUnKTtcbnZhciBWaWRlb0lucHV0ID0gcmVxdWlyZSgnaW5wdXRzL3ZpZGVvJyk7XG52YXIgR3JvdXBJbnB1dCA9IHJlcXVpcmUoJ2lucHV0cy9ncm91cCcpO1xudmFyIFNlYXJjaElucHV0ID0gcmVxdWlyZSgnaW5wdXRzL3NlYXJjaCcpO1xudmFyIGZvcm1idWlsZGVyID0gcmVxdWlyZSgnY29uZmlnL2Zvcm1idWlsZGVyJyk7XG52YXIgcG9zc2libGVfYW5zd2VycyA9IHJlcXVpcmUoJ2FjdGlvbnMvcG9zc2libGUtYW5zd2VycycpO1xudmFyIGp1bXBzID0gcmVxdWlyZSgnYWN0aW9ucy9qdW1wcycpO1xudmFyIHRlbXBsYXRlID0gcmVxdWlyZSgndGVtcGxhdGUnKTtcblxuLyoqXG4gKiBEZWZpbmUgYW4gaW50ZXJmYWNlIGZvciBjcmVhdGluZyBhbiBvYmplY3QsIGJ1dCBsZXQgc3ViY2xhc3NlcyBkZWNpZGUgd2hpY2ggY2xhc3MgdG8gaW5zdGFudGlhdGUuXG4gKiBGYWN0b3J5IE1ldGhvZCBsZXRzIGEgY2xhc3MgZGVmZXIgaW5zdGFudGlhdGlvbiB0byBzdWJjbGFzc2VzLlxuICovXG52YXIgaW5wdXRfZmFjdG9yeSA9IHtcblxuICAgIC8vc2V0IGRlZmF1bHQgaW5wdXQgYXMgdHlwZSB0ZXh0XG4gICAgdHlwZTogVGV4dElucHV0LFxuXG4gICAgLy9jcmVhdGUgaW5wdXQgYmFzZWQgb24gdHlwZSwgc2V0IGFsc28gaW5kZXggdW5pcXVlIHRvIGVhY2ggaW5wdXRcbiAgICBjcmVhdGVJbnB1dDogZnVuY3Rpb24gKHRoZV90eXBlLCB0aGVfaW5wdXRfcmVmKSB7XG5cbiAgICAgICAgdmFyIHR5cGUgPSB0aGVfdHlwZTtcbiAgICAgICAgdmFyIGlucHV0X3JlZiA9IHRoZV9pbnB1dF9yZWY7XG5cbiAgICAgICAgc3dpdGNoICh0eXBlKSB7XG4gICAgICAgICAgICBjYXNlIGNvbnN0cy5BVURJT19UWVBFOlxuICAgICAgICAgICAgICAgIHRoaXMudHlwZSA9IEF1ZGlvSW5wdXQ7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGNvbnN0cy5CQVJDT0RFX1RZUEU6XG4gICAgICAgICAgICAgICAgdGhpcy50eXBlID0gQmFyY29kZUlucHV0O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBjb25zdHMuQlJBTkNIX1RZUEU6XG4gICAgICAgICAgICAgICAgdGhpcy50eXBlID0gQnJhbmNoSW5wdXQ7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGNvbnN0cy5DSEVDS0JPWF9UWVBFOlxuICAgICAgICAgICAgICAgIHRoaXMudHlwZSA9IENoZWNrYm94SW5wdXQ7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGNvbnN0cy5EQVRFX1RZUEU6XG4gICAgICAgICAgICAgICAgdGhpcy50eXBlID0gRGF0ZUlucHV0O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBjb25zdHMuRFJPUERPV05fVFlQRTpcbiAgICAgICAgICAgICAgICB0aGlzLnR5cGUgPSBEcm9wZG93bklucHV0O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBjb25zdHMuR1JPVVBfVFlQRTpcbiAgICAgICAgICAgICAgICB0aGlzLnR5cGUgPSBHcm91cElucHV0O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBjb25zdHMuTE9DQVRJT05fVFlQRTpcbiAgICAgICAgICAgICAgICB0aGlzLnR5cGUgPSBMb2NhdGlvbklucHV0O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBjb25zdHMuSU5URUdFUl9UWVBFOlxuICAgICAgICAgICAgICAgIHRoaXMudHlwZSA9IE51bWVyaWNJbnB1dDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgY29uc3RzLkRFQ0lNQUxfVFlQRTpcbiAgICAgICAgICAgICAgICB0aGlzLnR5cGUgPSBOdW1lcmljSW5wdXQ7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGNvbnN0cy5QSE9ORV9UWVBFOlxuICAgICAgICAgICAgICAgIHRoaXMudHlwZSA9IFBob25lSW5wdXQ7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGNvbnN0cy5QSE9UT19UWVBFOlxuICAgICAgICAgICAgICAgIHRoaXMudHlwZSA9IFBob3RvSW5wdXQ7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGNvbnN0cy5SQURJT19UWVBFOlxuICAgICAgICAgICAgICAgIHRoaXMudHlwZSA9IFJhZGlvSW5wdXQ7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGNvbnN0cy5URVhUX1RZUEU6XG4gICAgICAgICAgICAgICAgdGhpcy50eXBlID0gVGV4dElucHV0O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBjb25zdHMuVEVYVEFSRUFfVFlQRTpcbiAgICAgICAgICAgICAgICB0aGlzLnR5cGUgPSBUZXh0YXJlYUlucHV0O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBjb25zdHMuUkVBRE1FX1RZUEU6XG4gICAgICAgICAgICAgICAgdGhpcy50eXBlID0gUmVhZG1lSW5wdXQ7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGNvbnN0cy5USU1FX1RZUEU6XG4gICAgICAgICAgICAgICAgdGhpcy50eXBlID0gVGltZUlucHV0O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBjb25zdHMuVklERU9fVFlQRTpcbiAgICAgICAgICAgICAgICB0aGlzLnR5cGUgPSBWaWRlb0lucHV0O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBjb25zdHMuU0VBUkNIX1NJTkdMRV9UWVBFOlxuICAgICAgICAgICAgICAgIHRoaXMudHlwZSA9IFNlYXJjaElucHV0O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBjb25zdHMuU0VBUkNIX01VTFRJUExFX1RZUEU6XG4gICAgICAgICAgICAgICAgdGhpcy50eXBlID0gU2VhcmNoSW5wdXQ7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbmV3IHRoaXMudHlwZShpbnB1dF9yZWYpO1xuICAgIH0sXG5cbiAgICAvL3JlbW92ZSBpbnB1dCBmcm9tIGRvbSBhbmQgbWVtb3J5XG4gICAgcmVtb3ZlSW5wdXQ6IGZ1bmN0aW9uICh0aGVfcmVmKSB7XG5cbiAgICAgICAgdmFyIHVuZG8gPSByZXF1aXJlKCdhY3Rpb25zL3VuZG8nKTtcbiAgICAgICAgdmFyIGlucHV0X3JlZiA9IHRoZV9yZWY7XG4gICAgICAgIHZhciBpbnB1dF9pbmRleCA9IHV0aWxzLmdldElucHV0Q3VycmVudEluZGV4QnlSZWYoaW5wdXRfcmVmKTtcbiAgICAgICAgdmFyIGlucHV0ID0gdXRpbHMuZ2V0SW5wdXRPYmplY3RCeVJlZihpbnB1dF9yZWYpO1xuXG4gICAgICAgIC8vcmVtb3ZlIGVsZW1lbnQgZnJvbSBnbG9iYWwgYXJyYXkgaW4gbWVtb3J5XG4gICAgICAgIGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbi5kYXRhLnByb2plY3QuZm9ybXNbZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4XS5pbnB1dHMuc3BsaWNlKGlucHV0X2luZGV4LCAxKTtcblxuICAgICAgICAvL3JlbW92ZSBwcm9wZXJ0aWVzIGRvbSBlbGVtZW50cyAocmlnaHQgc2lkZWJhcilcbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXMuZmluZCgnZGl2LnBhbmVsLWJvZHkgZm9ybVtkYXRhLWlucHV0LXJlZj1cIicgKyBpbnB1dF9yZWYgKyAnXCJdJykuZmFkZU91dChjb25zdHMuQU5JTUFUSU9OX0ZBU1QpLnJlbW92ZSgpO1xuXG4gICAgICAgIC8vcmVtb3ZlIGlucHV0IGZyb20gZG9tIGNvbGxlY3Rpb24gKG1pZGRsZSBjb2x1bW4pXG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbl9zb3J0YWJsZS5maW5kKCdkaXYuaW5wdXRbZGF0YS1pbnB1dC1yZWY9XCInICsgaW5wdXRfcmVmICsgJ1wiXScpLmZhZGVPdXQoY29uc3RzLkFOSU1BVElPTl9GQVNUKS5yZW1vdmUoKTtcblxuICAgICAgICAvL2FmdGVyIGRlbGV0aW9uIG5vIGlucHV0IGlzIHNlbGVjdGVkLCBzaG93IG1lc3NhZ2UgYW5kIGhpZGUgY29udGV4dCBidXR0b25zXG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX25vX2lucHV0X3NlbGVjdGVkLmZhZGVJbihjb25zdHMuQU5JTUFUSU9OX0ZBU1QpO1xuICAgICAgICAvL3Nob3cgYWN0aW9uIGJ1dHRvbiBmb3IgaW5wdXRcbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfYnV0dG9ucy5mYWRlT3V0KGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG5cbiAgICAgICAgLy9yZW1vdmUgdHJhY2sgb2YgdGhpcyBpbnB1dFxuICAgICAgICBmb3JtYnVpbGRlci5jdXJyZW50X2lucHV0X3JlZiA9IHVuZGVmaW5lZDtcbiAgICAgICAgaWYgKGlucHV0LnR5cGUgPT09IGNvbnN0cy5TRUFSQ0hfU0lOR0xFX1RZUEUgfHwgaW5wdXQudHlwZSA9PT0gY29uc3RzLlNFQVJDSF9NVUxUSVBMRV9UWVBFKSB7XG4gICAgICAgICAgICBpZiAodXRpbHMuZ2V0U2VhcmNoSW5wdXRzVG90YWwoKSA8PSAoY29uc3RzLkxJTUlUUy5zZWFyY2hfaW5wdXRzX21heCAtIDEpKSB7XG4gICAgICAgICAgICAgICAgdWkuaW5wdXRfdG9vbHMuc2hvd1NlYXJjaElucHV0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLy9yZW1vdmUgYnJhbmNoIGlucHV0IGZyb20gZG9tIGFuZCBtZW1vcnlcbiAgICByZW1vdmVCcmFuY2hJbnB1dDogZnVuY3Rpb24gKHRoZV9vd25lcl9pbnB1dF9yZWYsIHRoZV9icmFuY2hfaW5wdXRfcmVmKSB7XG5cbiAgICAgICAgdmFyIG93bmVyX2lucHV0X3JlZiA9IHRoZV9vd25lcl9pbnB1dF9yZWY7XG4gICAgICAgIHZhciBvd25lcl9pbnB1dF9pbmRleCA9IHV0aWxzLmdldElucHV0Q3VycmVudEluZGV4QnlSZWYob3duZXJfaW5wdXRfcmVmKTtcbiAgICAgICAgdmFyIGJyYW5jaF9pbnB1dF9yZWYgPSB0aGVfYnJhbmNoX2lucHV0X3JlZjtcbiAgICAgICAgdmFyIGJyYW5jaF9pbnB1dF9pbmRleCA9IHV0aWxzLmdldEJyYW5jaElucHV0Q3VycmVudEluZGV4QnlSZWYob3duZXJfaW5wdXRfaW5kZXgsIGJyYW5jaF9pbnB1dF9yZWYpO1xuICAgICAgICB2YXIgZm9ybV9pbmRleCA9IGZvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleDtcbiAgICAgICAgdmFyIGJyYW5jaF9pbnB1dHMgPSBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0LmZvcm1zW2Zvcm1faW5kZXhdLmlucHV0c1tvd25lcl9pbnB1dF9pbmRleF0uYnJhbmNoO1xuXG4gICAgICAgIC8vcmVtb3ZlIGVsZW1lbnQgZnJvbSBnbG9iYWwgb2JqZWN0IGluIG1lbW9yeSAoYW5kIHN0b3JlIHRoZSByZW1vdmVkIGVsZW1lbnQgZm9yIGxhdGVyIHVzZSlcbiAgICAgICAgdmFyIGJyYW5jaF9pbnB1dCA9IGJyYW5jaF9pbnB1dHMuc3BsaWNlKGJyYW5jaF9pbnB1dF9pbmRleCwgMSlbMF07XG5cbiAgICAgICAgLy9yZW1vdmUgcHJvcGVydGllcyBkb20gZWxlbWVudHMgKHJpZ2h0IHNpZGViYXIpXG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzLmZpbmQoJ2Rpdi5wYW5lbC1ib2R5IGZvcm1bZGF0YS1pbnB1dC1yZWY9XCInICsgYnJhbmNoX2lucHV0X3JlZiArICdcIl0nKS5mYWRlT3V0KGNvbnN0cy5BTklNQVRJT05fRkFTVCkucmVtb3ZlKCk7XG5cbiAgICAgICAgLy9yZW1vdmUgaW5wdXQgZnJvbSBkb20gY29sbGVjdGlvbiAobWlkZGxlIGNvbHVtbilcbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uX3NvcnRhYmxlLmZpbmQoJ2Rpdi5pbnB1dFtkYXRhLWlucHV0LXJlZj1cIicgKyBicmFuY2hfaW5wdXRfcmVmICsgJ1wiXScpLmZhZGVPdXQoY29uc3RzLkFOSU1BVElPTl9GQVNUKS5yZW1vdmUoKTtcblxuICAgICAgICAvL2FmdGVyIGRlbGV0aW9uIG5vIGJyYW5jaCBpbnB1dCBpcyBzZWxlY3RlZCwgc28gc2hvdyBtZXNzYWdlIGFuZCBoaWRlIGNvbnRleHQgYnV0dG9uc1xuICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc19ub19pbnB1dF9zZWxlY3RlZC5mYWRlSW4oY29uc3RzLkFOSU1BVElPTl9GQVNUKTtcbiAgICAgICAgLy9oaWRlIGFjdGlvbiBidXR0b24gZm9yIGlucHV0XG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2J1dHRvbnMuZmFkZU91dChjb25zdHMuQU5JTUFUSU9OX0ZBU1QpO1xuXG4gICAgICAgIC8vaWYgYnJhbmNoIGlzIGVtcHR5LCBzaG93IG1lc3NhZ2VcbiAgICAgICAgaWYgKGJyYW5jaF9pbnB1dHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25fc29ydGFibGUuZmluZCgnLmFjdGl2ZS1icmFuY2gnKS5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fbm8tYnJhbmNoLXF1ZXN0aW9ucy1tZXNzYWdlJykuc2hvdygpO1xuXG4gICAgICAgICAgICAvL3Nob3cgaW52YWxpZCBpY29uIGluIGFjdGl2ZSBicmFuY2hcbiAgICAgICAgICAgIHVpLmlucHV0c19jb2xsZWN0aW9uLnNob3dJbnB1dEludmFsaWRJY29uKGZvcm1idWlsZGVyLmJyYW5jaC5hY3RpdmVfYnJhbmNoX3JlZik7XG5cbiAgICAgICAgICAgIC8vc2V0IHRoZSBmb3JtIGFzIGludmFsaWRcbiAgICAgICAgICAgIHVpLmZvcm1zX3RhYnMuc2hvd0Zvcm1JbnZhbGlkSWNvbihmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXgpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9yZW1vdmUgdHJhY2sgb2YgdGhpcyBpbnB1dFxuICAgICAgICBmb3JtYnVpbGRlci5icmFuY2guY3VycmVudF9pbnB1dF9yZWYgPSB1bmRlZmluZWQ7XG5cbiAgICAgICAgaWYgKGJyYW5jaF9pbnB1dC50eXBlID09PSBjb25zdHMuU0VBUkNIX1NJTkdMRV9UWVBFIHx8IGJyYW5jaF9pbnB1dC50eXBlID09PSBjb25zdHMuU0VBUkNIX01VTFRJUExFX1RZUEUpIHtcbiAgICAgICAgICAgIC8vdXBkYXRlIHNlYXJjaCBpbnB1dHMgdG90YWxcbiAgICAgICAgICAgIGlmICh1dGlscy5nZXRTZWFyY2hJbnB1dHNUb3RhbCgpIDw9IChjb25zdHMuTElNSVRTLnNlYXJjaF9pbnB1dHNfbWF4IC0xKSkge1xuICAgICAgICAgICAgICAgIHVpLmlucHV0X3Rvb2xzLnNob3dTZWFyY2hJbnB1dCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8vcmVtb3ZlIGJyYW5jaCBpbnB1dCBmcm9tIGRvbSBhbmQgbWVtb3J5XG4gICAgcmVtb3ZlR3JvdXBJbnB1dDogZnVuY3Rpb24gKHRoZV9vd25lcl9pbnB1dF9yZWYsIHRoZV9ncm91cF9pbnB1dF9yZWYpIHtcblxuICAgICAgICB2YXIgb3duZXJfaW5wdXRfcmVmID0gdGhlX293bmVyX2lucHV0X3JlZjtcbiAgICAgICAgdmFyIG93bmVyX2lucHV0X2luZGV4ID0gdXRpbHMuZ2V0SW5wdXRDdXJyZW50SW5kZXhCeVJlZihvd25lcl9pbnB1dF9yZWYpO1xuICAgICAgICB2YXIgZ3JvdXBfaW5wdXRfcmVmID0gdGhlX2dyb3VwX2lucHV0X3JlZjtcbiAgICAgICAgdmFyIGdyb3VwX2lucHV0X2luZGV4ID0gdXRpbHMuZ2V0R3JvdXBJbnB1dEN1cnJlbnRJbmRleEJ5UmVmKG93bmVyX2lucHV0X2luZGV4LCBncm91cF9pbnB1dF9yZWYpO1xuICAgICAgICB2YXIgZm9ybV9pbmRleCA9IGZvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleDtcbiAgICAgICAgdmFyIGdyb3VwX2lucHV0cyA9IGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbi5kYXRhLnByb2plY3QuZm9ybXNbZm9ybV9pbmRleF0uaW5wdXRzW293bmVyX2lucHV0X2luZGV4XS5ncm91cDtcblxuICAgICAgICAvL3JlbW92ZSBlbGVtZW50IGZyb20gZ2xvYmFsIG9iamVjdCBpbiBtZW1vcnkgKGFuZCBzdG9yZSB0aGUgcmVtb3ZlZCBlbGVtZW50IGZvciBsYXRlciB1c2UpXG4gICAgICAgIHZhciBncm91cF9pbnB1dCA9IGdyb3VwX2lucHV0cy5zcGxpY2UoZ3JvdXBfaW5wdXRfaW5kZXgsIDEpWzBdO1xuXG4gICAgICAgIC8vcmVtb3ZlIHByb3BlcnRpZXMgZG9tIGVsZW1lbnRzIChyaWdodCBzaWRlYmFyKVxuICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllcy5maW5kKCdkaXYucGFuZWwtYm9keSBmb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIGdyb3VwX2lucHV0X3JlZiArICdcIl0nKS5mYWRlT3V0KGNvbnN0cy5BTklNQVRJT05fRkFTVCkucmVtb3ZlKCk7XG5cbiAgICAgICAgLy9yZW1vdmUgaW5wdXQgZnJvbSBkb20gY29sbGVjdGlvbiAobWlkZGxlIGNvbHVtbilcbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uX3NvcnRhYmxlLmZpbmQoJ2Rpdi5pbnB1dFtkYXRhLWlucHV0LXJlZj1cIicgKyBncm91cF9pbnB1dF9yZWYgKyAnXCJdJykuZmFkZU91dChjb25zdHMuQU5JTUFUSU9OX0ZBU1QpLnJlbW92ZSgpO1xuXG4gICAgICAgIC8vYWZ0ZXIgZGVsZXRpb24gbm8gZ3JvdXAgaW5wdXQgaXMgc2VsZWN0ZWQsIHNvIHNob3cgbWVzc2FnZSBhbmQgaGlkZSBjb250ZXh0IGJ1dHRvbnNcbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfbm9faW5wdXRfc2VsZWN0ZWQuZmFkZUluKGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG4gICAgICAgIC8vaGlkZSBhY3Rpb24gYnV0dG9uIGZvciBpbnB1dFxuICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc19idXR0b25zLmZhZGVPdXQoY29uc3RzLkFOSU1BVElPTl9GQVNUKTtcblxuICAgICAgICAvL2lmIGdyb3VwIGlzIGVtcHR5LCBzaG93IG1lc3NhZ2VcbiAgICAgICAgaWYgKGdyb3VwX2lucHV0cy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbl9zb3J0YWJsZS5maW5kKCcuYWN0aXZlLWdyb3VwJykuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX25vLWdyb3VwLXF1ZXN0aW9ucy1tZXNzYWdlJykuc2hvdygpO1xuXG4gICAgICAgICAgICAvL3Nob3cgaW52YWxpZCBpY29uIGluIGFjdGl2ZSBicmFuY2hcbiAgICAgICAgICAgIHVpLmlucHV0c19jb2xsZWN0aW9uLnNob3dJbnB1dEludmFsaWRJY29uKGZvcm1idWlsZGVyLmdyb3VwLmFjdGl2ZV9ncm91cF9yZWYpO1xuXG4gICAgICAgICAgICAvL3NldCB0aGUgZm9ybSBhcyBpbnZhbGlkXG4gICAgICAgICAgICB1aS5mb3Jtc190YWJzLnNob3dGb3JtSW52YWxpZEljb24oZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vcmVtb3ZlIHRyYWNrIG9mIHRoaXMgaW5wdXRcbiAgICAgICAgZm9ybWJ1aWxkZXIuZ3JvdXAuY3VycmVudF9pbnB1dF9yZWYgPSB1bmRlZmluZWQ7XG5cbiAgICAgICAgaWYgKGdyb3VwX2lucHV0LnR5cGUgPT09IGNvbnN0cy5TRUFSQ0hfU0lOR0xFX1RZUEUgfHwgZ3JvdXBfaW5wdXQudHlwZSA9PT0gY29uc3RzLlNFQVJDSF9NVUxUSVBMRV9UWVBFKSB7XG4gICAgICAgICAgICBpZiAodXRpbHMuZ2V0U2VhcmNoSW5wdXRzVG90YWwoKSA8PSAoY29uc3RzLkxJTUlUUy5zZWFyY2hfaW5wdXRzX21heCAtMSkpIHtcbiAgICAgICAgICAgICAgICB1aS5pbnB1dF90b29scy5zaG93U2VhcmNoSW5wdXQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICByZW1vdmVOZXN0ZWRHcm91cElucHV0OiBmdW5jdGlvbiAodGhlX293bmVyX2lucHV0X2JyYW5jaF9yZWYsIHRoZV9uZXN0ZWRfZ3JvdXBfcmVmKSB7XG5cbiAgICAgICAgdmFyIG5lc3RlZF9ncm91cF9yZWYgPSB0aGVfbmVzdGVkX2dyb3VwX3JlZjtcbiAgICAgICAgdmFyIGZvcm1faW5kZXggPSBmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXg7XG4gICAgICAgIHZhciBvd25lcl9pbnB1dF9pbmRleCA9IHV0aWxzLmdldElucHV0Q3VycmVudEluZGV4QnlSZWYoZm9ybWJ1aWxkZXIuY3VycmVudF9pbnB1dF9yZWYpO1xuICAgICAgICB2YXIgb3duZXJfYnJhbmNoID0gdXRpbHMuZ2V0SW5wdXRPYmplY3RCeVJlZihmb3JtYnVpbGRlci5icmFuY2guYWN0aXZlX2JyYW5jaF9yZWYpO1xuICAgICAgICB2YXIgb3duZXJfYnJhbmNoX2luZGV4ID0gdXRpbHMuZ2V0QnJhbmNoSW5wdXRDdXJyZW50SW5kZXhCeVJlZihvd25lcl9pbnB1dF9pbmRleCwgZm9ybWJ1aWxkZXIuYnJhbmNoLmN1cnJlbnRfaW5wdXRfcmVmKTtcbiAgICAgICAgdmFyIG5lc3RlZF9ncm91cF9pbmRleCA9IHV0aWxzLmdldE5lc3RlZEdyb3VwSW5wdXRDdXJyZW50SW5kZXhCeVJlZihvd25lcl9icmFuY2gsIG5lc3RlZF9ncm91cF9yZWYpO1xuICAgICAgICB2YXIgbmVzdGVkX2dyb3VwX2lucHV0cyA9IGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbi5kYXRhLnByb2plY3RcbiAgICAgICAgICAgIC5mb3Jtc1tmb3JtX2luZGV4XVxuICAgICAgICAgICAgLmlucHV0c1tvd25lcl9pbnB1dF9pbmRleF1cbiAgICAgICAgICAgIC5icmFuY2hbb3duZXJfYnJhbmNoX2luZGV4XVxuICAgICAgICAgICAgLmdyb3VwO1xuXG4gICAgICAgIC8vcmVtb3ZlIGVsZW1lbnQgZnJvbSBnbG9iYWwgb2JqZWN0IGluIG1lbW9yeSAoYW5kIHN0b3JlIHRoZSByZW1vdmVkIGVsZW1lbnQgZm9yIGxhdGVyIHVzZSlcbiAgICAgICAgdmFyIG5lc3RlZF9ncm91cF9pbnB1dCA9IG5lc3RlZF9ncm91cF9pbnB1dHMuc3BsaWNlKG5lc3RlZF9ncm91cF9pbmRleCwgMSlbMF07XG5cbiAgICAgICAgLy9yZW1vdmUgcHJvcGVydGllcyBkb20gZWxlbWVudHMgKHJpZ2h0IHNpZGViYXIpXG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzLmZpbmQoJ2Rpdi5wYW5lbC1ib2R5IGZvcm1bZGF0YS1pbnB1dC1yZWY9XCInICsgbmVzdGVkX2dyb3VwX3JlZiArICdcIl0nKS5mYWRlT3V0KGNvbnN0cy5BTklNQVRJT05fRkFTVCkucmVtb3ZlKCk7XG5cbiAgICAgICAgLy9yZW1vdmUgaW5wdXQgZnJvbSBkb20gY29sbGVjdGlvbiAobWlkZGxlIGNvbHVtbilcbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uX3NvcnRhYmxlLmZpbmQoJ2Rpdi5pbnB1dFtkYXRhLWlucHV0LXJlZj1cIicgKyBuZXN0ZWRfZ3JvdXBfcmVmICsgJ1wiXScpLmZhZGVPdXQoY29uc3RzLkFOSU1BVElPTl9GQVNUKS5yZW1vdmUoKTtcblxuICAgICAgICAvL2FmdGVyIGRlbGV0aW9uIG5vIGdyb3VwIGlucHV0IGlzIHNlbGVjdGVkLCBzbyBzaG93IG1lc3NhZ2UgYW5kIGhpZGUgY29udGV4dCBidXR0b25zXG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX25vX2lucHV0X3NlbGVjdGVkLmZhZGVJbihjb25zdHMuQU5JTUFUSU9OX0ZBU1QpO1xuICAgICAgICAvL2hpZGUgYWN0aW9uIGJ1dHRvbiBmb3IgaW5wdXRcbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfYnV0dG9ucy5mYWRlT3V0KGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG5cbiAgICAgICAgLy9pZiBncm91cCBpcyBlbXB0eSwgc2hvdyBtZXNzYWdlXG4gICAgICAgIGlmIChuZXN0ZWRfZ3JvdXBfaW5wdXRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uX3NvcnRhYmxlLmZpbmQoJy5hY3RpdmUtZ3JvdXAnKS5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fbm8tZ3JvdXAtcXVlc3Rpb25zLW1lc3NhZ2UnKS5zaG93KCk7XG5cbiAgICAgICAgICAgIC8vc2hvdyBpbnZhbGlkIGljb24gaW4gYWN0aXZlIGJyYW5jaFxuICAgICAgICAgICAgdWkuaW5wdXRzX2NvbGxlY3Rpb24uc2hvd0lucHV0SW52YWxpZEljb24oZm9ybWJ1aWxkZXIuZ3JvdXAuYWN0aXZlX2dyb3VwX3JlZik7XG5cbiAgICAgICAgICAgIC8vc2V0IHRoZSBmb3JtIGFzIGludmFsaWRcbiAgICAgICAgICAgIHVpLmZvcm1zX3RhYnMuc2hvd0Zvcm1JbnZhbGlkSWNvbihmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXgpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9yZW1vdmUgdHJhY2sgb2YgdGhpcyBpbnB1dFxuICAgICAgICBmb3JtYnVpbGRlci5ncm91cC5jdXJyZW50X2lucHV0X3JlZiA9IHVuZGVmaW5lZDtcblxuICAgICAgICBpZiAobmVzdGVkX2dyb3VwX2lucHV0LnR5cGUgPT09IGNvbnN0cy5TRUFSQ0hfU0lOR0xFX1RZUEUgfHwgbmVzdGVkX2dyb3VwX2lucHV0LnR5cGUgPT09IGNvbnN0cy5TRUFSQ0hfTVVMVElQTEVfVFlQRSkge1xuICAgICAgICAgICAgaWYgKHV0aWxzLmdldFNlYXJjaElucHV0c1RvdGFsKCkgPD0gKGNvbnN0cy5MSU1JVFMuc2VhcmNoX2lucHV0c19tYXggLTEpKSB7XG4gICAgICAgICAgICAgICAgdWkuaW5wdXRfdG9vbHMuc2hvd1NlYXJjaElucHV0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLy90b2RvIHRoaXMgaXMgYSBiaXQgb2YgY29kZSBkdXBsaWNhdGlvbiwgdG8gYmUgcmVmYWN0b3JlZFxuICAgIHNob3dHcm91cElucHV0UHJvcGVydGllc0RvbTogZnVuY3Rpb24gKHRoZV9ncm91cF9pbnB1dF9pbmRleCkge1xuXG4gICAgICAgIHZhciBmb3JtX2luZGV4ID0gZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4O1xuICAgICAgICB2YXIgb3duZXJfaW5wdXRfcmVmID0gZm9ybWJ1aWxkZXIuY3VycmVudF9pbnB1dF9yZWY7XG4gICAgICAgIHZhciBvd25lcl9pbnB1dF9pbmRleCA9IHV0aWxzLmdldElucHV0Q3VycmVudEluZGV4QnlSZWYob3duZXJfaW5wdXRfcmVmKTtcbiAgICAgICAgdmFyIGdyb3VwX2lucHV0X2luZGV4ID0gdGhlX2dyb3VwX2lucHV0X2luZGV4O1xuICAgICAgICB2YXIgZ3JvdXBfaW5wdXQgPSBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0LmZvcm1zW2Zvcm1faW5kZXhdLmlucHV0c1tvd25lcl9pbnB1dF9pbmRleF0uZ3JvdXBbZ3JvdXBfaW5wdXRfaW5kZXhdO1xuICAgICAgICB2YXIgaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyID0gZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlcjtcbiAgICAgICAgdmFyIHZpZXcgPSBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc192aWV3c1tncm91cF9pbnB1dC50eXBlXTtcblxuICAgICAgICBpbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXIuYXBwZW5kKHZpZXcpLmhpZGUoKS5mYWRlSW4oY29uc3RzLkFOSU1BVElPTl9GQVNUKTtcblxuICAgICAgICAvL2luaXQgcHJvcGVydGllcyBwYW5lbFxuICAgICAgICAvL3RvZG9cbiAgICAgICAgLy9oZWxwZXJzLmluaXRJbnB1dFByb3BlcnRpZXNQYW5lbChpbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXIsIGdyb3VwX2lucHV0LCBmb3JtYnVpbGRlci5kb20ucGFydGlhbHMpO1xuICAgIH0sXG5cbiAgICAvL3RvZG8gdGhpcyBpcyBhIGJpdCBvZiBjb2RlIGR1cGxpY2F0aW9uLCB0byBiZSByZWZhY3RvcmVkXG4gICAgc2hvd05lc3RlZEdyb3VwSW5wdXRQcm9wZXJ0aWVzRG9tOiBmdW5jdGlvbiAodGhlX25lc3RlZF9ncm91cF9pbnB1dF9pbmRleCkge1xuXG5cbiAgICAgICAgY29uc29sZS5sb2coZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uLmRhdGEucHJvamVjdC5mb3Jtcyk7XG5cbiAgICAgICAgdmFyIGZvcm1faW5kZXggPSBmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXg7XG4gICAgICAgIHZhciBicmFuY2hfaW5kZXggPSB1dGlscy5nZXRJbnB1dEN1cnJlbnRJbmRleEJ5UmVmKGZvcm1idWlsZGVyLmN1cnJlbnRfaW5wdXRfcmVmKTtcbiAgICAgICAgdmFyIGdyb3VwX2luZGV4ID0gdXRpbHMuZ2V0QnJhbmNoSW5wdXRDdXJyZW50SW5kZXhCeVJlZihicmFuY2hfaW5kZXgsIGZvcm1idWlsZGVyLmdyb3VwLmFjdGl2ZV9ncm91cF9yZWYpO1xuICAgICAgICB2YXIgbmVzdGVkX2dyb3VwX2luZGV4ID0gdGhlX25lc3RlZF9ncm91cF9pbnB1dF9pbmRleDtcbiAgICAgICAgdmFyIG5lc3RlZF9ncm91cF9pbnB1dCA9IGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbi5kYXRhLnByb2plY3RcbiAgICAgICAgICAgIC5mb3Jtc1tmb3JtX2luZGV4XVxuICAgICAgICAgICAgLmlucHV0c1ticmFuY2hfaW5kZXhdXG4gICAgICAgICAgICAuYnJhbmNoW2dyb3VwX2luZGV4XVxuICAgICAgICAgICAgLmdyb3VwW25lc3RlZF9ncm91cF9pbmRleF07XG5cbiAgICAgICAgdmFyIGlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlciA9IGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXI7XG4gICAgICAgIHZhciB2aWV3ID0gZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfdmlld3NbbmVzdGVkX2dyb3VwX2lucHV0LnR5cGVdO1xuXG4gICAgICAgIGlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlci5hcHBlbmQodmlldykuaGlkZSgpLmZhZGVJbihjb25zdHMuQU5JTUFUSU9OX0ZBU1QpO1xuXG4gICAgfSxcblxuICAgIGNyZWF0ZUlucHV0VG9vbEhUTUw6IGZ1bmN0aW9uIChpbnB1dCkge1xuICAgICAgICByZXR1cm4gdGVtcGxhdGUuY3JlYXRlSW5wdXRUb29sSFRNTChpbnB1dCk7XG4gICAgfSxcblxuICAgIGNyZWF0ZVByb3BlcnRpZXNIVE1MOiBmdW5jdGlvbiAoaW5wdXQpIHtcbiAgICAgICAgcmV0dXJuIHRlbXBsYXRlLmNyZWF0ZVByb3BlcnRpZXNIVE1MKGlucHV0KTtcbiAgICB9LFxuICAgIGdldEFkdmFuY2VkVGFiQnRuSFRNTDogZnVuY3Rpb24gKHJlZiwgaXNfYWN0aXZlKSB7XG4gICAgICAgIHJldHVybiB0ZW1wbGF0ZS5nZXRBZHZhbmNlZFRhYkJ0bkhUTUwocmVmLCBpc19hY3RpdmUpO1xuICAgIH0sXG4gICAgZ2V0SnVtcFRhYkJ0bkhUTUw6IGZ1bmN0aW9uIChyZWYsIGlzX2FjdGl2ZSkge1xuICAgICAgICByZXR1cm4gdGVtcGxhdGUuZ2V0SnVtcFRhYkJ0bkhUTUwocmVmLCBpc19hY3RpdmUpO1xuICAgIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gaW5wdXRfZmFjdG9yeTtcbiIsIi8qIGdsb2JhbCAkKi9cbid1c2Ugc3RyaWN0JztcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgZXJyb3JzID0gcmVxdWlyZSgnYWN0aW9ucy9lcnJvcnMnKTtcbnZhciBqdW1wcyA9IHJlcXVpcmUoJ2FjdGlvbnMvanVtcHMnKTtcbnZhciBzYXZlID0gcmVxdWlyZSgnYWN0aW9ucy9zYXZlJyk7XG52YXIgcG9zc2libGVfYW5zd2VycyA9IHJlcXVpcmUoJ2FjdGlvbnMvcG9zc2libGUtYW5zd2VycycpO1xudmFyIHZhbGlkYXRpb24gPSByZXF1aXJlKCdhY3Rpb25zL3ZhbGlkYXRpb24nKTtcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJ2NvbmZpZy9mb3JtYnVpbGRlcicpO1xudmFyIHVpID0gcmVxdWlyZSgnaGVscGVycy91aScpO1xudmFyIHV0aWxzID0gcmVxdWlyZSgnaGVscGVycy91dGlscycpO1xudmFyIHRlbXBsYXRlID0gcmVxdWlyZSAoJ3RlbXBsYXRlJyk7XG5cbnZhciBJbnB1dE11bHRpcGxlQW5zd2VycyA9IGZ1bmN0aW9uICgpIHtcbn07XG5cbklucHV0TXVsdGlwbGVBbnN3ZXJzLnByb3RvdHlwZS5wcmVwYXJlQWR2YW5jZWRJbnB1dFByb3BlcnRpZXMgPSBmdW5jdGlvbiAodmlldykge1xuICAgIHJldHVybiB0ZW1wbGF0ZS5wcmVwYXJlQWR2YW5jZWRJbnB1dFByb3BlcnRpZXModmlldywgdGhpcyk7XG59O1xuXG5JbnB1dE11bHRpcGxlQW5zd2Vycy5wcm90b3R5cGUuc2V0QWR2YW5jZWRJbnB1dFByb3BlcnRpZXMgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICB0aGlzLmRvbS5hZHZhbmNlZF9wcm9wZXJ0aWVzX3dyYXBwZXIgPSBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyXG4gICAgICAgIC5maW5kKCdmb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIHRoaXMucmVmICsgJ1wiXScpXG4gICAgICAgIC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fYWR2YW5jZWQtcHJvcGVydGllcycpO1xuXG4gICAgdGhpcy5kb20uYWR2YW5jZWRfcHJvcGVydGllc193cmFwcGVyXG4gICAgICAgIC5maW5kKCdkaXYucGFuZWwtYm9keSBkaXYuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fYWR2YW5jZWQtcHJvcGVydGllc19fZGVmYXVsdCBzZWxlY3Qgb3B0aW9uW3ZhbHVlPVwiJyArIHRoaXMuZGVmYXVsdCArICdcIl0nKS5wcm9wKCdzZWxlY3RlZCcsIHRydWUpO1xuXG4gICAgLy9zZXQgJ2lucHV0X3JlZicgb24gJ3VuaXF1ZW5lc3MnIG9wdGlvblxuICAgIHVpLmlucHV0X3Byb3BlcnRpZXNfcGFuZWwuc2V0VW5pcXVlbmVzc1Byb3BlcnR5KGZvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleCwgdGhpcyk7XG5cbn07XG5cbklucHV0TXVsdGlwbGVBbnN3ZXJzLnByb3RvdHlwZS5zYXZlQWR2YW5jZWRQcm9wZXJ0aWVzID0gZnVuY3Rpb24gKCkge1xuXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgc2VsZi5kb20uYWR2YW5jZWRfcHJvcGVydGllc193cmFwcGVyID0gZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlclxuICAgICAgICAuZmluZCgnZm9ybVtkYXRhLWlucHV0LXJlZj1cIicgKyBzZWxmLnJlZiArICdcIl0nKVxuICAgICAgICAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2FkdmFuY2VkLXByb3BlcnRpZXMnKTtcbiAgICAvL3NldCBkZWZhdWx0XG4gICAgdGhpcy5kZWZhdWx0ID0gdGhpcy5kb20uYWR2YW5jZWRfcHJvcGVydGllc193cmFwcGVyXG4gICAgICAgIC5maW5kKCdkaXYucGFuZWwtYm9keSBkaXYuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fYWR2YW5jZWQtcHJvcGVydGllc19fZGVmYXVsdCBzZWxlY3Qgb3B0aW9uOnNlbGVjdGVkJylcbiAgICAgICAgLnZhbCgpO1xuXG4gICAgaWYgKHRoaXMuZGVmYXVsdCA9PT0gJ05vbmUnKSB7XG4gICAgICAgIHRoaXMuZGVmYXVsdCA9IG51bGw7XG4gICAgfVxuXG4gICAgLy9mb3IgU0VBUkNIIHR5cGUsIHNhdmUgaWYgdGhlIHNlYXJjaCBhbGxvdyBhIHNpbmdsZSBhbnN3ZXIgb3IgbXVsdGlwbGUgYW5zd2Vyc1xuICAgIGlmKHNlbGYudHlwZSA9PT0gY29uc3RzLlNFQVJDSF9TSU5HTEVfVFlQRSB8fCBzZWxmLnR5cGUgPT09IGNvbnN0cy5TRUFSQ0hfTVVMVElQTEVfVFlQRSkge1xuXG4gICAgICAgIC8vc2V0IHNpbmdsZSBvciBtdWx0aXBsZSBzZWFyY2ggdHlwZVxuICAgICAgICBzZWxmLnR5cGUgPSB0aGlzLmRvbS5hZHZhbmNlZF9wcm9wZXJ0aWVzX3dyYXBwZXIuZmluZCgnZGl2LmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2FkdmFuY2VkLXByb3BlcnRpZXNfX3NlYXJjaCBpbnB1dDpjaGVja2VkJykudmFsKCk7XG4gICAgfVxuXG59O1xuXG5JbnB1dE11bHRpcGxlQW5zd2Vycy5wcm90b3R5cGUuaGlkZVByb3BlcnRpZXNFcnJvcnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgZXJyb3JzLmhpZGVQcm9wZXJ0aWVzRXJyb3JzKHRoaXMuZG9tLnByb3BlcnRpZXNfcGFuZWwpO1xuICAgIGVycm9ycy5oaWRlUG9zc2libGVBbnN3ZXJzRXJyb3JzKHRoaXMpO1xufTtcblxuSW5wdXRNdWx0aXBsZUFuc3dlcnMucHJvdG90eXBlLmFkZFBvc3NpYmxlQW5zd2VyID0gZnVuY3Rpb24gKCkge1xuICAgIHBvc3NpYmxlX2Fuc3dlcnMuYWRkUG9zc2libGVBbnN3ZXIodGhpcyk7XG59O1xuXG5JbnB1dE11bHRpcGxlQW5zd2Vycy5wcm90b3R5cGUucmVtb3ZlUG9zc2libGVBbnN3ZXIgPSBmdW5jdGlvbiAodGhlX2Fuc3dlcl9pbmRleCkge1xuICAgIHBvc3NpYmxlX2Fuc3dlcnMucmVtb3ZlUG9zc2libGVBbnN3ZXIodGhpcywgdGhlX2Fuc3dlcl9pbmRleCk7XG59O1xuXG5cbklucHV0TXVsdGlwbGVBbnN3ZXJzLnByb3RvdHlwZS5zYXZlUG9zc2libGVBbnN3ZXJzID0gZnVuY3Rpb24gKCkge1xuICAgIHNhdmUuc2F2ZVBvc3NpYmxlQW5zd2Vycyh0aGlzKTtcbn07XG5JbnB1dE11bHRpcGxlQW5zd2Vycy5wcm90b3R5cGUuc2hvd1Bvc3NpYmxlQW5zd2VyRXJyb3JzID0gZnVuY3Rpb24gKHRoZV9wb3NzaWJsZV9hbnN3ZXIsIHRoZV9lcnJvcl9tZXNzYWdlKSB7XG4gICAgZXJyb3JzLnNob3dQb3NzaWJsZUFuc3dlckVycm9ycyh0aGVfcG9zc2libGVfYW5zd2VyLCB0aGVfZXJyb3JfbWVzc2FnZSk7XG59O1xuSW5wdXRNdWx0aXBsZUFuc3dlcnMucHJvdG90eXBlLmhpZGVQb3NzaWJsZUFuc3dlcnNFcnJvcnMgPSBmdW5jdGlvbiAodGhlX3Bvc3NpYmxlX2Fuc3dlcnMpIHtcbiAgICBlcnJvcnMuaGlkZVBvc3NpYmxlQW5zd2Vyc0Vycm9ycyh0aGlzLCB0aGVfcG9zc2libGVfYW5zd2Vycyk7XG59O1xuSW5wdXRNdWx0aXBsZUFuc3dlcnMucHJvdG90eXBlLmlzUG9zc2libGVBbnN3ZXJWYWxpZCA9IGZ1bmN0aW9uICh0aGVfYW5zd2VyKSB7XG4gICAgLy92YWxpZGF0ZSBwb3NzaWJsZSBhbnN3ZXJcbiAgICByZXR1cm4gdmFsaWRhdGlvbi5pc1Bvc3NpYmxlQW5zd2VyVmFsaWQodGhlX2Fuc3dlcik7XG59O1xuXG4vKlxuIHVwZGF0ZSB0aGUgc2VsZWN0ZWQgcG9zc2libGUgYW5zd2VycyBmb3IgdGhlIGp1bXBzLCBpbiBjYXNlIHRoZSBwb3NzaWJsZSBhbnN3ZXJzIGdvdCBjaGFuZ2VkIGJ5IHRoZSB1c2VyXG4gdGhpcyBpcyB0byByZWZyZXNoIHRoZSBkb20gd2hlbiB0aGUgdXNlciBjaGFuZ2UgYSBwb3NzaWJsZSBhbnN3ZXIgdGV4dCBhbmQgdGhlbiBzd2l0Y2hlcyB0byB0aGUganVtcHMgcGFuZWw6XG4gaWYgYW4gb2xkIG9wdGlvbiB3YXMgc2VsZWN0ZWQsIHdlIHJlZmxlY3QgdGhhdCBjaGFuZ2Ugb24gdGhlIGRvbVxuICovXG5JbnB1dE11bHRpcGxlQW5zd2Vycy5wcm90b3R5cGUudXBkYXRlSnVtcFBvc3NpYmxlQW5zd2VycyA9IGZ1bmN0aW9uICh0aGVfanVtcF9wYW5lbCkge1xuICAgIHBvc3NpYmxlX2Fuc3dlcnMudXBkYXRlSnVtcFBvc3NpYmxlQW5zd2Vycyh0aGlzLCB0aGVfanVtcF9wYW5lbCk7XG59O1xuXG5JbnB1dE11bHRpcGxlQW5zd2Vycy5wcm90b3R5cGUudXBkYXRlUG9zc2libGVJbml0aWFsQW5zd2VycyA9IGZ1bmN0aW9uICgpIHtcbiAgICBwb3NzaWJsZV9hbnN3ZXJzLnVwZGF0ZVBvc3NpYmxlSW5pdGlhbEFuc3dlcnModGhpcyk7XG59O1xuXG5JbnB1dE11bHRpcGxlQW5zd2Vycy5wcm90b3R5cGUubGlzdFBvc3NpYmxlSW5pdGlhbEFuc3dlcnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgcG9zc2libGVfYW5zd2Vycy5saXN0UG9zc2libGVJbml0aWFsQW5zd2Vycyh0aGlzKTtcbn07XG5cbklucHV0TXVsdGlwbGVBbnN3ZXJzLnByb3RvdHlwZS5hZGRKdW1wID0gZnVuY3Rpb24gKCkge1xuXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgLy9zZXQgXCJBZGQgSnVtcFwiIGJ1dHRvbiByZWZlcmVuY2UgKHNvIGl0IGlzIGF2YWlsYWJsZSB3aGVuIHBsYXlpbmcgd2l0aCBqdW1wcylcbiAgICBzZWxmLmRvbS5hZGRfanVtcF9idXR0b24gPSBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc1xuICAgICAgICAuZmluZCgnLnBhbmVsLWJvZHkgZm9ybVtkYXRhLWlucHV0LXJlZj1cIicgKyBzZWxmLnJlZiArICdcIl0nKVxuICAgICAgICAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2p1bXBzX19hZGQtanVtcCcpO1xuXG4gICAgJC53aGVuKGp1bXBzLmFkZEp1bXAoc2VsZiwgdHJ1ZSkpLnRoZW4oZnVuY3Rpb24gKCkge1xuXG4gICAgICAgIC8vZGlzYWJsZSBhZGQganVtcCBidXR0b24gaWYgdG90YWwgb2YganVtcHMgaXMgZXF1YWwgdG8gdG90YWwgb2YgcG9zc2libGUgYW5zd2Vyc1xuICAgICAgICBpZiAoc2VsZi5qdW1wcy5sZW5ndGggPT09IHNlbGYucG9zc2libGVfYW5zd2Vycy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHNlbGYuZG9tLmFkZF9qdW1wX2J1dHRvbi5hdHRyKCdkaXNhYmxlZCcsIHRydWUpO1xuICAgICAgICB9XG4gICAgfSk7XG59O1xuXG4vL292ZXJyaWRlIHRoZSBleGlzdGluZyBtZXRob2QsIGFzIHdlIG5lZWQgYW4gZXh0cmEgY2hlY2sgZm9yIHRoZXNlIHR5cGVzIG9mIGlucHV0XG5JbnB1dE11bHRpcGxlQW5zd2Vycy5wcm90b3R5cGUucmVtb3ZlSnVtcCA9IGZ1bmN0aW9uICh0aGVfcmVtb3ZlX2J0bikge1xuXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgLy9zZXQgXCJBZGQgSnVtcFwiIGJ1dHRvbiByZWZlcmVuY2UgKHNvIGl0IGlzIGF2YWlsYWJsZSB3aGVuIHBsYXlpbmcgd2l0aCBqdW1wcylcbiAgICBzZWxmLmRvbS5hZGRfanVtcF9idXR0b24gPSBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc1xuICAgICAgICAuZmluZCgnLnBhbmVsLWJvZHkgZm9ybVtkYXRhLWlucHV0LXJlZj1cIicgKyBzZWxmLnJlZiArICdcIl0nKVxuICAgICAgICAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2p1bXBzX19hZGQtanVtcCcpO1xuXG4gICAganVtcHMucmVtb3ZlSnVtcChzZWxmLCB0aGVfcmVtb3ZlX2J0bik7XG5cbiAgICAvL2VuYWJsZSBidXR0b24gaWYgd2UgcmVtb3ZlZCBsYXN0IGp1bXBcbiAgICBpZiAoc2VsZi5qdW1wcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgLy9lbmFibGUgYWRkIGp1bXAgYnV0dG9uXG4gICAgICAgIHNlbGYuZG9tLmFkZF9qdW1wX2J1dHRvbi5hdHRyKCdkaXNhYmxlZCcsIGZhbHNlKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIC8vZW5hYmxlIGJ1dHRvbiBpZiB3ZSBjYW4gYWRkIGp1bXBzXG4gICAgICAgIGlmIChzZWxmLmp1bXBzLmxlbmd0aCA8IHNlbGYucG9zc2libGVfYW5zd2Vycy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHNlbGYuZG9tLmFkZF9qdW1wX2J1dHRvbi5hdHRyKCdkaXNhYmxlZCcsIGZhbHNlKTtcbiAgICAgICAgfVxuICAgIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gSW5wdXRNdWx0aXBsZUFuc3dlcnM7XG4iLCIndXNlIHN0cmljdCc7XG5cbi8vaW5wdXQgYmFzZSBwcm9wZXJ0aWVzXG52YXIgaW5wdXRzX3Byb3BlcnRpZXMgPSB7XG5cbiAgICAvL3RvcCBsZXZlbCwgdG8gYmUgZXhwb3J0ZWQgd2hlbiBzYXZpbmcgcHJvamVjdFxuICAgLy8gaW5kZXg6IG51bGwsXG4gICAgcmVmOiBudWxsLFxuICAgIHR5cGU6ICcnLFxuICAgIHF1ZXN0aW9uOiAnJyxcbiAgICBpc190aXRsZTogZmFsc2UsXG4gICAgaXNfcmVxdWlyZWQ6IGZhbHNlLFxuICAgIHVuaXF1ZW5lc3M6ICdub25lJyxcbiAgICByZWdleDogbnVsbCxcbiAgICBkZWZhdWx0OiBudWxsLFxuICAgIHZlcmlmeTogZmFsc2UsXG4gICAgbWF4OiBudWxsLFxuICAgIG1pbjogbnVsbCxcbiAgICBkYXRldGltZV9mb3JtYXQ6IG51bGwsXG4gICAgc2V0X3RvX2N1cnJlbnRfZGF0ZXRpbWU6IGZhbHNlLFxuICAgIHBvc3NpYmxlX2Fuc3dlcnM6IFtdLFxuICAgIGp1bXBzOiBbXSxcbiAgICBicmFuY2g6IFtdLFxuICAgIGdyb3VwOiBbXVxuXG4gICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuICAgIC8vdGhpcyBwcm9wZXJ0eSBpcyBub3QgZGVjbGFyZWQgaGVyZSBhbnltb3JlIGFzIHdpdGgganF1ZXJ5IHRoZSBkb20gaXMgY2FjaGVkIGFuZCBzdGF5cyB0aGUgc2FtZSBwZXIgZWFjaCBvYmplY3QsXG4gICAgLy9zbyBJIHdpbGwgYWRkIHRoZW0gbGF0ZXIgYWZ0ZXIgdGhlIG9iamVjdCBpcyBpbnN0YW50aWF0ZWRcbiAgICAvLy8qIERPTSBwcm9wZXJ0aWVzKi9cbiAgICAvL2RvbToge1xuICAgIC8vICAgIGlzX3ZhbGlkOiBmYWxzZSwgLy9mYWxzZSBieSBkZWZhdWx0IGFzIHdlIHNkbyBub3QgaGF2ZSBhIHF1ZXN0aW9uIHRleHQgYWZ0ZXIgZHJhZyBhbmQgZHJvcFxuICAgIC8vICAgIGFkdmFuY2VkX3Byb3BlcnRpZXNfd3JhcHBlcjogbnVsbCxcbiAgICAvLyAgICBhZGRfanVtcF9idXR0b246IG51bGwsXG4gICAgLy8gICAgcHJvcGVydGllc19wYW5lbDpudWxsXG4gICAgLy99XG4gICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBpbnB1dHNfcHJvcGVydGllcztcbiIsIi8qIGdsb2JhbCAkKi9cbid1c2Ugc3RyaWN0JztcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgZXJyb3JzID0gcmVxdWlyZSgnYWN0aW9ucy9lcnJvcnMnKTtcbnZhciBqdW1wcyA9IHJlcXVpcmUoJ2FjdGlvbnMvanVtcHMnKTtcbnZhciBzYXZlID0gcmVxdWlyZSgnYWN0aW9ucy9zYXZlJyk7XG52YXIgdmFsaWRhdGlvbiA9IHJlcXVpcmUoJ2FjdGlvbnMvdmFsaWRhdGlvbicpO1xudmFyIGZvcm1idWlsZGVyID0gcmVxdWlyZSgnY29uZmlnL2Zvcm1idWlsZGVyJyk7XG52YXIgdWkgPSByZXF1aXJlKCdoZWxwZXJzL3VpJyk7XG52YXIgdXRpbHMgPSByZXF1aXJlKCdoZWxwZXJzL3V0aWxzJyk7XG52YXIgdGVtcGxhdGUgPSByZXF1aXJlKCd0ZW1wbGF0ZScpO1xuXG5cbnZhciBJbnB1dCA9IGZ1bmN0aW9uICgpIHtcbn07XG5cbklucHV0LnByb3RvdHlwZS5wcmVwYXJlQWR2YW5jZWRJbnB1dFByb3BlcnRpZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgLy9vdmVycmlkZSBpbiBzcGVjaWZpYyBpbnB1dCB0eXBlXG59O1xuXG5JbnB1dC5wcm90b3R5cGUuaXNRdWVzdGlvblRleHRWYWxpZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAvL3ZhbGlkYXRlIHF1ZXN0aW9uIHRleHRcbiAgICByZXR1cm4gdmFsaWRhdGlvbi5pc1F1ZXN0aW9uVGV4dFZhbGlkKHRoaXMpO1xufTtcblxuSW5wdXQucHJvdG90eXBlLmhpZGVRdWVzdGlvbkVycm9ycyA9IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmhpZGVQcm9wZXJ0aWVzRXJyb3JzKCk7XG59O1xuSW5wdXQucHJvdG90eXBlLnNob3dRdWVzdGlvbkVycm9ycyA9IGZ1bmN0aW9uICh0aGVfZXJyb3JfbWVzc2FnZSkge1xuICAgIHRoaXMuc2hvd1Byb3BlcnRpZXNFcnJvcnModGhlX2Vycm9yX21lc3NhZ2UpO1xufTtcblxuSW5wdXQucHJvdG90eXBlLmlzSW5pdGlhbEFuc3dlclZhbGlkID0gZnVuY3Rpb24gKCkge1xuICAgIC8vdmFsaWRhdGUgaW5pdGlhbCBhbnN3ZXJcbiAgICByZXR1cm4gdmFsaWRhdGlvbi5pc0luaXRpYWxBbnN3ZXJWYWxpZCh0aGlzLnR5cGUsIHRoaXMuZGVmYXVsdCwgdGhpcy5yZWdleCk7XG59O1xuXG5JbnB1dC5wcm90b3R5cGUuaXNKdW1wVmFsaWQgPSBmdW5jdGlvbiAodGhlX2p1bXBfcHJvcGVydGllcykge1xuICAgIC8vdmFsaWRhdGUgaW5pdGlhbCBhbnN3ZXJcbiAgICByZXR1cm4gdmFsaWRhdGlvbi5pc0p1bXBWYWxpZCh0aGVfanVtcF9wcm9wZXJ0aWVzLCB0aGlzKTtcbn07XG5cbklucHV0LnByb3RvdHlwZS5zYXZlUHJvcGVydGllcyA9IGZ1bmN0aW9uICgpIHtcbiAgICBzYXZlLnNhdmVQcm9wZXJ0aWVzKHRoaXMpO1xufTtcblxuSW5wdXQucHJvdG90eXBlLnNhdmVBZHZhbmNlZFByb3BlcnRpZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgc2F2ZS5zYXZlQWR2YW5jZWRQcm9wZXJ0aWVzKHRoaXMpO1xufTtcblxuSW5wdXQucHJvdG90eXBlLnNhdmVKdW1wcyA9IGZ1bmN0aW9uICgpIHtcbiAgICBzYXZlLnNhdmVKdW1wcyh0aGlzKTtcbn07XG5cbklucHV0LnByb3RvdHlwZS5zaG93UHJvcGVydGllc0Vycm9ycyA9IGZ1bmN0aW9uICh0aGVfZXJyb3JfbWVzc2FnZSkge1xuICAgIGVycm9ycy5zaG93UXVlc3Rpb25UZXh0RXJyb3JzKHRoaXMuZG9tLnByb3BlcnRpZXNfcGFuZWwsIHRoZV9lcnJvcl9tZXNzYWdlKTtcbn07XG5cbklucHV0LnByb3RvdHlwZS5oaWRlUHJvcGVydGllc0Vycm9ycyA9IGZ1bmN0aW9uICgpIHtcbiAgICBlcnJvcnMuaGlkZVByb3BlcnRpZXNFcnJvcnModGhpcy5kb20ucHJvcGVydGllc19wYW5lbCk7XG59O1xuXG5JbnB1dC5wcm90b3R5cGUuc2hvd0FkdmFuY2VkUHJvcGVydGllc0Vycm9ycyA9IGZ1bmN0aW9uICh0aGVfaW52YWxpZF9wcm9wZXJ0eSwgdGhlX2Vycm9yX21lc3NhZ2UpIHtcbiAgICBlcnJvcnMuc2hvd1NpbmdsZUFkdmFuY2VkUHJvcGVydHlFcnJvcih0aGlzLmRvbS5hZHZhbmNlZF9wcm9wZXJ0aWVzX3dyYXBwZXIsIHRoZV9pbnZhbGlkX3Byb3BlcnR5LCB0aGVfZXJyb3JfbWVzc2FnZSk7XG59O1xuXG5JbnB1dC5wcm90b3R5cGUuaGlkZUFkdmFuY2VkUHJvcGVydGllc0Vycm9ycyA9IGZ1bmN0aW9uICgpIHtcbiAgICAvL292ZXJyaWRlIGluIHNwZWNpZmljIGlucHV0IHR5cGVcbn07XG5cbklucHV0LnByb3RvdHlwZS5hZGRKdW1wID0gZnVuY3Rpb24gKCkge1xuXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgLy9zZXQgXCJBZGQgSnVtcFwiIGJ1dHRvbiByZWZlcmVuY2UgKHNvIGl0IGlzIGF2YWlsYWJsZSB3aGVuIHBsYXlpbmcgd2l0aCBqdW1wcylcbiAgICBzZWxmLmRvbS5hZGRfanVtcF9idXR0b24gPSBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc1xuICAgICAgICAuZmluZCgnLnBhbmVsLWJvZHkgZm9ybVtkYXRhLWlucHV0LXJlZj1cIicgKyBzZWxmLnJlZiArICdcIl0nKVxuICAgICAgICAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2p1bXBzX19hZGQtanVtcCcpO1xuXG4gICAgJC53aGVuKGp1bXBzLmFkZEp1bXAodGhpcykpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAvL2Rpc2FibGUgYWRkIGp1bXAgYnV0dG9uIGFzIHRoaXMgaW5wdXQgdHlwZSBvbmx5IGFsbG93cyB0byBzZXQgYSBzaW5nbGUganVtcFxuICAgICAgICBzZWxmLmRvbS5hZGRfanVtcF9idXR0b24uYXR0cignZGlzYWJsZWQnLCB0cnVlKTtcbiAgICB9KTtcbn07XG5cbklucHV0LnByb3RvdHlwZS5yZW1vdmVKdW1wID0gZnVuY3Rpb24gKHRoZV9yZW1vdmVfYnRuKSB7XG5cbiAgICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgICBzZWxmLmRvbS5hZGRfanVtcF9idXR0b24gPSBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc1xuICAgICAgICAuZmluZCgnLnBhbmVsLWJvZHkgZm9ybVtkYXRhLWlucHV0LXJlZj1cIicgKyBzZWxmLnJlZiArICdcIl0nKVxuICAgICAgICAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2p1bXBzX19hZGQtanVtcCcpO1xuXG4gICAganVtcHMucmVtb3ZlSnVtcCh0aGlzLCB0aGVfcmVtb3ZlX2J0bik7XG5cbiAgICBpZiAodGhpcy5qdW1wcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgLy9lbmFibGUgYWRkIGp1bXAgYnV0dG9uXG4gICAgICAgIHRoaXMuZG9tLmFkZF9qdW1wX2J1dHRvbi5hdHRyKCdkaXNhYmxlZCcsIGZhbHNlKTtcbiAgICB9XG59O1xuXG5JbnB1dC5wcm90b3R5cGUuc2hvd1NpbmdsZUp1bXBFcnJvcnMgPSBmdW5jdGlvbiAodGhlX2p1bXBfaXRlbSwgdGhlX2p1bXBfcHJvcGVydGllcykge1xuICAgIGVycm9ycy5zaG93U2luZ2xlSnVtcEVycm9ycyh0aGVfanVtcF9pdGVtLCB0aGVfanVtcF9wcm9wZXJ0aWVzKTtcbn07XG5JbnB1dC5wcm90b3R5cGUuaGlkZUp1bXBzRXJyb3JzID0gZnVuY3Rpb24gKHRoZV9qdW1wc19saXN0KSB7XG4gICAgZXJyb3JzLmhpZGVKdW1wc0Vycm9ycyh0aGVfanVtcHNfbGlzdCk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IElucHV0O1xuIiwiJ3VzZSBzdHJpY3QnO1xudmFyIGNvbnN0cyA9IHJlcXVpcmUoJ2NvbmZpZy9jb25zdHMnKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoJ2hlbHBlcnMvdXRpbHMnKTtcblxudmFyIHZhbGlkX2RhdGVfZm9ybWF0cyA9IFtcbiAgICBjb25zdHMuREFURV9GT1JNQVRfMSxcbiAgICBjb25zdHMuREFURV9GT1JNQVRfMixcbiAgICBjb25zdHMuREFURV9GT1JNQVRfMyxcbiAgICBjb25zdHMuREFURV9GT1JNQVRfNCxcbiAgICBjb25zdHMuREFURV9GT1JNQVRfNVxuXTtcblxudmFyIHZhbGlkX3RpbWVfZm9ybWF0cyA9IFtcbiAgICBjb25zdHMuVElNRV9GT1JNQVRfMSxcbiAgICBjb25zdHMuVElNRV9GT1JNQVRfMixcbiAgICBjb25zdHMuVElNRV9GT1JNQVRfMyxcbiAgICBjb25zdHMuVElNRV9GT1JNQVRfNCxcbiAgICBjb25zdHMuVElNRV9GT1JNQVRfNVxuXTtcblxudmFyIGltcG9ydF9mb3JtX3ZhbGlkYXRpb24gPSB7XG5cbiAgICBoYXNWYWxpZEZvcm1TdHJ1Y3R1cmU6IGZ1bmN0aW9uIChmb3JtKSB7XG5cbiAgICAgICAgdmFyIHZhbGlkRm9ybVN0cnVjdHVyZSA9IHtcbiAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgICBpZDogJycsXG4gICAgICAgICAgICAgICAgdHlwZTogJ2Zvcm0nLFxuICAgICAgICAgICAgICAgIGZvcm06IHtcbiAgICAgICAgICAgICAgICAgICAgcmVmOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogJycsXG4gICAgICAgICAgICAgICAgICAgIHNsdWc6ICcnLFxuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnaGllcmFyY2h5JyxcbiAgICAgICAgICAgICAgICAgICAgaW5wdXRzOiBbXVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICAvL2NvbXBhcmUgYSB2YWxpZCBvYmplY3QgYWdhaW5zdCB0aGUgaW1wb3J0ZWQgZm9ybSBvYmplY3QgaWYgdGhleSBoYXZlIHRoZSBzYW1lIGtleXNcbiAgICAgICAgaWYgKCF1dGlscy5oYXNTYW1lUHJvcHModmFsaWRGb3JtU3RydWN0dXJlLCBmb3JtKSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9kYXRhIHR5cGUgbXVzdCBiZSBmb3JtXG4gICAgICAgIGlmIChmb3JtLmRhdGEudHlwZSAhPT0gJ2Zvcm0nKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICAvL2Zvcm0gdHlwZSBtdXN0IGJlIGhpZXJhcmNoeVxuICAgICAgICBpZiAoZm9ybS5kYXRhLmZvcm0udHlwZSAhPT0gJ2hpZXJhcmNoeScpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vcmVmLCBuYW1lLCBzbHVnIGFuZCBpbnB1dHMgcHJvcHMgYXJlIG5vdCBjb25zaWRlcmVkIGhlcmVcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSxcblxuICAgIGFyZUp1bXBzVmFsaWQ6IGZ1bmN0aW9uIChpbnB1dCkge1xuXG4gICAgICAgIHZhciBqdW1wcyA9IGlucHV0Lmp1bXBzO1xuICAgICAgICB2YXIgYXJlX3ZhbGlkID0gdHJ1ZTtcbiAgICAgICAgdmFyIHBvc3NpYmxlX2Fuc3dlcnMgPSBpbnB1dC5wb3NzaWJsZV9hbnN3ZXJzO1xuICAgICAgICB2YXIgdmFsaWRKdW1wU3RydWN0dXJlID0ge1xuICAgICAgICAgICAgdG86ICcnLFxuICAgICAgICAgICAgd2hlbjogJycsXG4gICAgICAgICAgICBhbnN3ZXJfcmVmOiAnJ1xuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBhbnN3ZXJfcmVmX3JlZ2V4ID0gbmV3IFJlZ0V4cChjb25zdHMuUkVHRVgucG9zc2libGVfYW5zd2VyX3JlZik7XG5cbiAgICAgICAgaWYgKCEkLmlzQXJyYXkoanVtcHMpKSB7XG4gICAgICAgICAgICBhcmVfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICQoanVtcHMpLmVhY2goZnVuY3Rpb24gKGluZGV4LCBqdW1wKSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgYW5zd2VyX3JlZl9mb3VuZCA9IGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgLy92YWxpZGF0ZSBzdHJ1Y3R1cmVcbiAgICAgICAgICAgICAgICBpZiAoIXV0aWxzLmhhc1NhbWVQcm9wcyh2YWxpZEp1bXBTdHJ1Y3R1cmUsIGp1bXApKSB7XG4gICAgICAgICAgICAgICAgICAgIGFyZV92YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9pZiBhbnN3ZXJfcmVmIGlzIGluIGludmFsaWQgZm9ybWF0LCBiYWlsIG91dCAoY2FuIGJlIG51bGwsIHdlIGNhdGNoIHRoYXQgbGF0ZXIpXG4gICAgICAgICAgICAgICAgaWYgKGp1bXAuYW5zd2VyX3JlZikge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWFuc3dlcl9yZWZfcmVnZXgudGVzdChqdW1wLmFuc3dlcl9yZWYpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmVfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vdmFsaWRhdGUganVtcHMgcHJvcGVydGllcyB2YWx1ZXNcbiAgICAgICAgICAgICAgICBpZiAoJC5pbkFycmF5KGlucHV0LnR5cGUsIGNvbnN0cy5NVUxUSVBMRV9BTlNXRVJfVFlQRVMpID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gbXVsdGlwbGUgY2hvaWNlIGlucHV0XG4gICAgICAgICAgICAgICAgICAgIC8vanVtcCBcInRvXCIgdmFsdWUgbXVzdCBiZSBhbiBleGlzdGluZyBcImZvcndhcmRcIiBpbnB1dF9yZWZcbiAgICAgICAgICAgICAgICAgICAgLy90b2RvIG5lZWQgbmV4dCBpbnB1dHNcblxuICAgICAgICAgICAgICAgICAgICAvL2p1bXAgXCJ0b1wiIG11c3QgZXhpc3QgaW4gcG9zc2libGUgYW5zd2VycyAoaXQgaXMgdGhlIGFuc3dlcl9yZWYpXG4gICAgICAgICAgICAgICAgICAgIC8vIG9ubHkgaWYgXCJ3aGVuXCIgaXMgbm90IGVpdGhlciBBTEwgb3IgTk9fQU5TV0VSX0dJVkVOXG4gICAgICAgICAgICAgICAgICAgIGlmICghKGp1bXAud2hlbiA9PT0gJ0FMTCcgfHwganVtcC53aGVuID09PSAnTk9fQU5TV0VSX0dJVkVOJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICQocG9zc2libGVfYW5zd2VycykuZWFjaChmdW5jdGlvbiAoaW5kZXgsIHBvc3NpYmxlX2Fuc3dlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChqdW1wLmFuc3dlcl9yZWYgPT09IHBvc3NpYmxlX2Fuc3dlci5hbnN3ZXJfcmVmKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuc3dlcl9yZWZfZm91bmQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFuc3dlcl9yZWZfZm91bmQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmVfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vc2luZ2xlIHF1ZXN0aW9uLCBqdW1wIFwid2hlblwiIG11c3QgYmUgc2V0IHRvIEFMTFxuICAgICAgICAgICAgICAgICAgICBpZiAoanVtcC53aGVuICE9PSAnQUxMJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJlX3ZhbGlkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBJZiB3ZSBoYXZlIGFuIGVtcHR5ICd0bycgLSBlcnJvclxuICAgICAgICAgICAgICAgIC8vIElmIHdlIGhhdmUgYW4gZW1wdHkgJ3doZW4nIC0gZXJyb3JcbiAgICAgICAgICAgICAgICAvLyBJZiB3ZSBoYXZlIGFuIGVtcHR5ICdhbnN3ZXJfcmVmJyBhbmQgJ3doZW4nIGlzIG5vdCAnQUxMJyBvciAnTk9fQU5TV0VSX0dJVkVOJyAtIGVycm9yXG4gICAgICAgICAgICAgICAgaWYgKCFqdW1wLnRvIHx8ICFqdW1wLndoZW4gfHxcbiAgICAgICAgICAgICAgICAgICAgKCFqdW1wLmFuc3dlcl9yZWYgJiYgIShqdW1wLndoZW4gPT09ICdBTEwnIHx8IGp1bXAud2hlbiA9PT0gJ05PX0FOU1dFUl9HSVZFTicpKVxuICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICBhcmVfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vdmFsaWRhdGUgXCJ3aGVuXCIgcHJvcCwgbXVzdCBiZSBvbmUgb2YgdGhlIGp1bXAgY29uZGl0aW9uc1xuICAgICAgICAgICAgICAgIHZhciBpc1ZhbGlkV2hlblByb3BlcnR5ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgJChjb25zdHMuSlVNUF9DT05ESVRJT05TKS5lYWNoKGZ1bmN0aW9uIChpbmRleCwgY29uZGl0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjb25kaXRpb24ua2V5ID09PSBqdW1wLndoZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzVmFsaWRXaGVuUHJvcGVydHkgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgaWYgKCFpc1ZhbGlkV2hlblByb3BlcnR5KSB7XG4gICAgICAgICAgICAgICAgICAgIGFyZV92YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBhcmVfdmFsaWQ7XG4gICAgfSxcblxuICAgIGFyZUp1bXBzRGVzdGluYXRpb25zVmFsaWQ6IGZ1bmN0aW9uIChpbnB1dHMpIHtcblxuICAgICAgICB2YXIgYWxsX2p1bXBzX3ZhbGlkID0gdHJ1ZTtcblxuICAgICAgICAkKGlucHV0cykuZWFjaChmdW5jdGlvbiAoaW5wdXRJbmRleCwgaW5wdXQpIHtcblxuICAgICAgICAgICAgLy9nZXQgdmFsaWQganVtcCBkZXN0aW5hdGlvbnNcbiAgICAgICAgICAgIHZhciBqdW1wX2Rlc3RpbmF0aW9ucyA9IHV0aWxzLmdldEp1bXBBdmFpbGFibGVEZXN0aW5hdGlvbnNBc0tleXMoaW5wdXRJbmRleCwgaW5wdXQsIGlucHV0cywgZmFsc2UpO1xuXG4gICAgICAgICAgICAvL2V4dHJhIHZhbGlkYXRpb24gZm9yIGp1bXBzLCBjaGVjayBpZiB0aGUgZGVzdGluYXRpb24gc3RpbGwgZXhpc3RzIGFuZCBpdCBpcyB2YWxpZFxuICAgICAgICAgICAgJChpbnB1dC5qdW1wcykuZWFjaChmdW5jdGlvbiAoanVtcEluZGV4LCBqdW1wKSB7XG4gICAgICAgICAgICAgICAgLy9kb2VzIHRoZSBqdW1wIFwidG9cIiBwcm9wZXJ0eSByZWZlcmVuY2UgYSB2YWxpZCBkZXN0aW5hdGlvbiBpbnB1dD9cbiAgICAgICAgICAgICAgICBpZiAoIWp1bXBfZGVzdGluYXRpb25zW2p1bXAudG9dKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vaW52YWxpZCBkZXN0aW5hdGlvbiBmb3VuZFxuICAgICAgICAgICAgICAgICAgICBhbGxfanVtcHNfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy92YWxpZGF0ZSBicmFuY2gganVtcHNcbiAgICAgICAgICAgICQoaW5wdXQuYnJhbmNoKS5lYWNoKGZ1bmN0aW9uIChicmFuY2hJbnB1dEluZGV4LCBicmFuY2hfaW5wdXQpIHtcblxuICAgICAgICAgICAgICAgIGp1bXBfZGVzdGluYXRpb25zID0gdXRpbHMuZ2V0SnVtcEF2YWlsYWJsZURlc3RpbmF0aW9uc0FzS2V5cyhicmFuY2hJbnB1dEluZGV4LCBicmFuY2hfaW5wdXQsIGlucHV0LmJyYW5jaCwgdHJ1ZSk7XG5cbiAgICAgICAgICAgICAgICAvL2V4dHJhIHZhbGlkYXRpb24gZm9yIGp1bXBzLCBjaGVjayBpZiB0aGUgZGVzdGluYXRpb24gc3RpbGwgZXhpc3RzIGFuZCBpdCBpcyB2YWxpZFxuICAgICAgICAgICAgICAgICQoYnJhbmNoX2lucHV0Lmp1bXBzKS5lYWNoKGZ1bmN0aW9uIChicmFuY2hKdW1wSW5kZXgsIGJyYW5jaEp1bXApIHtcbiAgICAgICAgICAgICAgICAgICAgLy9kb2VzIHRoZSBqdW1wIFwidG9cIiBwcm9wZXJ0eSByZWZlcmVuY2UgYSB2YWxpZCBkZXN0aW5hdGlvbiBpbnB1dD9cbiAgICAgICAgICAgICAgICAgICAgaWYgKCFqdW1wX2Rlc3RpbmF0aW9uc1ticmFuY2hKdW1wLnRvXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9pbnZhbGlkIGRlc3RpbmF0aW9uIGZvdW5kXG4gICAgICAgICAgICAgICAgICAgICAgICBhbGxfanVtcHNfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBhbGxfanVtcHNfdmFsaWQ7XG4gICAgfSxcblxuICAgIGFyZVBvc3NpYmxlQW5zd2Vyc1ZhbGlkOiBmdW5jdGlvbiAocG9zc2libGVfYW5zd2VycywgaW5wdXRfdHlwZSkge1xuXG4gICAgICAgIHZhciBhbnN3ZXJfcmVmX3JlZ2V4ID0gbmV3IFJlZ0V4cChjb25zdHMuUkVHRVgucG9zc2libGVfYW5zd2VyX3JlZik7XG4gICAgICAgIHZhciBhbnN3ZXJfcmVmcyA9IFtdO1xuICAgICAgICB2YXIgdmFsaWRQb3NzaWJsZUFuc3dlclN0cnVjdHVyZSA9IHtcbiAgICAgICAgICAgIGFuc3dlcjogJycsXG4gICAgICAgICAgICBhbnN3ZXJfcmVmOiAnJy8vdGhpcyBtdXN0IGJlIHVuaXF1ZVxuICAgICAgICB9O1xuXG4gICAgICAgIGlmICghJC5pc0FycmF5KHBvc3NpYmxlX2Fuc3dlcnMpKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvL2NoZWNrIHBvc3NpYmxlIGFuc3dlciB0b3RhbCBpcyB3aXRoaW4gbGltaXRzXG4gICAgICAgICAgICBpZiAocG9zc2libGVfYW5zd2Vycy5sZW5ndGggPiBjb25zdHMuTElNSVRTLnBvc3NpYmxlX2Fuc3dlcnNfbWF4KSB7XG4gICAgICAgICAgICAgICAgLy9pcyB0aGlzIGEgc2VhcmNoIHR5cGU/XG4gICAgICAgICAgICAgICAgaWYgKGlucHV0X3R5cGUgPT09IGNvbnN0cy5TRUFSQ0hfTVVMVElQTEVfVFlQRSB8fCBpbnB1dF90eXBlID09PSBjb25zdHMuU0VBUkNIX1NJTkdMRV9UWVBFKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vbGltaXQgaXMgaGlnaGVyIGZvciBzZWFyY2ggdHlwZVxuICAgICAgICAgICAgICAgICAgICBpZiAocG9zc2libGVfYW5zd2Vycy5sZW5ndGggPiBjb25zdHMuTElNSVRTLnBvc3NpYmxlX2Fuc3dlcnNfbWF4X3NlYXJjaCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vYXQgbGVhc3QgMSBwb3NzaWJsZSBhbnN3ZXJcbiAgICAgICAgICAgIGlmIChwb3NzaWJsZV9hbnN3ZXJzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy9jaGVjayBwb3NzaWJsZSBhbnN3ZXIgc3RydWN0dXJlXG4gICAgICAgICAgICB2YXIgYXJlX3Bvc3NpYmxlX2Fuc3dlcl92YWxpZCA9IHRydWU7XG4gICAgICAgICAgICAkKHBvc3NpYmxlX2Fuc3dlcnMpLmVhY2goZnVuY3Rpb24gKGtleSwgcG9zc2libGVfYW5zd2VyKSB7XG5cbiAgICAgICAgICAgICAgICBhbnN3ZXJfcmVmcy5wdXNoKHBvc3NpYmxlX2Fuc3dlci5hbnN3ZXJfcmVmKTtcblxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgcG9zc2libGVfYW5zd2VyLmFuc3dlcl9yZWYgIT09ICdzdHJpbmcnIHx8IHR5cGVvZiBwb3NzaWJsZV9hbnN3ZXIuYW5zd2VyICE9PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgICAgICBhcmVfcG9zc2libGVfYW5zd2VyX3ZhbGlkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL2NoZWNrIGFuc3dlcl9yZWYgbGVuZ3RoXG4gICAgICAgICAgICAgICAgaWYgKHBvc3NpYmxlX2Fuc3dlci5hbnN3ZXJfcmVmLmxlbmd0aCAhPT0gY29uc3RzLkxJTUlUUy5wb3NzaWJsZV9hbnN3ZXJfcmVmX2xlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICBhcmVfcG9zc2libGVfYW5zd2VyX3ZhbGlkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvL2NoZWNrIGFuc3dlcl9yZWYgdG8gYmUgaGV4IGNoYXJhY3RlcnNcbiAgICAgICAgICAgICAgICBpZiAoIWFuc3dlcl9yZWZfcmVnZXgudGVzdChwb3NzaWJsZV9hbnN3ZXIuYW5zd2VyX3JlZikpIHtcbiAgICAgICAgICAgICAgICAgICAgYXJlX3Bvc3NpYmxlX2Fuc3dlcl92YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9jaGVjayBhbnN3ZXIgbWF4IGxlbmd0aFxuICAgICAgICAgICAgICAgIGlmIChwb3NzaWJsZV9hbnN3ZXIuYW5zd2VyLmxlbmd0aCA9PT0gMCB8fCBwb3NzaWJsZV9hbnN3ZXIuYW5zd2VyLmxlbmd0aCA+IGNvbnN0cy5MSU1JVFMucG9zc2libGVfYW5zd2VyX21heF9sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgYXJlX3Bvc3NpYmxlX2Fuc3dlcl92YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9wb3NzaWJsZV9hbnN3ZXIgY2Fubm90IGJlIGVtcHR5XG4gICAgICAgICAgICAgICAgaWYgKHBvc3NpYmxlX2Fuc3dlci5hbnN3ZXIgPT09ICcnKSB7XG4gICAgICAgICAgICAgICAgICAgIGFyZV9wb3NzaWJsZV9hbnN3ZXJfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vc3RyaXAgaHRtbCB0YWdzIGZyb20gcG9zc2libGUgYW5zd2VycyBhbnN3ZXIgcHJvcFxuICAgICAgICAgICAgICAgIHBvc3NpYmxlX2Fuc3dlci5hbnN3ZXIgPSBwb3NzaWJsZV9hbnN3ZXIuYW5zd2VyLnJlcGxhY2UoLyg8KFtePl0rKT4pL2lnLCAnICcpO1xuXG4gICAgICAgICAgICAgICAgaWYgKCF1dGlscy5oYXNTYW1lUHJvcHModmFsaWRQb3NzaWJsZUFuc3dlclN0cnVjdHVyZSwgcG9zc2libGVfYW5zd2VyKSkge1xuICAgICAgICAgICAgICAgICAgICBhcmVfcG9zc2libGVfYW5zd2VyX3ZhbGlkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLy8vY2hlY2sgZm9yIGFuc3dlcl9yZWYgdW5pcXVlbmVzc1xuICAgICAgICAgICAgICAgIC8vLy9ub3RlOiB0aGlzIGhhcyBiYWQgcGVyZm9ybWFuY2Ugd2l0aCBiaWcgYXJyYXlzXG4gICAgICAgICAgICAgICAgLy92YXIgaGFzRHVwbGljYXRlQW5zd2VyUmVmID0gYW5zd2VyX3JlZnMuc29tZShmdW5jdGlvbiAocmVmLCBpbmRleCkge1xuICAgICAgICAgICAgICAgIC8vICAgIHJldHVybiBhbnN3ZXJfcmVmcy5pbmRleE9mKHJlZikgIT09IGluZGV4O1xuICAgICAgICAgICAgICAgIC8vfSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgc2VlbiA9IHt9O1xuICAgICAgICAgICAgICAgIHZhciBoYXNEdXBsaWNhdGVBbnN3ZXJSZWYgPSBwb3NzaWJsZV9hbnN3ZXJzLnNvbWUoZnVuY3Rpb24gKHBvc3NpYmxlX2Fuc3dlcikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2Vlbi5oYXNPd25Qcm9wZXJ0eShwb3NzaWJsZV9hbnN3ZXIuYW5zd2VyX3JlZikgfHwgKHNlZW5bcG9zc2libGVfYW5zd2VyLmFuc3dlcl9yZWZdID09PSBmYWxzZSk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBpZiAoaGFzRHVwbGljYXRlQW5zd2VyUmVmKSB7XG4gICAgICAgICAgICAgICAgICAgIGFyZV9wb3NzaWJsZV9hbnN3ZXJfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpZiAoIWFyZV9wb3NzaWJsZV9hbnN3ZXJfdmFsaWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9LFxuXG4gICAgaXNWYWxpZElucHV0OiBmdW5jdGlvbiAoZm9ybV9yZWYsIGlucHV0LCBpc19icmFuY2gsIGlzX2dyb3VwKSB7XG5cbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB2YXIgdmFsaWQgPSB0cnVlO1xuICAgICAgICB2YXIgaW5wdXRfcmVmX3JlZ2V4ID0gbmV3IFJlZ0V4cChjb25zdHMuUkVHRVguaW5wdXRfcmVmKTtcbiAgICAgICAgdmFyIHJlYWRtZSA9ICcnO1xuXG4gICAgICAgIHZhciB2YWxpZElucHV0U3RydWN0dXJlID0ge1xuICAgICAgICAgICAgcmVmOiAnJyxcbiAgICAgICAgICAgIHR5cGU6ICcnLFxuICAgICAgICAgICAgcXVlc3Rpb246ICcnLFxuICAgICAgICAgICAgaXNfdGl0bGU6IHRydWUsXG4gICAgICAgICAgICBpc19yZXF1aXJlZDogZmFsc2UsXG4gICAgICAgICAgICB1bmlxdWVuZXNzOiAnJyxcbiAgICAgICAgICAgIHJlZ2V4OiBudWxsLFxuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcbiAgICAgICAgICAgIHZlcmlmeTogZmFsc2UsXG4gICAgICAgICAgICBtYXg6IG51bGwsXG4gICAgICAgICAgICBtaW46IG51bGwsXG4gICAgICAgICAgICBkYXRldGltZV9mb3JtYXQ6IG51bGwsXG4gICAgICAgICAgICBzZXRfdG9fY3VycmVudF9kYXRldGltZTogZmFsc2UsXG4gICAgICAgICAgICBwb3NzaWJsZV9hbnN3ZXJzOiBbXSxcbiAgICAgICAgICAgIGp1bXBzOiBbXSxcbiAgICAgICAgICAgIGJyYW5jaDogW10sXG4gICAgICAgICAgICBncm91cDogW11cbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgYWNjZXB0ZWRfdHlwZXMgPSBbXG4gICAgICAgICAgICBjb25zdHMuVEVYVF9UWVBFLFxuICAgICAgICAgICAgY29uc3RzLlRFWFRBUkVBX1RZUEUsXG4gICAgICAgICAgICBjb25zdHMuSU5URUdFUl9UWVBFLFxuICAgICAgICAgICAgY29uc3RzLkRFQ0lNQUxfVFlQRSxcbiAgICAgICAgICAgIGNvbnN0cy5EQVRFX1RZUEUsXG4gICAgICAgICAgICBjb25zdHMuVElNRV9UWVBFLFxuICAgICAgICAgICAgY29uc3RzLlJBRElPX1RZUEUsXG4gICAgICAgICAgICBjb25zdHMuQ0hFQ0tCT1hfVFlQRSxcbiAgICAgICAgICAgIGNvbnN0cy5EUk9QRE9XTl9UWVBFLFxuICAgICAgICAgICAgY29uc3RzLkJBUkNPREVfVFlQRSxcbiAgICAgICAgICAgIGNvbnN0cy5MT0NBVElPTl9UWVBFLFxuICAgICAgICAgICAgY29uc3RzLkFVRElPX1RZUEUsXG4gICAgICAgICAgICBjb25zdHMuVklERU9fVFlQRSxcbiAgICAgICAgICAgIGNvbnN0cy5QSE9UT19UWVBFLFxuICAgICAgICAgICAgY29uc3RzLkJSQU5DSF9UWVBFLFxuICAgICAgICAgICAgY29uc3RzLkdST1VQX1RZUEUsXG4gICAgICAgICAgICBjb25zdHMuUkVBRE1FX1RZUEUsXG4gICAgICAgICAgICBjb25zdHMuUEhPTkVfVFlQRSxcbiAgICAgICAgICAgIGNvbnN0cy5TRUFSQ0hfU0lOR0xFX1RZUEUsXG4gICAgICAgICAgICBjb25zdHMuU0VBUkNIX01VTFRJUExFX1RZUEVcbiAgICAgICAgXTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVmFsaWRhdGUgaW5wdXQgc3RydWN0dXJlXG4gICAgICAgICAqL1xuXG4gICAgICAgIGlmICghdXRpbHMuaGFzU2FtZVByb3BzKHZhbGlkSW5wdXRTdHJ1Y3R1cmUsIGlucHV0KSkge1xuICAgICAgICAgICAgLy9pdCBtZWFucyB0aGUgaW5wdXQgc3RydWN0dXJlIGlzIGludmFsaWRcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBWYWxpZGF0ZSByZWZcbiAgICAgICAgICovXG4gICAgICAgIGlmIChpbnB1dC5yZWYgJiYgdHlwZW9mIGlucHV0LnJlZiAhPT0gJ2Jvb2xlYW4nKSB7XG4gICAgICAgICAgICBpZiAoIWlucHV0LnJlZi5zdGFydHNXaXRoKGZvcm1fcmVmKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vY2hlY2sgcmVmIHN0cnVjdHVyZVxuICAgICAgICAgICAgaWYgKCFpbnB1dF9yZWZfcmVnZXgudGVzdChpbnB1dC5yZWYpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBtdXN0IGhhdmUgMyBjb21wb25lbnRzXG4gICAgICAgICAgICBpZiAoaW5wdXQucmVmLnNwbGl0KCdfJykubGVuZ3RoICE9PSAzKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgLy92YWxpZGF0ZSByZWYgYWdhaW5zdCByZWdleFxuICAgICAgICAvLyh0b2RvKVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBWYWxpZGF0ZSB0eXBlXG4gICAgICAgICAqL1xuICAgICAgICBpZiAoJC5pbkFycmF5KGlucHV0LnR5cGUsIGFjY2VwdGVkX3R5cGVzKSA8IDAgfHwgdHlwZW9mIGlucHV0LnR5cGUgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogVmFsaWRhdGUgcXVlc3Rpb25cbiAgICAgICAgICovXG4gICAgICAgIGlmIChpbnB1dC50eXBlID09PSBjb25zdHMuUkVBRE1FX1RZUEUpIHtcbiAgICAgICAgICAgIC8vcmVhZG1lIHR5cGUgaXMgdXAgdG8gMTAwMCBjaGFycywgaHRtbCBpcyBhbGxvd2VkIChzZXJ2ZXIgY2F0Y2hlcyB3YXMgaXQgaXMgbm90KVxuICAgICAgICAgICAgaWYgKHR5cGVvZiBpbnB1dC5xdWVzdGlvbiAhPT0gJ3N0cmluZycgfHwgaW5wdXQucXVlc3Rpb24gPT09ICcnKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL2ZpcnN0IGNvbnZlcnQgaHRtbCBlbnRpdGllcyB0byB0YWdzXG4gICAgICAgICAgICByZWFkbWUgPSB1dGlscy5kZWNvZGVIdG1sKGlucHV0LnF1ZXN0aW9uKTtcbiAgICAgICAgICAgIC8vdGhlbiByZW1vdmUgYWxsIHRhZ3NcbiAgICAgICAgICAgIHJlYWRtZSA9IHJlYWRtZS5yZXBsYWNlKC8oPChbXj5dKyk+KS9pZywgJyAnKTtcblxuICAgICAgICAgICAgLy9ub3cgY2hlY2sgdGhlIGxlbmdodCBvZiB0aGUgcmVtYWluaW5nIHB1cmUgdGV4dCA7KVxuICAgICAgICAgICAgaWYgKHJlYWRtZS5sZW5ndGggPiBjb25zdHMuTElNSVRTLnJlYWRtZV9sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvL2FueSBvdGhlciBxdWVzdGlvblxuICAgICAgICAgICAgaWYgKGlucHV0LnF1ZXN0aW9uLmxlbmd0aCA+IGNvbnN0cy5MSU1JVFMucXVlc3Rpb25fbGVuZ3RoIHx8IHR5cGVvZiBpbnB1dC5xdWVzdGlvbiAhPT0gJ3N0cmluZycgfHwgaW5wdXQucXVlc3Rpb24gPT09ICcnKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaW5wdXQucXVlc3Rpb24gPSBpbnB1dC5xdWVzdGlvbi5yZXBsYWNlKC8oPChbXj5dKyk+KS9pZywgJyAnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFZhbGlkYXRlIGlzX3RpdGxlXG4gICAgICAgICAqL1xuXG4gICAgICAgIGlmICh0eXBlb2YgaW5wdXQuaXNfdGl0bGUgIT09ICdib29sZWFuJykge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqICBWYWxpZGF0ZSBpc19yZXF1aXJlZFxuICAgICAgICAgKi9cbiAgICAgICAgaWYgKHR5cGVvZiBpbnB1dC5pc19yZXF1aXJlZCAhPT0gJ2Jvb2xlYW4nKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvL2NoZWNrIGlmIHdlIGNhbiBoYXZlIHJlcXVpcmVkIHNldCB0byB0cnVlXG4gICAgICAgICAgICBpZiAoJC5pbkFycmF5KGlucHV0LnR5cGUsIGNvbnN0cy5SRVFVSVJFRF9BTExPV0VEX1RZUEVTKSA8IDAgJiYgaW5wdXQuaXNfcmVxdWlyZWQgPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogVmFsaWRhdGUgdW5pcXVlbmVzc1xuICAgICAgICAgKi9cbiAgICAgICAgaWYgKCQuaW5BcnJheShpbnB1dC50eXBlLCBjb25zdHMuVU5JUVVFTkVTU19BTExPV0VEX1RZUEVTKSA8IDApIHtcbiAgICAgICAgICAgIC8vdW5pcXVlc3MgbXVzdCBiZSBcIm5vbmVcIlxuICAgICAgICAgICAgaWYgKGlucHV0LnVuaXF1ZW5lc3MgIT09IGNvbnN0cy5VTklRVUVTU19OT05FKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaWYgKGlzX2JyYW5jaCkge1xuICAgICAgICAgICAgICAgIGlmICghKGlucHV0LnVuaXF1ZW5lc3MgPT09IGNvbnN0cy5VTklRVUVTU19OT05FIHx8IGlucHV0LnVuaXF1ZW5lc3MgPT0gY29uc3RzLlVOSVFVRVNTX0ZPUk0pKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoIShpbnB1dC51bmlxdWVuZXNzID09PSBjb25zdHMuVU5JUVVFU1NfTk9ORSB8fCBpbnB1dC51bmlxdWVuZXNzID09PSBjb25zdHMuVU5JUVVFU1NfRk9STSB8fCBpbnB1dC51bmlxdWVuZXNzID09IGNvbnN0cy5VTklRVUVTU19ISUVSQVJDSFkpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogVmFsaWRhdGUgcmVnZXggKGNhbiBiZSBudWxsKVxuICAgICAgICAgKi9cbiAgICAgICAgaWYgKGlucHV0LnJlZ2V4ICE9PSBudWxsICYmIGlucHV0LnJlZ2V4ICE9PSAnJykge1xuICAgICAgICAgICAgaWYgKGlucHV0LnJlZ2V4Lmxlbmd0aCA+IGNvbnN0cy5MSU1JVFMucmVnZXhfbGVuZ3RoIHx8IHR5cGVvZiBpbnB1dC5yZWdleCAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvL2NoZWNrIGlmIGEgcmVnZXggaXMgYWxsb3dlZCBmb3IgdGhpcyBpbnB1dCB0eXBlP1xuICAgICAgICAgICAgLy90b2RvXG5cbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBWYWxpZGF0ZSBkZWZhdWx0IGFuc3dlclxuICAgICAgICAgKi9cbiAgICAgICAgaWYgKGlucHV0LmRlZmF1bHQgIT09IG51bGwgJiYgaW5wdXQuZGVmYXVsdCAhPT0gJycpIHtcbiAgICAgICAgICAgIGlmIChpbnB1dC5kZWZhdWx0Lmxlbmd0aCA+IGNvbnN0cy5MSU1JVFMuZGVmYXVsdF9hbnN3ZXJfbGVuZ3RoIHx8IHR5cGVvZiBpbnB1dC5kZWZhdWx0ICE9PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy9tdWx0aXBsZSBhbnN3ZXJzIHR5cGU/XG4gICAgICAgICAgICBpZiAoJC5pbkFycmF5KGlucHV0LnR5cGUsIGNvbnN0cy5NVUxUSVBMRV9BTlNXRVJfVFlQRVMpID4gMCkge1xuICAgICAgICAgICAgICAgIC8vY2hlY2sgdGhhdCB0aGUgZGVmYXVsdCBhbnN3ZXIgKGlmIHNldCkgaXMgb25lIG9mIHRoZSBwb3NzaWJsZSBhbnN3ZXJzXG4gICAgICAgICAgICAgICAgdmFyIGZvdW5kID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgJChpbnB1dC5wb3NzaWJsZV9hbnN3ZXJzKS5lYWNoKGZ1bmN0aW9uIChrZXksIHBvc3NpYmxlX2Fuc3dlcikge1xuICAgICAgICAgICAgICAgICAgICBpZiAocG9zc2libGVfYW5zd2VyLmFuc3dlcl9yZWYgPT09IGlucHV0LmRlZmF1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvdW5kID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsvL2V4aXQgdGhlIGxvb3BcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgaWYgKCFmb3VuZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgLy92YWxpZCBkZWZhdWx0IGFuc3dlciwgc3RyaXAgaHRtbCB0YWdzXG4gICAgICAgICAgICAgICAgaW5wdXQuZGVmYXVsdCA9IGlucHV0LmRlZmF1bHQucmVwbGFjZSgvKDwoW14+XSspPikvaWcsICcgJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogVmFsaWRhdGUgdmVyaWZ5XG4gICAgICAgICAqL1xuICAgICAgICBpZiAodHlwZW9mIGlucHV0LnZlcmlmeSAhPT0gJ2Jvb2xlYW4nKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiB2YWxpZGF0ZSBtYXggYW5kIG1pbiAoZm9yIG51bWVyaWMgdHlwZXMpXG4gICAgICAgICAqL1xuICAgICAgICBpZiAoaW5wdXQudHlwZSA9PT0gY29uc3RzLklOVEVHRVJfVFlQRSB8fCBpbnB1dC50eXBlID09PSBjb25zdHMuREVDSU1BTF9UWVBFKSB7XG4gICAgICAgICAgICAvL2NoZWNrIG1pbiwgaWYgaXQgaXMgc2V0IG11c3QgYmUgbnVtZXJpYy4gY2FuIGJlIG51bGxcbiAgICAgICAgICAgIGlmIChpbnB1dC5taW4pIHtcblxuICAgICAgICAgICAgICAgIGlmIChpbnB1dC50eXBlID09PSBjb25zdHMuSU5URUdFUl9UWVBFICYmICF1dGlscy5pc0ludGVnZXIocGFyc2VJbnQoaW5wdXQubWluKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChpbnB1dC50eXBlID09PSBjb25zdHMuREVDSU1BTF9UWVBFICYmICEkLmlzTnVtZXJpYyhpbnB1dC5taW4pKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoaW5wdXQubWluLnRvU3RyaW5nKCkubGVuZ3RoID4gY29uc3RzLkxJTUlUUy5taW5fdmFsdWVfbGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy9jaGVjayBtaW4sIGlmIGl0IGlzIHNldCBtdXN0IGJlIG51bWVyaWMuIGNhbiBiZSBudWxsXG4gICAgICAgICAgICBpZiAoaW5wdXQubWF4KSB7XG5cbiAgICAgICAgICAgICAgICAvL2JhaWwgaWYgbm90IGludGVnZXIgZm9yIGludGVnZXIgdHlwZVxuICAgICAgICAgICAgICAgIGlmIChpbnB1dC50eXBlID09PSBjb25zdHMuSU5URUdFUl9UWVBFICYmICF1dGlscy5pc0ludGVnZXIocGFyc2VJbnQoaW5wdXQubWF4KSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vYmFpbCBpZiBub3QgbnVtZXJpYyBmb3IgZGVjaW1hbCB0eXBlXG4gICAgICAgICAgICAgICAgaWYgKGlucHV0LnR5cGUgPT09IGNvbnN0cy5ERUNJTUFMX1RZUEUgJiYgISQuaXNOdW1lcmljKGlucHV0Lm1heCkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChpbnB1dC5tYXgudG9TdHJpbmcoKS5sZW5ndGggPiBjb25zdHMuTElNSVRTLm1heF92YWx1ZV9sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy9pZiB0aGV5IGFyZSBib3RoIHNldCwgY2hlY2sgbWluIDwgbWF4XG4gICAgICAgICAgICBpZiAoaW5wdXQubWluICYmIGlucHV0Lm1heCkge1xuXG4gICAgICAgICAgICAgICAgaWYgKGlucHV0LnR5cGUgPT09IGNvbnN0cy5JTlRFR0VSX1RZUEUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBhcnNlSW50KGlucHV0Lm1pbiwgMTApID49IHBhcnNlSW50KGlucHV0Lm1heCwgMTApKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudHlwZSA9PT0gY29uc3RzLkRFQ0lNQUxfVFlQRSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAocGFyc2VGbG9hdChpbnB1dC5taW4sIDEwKSA+PSBwYXJzZUZsb2F0KGlucHV0Lm1heCwgMTApKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogVmFsaWRhdGUgZGF0ZSBmb3JtYXRcbiAgICAgICAgICovXG5cbiAgICAgICAgLy9kYXRlXG4gICAgICAgIGlmIChpbnB1dC50eXBlID09PSBjb25zdHMuREFURV9UWVBFKSB7XG4gICAgICAgICAgICBpZiAoaW5wdXQuZGF0ZXRpbWVfZm9ybWF0KSB7XG4gICAgICAgICAgICAgICAgaWYgKCQuaW5BcnJheShpbnB1dC5kYXRldGltZV9mb3JtYXQsIHZhbGlkX2RhdGVfZm9ybWF0cykgPCAwKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vZm9ybWF0IG5vdCBhbGxvd2VkXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvL3RpbWVcbiAgICAgICAgaWYgKGlucHV0LnR5cGUgPT09IGNvbnN0cy5USU1FX1RZUEUpIHtcbiAgICAgICAgICAgIGlmIChpbnB1dC5kYXRldGltZV9mb3JtYXQpIHtcbiAgICAgICAgICAgICAgICBpZiAoJC5pbkFycmF5KGlucHV0LmRhdGV0aW1lX2Zvcm1hdCwgdmFsaWRfdGltZV9mb3JtYXRzKSA8IDApIHtcbiAgICAgICAgICAgICAgICAgICAgLy9mb3JtYXQgbm90IGFsbG93ZWRcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBWYWxpZGF0ZSBzZXRfdG9fY3VycmVudF9kYXRldGltZVxuICAgICAgICAgKi9cbiAgICAgICAgaWYgKGlucHV0LnNldF90b19jdXJyZW50X2RhdGV0aW1lKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIGlucHV0LnNldF90b19jdXJyZW50X2RhdGV0aW1lICE9PSAnYm9vbGVhbicpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vaXQgY2FuIGJlIHRydWUgb25seSBmb3IgZGF0ZSBhbmQgdGltZSBpbnB1dCB0eXBlc1xuICAgICAgICAgICAgaWYgKGlucHV0LnNldF90b19jdXJyZW50X2RhdGV0aW1lID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgaWYgKCEoaW5wdXQudHlwZSA9PT0gY29uc3RzLkRBVEVfVFlQRSB8fCBpbnB1dC50eXBlID09PSBjb25zdHMuVElNRV9UWVBFKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFZhbGlkYXRlIHBvc3NpYmxlIGFuc3dlcnNcbiAgICAgICAgICovXG4gICAgICAgIGlmICgkLmluQXJyYXkoaW5wdXQudHlwZSwgY29uc3RzLk1VTFRJUExFX0FOU1dFUl9UWVBFUykgPiAwKSB7XG4gICAgICAgICAgICBpZiAoIXNlbGYuYXJlUG9zc2libGVBbnN3ZXJzVmFsaWQoaW5wdXQucG9zc2libGVfYW5zd2VycywgaW5wdXQudHlwZSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIWlzX2JyYW5jaCAmJiAhaXNfZ3JvdXApIHtcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogVmFsaWRhdGUganVtcHNcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgaWYgKCFzZWxmLmFyZUp1bXBzVmFsaWQoaW5wdXQpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgIC8vdG9wIGxldmVsIGlucHV0LCB2YWxpZGF0ZSBicmFuY2ggYW5kIGdyb3VwIHJlY3Vyc2l2ZWx5XG5cbiAgICAgICAgICAgIC8vYnJhbmNoXG4gICAgICAgICAgICBpZiAoJC5pc0FycmF5KGlucHV0LmJyYW5jaCkpIHtcbiAgICAgICAgICAgICAgICAkKGlucHV0LmJyYW5jaCkuZWFjaChmdW5jdGlvbiAoaW5kZXgsIGJyYW5jaF9pbnB1dCkge1xuICAgICAgICAgICAgICAgICAgICBzZWxmLmlzVmFsaWRJbnB1dChmb3JtX3JlZiwgYnJhbmNoX2lucHV0LCB0cnVlLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vZ3JvdXBcbiAgICAgICAgICAgIGlmICgkLmlzQXJyYXkoaW5wdXQuZ3JvdXApKSB7XG4gICAgICAgICAgICAgICAgJChpbnB1dC5ncm91cCkuZWFjaChmdW5jdGlvbiAoaW5kZXgsIGdyb3VwX2lucHV0KSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuaXNWYWxpZElucHV0KGZvcm1fcmVmLCBncm91cF9pbnB1dCwgZmFsc2UsIHRydWUpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG5cbiAgICAgICAgICAgIGlmIChpc19icmFuY2gpIHtcbiAgICAgICAgICAgICAgICAvL2JyYW5jaCBpbiBicmFuY2ggaXMgbm90IGFsbG93ZWRcbiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuYnJhbmNoLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAqIFZhbGlkYXRlIGp1bXBzXG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgaWYgKCFzZWxmLmFyZUp1bXBzVmFsaWQoaW5wdXQuYnJhbmNoKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoaXNfZ3JvdXApIHtcbiAgICAgICAgICAgICAgICAvL2dyb3VwIGluIGdyb3VwIGlzIG5vdCBhbGxvd2VkXG4gICAgICAgICAgICAgICAgaWYgKGlucHV0Lmdyb3VwLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vanVtcHMgaW4gZ3JvdXAgYXJlIG5vdCBhbGxvd2VkXG4gICAgICAgICAgICAgICAgaWYgKGlucHV0Lmp1bXBzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmFsaWQ7XG4gICAgfVxuXG59O1xuXG5cbm1vZHVsZS5leHBvcnRzID0gaW1wb3J0X2Zvcm1fdmFsaWRhdGlvbjtcbiIsIid1c2Ugc3RyaWN0JztcblxudmFyIGZvcm1idWlsZGVyID0gcmVxdWlyZSgnY29uZmlnL2Zvcm1idWlsZGVyJyk7XG52YXIgbWVzc2FnZXMgPSByZXF1aXJlKCdjb25maWcvbWVzc2FnZXMnKTtcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIganVtcHMgPSByZXF1aXJlKCdhY3Rpb25zL2p1bXBzJyk7XG52YXIgdXRpbHMgPSByZXF1aXJlKCdoZWxwZXJzL3V0aWxzJyk7XG52YXIgbG9hZF9jaGlsZF9mb3JtX2NvbnRhaW5lcnMgPSByZXF1aXJlKCdsb2FkZXJzL2xvYWQtY2hpbGQtZm9ybS1jb250YWluZXJzJyk7XG5cbnZhciB1aSA9IHtcblxuICAgIG5hdmJhcjoge1xuXG4gICAgICAgIHRvZ2dsZVVuZG9CdG46IGZ1bmN0aW9uIChzdGF0dXMpIHtcblxuICAgICAgICAgICAgaWYgKHN0YXR1cyA9PT0gY29uc3RzLkJUTl9ESVNBQkxFRCkge1xuICAgICAgICAgICAgICAgIC8vdG9nZ2xlIGJ1dHRvblxuICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS51bmRvX2J0blxuICAgICAgICAgICAgICAgICAgICAuYXR0cignZGlzYWJsZWQnLCB0cnVlKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHN0YXR1cyA9PT0gY29uc3RzLkJUTl9FTkFCTEVEKSB7XG4gICAgICAgICAgICAgICAgLy90b2dnbGUgYnV0dG9uXG4gICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLnVuZG9fYnRuXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdkaXNhYmxlZCcsIGZhbHNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICB0b2dnbGVTYXZlUHJvamVjdEJ0bjogZnVuY3Rpb24gKHN0YXR1cykge1xuXG4gICAgICAgICAgICBpZiAoc3RhdHVzID09PSBjb25zdHMuQlROX0RJU0FCTEVEKSB7XG4gICAgICAgICAgICAgICAgLy90b2dnbGUgYnV0dG9uXG4gICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLnNhdmVfcHJvamVjdF9idG5cbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2Rpc2FibGVkJywgdHJ1ZSk7XG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHN0YXR1cyA9PT0gY29uc3RzLkJUTl9FTkFCTEVEKSB7XG4gICAgICAgICAgICAgICAgLy90b2dnbGUgYnV0dG9uXG4gICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLnNhdmVfcHJvamVjdF9idG5cbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2Rpc2FibGVkJywgZmFsc2UpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL3RvZ2dsZSBpY29uXG4gICAgICAgICAgICBpZiAoc3RhdHVzID09PSBjb25zdHMuQlROX0VOQUJMRUQpIHtcbiAgICAgICAgICAgICAgICBmb3JtYnVpbGRlclxuICAgICAgICAgICAgICAgICAgICAuZG9tLnNhdmVfcHJvamVjdF9idG5cbiAgICAgICAgICAgICAgICAgICAgLmZpbmQoJy5wcm9qZWN0LXN0YXRlJylcbiAgICAgICAgICAgICAgICAgICAgLnJlbW92ZUNsYXNzKCdmYS13YXJuaW5nJylcbiAgICAgICAgICAgICAgICAgICAgLmFkZENsYXNzKCdmYS1jaGVjaycpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXJcbiAgICAgICAgICAgICAgICAgICAgLmRvbS5zYXZlX3Byb2plY3RfYnRuXG4gICAgICAgICAgICAgICAgICAgIC5maW5kKCcucHJvamVjdC1zdGF0ZScpXG4gICAgICAgICAgICAgICAgICAgIC5hZGRDbGFzcygnZmEtd2FybmluZycpXG4gICAgICAgICAgICAgICAgICAgIC5yZW1vdmVDbGFzcygnZmEtY2hlY2snKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sXG4gICAgZm9ybXNfdGFiczoge1xuXG4gICAgICAgIGluamVjdFJlZkludG9Gb3JtVGFiOiBmdW5jdGlvbiAocmVmKSB7XG5cbiAgICAgICAgICAgIHZhciB0YWJfYnV0dG9uID0gJCgnLm1haW4gLm1haW5fX3RhYnMgbGknKS5maXJzdCgpO1xuICAgICAgICAgICAgdmFyIHRhYl9wYW5lbCA9ICQoJy5tYWluIC5tYWluX190YWJzLWNvbnRlbnQgLm1haW5fX3RhYnMtY29udGVudC10YWJwYW5lbCcpLmZpcnN0KCk7XG5cbiAgICAgICAgICAgIC8vaW5qZWN0IHJlZiBvZiB0aGUgZmlyc3QgZm9ybSB0byB0aGUgZmlzdCB0YWIvdGFiIGNvbnRlbnQsIGFzIGl0IGlzIHNob3duIGJ5IGRlZmF1bHRcbiAgICAgICAgICAgIHRhYl9idXR0b24uZmluZCgnYScpLmF0dHIoJ2hyZWYnLCAnIycgKyByZWYgKyAnLXRhYnBhbmVsJyk7XG4gICAgICAgICAgICB0YWJfcGFuZWwuZmlyc3QoKS5hdHRyKCdpZCcsIHJlZiArICctdGFicGFuZWwnKTtcbiAgICAgICAgICAgIHRhYl9wYW5lbC5maW5kKCcuaW5wdXRzLWNvbGxlY3Rpb24nKS5hdHRyKCdpZCcsIHJlZiArICctaW5wdXRzLWNvbGxlY3Rpb24nKTtcbiAgICAgICAgICAgIHRhYl9wYW5lbC5maW5kKCcuaW5wdXQtcHJvcGVydGllcycpLmF0dHIoJ2lkJywgcmVmICsgJy1pbnB1dC1wcm9wZXJ0aWVzJyk7XG5cbiAgICAgICAgfSxcblxuICAgICAgICB0b2dnbGVGb3JtVGFic0J1dHRvbnM6IGZ1bmN0aW9uIChvcHRpb24pIHtcblxuICAgICAgICAgICAgaWYgKG9wdGlvbi5lbmFibGUpIHtcbiAgICAgICAgICAgICAgICAvL2VuYWJsZSBmb3JtIHRhYiBidXR0b25zXG4gICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmZvcm1zX3RhYnMuZmluZCgnbGknKVxuICAgICAgICAgICAgICAgICAgICAubm90KCcubWFpbl9fdGFicy1idG5zJylcbiAgICAgICAgICAgICAgICAgICAgLmVhY2goZnVuY3Rpb24gKGluZGV4LCBpdGVtKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkKGl0ZW0pLnJlbW92ZUNsYXNzKCdkaXNhYmxlZCBkaXNhYmxlZC10YWInKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAvL2Rpc2FibGUgZm9ybSB0YWIgYnV0dG9uc1xuICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5mb3Jtc190YWJzLmZpbmQoJ2xpJylcbiAgICAgICAgICAgICAgICAgICAgLm5vdCgnLm1haW5fX3RhYnMtYnRucycpXG4gICAgICAgICAgICAgICAgICAgIC5lYWNoKGZ1bmN0aW9uIChpbmRleCwgaXRlbSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJChpdGVtKS5hZGRDbGFzcygnZGlzYWJsZWQgZGlzYWJsZWQtdGFiJyk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIHNldEZpcnN0Rm9ybVRhYk5hbWU6IGZ1bmN0aW9uICh0aGVfZm9ybV9uYW1lKSB7XG5cbiAgICAgICAgICAgIHZhciBmb3JtcyA9IGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbi5kYXRhLnByb2plY3QuZm9ybXM7XG5cbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5mb3Jtc190YWJzXG4gICAgICAgICAgICAgICAgLmZpbmQoJy5hY3RpdmUgYVtkYXRhLWZvcm0taW5kZXg9XCIwXCJdJylcbiAgICAgICAgICAgICAgICAudGV4dCh0aGVfZm9ybV9uYW1lLnRydW5jKGNvbnN0cy5UQUJfRk9STV9OQU1FX01BWF9ESVNQTEFZX0xFTkdIVCAtIChmb3Jtcy5sZW5ndGggKiAyKSkpXG4gICAgICAgICAgICAgICAgLmFwcGVuZCgnJm5ic3A7PGkgY2xhc3M9XCJmb3JtLXN0YXRlIGZhIGZhLWV4Y2xhbWF0aW9uLXRyaWFuZ2xlXCI+PC9pPicpO1xuICAgICAgICB9LFxuXG5cbiAgICAgICAgLy9pZiB0aGUgZm9ybSBpcyB2YWxpZCBzaG93IGEgZ3JlZW4gY2hlY2sgb24gaXRzIHRhYiBidXR0b25cbiAgICAgICAgc2hvd0Zvcm1WYWxpZEljb246IGZ1bmN0aW9uICh0aGVfZm9ybV9pbmRleCkge1xuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmZvcm1zX3RhYnNcbiAgICAgICAgICAgICAgICAuZmluZCgnbGkgYVtkYXRhLWZvcm0taW5kZXg9JyArIHRoZV9mb3JtX2luZGV4ICsgJ10gaS5mb3JtLXN0YXRlJylcbiAgICAgICAgICAgICAgICAucmVtb3ZlQ2xhc3MoJ2ZhLWV4Y2xhbWF0aW9uLXRyaWFuZ2xlJykuYWRkQ2xhc3MoJ2ZhLWNoZWNrJyk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLy9pZiB0aGUgZm9ybSBpcyBOT1QgdmFsaWQgc2hvdyBhIHdhcm5pbmcgaWNvbiBvbiBpdHMgdGFiIGJ1dHRvblxuICAgICAgICBzaG93Rm9ybUludmFsaWRJY29uOiBmdW5jdGlvbiAodGhlX2Zvcm1faW5kZXgpIHtcbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5mb3Jtc190YWJzXG4gICAgICAgICAgICAgICAgLmZpbmQoJ2xpIGFbZGF0YS1mb3JtLWluZGV4PScgKyB0aGVfZm9ybV9pbmRleCArICddIGkuZm9ybS1zdGF0ZScpXG4gICAgICAgICAgICAgICAgLnJlbW92ZUNsYXNzKCdmYS1jaGVjaycpLmFkZENsYXNzKCdmYS1leGNsYW1hdGlvbi10cmlhbmdsZScpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8vcmV0dXJuIHRoZSBtYXJrdXAgZm9yIGEgZm9ybSB0YWIgYnV0dG9uLCBzaG93aW5nIGZvcm0gbmFtZVxuICAgICAgICBnZXRGb3JtVGFiQnV0dG9uSFRNTDogZnVuY3Rpb24gKGZvcm0pIHtcblxuICAgICAgICAgICAgdmFyIGh0bWwgPSAnJztcbiAgICAgICAgICAgIHZhciBmb3JtX2luZGV4ID0gZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4O1xuICAgICAgICAgICAgdmFyIGZvcm1zID0gZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uLmRhdGEucHJvamVjdC5mb3JtcztcblxuICAgICAgICAgICAgaHRtbCArPSAnPGxpIHJvbGU9XCJwcmVzZW50YXRpb25cIiBjbGFzcz1cIm1haW5fX3RhYnNfX2Zvcm0tYnRuXCI+JztcbiAgICAgICAgICAgIGh0bWwgKz0gJzxhIGhyZWY9XCIjJyArIGZvcm0ucmVmICsgJy10YWJwYW5lbFwiIHJvbGU9XCJ0YWJcIiBkYXRhLXRvZ2dsZT1cInRhYlwiIGRhdGEtZm9ybS1pbmRleD1cIicgKyBmb3JtX2luZGV4ICsgJ1wiPic7XG4gICAgICAgICAgICBodG1sICs9IGZvcm0ubmFtZS50cnVuYyhjb25zdHMuVEFCX0ZPUk1fTkFNRV9NQVhfRElTUExBWV9MRU5HSFQgLSAoZm9ybXMubGVuZ3RoICogMikpO1xuICAgICAgICAgICAgaHRtbCArPSAnJm5ic3A7PGkgY2xhc3M9XCJmb3JtLXN0YXRlIGZhIGZhLWV4Y2xhbWF0aW9uLXRyaWFuZ2xlXCI+PC9pPic7XG4gICAgICAgICAgICBodG1sICs9ICc8L2E+JztcbiAgICAgICAgICAgIGh0bWwgKz0gJzwvbGk+JztcblxuICAgICAgICAgICAgcmV0dXJuIGh0bWw7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLy9nZXQgbWFya3VwIGZvciBhIGZvcm0gdGFiIGNvbnRlbnQgKGlucHV0IGNvbGxlY3Rpb24gKyBpbnB1dCBwcm9wZXJ0aWVzKVxuICAgICAgICBnZXRGb3JtVGFiQ29udGVudEhUTUw6IGZ1bmN0aW9uIChmb3JtKSB7XG5cbiAgICAgICAgICAgIHZhciBodG1sID0gJyc7XG5cbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9IG5ldyAkLkRlZmVycmVkKCk7XG5cbiAgICAgICAgICAgICQud2hlbihsb2FkX2NoaWxkX2Zvcm1fY29udGFpbmVycygpKS50aGVuKGZ1bmN0aW9uICh2aWV3cykge1xuXG4gICAgICAgICAgICAgICAgaHRtbCArPSAnPGRpdiByb2xlPVwidGFicGFuZWxcIiBjbGFzcz1cIm1haW5fX3RhYnMtY29udGVudC10YWJwYW5lbCB0YWItcGFuZSBmYWRlIGluIGFjdGl2ZVwiIGlkPVwiJyArIGZvcm0ucmVmICsgJy10YWJwYW5lbFwiPic7XG4gICAgICAgICAgICAgICAgaHRtbCArPSAnPGRpdiBpZD1cIicgKyBmb3JtLnJlZiArICctaW5wdXRzLWNvbGxlY3Rpb25cIiBjbGFzcz1cImlucHV0cy1jb2xsZWN0aW9uIGNvbC1tZC02XCI+JztcbiAgICAgICAgICAgICAgICBodG1sICs9IHZpZXdzLmlucHV0c19jb2xsZWN0aW9uO1xuICAgICAgICAgICAgICAgIGh0bWwgKz0gJzwvZGl2Pic7XG4gICAgICAgICAgICAgICAgaHRtbCArPSAnPGRpdiBpZD1cIicgKyBmb3JtLnJlZiArICctaW5wdXQtcHJvcGVydGllc1wiIGNsYXNzPVwiaW5wdXQtcHJvcGVydGllcyBjb2wtbWQtNlwiPic7XG4gICAgICAgICAgICAgICAgaHRtbCArPSB2aWV3cy5pbnB1dHNfcHJvcGVydGllcztcbiAgICAgICAgICAgICAgICBodG1sICs9ICc8L2Rpdj4nO1xuICAgICAgICAgICAgICAgIGh0bWwgKz0gJzwvZGl2Pic7XG5cbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKGh0bWwpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlKCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgcmVzaXplRm9ybVRhYnM6IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgdmFyIGZvcm1zID0gZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uLmRhdGEucHJvamVjdC5mb3JtcztcblxuXG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uZm9ybXNfdGFic1xuICAgICAgICAgICAgICAgIC5maW5kKCdsaTpsdCgnICsgZm9ybXMubGVuZ3RoICsgJyknKS5lYWNoKGZ1bmN0aW9uIChpbmRleCwgZm9ybV9idG4pIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgc3RhdGUgPSAkKGZvcm1fYnRuKS5maW5kKCdhIGknKS5oYXNDbGFzcygnZmEtY2hlY2snKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGJ0biA9ICQoZm9ybV9idG4pLmZpbmQoJ2EnKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHZhbGlkX2ljb25faHRtbCA9ICcmbmJzcDs8aSBjbGFzcz1cImZvcm0tc3RhdGUgZmEgZmEtY2hlY2tcIj48L2k+JztcbiAgICAgICAgICAgICAgICAgICAgdmFyIGludmFsaWRfaWNvbl9odG1sID0gJyZuYnNwOzxpIGNsYXNzPVwiZm9ybS1zdGF0ZSBmYSBmYS1leGNsYW1hdGlvbi10cmlhbmdsZVwiPjwvaT4nO1xuXG4gICAgICAgICAgICAgICAgICAgIGJ0bi50ZXh0KGZvcm1zW2luZGV4XS5uYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAudHJ1bmMoY29uc3RzLlRBQl9GT1JNX05BTUVfTUFYX0RJU1BMQVlfTEVOR0hUIC0gKGZvcm1zLmxlbmd0aCAqIDIpKSk7XG4gICAgICAgICAgICAgICAgICAgIGJ0bi5hcHBlbmQoc3RhdGUgPyB2YWxpZF9pY29uX2h0bWwgOiBpbnZhbGlkX2ljb25faHRtbCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIGlucHV0c19jb2xsZWN0aW9uOiB7XG5cbiAgICAgICAgLy9zaG93L2hpZGUgdGhlIHRpdGxlIG5vdCBzZXQgd2FybmluZyBtZXNzYWdlXG4gICAgICAgIHRvZ2dsZVRpdGxlV2FybmluZzogZnVuY3Rpb24gKGNvdW50LCBpc19icmFuY2gpIHtcblxuICAgICAgICAgICAgLy9maW5kIHdhcm5pbmcgZm9yIGVpdGhlciB0aGUgYWN0aXZlIGZvcm0gb3IgdGhlIGFjdGl2ZSBicmFuY2hcbiAgICAgICAgICAgIHZhciBlbGVtZW50X3RvX2ZpbmQgPSBpc19icmFuY2ggPyAnLmFjdGl2ZS1icmFuY2ggLm5vLWJyYW5jaC10aXRsZS1zZXQnIDogJy5uby1mb3JtLXRpdGxlLXNldCc7XG5cbiAgICAgICAgICAgIGlmIChjb3VudCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIC8vc2hvd1xuICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbl9zb3J0YWJsZS5maW5kKGVsZW1lbnRfdG9fZmluZCkucmVtb3ZlQ2xhc3MoJ2hpZGRlbicpLmFuaW1hdGUoe1xuICAgICAgICAgICAgICAgICAgICBvcGFjaXR5OiAxLFxuICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IDM3XG4gICAgICAgICAgICAgICAgfSwgY29uc3RzLkFOSU1BVElPTl9GQVNUKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vaGlkZVxuICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbl9zb3J0YWJsZS5maW5kKGVsZW1lbnRfdG9fZmluZCkuYW5pbWF0ZSh7XG4gICAgICAgICAgICAgICAgICAgIG9wYWNpdHk6IDAsXG4gICAgICAgICAgICAgICAgICAgIGhlaWdodDogMFxuICAgICAgICAgICAgICAgIH0sIGNvbnN0cy5BTklNQVRJT05fRkFTVCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLmFkZENsYXNzKCdoaWRkZW4nKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICBnZXRJbnB1dFN0YXRlSWNvbnNIVE1MOiBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgIHZhciBodG1sID0gJyc7XG4gICAgICAgICAgICBodG1sICs9ICc8aSBjbGFzcz1cInF1ZXN0aW9uLXN0YXRlIGZhIGZhLWV4Y2xhbWF0aW9uLXRyaWFuZ2xlIGZhLTJ4IGZhLWZ3IHB1bGwtcmlnaHRcIj48L2k+JztcbiAgICAgICAgICAgIGh0bWwgKz0gJzxpIGNsYXNzPVwianVtcC1zdGF0ZSBmYSBmYS1hcnJvdy1jaXJjbGUtby1kb3duIGZhLTJ4IGZhLWZ3IHB1bGwtcmlnaHQgaW52aXNpYmxlXCI+PC9pPic7XG5cbiAgICAgICAgICAgIHJldHVybiBodG1sO1xuICAgICAgICB9LFxuXG4gICAgICAgIHNob3dJbnB1dFZhbGlkSWNvbjogZnVuY3Rpb24gKHRoZV9yZWYpIHtcbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbl9zb3J0YWJsZVxuICAgICAgICAgICAgICAgIC5maW5kKCdkaXYuaW5wdXRbZGF0YS1pbnB1dC1yZWY9XCInICsgdGhlX3JlZiArICdcIl0gaS5xdWVzdGlvbi1zdGF0ZScpXG4gICAgICAgICAgICAgICAgLmZpcnN0KClcbiAgICAgICAgICAgICAgICAucmVtb3ZlQ2xhc3MoJ2ZhLWV4Y2xhbWF0aW9uLXRyaWFuZ2xlJykuYWRkQ2xhc3MoJ2ZhLWNoZWNrJyk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgc2hvd0lucHV0SW52YWxpZEljb246IGZ1bmN0aW9uICh0aGVfcmVmKSB7XG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25fc29ydGFibGVcbiAgICAgICAgICAgICAgICAuZmluZCgnZGl2LmlucHV0W2RhdGEtaW5wdXQtcmVmPVwiJyArIHRoZV9yZWYgKyAnXCJdIGkucXVlc3Rpb24tc3RhdGUnKVxuICAgICAgICAgICAgICAgIC5maXJzdCgpXG4gICAgICAgICAgICAgICAgLnJlbW92ZUNsYXNzKCdmYS1jaGVjaycpLmFkZENsYXNzKCdmYS1leGNsYW1hdGlvbi10cmlhbmdsZScpO1xuICAgICAgICB9LFxuXG4gICAgICAgIHNob3dJbnB1dFF1ZXN0aW9uUHJldmlldzogZnVuY3Rpb24gKHRoZV9yZWYsIHRoZV9xdWVzdGlvbikge1xuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uX3NvcnRhYmxlXG4gICAgICAgICAgICAgICAgLmZpbmQoJ2Rpdi5pbnB1dFtkYXRhLWlucHV0LXJlZj1cIicgKyB0aGVfcmVmICsgJ1wiXSA+IC5pbnB1dC1pbm5lciA+IC5xdWVzdGlvbi1wcmV2aWV3JylcbiAgICAgICAgICAgICAgICAudGV4dCh0aGVfcXVlc3Rpb24udHJ1bmMoNTApKTtcbiAgICAgICAgfSxcbiAgICAgICAgdG9nZ2xlRm9ybUFjdGlvbkJ1dHRvbnM6IGZ1bmN0aW9uICh0aGVfc3RhdGUpIHtcbiAgICAgICAgICAgIHZhciBidXR0b25zID0gZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uXG4gICAgICAgICAgICAgICAgLmZpbmQoJy5pbnB1dHMtY29sbGVjdGlvbl9fYnV0dG9ucycpXG4gICAgICAgICAgICAgICAgLmZpbmQoJy5idG4nKTtcblxuICAgICAgICAgICAgaWYgKHRoZV9zdGF0ZSkge1xuICAgICAgICAgICAgICAgIGJ1dHRvbnMuYXR0cignZGlzYWJsZWQnLCBmYWxzZSkuc2hvdygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgYnV0dG9ucy5hdHRyKCdkaXNhYmxlZCcsIHRydWUpLmhpZGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZ2V0RW1wdHlDb2xsZWN0aW9uU29ydGFibGVIVE1MOiBmdW5jdGlvbiAodHlwZSkge1xuXG4gICAgICAgICAgICB2YXIgaHRtbCA9ICcnO1xuXG4gICAgICAgICAgICBodG1sICs9ICc8ZGl2IGNsYXNzPVwiJyArIHR5cGUgKyAnLXNvcnRhYmxlIGhpZGRlblwiPic7XG4gICAgICAgICAgICAvL25vIHRpdGxlIHNldCB3YXJuaW5nIChvbmx5IGZvciBicmFuY2ggdHlwZSlcbiAgICAgICAgICAgIGlmICh0eXBlID09PSBjb25zdHMuQlJBTkNIX1RZUEUpIHtcbiAgICAgICAgICAgICAgICBodG1sICs9ICc8ZGl2IGNsYXNzPVwid2FybmluZy13ZWxsIG5vLWJyYW5jaC10aXRsZS1zZXQgaGlkZGVuXCI+Tm8gdGl0bGUgc2V0IGZvciB0aGlzIGJyYW5jaCB5ZXQgJztcbiAgICAgICAgICAgICAgICBodG1sICs9ICc8aSBjbGFzcz1cImZhIGZhLXF1ZXN0aW9uLWNpcmNsZSBmYS0yeCBmYS1md1wiIGRhdGEtdG9nZ2xlPVwibW9kYWxcIiBkYXRhLXRhcmdldD1cIiNpbmZvLXRpdGxlXCI+JztcbiAgICAgICAgICAgICAgICBodG1sICs9ICc8L2k+JztcbiAgICAgICAgICAgICAgICBodG1sICs9ICc8L2Rpdj4nO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy9ubyBpbnB1dHMgeWV0IG1lc3NhZ2VcbiAgICAgICAgICAgIGh0bWwgKz0gJzxzcGFuIGNsYXNzPVwiaW5wdXQtcHJvcGVydGllc19fbm8tJyArIHR5cGUgKyAnLXF1ZXN0aW9ucy1tZXNzYWdlXCIgc3R5bGU9XCJkaXNwbGF5OiBub25lO1wiPic7XG4gICAgICAgICAgICBodG1sICs9IHR5cGUgPT09IGNvbnN0cy5CUkFOQ0hfVFlQRSA/IG1lc3NhZ2VzLmxhYmVscy5BRERfQlJBTkNIX0lOUFVUU19IRVJFIDogbWVzc2FnZXMubGFiZWxzLkFERF9HUk9VUF9JTlBVVFNfSEVSRTtcbiAgICAgICAgICAgIGh0bWwgKz0gJzwvc3Bhbj4nO1xuICAgICAgICAgICAgaHRtbCArPSAne3snICsgdHlwZSArICctaW5wdXRzfX0nO1xuICAgICAgICAgICAgaHRtbCArPSAnPC9kaXY+JztcblxuICAgICAgICAgICAgcmV0dXJuIGh0bWw7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIGlucHV0X3Rvb2xzOiB7XG5cbiAgICAgICAgZW5hYmxlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkKCd1bCNpbnB1dHMtdG9vbHMtbGlzdCBsaSBkaXYuaW5wdXQnKVxuICAgICAgICAgICAgICAgIC5kcmFnZ2FibGUoJ2VuYWJsZScpXG4gICAgICAgICAgICAgICAgLnJlbW92ZUNsYXNzKCdkcmFnZ2luZy1kaXNhYmxlZCcpO1xuICAgICAgICB9LFxuICAgICAgICBkaXNhYmxlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAvL2Rpc2FibGUgZHJhZ2dhYmxlXG4gICAgICAgICAgICAkKCd1bCNpbnB1dHMtdG9vbHMtbGlzdCBsaSBkaXYuaW5wdXQnKVxuICAgICAgICAgICAgICAgIC5kcmFnZ2FibGUoJ2Rpc2FibGUnKVxuICAgICAgICAgICAgICAgIC5hZGRDbGFzcygnZHJhZ2dpbmctZGlzYWJsZWQnKTtcblxuICAgICAgICAgICAgLy9zaG93IHRvYXN0IG1heCBudW1iZXIgb2YgaW5wdXQgaGl0XG4gICAgICAgICAgICAvL3RvZG9cbiAgICAgICAgfSxcbiAgICAgICAgaGlkZVNlYXJjaElucHV0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX3Rvb2xzX2RyYWdnYWJsZS5maWx0ZXIoJy5pbnB1dC1zZWFyY2gnKS5oaWRlKCk7XG4gICAgICAgIH0sXG4gICAgICAgIHNob3dTZWFyY2hJbnB1dDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c190b29sc19kcmFnZ2FibGUuZmlsdGVyKCcuaW5wdXQtc2VhcmNoJykuc2hvdygpO1xuICAgICAgICB9XG4gICAgfSxcbiAgICBpbnB1dF9wcm9wZXJ0aWVzX3BhbmVsOiB7XG5cbiAgICAgICAgdG9nZ2xlQWRkQW5zd2VyQnRuOiBmdW5jdGlvbiAoaXNfZGlzYWJsZWQpIHtcblxuICAgICAgICAgICAgdmFyIGlucHV0ID0gdXRpbHMuZ2V0QWN0aXZlSW5wdXQoKTtcbiAgICAgICAgICAgIHZhciBwcm9wZXJ0aWVzX3BhbmVsID0gZm9ybWJ1aWxkZXIuZG9tXG4gICAgICAgICAgICAgICAgLmlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlclxuICAgICAgICAgICAgICAgIC5maW5kKCdmb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIGlucHV0LnJlZiArICdcIl0nKTtcblxuICAgICAgICAgICAgcHJvcGVydGllc19wYW5lbFxuICAgICAgICAgICAgICAgIC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fcG9zc2libGUtYW5zd2Vyc19fYWRkLWFuc3dlcicpXG4gICAgICAgICAgICAgICAgLmF0dHIoJ2Rpc2FibGVkJywgaXNfZGlzYWJsZWQpO1xuXG4gICAgICAgIH0sXG5cbiAgICAgICAgc2V0VW5pcXVlbmVzc1Byb3BlcnR5OiBmdW5jdGlvbiAodGhlX2Zvcm1faW5kZXgsIHRoZV9pbnB1dCkge1xuXG4gICAgICAgICAgICB2YXIgZm9ybV9pbmRleCA9IHRoZV9mb3JtX2luZGV4O1xuICAgICAgICAgICAgdmFyIGlucHV0ID0gdGhlX2lucHV0O1xuXG4gICAgICAgICAgICBpZiAoZm9ybV9pbmRleCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIGlucHV0LmRvbS5hZHZhbmNlZF9wcm9wZXJ0aWVzX3dyYXBwZXIuZmluZCgnZGl2LmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2FkdmFuY2VkLXByb3BlcnRpZXNfX3VuaXF1ZW5lc3MgaW5wdXQnKVxuICAgICAgICAgICAgICAgICAgICAucHJvcCgnY2hlY2tlZCcsIGlucHV0LnVuaXF1ZXNzICE9PSBjb25zdHMuVU5JUVVFU1NfTk9ORSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKGlucHV0LnVuaXF1ZW5lc3MpIHtcblxuICAgICAgICAgICAgICAgICAgICBjYXNlIGNvbnN0cy5VTklRVUVTU19GT1JNOlxuICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXQuZG9tLmFkdmFuY2VkX3Byb3BlcnRpZXNfd3JhcHBlci5maW5kKCdkaXYuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fYWR2YW5jZWQtcHJvcGVydGllc19fdW5pcXVlbmVzcyBpbnB1dC51bmlxdWVuZXNzLWZvcm0nKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5wcm9wKCdjaGVja2VkJywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBjb25zdHMuVU5JUVVFU1NfSElFUkFSQ0hZOlxuICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXQuZG9tLmFkdmFuY2VkX3Byb3BlcnRpZXNfd3JhcHBlci5maW5kKCdkaXYuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fYWR2YW5jZWQtcHJvcGVydGllc19fdW5pcXVlbmVzcyBpbnB1dC51bmlxdWVuZXNzLWhpZXJhcmNoeScpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnByb3AoJ2NoZWNrZWQnLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICBzaG93SW5wdXRRdWVzdGlvblByZXZpZXc6IGZ1bmN0aW9uIChxdWVzdGlvbikge1xuXG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc1xuICAgICAgICAgICAgICAgIC5maW5kKCcucGFuZWwgLnBhbmVsLWhlYWRpbmcgLmlucHV0LXByb3BlcnRpZXNfX2hlYWRlciAucXVlc3Rpb24tcHJldmlldycpXG4gICAgICAgICAgICAgICAgLnRleHQocXVlc3Rpb24pO1xuICAgICAgICB9LFxuXG4gICAgICAgIHRvZ2dsZUp1bXBUYWI6IGZ1bmN0aW9uICh0aGVfcmVmLCB0aGVfc3RhdGUpIHtcblxuICAgICAgICAgICAgdmFyIGp1bXBfdGFiID0gZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlclxuICAgICAgICAgICAgICAgIC5maW5kKCdmb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIHRoZV9yZWYgKyAnXCJdJylcbiAgICAgICAgICAgICAgICAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX3RhYnMnKVxuICAgICAgICAgICAgICAgIC5maW5kKCcubmF2LXRhYnMnKVxuICAgICAgICAgICAgICAgIC5jaGlsZHJlbigpXG4gICAgICAgICAgICAgICAgLmVxKDIpO1xuXG4gICAgICAgICAgICAvL3RydWUgZW5hYmxlLCBmYWxzZSBkaXNhYmxlXG4gICAgICAgICAgICBpZiAodGhlX3N0YXRlKSB7XG4gICAgICAgICAgICAgICAganVtcF90YWIucmVtb3ZlQ2xhc3MoJ2Rpc2FibGVkIGRpc2FibGVkLXRhYicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAganVtcF90YWIuYWRkQ2xhc3MoJ2Rpc2FibGVkIGRpc2FibGVkLXRhYicpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIHNob3dKdW1wVGFiRXJyb3I6IGZ1bmN0aW9uIChqdW1wX2RvbV9vYmplY3QpIHtcblxuICAgICAgICAgICAgLy9zaG93ICchJyBvbiBhZmZlY3RlZCB0YWIsIGluIHRoaXMgY2FzZSB0aGUganVtcCBwcm9wZXJ0aWVzIHRhYiAodGhpcmQpXG4gICAgICAgICAgICBqdW1wX2RvbV9vYmplY3RcbiAgICAgICAgICAgICAgICAucGFyZW50cygpXG4gICAgICAgICAgICAgICAgLmVxKDUpXG4gICAgICAgICAgICAgICAgLmZpbmQoJy5uYXYtdGFicycpXG4gICAgICAgICAgICAgICAgLmZpbmQoJ2kuanVtcHMtZXJyb3InKVxuICAgICAgICAgICAgICAgIC5yZW1vdmVDbGFzcygnaW52aXNpYmxlJylcbiAgICAgICAgICAgICAgICAuaGlkZSgpXG4gICAgICAgICAgICAgICAgLmZhZGVJbigzMDApO1xuXG4gICAgICAgICAgICAvL3NldCBqdW1wIHByb3BlcnRpZXMgdGFiIHRleHQgdG8gcmVkXG4gICAgICAgICAgICBqdW1wX2RvbV9vYmplY3RcbiAgICAgICAgICAgICAgICAucGFyZW50cygpXG4gICAgICAgICAgICAgICAgLmVxKDUpXG4gICAgICAgICAgICAgICAgLmZpbmQoJy5uYXYtdGFicycpXG4gICAgICAgICAgICAgICAgLmZpbmQoJ2kuanVtcHMtZXJyb3InKVxuICAgICAgICAgICAgICAgIC5wYXJlbnQoKVxuICAgICAgICAgICAgICAgIC5hZGRDbGFzcygndmFsaWRhdGlvbi1lcnJvcicpO1xuXG4gICAgICAgIH0sXG5cbiAgICAgICAgaGlkZUp1bXBUYWJFcnJvcjogZnVuY3Rpb24gKGp1bXBfZG9tX29iamVjdCkge1xuXG4gICAgICAgICAgICAvL3Nob3cgJyEnIG9uIGFmZmVjdGVkIHRhYiwgaW4gdGhpcyBjYXNlIHRoZSBqdW1wIHByb3BlcnRpZXMgdGFiICh0aGlyZClcbiAgICAgICAgICAgIGp1bXBfZG9tX29iamVjdFxuICAgICAgICAgICAgICAgIC5wYXJlbnRzKClcbiAgICAgICAgICAgICAgICAuZXEoNSlcbiAgICAgICAgICAgICAgICAuZmluZCgnLm5hdi10YWJzJylcbiAgICAgICAgICAgICAgICAuZmluZCgnaS5qdW1wcy1lcnJvcicpXG4gICAgICAgICAgICAgICAgLmFkZENsYXNzKCdpbnZpc2libGUnKTtcblxuXG4gICAgICAgICAgICAvL3NldCBqdW1wIHByb3BlcnRpZXMgdGFiIHRleHQgdG8gcmVkXG4gICAgICAgICAgICBqdW1wX2RvbV9vYmplY3RcbiAgICAgICAgICAgICAgICAucGFyZW50cygpXG4gICAgICAgICAgICAgICAgLmVxKDUpXG4gICAgICAgICAgICAgICAgLmZpbmQoJy5uYXYtdGFicycpXG4gICAgICAgICAgICAgICAgLmZpbmQoJ2kuanVtcHMtZXJyb3InKVxuICAgICAgICAgICAgICAgIC5wYXJlbnQoKVxuICAgICAgICAgICAgICAgIC5yZW1vdmVDbGFzcygndmFsaWRhdGlvbi1lcnJvcicpO1xuXG4gICAgICAgIH0sXG5cbiAgICAgICAgdG9nZ2xlVGl0bGVDaGVja2JveDogZnVuY3Rpb24gKHN0YXRlLCByZWYpIHtcblxuICAgICAgICAgICAgdmFyIHRpdGxlX2NvbnRyb2wgPSBmb3JtYnVpbGRlci5kb21cbiAgICAgICAgICAgICAgICAuaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyXG4gICAgICAgICAgICAgICAgLmZpbmQoJ2Zvcm1bZGF0YS1pbnB1dC1yZWY9XCInICsgcmVmICsgJ1wiXScpXG4gICAgICAgICAgICAgICAgLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX190aXRsZS1mbGFnJyk7XG5cbiAgICAgICAgICAgIHN3aXRjaCAoc3RhdGUpIHtcbiAgICAgICAgICAgICAgICBjYXNlIGNvbnN0cy5ESVNBQkxFRF9TVEFURTpcbiAgICAgICAgICAgICAgICAgICAgdGl0bGVfY29udHJvbC5maW5kKCdsYWJlbCcpLmFkZENsYXNzKCdkaXNhYmxlZC1jaGVja2JveCcpO1xuICAgICAgICAgICAgICAgICAgICB0aXRsZV9jb250cm9sLmZpbmQoJ2lucHV0JykuYXR0cignZGlzYWJsZWQnLCB0cnVlKS5hZGRDbGFzcygnZGlzYWJsZWQtY2hlY2tib3gnKTtcbiAgICAgICAgICAgICAgICAgICAgdGl0bGVfY29udHJvbC5maW5kKCdzcGFuLnRpdGxlLWxhYmVsJykudGV4dChjb25zdHMuTUFYX1RJVExFX0xJTUlUX1JFQUNIRUQpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIGNvbnN0cy5FTkFCTEVEX1NUQVRFOlxuICAgICAgICAgICAgICAgICAgICB0aXRsZV9jb250cm9sLmZpbmQoJ2xhYmVsJykucmVtb3ZlQ2xhc3MoJ2Rpc2FibGVkLWNoZWNrYm94Jyk7XG4gICAgICAgICAgICAgICAgICAgIHRpdGxlX2NvbnRyb2wuZmluZCgnaW5wdXQnKS5hdHRyKCdkaXNhYmxlZCcsIGZhbHNlKS5yZW1vdmVDbGFzcygnZGlzYWJsZWQtY2hlY2tib3gnKTtcbiAgICAgICAgICAgICAgICAgICAgdGl0bGVfY29udHJvbC5maW5kKCdzcGFuLnRpdGxlLWxhYmVsJykudGV4dChjb25zdHMuVVNFX0FOU1dFUl9BU19USVRMRSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB0b2dnbGVDb3B5SW5wdXRCdXR0b246IGZ1bmN0aW9uIChyZWYsIHN0YXRlKSB7XG5cbiAgICAgICAgICAgIHZhciBjb3B5X2J0biA9IGZvcm1idWlsZGVyLmRvbVxuICAgICAgICAgICAgICAgIC5pbnB1dF9wcm9wZXJ0aWVzXG4gICAgICAgICAgICAgICAgLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19idXR0b25zLS1jb3B5LWlucHV0Jyk7XG5cbiAgICAgICAgICAgIHN3aXRjaCAoc3RhdGUpIHtcbiAgICAgICAgICAgICAgICBjYXNlIGNvbnN0cy5CVE5fRElTQUJMRUQ6XG4gICAgICAgICAgICAgICAgICAgIGNvcHlfYnRuLmF0dHIoJ2Rpc2FibGVkJywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgY29uc3RzLkJUTl9FTkFCTEVEOlxuICAgICAgICAgICAgICAgICAgICBjb3B5X2J0bi5hdHRyKCdkaXNhYmxlZCcsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LFxuICAgIGdyb3VwOiB7XG5cbiAgICAgICAgdG9nZ2xlRWRpdEdyb3VwQnV0dG9uOiBmdW5jdGlvbiAodGhlX3JlZiwgdGhlX3N0YXRlKSB7XG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyXG4gICAgICAgICAgICAgICAgLmZpbmQoJ2Zvcm1bZGF0YS1pbnB1dC1yZWY9XCInICsgdGhlX3JlZiArICdcIl0nKVxuICAgICAgICAgICAgICAgIC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fYmFzaWMtcHJvcGVydGllcycpXG4gICAgICAgICAgICAgICAgLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19lZGl0LWdyb3VwJykuYXR0cignZGlzYWJsZWQnLCAhdGhlX3N0YXRlKTtcbiAgICAgICAgfSxcblxuICAgICAgICBoaWRlR3JvdXBJbnB1dHNFcnJvcnM6IGZ1bmN0aW9uICh0aGVfcHJvcGVydGllc19wYW5lbCkge1xuICAgICAgICAgICAgLy9zaG93IGVycm9yIG1lc3NhZ2VcbiAgICAgICAgICAgIHRoZV9wcm9wZXJ0aWVzX3BhbmVsLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19lcnJvci0tZ3JvdXAtZXJyb3InKVxuICAgICAgICAgICAgICAgIC5hZGRDbGFzcygnaGlkZGVuJylcbiAgICAgICAgICAgICAgICAudGV4dCgnJm5ic3A7Jyk7XG4gICAgICAgIH1cblxuICAgIH0sXG4gICAgYnJhbmNoOiB7XG5cbiAgICAgICAgdG9nZ2xlRWRpdEJyYW5jaEJ1dHRvbjogZnVuY3Rpb24gKHRoZV9yZWYsIHRoZV9zdGF0ZSkge1xuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlclxuICAgICAgICAgICAgICAgIC5maW5kKCdmb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIHRoZV9yZWYgKyAnXCJdJylcbiAgICAgICAgICAgICAgICAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2Jhc2ljLXByb3BlcnRpZXMnKVxuICAgICAgICAgICAgICAgIC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fZWRpdC1icmFuY2gnKS5hdHRyKCdkaXNhYmxlZCcsICF0aGVfc3RhdGUpO1xuICAgICAgICB9LFxuXG4gICAgICAgIGhpZGVCcmFuY2hJbnB1dHNFcnJvcnM6IGZ1bmN0aW9uICh0aGVfcHJvcGVydGllc19wYW5lbCkge1xuICAgICAgICAgICAgLy9zaG93IGVycm9yIG1lc3NhZ2VcbiAgICAgICAgICAgIHRoZV9wcm9wZXJ0aWVzX3BhbmVsLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19lcnJvci0tYnJhbmNoLWVycm9yJylcbiAgICAgICAgICAgICAgICAuYWRkQ2xhc3MoJ2hpZGRlbicpXG4gICAgICAgICAgICAgICAgLnRleHQoJyZuYnNwOycpO1xuICAgICAgICB9LFxuICAgICAgICBzaG93QnJhbmNoSW5wdXRQcm9wZXJ0aWVzRG9tOiBmdW5jdGlvbiAodGhlX2JyYW5jaF9pbnB1dF9pbmRleCkge1xuXG4gICAgICAgICAgICB2YXIgZm9ybV9pbmRleCA9IGZvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleDtcbiAgICAgICAgICAgIHZhciBvd25lcl9pbnB1dF9yZWYgPSBmb3JtYnVpbGRlci5jdXJyZW50X2lucHV0X3JlZjtcbiAgICAgICAgICAgIHZhciBvd25lcl9pbnB1dF9pbmRleCA9IHV0aWxzLmdldElucHV0Q3VycmVudEluZGV4QnlSZWYob3duZXJfaW5wdXRfcmVmKTtcbiAgICAgICAgICAgIHZhciBicmFuY2hfaW5wdXRfaW5kZXggPSB0aGVfYnJhbmNoX2lucHV0X2luZGV4O1xuICAgICAgICAgICAgdmFyIGJyYW5jaF9pbnB1dCA9IGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbi5kYXRhLnByb2plY3QuZm9ybXNbZm9ybV9pbmRleF0uaW5wdXRzW293bmVyX2lucHV0X2luZGV4XS5icmFuY2hbYnJhbmNoX2lucHV0X2luZGV4XTtcbiAgICAgICAgICAgIHZhciBpbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXIgPSBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyO1xuICAgICAgICAgICAgdmFyIHZpZXcgPSBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc192aWV3c1ticmFuY2hfaW5wdXQudHlwZV07XG5cblxuICAgICAgICAgICAgLy90b2RvIHVwZGF0ZSB2aWV3IHRlbXBsYXRlIHdpdGggcmVmIGFuZCBzdHVmZlxuICAgICAgICAgICAgLy9pbml0IHByb3BlcnRpZXMgcGFuZWxcbiAgICAgICAgICAgIC8vIGhlbHBlcnMuaW5pdElucHV0UHJvcGVydGllc1BhbmVsKGlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlciwgYnJhbmNoX2lucHV0LCBmb3JtYnVpbGRlci5kb20ucGFydGlhbHMpO1xuXG5cbiAgICAgICAgICAgIGlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlci5hcHBlbmQodmlldykuaGlkZSgpLmZhZGVJbihjb25zdHMuQU5JTUFUSU9OX0ZBU1QpO1xuXG5cbiAgICAgICAgICAgIC8vLy90b2RvIG1vdmUgdGhpcyBpbiBtb3VzZWRvd24/XG4gICAgICAgICAgICAvLy8vZm9yIGdyb3VwIG5lc3RlZCBpbiBhIGJyYW5jaCwgZW5hYmxlIGtleXVwIHRvIGNoZWNrIGZvciB2YWxpZGF0aW9uIG9mIGhlYWRlciB0ZXh0XG4gICAgICAgICAgICAvL2lmIChicmFuY2hfaW5wdXQudHlwZSA9PT0gY29uc3RzLkdST1VQX1RZUEUpIHtcbiAgICAgICAgICAgIC8vICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzLm9mZigna2V5dXAnKS5vbigna2V5dXAnLCAnaW5wdXQnLCBpbnB1dF9wcm9wZXJ0aWVzX2tleXVwX2NhbGxiYWNrKTtcbiAgICAgICAgICAgIC8vfVxuICAgICAgICAgICAgLy9lbHNlIHtcbiAgICAgICAgICAgIC8vICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzLm9mZigna2V5dXAnKTtcbiAgICAgICAgICAgIC8vfVxuICAgICAgICB9XG4gICAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSB1aTtcbiIsIid1c2Ugc3RyaWN0JztcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcblxudmFyIHV0aWxzID0ge1xuXG4gICAgLy9mcm9tIE1ETlxuICAgIEpTT05Qb2x5ZmlsbDoge1xuICAgICAgICBwYXJzZTogZnVuY3Rpb24gKHNKU09OKSB7XG4gICAgICAgICAgICByZXR1cm4gZXZhbCgnKCcgKyBzSlNPTiArICcpJyk7XG4gICAgICAgIH0sXG4gICAgICAgIHN0cmluZ2lmeTogKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciB0b1N0cmluZyA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmc7XG4gICAgICAgICAgICB2YXIgaXNBcnJheSA9IEFycmF5LmlzQXJyYXkgfHwgZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdG9TdHJpbmcuY2FsbChhKSA9PT0gJ1tvYmplY3QgQXJyYXldJztcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2YXIgZXNjTWFwID0ge1xuICAgICAgICAgICAgICAgICdcIic6ICdcXFxcXCInLFxuICAgICAgICAgICAgICAgICdcXFxcJzogJ1xcXFxcXFxcJyxcbiAgICAgICAgICAgICAgICAnXFxiJzogJ1xcXFxiJyxcbiAgICAgICAgICAgICAgICAnXFxmJzogJ1xcXFxmJyxcbiAgICAgICAgICAgICAgICAnXFxuJzogJ1xcXFxuJyxcbiAgICAgICAgICAgICAgICAnXFxyJzogJ1xcXFxyJyxcbiAgICAgICAgICAgICAgICAnXFx0JzogJ1xcXFx0J1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZhciBlc2NGdW5jID0gZnVuY3Rpb24gKG0pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZXNjTWFwW21dIHx8ICdcXFxcdScgKyAobS5jaGFyQ29kZUF0KDApICsgMHgxMDAwMCkudG9TdHJpbmcoMTYpLnN1YnN0cigxKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2YXIgZXNjUkUgPSAvW1xcXFxcIlxcdTAwMDAtXFx1MDAxRlxcdTIwMjhcXHUyMDI5XS9nO1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIHN0cmluZ2lmeSh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAnbnVsbCc7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpc0Zpbml0ZSh2YWx1ZSkgPyB2YWx1ZS50b1N0cmluZygpIDogJ251bGwnO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHZhbHVlID09PSAnYm9vbGVhbicpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUudG9KU09OID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3RyaW5naWZ5KHZhbHVlLnRvSlNPTigpKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpc0FycmF5KHZhbHVlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlcyA9ICdbJztcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdmFsdWUubGVuZ3RoOyBpKyspXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzICs9IChpID8gJywgJyA6ICcnKSArIHN0cmluZ2lmeSh2YWx1ZVtpXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzICsgJ10nO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRvU3RyaW5nLmNhbGwodmFsdWUpID09PSAnW29iamVjdCBPYmplY3RdJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRtcCA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgayBpbiB2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZS5oYXNPd25Qcm9wZXJ0eShrKSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG1wLnB1c2goc3RyaW5naWZ5KGspICsgJzogJyArIHN0cmluZ2lmeSh2YWx1ZVtrXSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICd7JyArIHRtcC5qb2luKCcsICcpICsgJ30nO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiAnXCInICsgdmFsdWUudG9TdHJpbmcoKS5yZXBsYWNlKGVzY1JFLCBlc2NGdW5jKSArICdcIic7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9KSgpXG4gICAgfSxcbiAgICAvL2h0dHBzOi8vZ29vLmdsL3g0amNTXG4gICAgaXNTYWZhcmk6IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh3aW5kb3cuSFRNTEVsZW1lbnQpLmluZGV4T2YoJ0NvbnN0cnVjdG9yJykgPiAwIHx8IChmdW5jdGlvbiAocCkge1xuICAgICAgICByZXR1cm4gcC50b1N0cmluZygpID09PSAnW29iamVjdCBTYWZhcmlSZW1vdGVOb3RpZmljYXRpb25dJztcbiAgICB9KSghd2luZG93LnNhZmFyaSB8fCBzYWZhcmkucHVzaE5vdGlmaWNhdGlvbiksXG5cbiAgICBnZXRDb250YWluZXJzUGF0aDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gY29uc3RzLlZJRVdTX1BBVEggKyAnY29udGFpbmVycy8nO1xuICAgIH0sXG5cbiAgICBnZXRQcm9wZXJ0aWVzUGF0aDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gY29uc3RzLlZJRVdTX1BBVEggKyAncHJvcGVydGllcy8nO1xuICAgIH0sXG5cbiAgICBnZXRQYXJ0aWFsc1BhdGg6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIGNvbnN0cy5WSUVXU19QQVRIICsgJ3BhcnRpYWxzLyc7XG4gICAgfSxcblxuICAgIC8vZ28gYmFjayB0byBwcm9qZWN0IGRldGFpbHMgcGFnZSAod2hlbiBpbnNpZGUgRXBpY29sbGVjdDUgTGFyYXZlbClcbiAgICBnb0JhY2s6IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICB2YXIgaHJlZiA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmO1xuICAgICAgICAvL2JvdGggaHR0cCBhbmQgaHR0cHNcbiAgICAgICAgdmFyIHByb3RvY29sID0gd2luZG93LmxvY2F0aW9uLnByb3RvY29sO1xuICAgICAgICB2YXIgcGFydHMgPSBocmVmLnJlcGxhY2UocHJvdG9jb2wgKyAnLy8nLCAnJykuc3BsaXQoJy8nKTtcbiAgICAgICAgdmFyIGxhc3QgPSBwYXJ0cy5wb3AoKTtcbiAgICAgICAgdmFyIGJhY2tfaHJlZiA9IHBhcnRzLmpvaW4oJy8nKTtcblxuICAgICAgICAvL3N0YW5kYWxvbmUgbW9kZSBmb3IgdGVzdGluZyBmcm9tIGxvY2FsaG9zdD9cbiAgICAgICAgaWYgKGxhc3QuaW5kZXhPZignZm9ybWJ1aWxkZXInKSAhPT0gLTEpIHtcbiAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZXBsYWNlKHByb3RvY29sICsgJy8vJyArIGJhY2tfaHJlZik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLy9wcm9qZWN0X3JlZiBpcyBkZWZpbmVkIG9uIHRoZSBzZXJ2ZXIsIGFuZCBpdCBpcyB1bmlxdWUgc2VydmVyIHdpc2VcbiAgICBzZXRQcm9qZWN0VVJMOiBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgdmFyIGRvbWFpbjtcbiAgICAgICAgdmFyIHBhdGg7XG4gICAgICAgIHZhciBzbHVnO1xuICAgICAgICB2YXIgaHJlZiA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmO1xuICAgICAgICB2YXIgcHJvdG9jb2wgPSB3aW5kb3cubG9jYXRpb24ucHJvdG9jb2w7XG4gICAgICAgIHZhciBwYXJ0cyA9IGhyZWYucmVwbGFjZShwcm90b2NvbCArICcvLycsICcnKS5zcGxpdCgnLycpO1xuICAgICAgICB2YXIgc3VicGF0aDtcblxuICAgICAgICBjb25zb2xlLmxvZygncGFydHNbMF0nLCBwYXJ0c1swXSk7XG5cbiAgICAgICAgLy9zdGFuZGFsb25lIG1vZGUgZm9yIHRlc3RpbmcgZnJvbSBsb2NhbGhvc3Q/XG4gICAgICAgIGlmIChwYXJ0c1swXS5pbmRleE9mKCdsb2NhbGhvc3QnKSAhPT0gLTEgfHwgcGFydHNbMF0uaW5kZXhPZignbmdyb2snKSkge1xuXG4gICAgICAgICAgICAvL2lzIHN0YW5kYWxvbmUgZm9ybWJ1aWxkZXI/XG4gICAgICAgICAgICBpZiAocGFydHMuaW5kZXhPZignZXBpY29sbGVjdDUtZm9ybWJ1aWxkZXInKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICBidWlsZExvY2FsUGF0aCgpOy8vdGVzdGluZyBsb2NhbGx5LCBjb3B5aW5nIHRoZSBqc29uIGludG8gcHJvamVjdC5qc29uXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAvL2l0IGlzIGEgbG9jYWwgaW5zdGFsbGF0aW9uIG9mIExhcmF2ZWxcbiAgICAgICAgICAgICAgICBidWlsZExhcmF2ZWxQYXRoKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvL2xhcmF2ZWwgc2VydmVyXG4gICAgICAgICAgICBidWlsZExhcmF2ZWxQYXRoKCk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhjb25zdHMuUFJPSkVDVF9VUkwpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gYnVpbGRMYXJhdmVsUGF0aCgpIHtcblxuICAgICAgICAgICAgc2x1ZyA9IHBhcnRzW3BhcnRzLmxlbmd0aCAtIDJdO1xuICAgICAgICAgICAgcGFydHMuc3BsaWNlKHBhcnRzLmxlbmd0aCAtIDMsIDMpO1xuICAgICAgICAgICAgZG9tYWluID0gcHJvdG9jb2wgKyAnLy8nICsgcGFydHMuam9pbignLycpICsgJy8nO1xuXG4gICAgICAgICAgICBwYXRoID0gY29uc3RzLkFQSV9QUk9EVUNUSU9OX1BBVEg7XG4gICAgICAgICAgICBjb25zdHMuUFJPSkVDVF9VUkwgPSBkb21haW4gKyBwYXRoICsgc2x1ZztcblxuICAgICAgICAgICAgLy9kbyB0aGlzIGZvciBMYXJhdmVsIGludGVncmF0aW9uXG4gICAgICAgICAgICAvL3JlbW92ZSBkb21haW4gKGZpcnN0IGVsZW1lbnQpXG4gICAgICAgICAgICBwYXJ0cy5zaGlmdCgpO1xuICAgICAgICAgICAgaWYgKHBhcnRzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBzdWJwYXRoID0gcGFydHMuam9pbignLycpO1xuICAgICAgICAgICAgICAgIGNvbnN0cy5WSUVXU19QQVRIID0gJy8nICsgc3VicGF0aCArICcvJyArIGNvbnN0cy5WSUVXU19QQVRIO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3RzLlZJRVdTX1BBVEggPSAnLycgKyBjb25zdHMuVklFV1NfUEFUSDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGJ1aWxkTG9jYWxQYXRoKCkge1xuICAgICAgICAgICAgY29uc3RzLlBST0pFQ1RfVVJMID0gY29uc3RzLkFQSV9ERVZFTE9QTUVOVF9HRVRfUEFUSCArIGNvbnN0cy5BUElfREVWRUxPUE1FTlRfUFJPSkVDVDtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBzZXRQcm9qZWN0TG9nb1VybDogZnVuY3Rpb24gKCkge1xuICAgICAgICBjb25zb2xlLmxvZygnaHJlZiA9PicgKyB3aW5kb3cubG9jYXRpb24uaHJlZik7XG4gICAgICAgIHZhciBkb21haW47XG4gICAgICAgIHZhciBwYXRoO1xuICAgICAgICB2YXIgc2x1ZztcbiAgICAgICAgdmFyIGhyZWYgPSB3aW5kb3cubG9jYXRpb24uaHJlZjtcbiAgICAgICAgdmFyIHByb3RvY29sID0gd2luZG93LmxvY2F0aW9uLnByb3RvY29sO1xuICAgICAgICB2YXIgcGFydHMgPSBocmVmLnJlcGxhY2UocHJvdG9jb2wgKyAnLy8nLCAnJykuc3BsaXQoJy8nKTtcblxuICAgICAgICBzbHVnID0gcGFydHNbcGFydHMubGVuZ3RoIC0gMl07XG4gICAgICAgIHBhcnRzLnNwbGljZShwYXJ0cy5sZW5ndGggLSAzLCAzKTtcbiAgICAgICAgZG9tYWluID0gd2luZG93LmxvY2F0aW9uLnByb3RvY29sICsgJy8vJyArIHBhcnRzLmpvaW4oJy8nKSArICcvJztcblxuICAgICAgICBwYXRoID0gY29uc3RzLkFQSV9NRURJQV9QQVRIO1xuICAgICAgICBjb25zdHMuUFJPSkVDVF9MT0dPX1VSTCA9IGRvbWFpbiArIHBhdGggKyBzbHVnICsgY29uc3RzLkFQSV9QUk9KRUNUX0xPR09fUVVFUllfU1RSSU5HO1xuXG5cbiAgICAgICAgY29uc29sZS5sb2coY29uc3RzLlBST0pFQ1RfTE9HT19VUkwpO1xuICAgIH0sXG5cbiAgICAvL3dlIGdlbmVyYXRlIHRoZSByZWZzIGFwcGVuZGluZyBhIHVuaXFpZCBwZXIgZWFjaCBsZXZlbFxuICAgIC8vZm9ybSAtIGlucHV0IC0gYnJhbmNoX2lucHV0IC0gZ3JvdXBfaW5wdXRcbiAgICBnZW5lcmF0ZUZvcm1SZWY6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbi5kYXRhLnByb2plY3QucmVmICsgJ18nICsgdGhpcy5nZW5lcmF0ZVVuaXFJRCgpO1xuICAgIH0sXG5cbiAgICAvL2lucHV0IHJlZiBjb25zaXN0cyBvZiBmb3JtX3JlZiArIGlucHV0X3JlZlxuICAgIGdlbmVyYXRlSW5wdXRSZWY6IGZ1bmN0aW9uIChmb3JtX3JlZikge1xuICAgICAgICByZXR1cm4gZm9ybV9yZWYgKyAnXycgKyB0aGlzLmdlbmVyYXRlVW5pcUlEKCk7XG4gICAgfSxcblxuICAgIGdlbmVyYXRlSW5wdXRDb3B5UmVmOiBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgdmFyIHJlZjtcbiAgICAgICAgLy90b3AgbGV2ZWwgaW5wdXQ/XG4gICAgICAgIGlmICghZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19icmFuY2ggJiYgIWZvcm1idWlsZGVyLmlzX2VkaXRpbmdfZ3JvdXApIHtcbiAgICAgICAgICAgIHJlZiA9IHV0aWxzLmdlbmVyYXRlSW5wdXRSZWYoZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX3JlZik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfYnJhbmNoICYmIGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfZ3JvdXApIHtcbiAgICAgICAgICAgIC8vZ2VuZXJhdGUgbmVzdGVkIGdyb3VwIGlucHV0IHJlZiAocGFzc2luZyBhY3RpdmUgYnJhbmNoIGlucHV0IHJlZilcbiAgICAgICAgICAgIHJlZiA9IHV0aWxzLmdlbmVyYXRlQnJhbmNoR3JvdXBJbnB1dFJlZihmb3JtYnVpbGRlci5icmFuY2guY3VycmVudF9pbnB1dF9yZWYpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaWYgKGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfYnJhbmNoKSB7XG4gICAgICAgICAgICAgICAgLy9nZW5lcmF0ZWQgYnJhbmNoIGlucHV0IHJlZlxuICAgICAgICAgICAgICAgIHJlZiA9IHV0aWxzLmdlbmVyYXRlQnJhbmNoR3JvdXBJbnB1dFJlZihmb3JtYnVpbGRlci5icmFuY2guYWN0aXZlX2JyYW5jaF9yZWYpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfZ3JvdXApIHtcbiAgICAgICAgICAgICAgICAvL2dlbmVyYXRlIGdyb3VwIHJlZlxuICAgICAgICAgICAgICAgIHJlZiA9IHV0aWxzLmdlbmVyYXRlQnJhbmNoR3JvdXBJbnB1dFJlZihmb3JtYnVpbGRlci5ncm91cC5hY3RpdmVfZ3JvdXBfcmVmKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVmO1xuICAgIH0sXG5cbiAgICAvL2ZvciBicmFuY2ggYW5kIGdyb3Vwcywgd2UgYXBwZW5kIHRoZSB1bmlxdWUgSUQgdG8gdGhlIGlucHV0IChuZXN0aW5nIGEgbGV2ZWwgbW9yZSlcbiAgICAvL2EgbmVzdGVkIGdyb3VwIHdpbGwgYmUgMiBsZXZlbHMgbmVzdGVkXG4gICAgZ2VuZXJhdGVCcmFuY2hHcm91cElucHV0UmVmOiBmdW5jdGlvbiAoaW5wdXRfcmVmKSB7XG4gICAgICAgIHJldHVybiBpbnB1dF9yZWYgKyAnXycgKyB0aGlzLmdlbmVyYXRlVW5pcUlEKCk7XG4gICAgfSxcbiAgICAvL2dlbmVyYXRlIFBIUCB0eXBlIHVuaXFpZCB0byBiZSBhcHBlbmRlZCB0byBmb3JtLCBpbnB1dHMsIGJyYW5jaCBhbmQgZ3JvdXBzXG4gICAgZ2VuZXJhdGVVbmlxSUQ6IGZ1bmN0aW9uIChwcmVmaXgsIG1vcmVfZW50cm9weSkge1xuICAgICAgICBpZiAodHlwZW9mIHByZWZpeCA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgIHByZWZpeCA9ICcnO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHJldElkO1xuICAgICAgICB2YXIgZm9ybWF0U2VlZCA9IGZ1bmN0aW9uIChzZWVkLCByZXFXaWR0aCkge1xuICAgICAgICAgICAgc2VlZCA9IHBhcnNlSW50KHNlZWQsIDEwKVxuICAgICAgICAgICAgICAgIC50b1N0cmluZygxNik7IC8vIHRvIGhleCBzdHJcbiAgICAgICAgICAgIGlmIChyZXFXaWR0aCA8IHNlZWQubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgLy8gc28gbG9uZyB3ZSBzcGxpdFxuICAgICAgICAgICAgICAgIHJldHVybiBzZWVkLnNsaWNlKHNlZWQubGVuZ3RoIC0gcmVxV2lkdGgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHJlcVdpZHRoID4gc2VlZC5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAvLyBzbyBzaG9ydCB3ZSBwYWRcbiAgICAgICAgICAgICAgICByZXR1cm4gQXJyYXkoMSArIChyZXFXaWR0aCAtIHNlZWQubGVuZ3RoKSlcbiAgICAgICAgICAgICAgICAgICAgLmpvaW4oJzAnKSArIHNlZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gc2VlZDtcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBCRUdJTiBSRURVTkRBTlRcbiAgICAgICAgaWYgKCF0aGlzLnBocF9qcykge1xuICAgICAgICAgICAgdGhpcy5waHBfanMgPSB7fTtcbiAgICAgICAgfVxuICAgICAgICAvLyBFTkQgUkVEVU5EQU5UXG4gICAgICAgIGlmICghdGhpcy5waHBfanMudW5pcWlkU2VlZCkge1xuICAgICAgICAgICAgLy8gaW5pdCBzZWVkIHdpdGggYmlnIHJhbmRvbSBpbnRcbiAgICAgICAgICAgIHRoaXMucGhwX2pzLnVuaXFpZFNlZWQgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAweDc1YmNkMTUpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucGhwX2pzLnVuaXFpZFNlZWQrKztcblxuICAgICAgICAvLyBzdGFydCB3aXRoIHByZWZpeCwgYWRkIGN1cnJlbnQgbWlsbGlzZWNvbmRzIGhleCBzdHJpbmdcbiAgICAgICAgcmV0SWQgPSBwcmVmaXg7XG4gICAgICAgIHJldElkICs9IGZvcm1hdFNlZWQocGFyc2VJbnQobmV3IERhdGUoKVxuICAgICAgICAgICAgLmdldFRpbWUoKSAvIDEwMDAsIDEwKSwgOCk7XG4gICAgICAgIC8vIGFkZCBzZWVkIGhleCBzdHJpbmdcbiAgICAgICAgcmV0SWQgKz0gZm9ybWF0U2VlZCh0aGlzLnBocF9qcy51bmlxaWRTZWVkLCA1KTtcbiAgICAgICAgaWYgKG1vcmVfZW50cm9weSkge1xuICAgICAgICAgICAgLy8gZm9yIG1vcmUgZW50cm9weSB3ZSBhZGQgYSBmbG9hdCBsb3dlciB0byAxMFxuICAgICAgICAgICAgcmV0SWQgKz0gKE1hdGgucmFuZG9tKCkgKiAxMClcbiAgICAgICAgICAgICAgICAudG9GaXhlZCg4KVxuICAgICAgICAgICAgICAgIC50b1N0cmluZygpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHJldElkO1xuICAgIH0sXG5cbiAgICAvL2ZpbmQgZHVwbGljYXRlcyBpbiBhcnJheVxuICAgIGhhc0R1cGxpY2F0ZXM6IGZ1bmN0aW9uIChhcnJheSkge1xuICAgICAgICB2YXIgdmFsdWVzU29GYXIgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnJheS5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgdmFyIHZhbHVlID0gYXJyYXlbaV07XG4gICAgICAgICAgICBpZiAodmFsdWVzU29GYXIuaW5kZXhPZih2YWx1ZSkgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YWx1ZXNTb0Zhci5wdXNoKHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSxcblxuICAgIGdldElucHV0Q3VycmVudEluZGV4QnlSZWY6IGZ1bmN0aW9uICh0aGVfcmVmKSB7XG5cbiAgICAgICAgdmFyIGlucHV0cyA9IGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbi5kYXRhLnByb2plY3QuZm9ybXNbZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4XS5pbnB1dHM7XG4gICAgICAgIHZhciBpO1xuICAgICAgICB2YXIgaUxlbmd0aCA9IGlucHV0cy5sZW5ndGg7XG5cbiAgICAgICAgZm9yIChpID0gMDsgaSA8IGlMZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKGlucHV0c1tpXS5yZWYgPT09IHRoZV9yZWYpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBnZXRCcmFuY2hJbnB1dEN1cnJlbnRJbmRleEJ5UmVmOiBmdW5jdGlvbiAodGhlX293bmVyX2lucHV0X2luZGV4LCB0aGVfYnJhbmNoX2lucHV0X3JlZikge1xuXG4gICAgICAgIHZhciBicmFuY2hfaW5wdXRzID0gZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uLmRhdGEucHJvamVjdC5mb3Jtc1tmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXhdLmlucHV0c1t0aGVfb3duZXJfaW5wdXRfaW5kZXhdLmJyYW5jaDtcbiAgICAgICAgdmFyIGZvdW5kID0gLTE7XG5cbiAgICAgICAgJChicmFuY2hfaW5wdXRzKS5lYWNoKGZ1bmN0aW9uIChpbmRleCwgYnJhbmNoX2lucHV0KSB7XG4gICAgICAgICAgICBpZiAoYnJhbmNoX2lucHV0LnJlZiA9PT0gdGhlX2JyYW5jaF9pbnB1dF9yZWYpIHtcbiAgICAgICAgICAgICAgICBmb3VuZCA9IGluZGV4O1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBmb3VuZDtcbiAgICB9LFxuXG4gICAgZ2V0R3JvdXBJbnB1dEN1cnJlbnRJbmRleEJ5UmVmOiBmdW5jdGlvbiAodGhlX293bmVyX2lucHV0X2luZGV4LCB0aGVfZ3JvdXBfaW5wdXRfcmVmKSB7XG5cbiAgICAgICAgdmFyIGdyb3VwX2lucHV0cyA9IGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbi5kYXRhLnByb2plY3QuZm9ybXNbZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4XS5pbnB1dHNbdGhlX293bmVyX2lucHV0X2luZGV4XS5ncm91cDtcbiAgICAgICAgdmFyIGZvdW5kID0gLTE7XG5cbiAgICAgICAgJChncm91cF9pbnB1dHMpLmVhY2goZnVuY3Rpb24gKGluZGV4LCBicmFuY2hfaW5wdXQpIHtcbiAgICAgICAgICAgIGlmIChicmFuY2hfaW5wdXQucmVmID09PSB0aGVfZ3JvdXBfaW5wdXRfcmVmKSB7XG4gICAgICAgICAgICAgICAgZm91bmQgPSBpbmRleDtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gZm91bmQ7XG4gICAgfSxcblxuICAgIGdldElucHV0T2JqZWN0QnlSZWY6IGZ1bmN0aW9uICh0aGVfcmVmKSB7XG5cbiAgICAgICAgdmFyIGlucHV0cyA9IGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbi5kYXRhLnByb2plY3QuZm9ybXNbZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4XS5pbnB1dHM7XG4gICAgICAgIHZhciBpO1xuICAgICAgICB2YXIgaUxlbmd0aCA9IGlucHV0cy5sZW5ndGg7XG5cbiAgICAgICAgaWYgKHRoZV9yZWYgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgZm9yIChpID0gMDsgaSA8IGlMZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKGlucHV0c1tpXS5yZWYgPT09IHRoZV9yZWYpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaW5wdXRzW2ldO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICB9LFxuXG4gICAgZ2V0QnJhbmNoSW5wdXRPYmplY3RCeVJlZjogZnVuY3Rpb24gKHRoZV9yZWYpIHtcblxuICAgICAgICB2YXIgaW5wdXRzID0gZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uLmRhdGEucHJvamVjdC5mb3Jtc1tmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXhdLmlucHV0cztcbiAgICAgICAgdmFyIG93bmVyX2lucHV0X2luZGV4ID0gdXRpbHMuZ2V0SW5wdXRDdXJyZW50SW5kZXhCeVJlZihmb3JtYnVpbGRlci5jdXJyZW50X2lucHV0X3JlZik7XG4gICAgICAgIHZhciBicmFuY2hfaW5wdXRzID0gaW5wdXRzW293bmVyX2lucHV0X2luZGV4XS5icmFuY2g7XG4gICAgICAgIHZhciBmb3VuZDtcblxuICAgICAgICBpZiAodGhlX3JlZiAhPT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICQoYnJhbmNoX2lucHV0cykuZWFjaChmdW5jdGlvbiAoaW5kZXgsIGlucHV0KSB7XG4gICAgICAgICAgICAgICAgaWYgKGlucHV0LnJlZiA9PT0gdGhlX3JlZikge1xuICAgICAgICAgICAgICAgICAgICBmb3VuZCA9IGlucHV0O1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZm91bmQ7XG4gICAgfSxcblxuICAgIGdldE5lc3RlZEdyb3VwSW5wdXRPYmplY3RCeVJlZjogZnVuY3Rpb24gKHRoZV9vd25lcl9icmFuY2gsIHRoZV9jdXJyZW50X25lc3RlZF9ncm91cF9pbnB1dF9yZWYpIHtcblxuICAgICAgICB2YXIgcmVmID0gdGhlX2N1cnJlbnRfbmVzdGVkX2dyb3VwX2lucHV0X3JlZjtcbiAgICAgICAgdmFyIG93bmVyX2JyYW5jaCA9IHRoZV9vd25lcl9icmFuY2g7XG4gICAgICAgIHZhciBvd25lcl9ncm91cF9yZWYgPSBmb3JtYnVpbGRlci5ncm91cC5hY3RpdmVfZ3JvdXBfcmVmO1xuXG4gICAgICAgIHZhciBmb3VuZDtcblxuICAgICAgICAkKG93bmVyX2JyYW5jaC5icmFuY2gpLmVhY2goZnVuY3Rpb24gKGluZGV4LCBicmFuY2hfaW5wdXQpIHtcblxuICAgICAgICAgICAgLy9nZXQgdGhlIG5lc3RlZCBncm91cFxuICAgICAgICAgICAgaWYgKGJyYW5jaF9pbnB1dC5yZWYgPT09IG93bmVyX2dyb3VwX3JlZikge1xuXG4gICAgICAgICAgICAgICAgLy9mb3IgZWFjaCBuZXN0ZWQgZ3JvdXAgaW5wdXRzLCBsb29rIGZvciB0aGUgb25lIHdlIGFyZSBsb29raW5nIGZvclxuICAgICAgICAgICAgICAgICQoYnJhbmNoX2lucHV0Lmdyb3VwKS5lYWNoKGZ1bmN0aW9uIChpbmRleCwgbmVzdGVkX2dyb3VwX2lucHV0KSB7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKG5lc3RlZF9ncm91cF9pbnB1dC5yZWYgPT09IHJlZikge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm91bmQgPSBuZXN0ZWRfZ3JvdXBfaW5wdXQ7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIGlmIChmb3VuZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGZvdW5kO1xuICAgIH0sXG5cbiAgICBnZXROZXN0ZWRHcm91cElucHV0Q3VycmVudEluZGV4QnlSZWY6IGZ1bmN0aW9uICh0aGVfb3duZXJfYnJhbmNoLCB0aGVfY3VycmVudF9uZXN0ZWRfZ3JvdXBfaW5wdXRfcmVmKSB7XG5cbiAgICAgICAgdmFyIHJlZiA9IHRoZV9jdXJyZW50X25lc3RlZF9ncm91cF9pbnB1dF9yZWY7XG4gICAgICAgIHZhciBvd25lcl9icmFuY2ggPSB0aGVfb3duZXJfYnJhbmNoO1xuICAgICAgICB2YXIgb3duZXJfZ3JvdXBfcmVmID0gZm9ybWJ1aWxkZXIuZ3JvdXAuYWN0aXZlX2dyb3VwX3JlZjtcblxuICAgICAgICB2YXIgZm91bmQ7XG5cbiAgICAgICAgJChvd25lcl9icmFuY2guYnJhbmNoKS5lYWNoKGZ1bmN0aW9uIChpbmRleCwgYnJhbmNoX2lucHV0KSB7XG5cbiAgICAgICAgICAgIC8vZ2V0IHRoZSBuZXN0ZWQgZ3JvdXBcbiAgICAgICAgICAgIGlmIChicmFuY2hfaW5wdXQucmVmID09PSBvd25lcl9ncm91cF9yZWYpIHtcblxuICAgICAgICAgICAgICAgIC8vZm9yIGVhY2ggbmVzdGVkIGdyb3VwIGlucHV0cywgbG9vayBmb3IgdGhlIG9uZSB3ZSBhcmUgbG9va2luZyBmb3JcbiAgICAgICAgICAgICAgICAkKGJyYW5jaF9pbnB1dC5ncm91cCkuZWFjaChmdW5jdGlvbiAoZ3JvdXBfaW5kZXgsIG5lc3RlZF9ncm91cF9pbnB1dCkge1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChuZXN0ZWRfZ3JvdXBfaW5wdXQucmVmID09PSByZWYpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvdW5kID0gZ3JvdXBfaW5kZXg7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIGlmIChmb3VuZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGZvdW5kO1xuICAgIH0sXG5cbiAgICBnZXRHcm91cElucHV0T2JqZWN0QnlSZWY6IGZ1bmN0aW9uICh0aGVfcmVmKSB7XG5cbiAgICAgICAgdmFyIGlucHV0cyA9IGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbi5kYXRhLnByb2plY3QuZm9ybXNbZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4XS5pbnB1dHM7XG4gICAgICAgIHZhciBvd25lcl9pbnB1dF9pbmRleCA9IHV0aWxzLmdldElucHV0Q3VycmVudEluZGV4QnlSZWYoZm9ybWJ1aWxkZXIuY3VycmVudF9pbnB1dF9yZWYpO1xuICAgICAgICB2YXIgZ3JvdXBfaW5wdXRzID0gaW5wdXRzW293bmVyX2lucHV0X2luZGV4XS5ncm91cDtcbiAgICAgICAgdmFyIGZvdW5kO1xuXG4gICAgICAgIGlmICh0aGVfcmVmICE9PSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgJChncm91cF9pbnB1dHMpLmVhY2goZnVuY3Rpb24gKGluZGV4LCBpbnB1dCkge1xuICAgICAgICAgICAgICAgIGlmIChpbnB1dC5yZWYgPT09IHRoZV9yZWYpIHtcbiAgICAgICAgICAgICAgICAgICAgZm91bmQgPSBpbnB1dDtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGZvdW5kO1xuICAgIH0sXG5cbiAgICBnZXROZXN0ZWRHcm91cE9iamVjdEJ5UmVmOiBmdW5jdGlvbiAob3duZXJfYnJhbmNoLCBuZXN0ZWRfZ3JvdXBfcmVmKSB7XG5cbiAgICAgICAgdmFyIGZvdW5kO1xuXG4gICAgICAgICQob3duZXJfYnJhbmNoLmJyYW5jaCkuZWFjaChmdW5jdGlvbiAoaW5kZXgsIGJyYW5jaF9pbnB1dCkge1xuXG4gICAgICAgICAgICAvL2dldCB0aGUgbmVzdGVkIGdyb3VwXG4gICAgICAgICAgICBpZiAoYnJhbmNoX2lucHV0LnJlZiA9PT0gbmVzdGVkX2dyb3VwX3JlZikge1xuICAgICAgICAgICAgICAgIGZvdW5kID0gYnJhbmNoX2lucHV0O1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIGZvdW5kO1xuICAgIH0sXG5cbiAgICAvL3Bhc3NpbmcgaW4gYSBicmFuY2ggaW5wdXQgcmVmLCByZW1vdmluZyB0aGUgbGFzdCBgX3VuaXFpZGAgd2UgaGF2ZSB0aGUgaW5wdXQgcmVmIHRoYXQgYnJhbmNoIGJlbG9uZyB0b1xuICAgIGdldEJyYW5jaE93bmVySW5wdXRSZWY6IGZ1bmN0aW9uICh0aGVfYnJhbmNoX2lucHV0X3JlZikge1xuXG4gICAgICAgIHZhciBwYXJ0cyA9IHRoZV9icmFuY2hfaW5wdXRfcmVmLnNwbGl0KCdfJyk7XG5cbiAgICAgICAgcGFydHMucG9wKCk7XG5cbiAgICAgICAgcmV0dXJuIHBhcnRzLmpvaW4oJ18nKTtcbiAgICB9LFxuXG4gICAgLy9wYXNzaW5nIGluIGEgZ3JvdXAgaW5wdXQgcmVmLCByZW1vdmluZyB0aGUgbGFzdCBgX3VuaXFpZGAgd2UgaGF2ZSB0aGUgaW5wdXQgcmVmIHRoYXQgZ3JvdXAgYmVsb25nIHRvXG4gICAgZ2V0R3JvdXBPd25lcklucHV0UmVmOiBmdW5jdGlvbiAodGhlX2dyb3VwX2lucHV0X3JlZikge1xuXG4gICAgICAgIHZhciBwYXJ0cyA9IHRoZV9ncm91cF9pbnB1dF9yZWYuc3BsaXQoJ18nKTtcblxuICAgICAgICBwYXJ0cy5wb3AoKTtcblxuICAgICAgICByZXR1cm4gcGFydHMuam9pbignXycpO1xuICAgIH0sXG5cbiAgICBnZXRJbnB1dFRvb2xJY29uOiBmdW5jdGlvbiAodGhlX3R5cGUpIHtcblxuICAgICAgICB2YXIgaWNvbjtcblxuICAgICAgICBzd2l0Y2ggKHRoZV90eXBlKSB7XG4gICAgICAgICAgICBjYXNlIGNvbnN0cy5BVURJT19UWVBFOlxuICAgICAgICAgICAgICAgIGljb24gPSBjb25zdHMuQVVESU9fVFlQRV9JQ09OO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBjb25zdHMuQkFSQ09ERV9UWVBFOlxuICAgICAgICAgICAgICAgIGljb24gPSBjb25zdHMuQkFSQ09ERV9UWVBFX0lDT047XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGNvbnN0cy5CUkFOQ0hfVFlQRTpcbiAgICAgICAgICAgICAgICBpY29uID0gY29uc3RzLkJSQU5DSF9UWVBFX0lDT047XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGNvbnN0cy5DSEVDS0JPWF9UWVBFOlxuICAgICAgICAgICAgICAgIGljb24gPSBjb25zdHMuQ0hFQ0tCT1hfVFlQRV9JQ09OO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBjb25zdHMuREFURV9UWVBFOlxuICAgICAgICAgICAgICAgIGljb24gPSBjb25zdHMuREFURV9UWVBFX0lDT047XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGNvbnN0cy5EUk9QRE9XTl9UWVBFOlxuICAgICAgICAgICAgICAgIGljb24gPSBjb25zdHMuRFJPUERPV05fVFlQRV9JQ09OO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBjb25zdHMuR1JPVVBfVFlQRTpcbiAgICAgICAgICAgICAgICBpY29uID0gY29uc3RzLkdST1VQX1RZUEVfSUNPTjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgY29uc3RzLkxPQ0FUSU9OX1RZUEU6XG4gICAgICAgICAgICAgICAgaWNvbiA9IGNvbnN0cy5MT0NBVElPTl9UWVBFX0lDT047XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGNvbnN0cy5JTlRFR0VSX1RZUEU6XG4gICAgICAgICAgICAgICAgaWNvbiA9IGNvbnN0cy5OVU1FUklDX1RZUEVfSUNPTjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgY29uc3RzLkRFQ0lNQUxfVFlQRTpcbiAgICAgICAgICAgICAgICBpY29uID0gY29uc3RzLk5VTUVSSUNfVFlQRV9JQ09OO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBjb25zdHMuUEhPTkVfVFlQRTpcbiAgICAgICAgICAgICAgICBpY29uID0gY29uc3RzLlBIT05FX1RZUEVfSUNPTjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgY29uc3RzLlBIT1RPX1RZUEU6XG4gICAgICAgICAgICAgICAgaWNvbiA9IGNvbnN0cy5QSE9UT19UWVBFX0lDT047XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGNvbnN0cy5SQURJT19UWVBFOlxuICAgICAgICAgICAgICAgIGljb24gPSBjb25zdHMuUkFESU9fVFlQRV9JQ09OO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBjb25zdHMuUkVBRE1FX1RZUEU6XG4gICAgICAgICAgICAgICAgaWNvbiA9IGNvbnN0cy5SRUFETUVfVFlQRV9JQ09OO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBjb25zdHMuVEVYVF9UWVBFOlxuICAgICAgICAgICAgICAgIGljb24gPSBjb25zdHMuVEVYVF9UWVBFX0lDT047XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGNvbnN0cy5URVhUQVJFQV9UWVBFOlxuICAgICAgICAgICAgICAgIGljb24gPSBjb25zdHMuVEVYVEFSRUFfVFlQRV9JQ09OO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBjb25zdHMuVElNRV9UWVBFOlxuICAgICAgICAgICAgICAgIGljb24gPSBjb25zdHMuVElNRV9UWVBFX0lDT047XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGNvbnN0cy5WSURFT19UWVBFOlxuICAgICAgICAgICAgICAgIGljb24gPSBjb25zdHMuVklERU9fVFlQRV9JQ09OO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBjb25zdHMuU0VBUkNIX1NJTkdMRV9UWVBFOlxuICAgICAgICAgICAgICAgIGljb24gPSBjb25zdHMuU0VBUkNIX1NJTkdMRV9UWVBFX0lDT047XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGNvbnN0cy5TRUFSQ0hfTVVMVElQTEVfVFlQRTpcbiAgICAgICAgICAgICAgICBpY29uID0gY29uc3RzLlNFQVJDSF9NVUxUSVBMRV9UWVBFX0lDT047XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGljb247XG4gICAgfSxcblxuICAgIHNsdWdpZnk6IGZ1bmN0aW9uICh0ZXh0KSB7XG5cbiAgICAgICAgdmFyIHRyaW1tZWQgPSAkLnRyaW0odGV4dCk7XG4gICAgICAgIHZhciAkc2x1ZyA9IHRyaW1tZWQucmVwbGFjZSgvW15hLXowLTktXS9naSwgJy0nKS5yZXBsYWNlKC8tKy9nLCAnLScpLnJlcGxhY2UoL14tfC0kL2csICcnKTtcbiAgICAgICAgcmV0dXJuICRzbHVnLnRvTG93ZXJDYXNlKCk7XG4gICAgfSxcblxuICAgIC8vZ2V0IHRvdGFsIGlucHV0cyBkb3dubyB0byBhbCBsZXZlbHM6IGNvdW50aW5nIGFsc28gbmVzdGVkIGJyYW5jaCBpbnB1dHMgYW5kIGdyb3VwIGlucHV0c1xuICAgIGdldElucHV0c1RvdGFsOiBmdW5jdGlvbiAoaW5wdXRzKSB7XG5cbiAgICAgICAgdmFyIHRvdGFsID0gMDtcblxuICAgICAgICB0b3RhbCArPSBpbnB1dHMubGVuZ3RoO1xuXG4gICAgICAgICQoaW5wdXRzKS5lYWNoKGZ1bmN0aW9uIChpbmRleCwgaW5wdXQpIHtcbiAgICAgICAgICAgIGlmIChpbnB1dC50eXBlID09PSBjb25zdHMuR1JPVVBfVFlQRSkge1xuICAgICAgICAgICAgICAgIHRvdGFsICs9IGlucHV0Lmdyb3VwLmxlbmd0aDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChpbnB1dC50eXBlID09PSBjb25zdHMuQlJBTkNIX1RZUEUpIHtcbiAgICAgICAgICAgICAgICB0b3RhbCArPSBpbnB1dC5icmFuY2gubGVuZ3RoO1xuXG4gICAgICAgICAgICAgICAgLy90b2RvIGNvdW50IG5lc3RlZCBncm91cCBpbnB1dHMhXG4gICAgICAgICAgICAgICAgLy90b2RvXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gdG90YWw7XG4gICAgfSxcbiAgICAvL2dldCB0b3RhbCBpbnB1dHMgZG93biB0byBhbGwgbGV2ZWxzOiBjb3VudGluZyBhbHNvIG5lc3RlZCBicmFuY2ggaW5wdXRzIGFuZCBncm91cCBpbnB1dHNcbiAgICBnZXRTZWFyY2hJbnB1dHNUb3RhbDogZnVuY3Rpb24gKCkge1xuXG4gICAgICAgIHZhciB0b3RhbCA9IDA7XG4gICAgICAgIHZhciBmb3JtcyA9IGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbi5kYXRhLnByb2plY3QuZm9ybXM7XG5cbiAgICAgICAgJChmb3JtcykuZWFjaChmdW5jdGlvbiAoZm9ybUluZGV4LCBmb3JtKSB7XG5cbiAgICAgICAgICAgICQoZm9ybS5pbnB1dHMpLmVhY2goZnVuY3Rpb24gKGlucHV0SW5kZXgsIGlucHV0KSB7XG4gICAgICAgICAgICAgICAgLy9jb3VudCBhbGwgc2VhcmNoIGlucHV0IHR5cGVzXG4gICAgICAgICAgICAgICAgaWYgKGlucHV0LnR5cGUgPT09IGNvbnN0cy5TRUFSQ0hfTVVMVElQTEVfVFlQRSB8fCBpbnB1dC50eXBlID09PSBjb25zdHMuU0VBUkNIX1NJTkdMRV9UWVBFKSB7XG4gICAgICAgICAgICAgICAgICAgIHRvdGFsKys7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKGlucHV0LnR5cGUgPT09IGNvbnN0cy5HUk9VUF9UWVBFKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vY291bnQgYWxsIHNlYXJjaCBpbnB1dCB0eXBlcyBvZiBhIGdyb3VwXG4gICAgICAgICAgICAgICAgICAgICQoaW5wdXQuZ3JvdXApLmVhY2goZnVuY3Rpb24gKGdyb3VwSW5kZXgsIGdyb3VwSW5wdXQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChncm91cElucHV0LnR5cGUgPT09IGNvbnN0cy5TRUFSQ0hfTVVMVElQTEVfVFlQRSB8fCBncm91cElucHV0LnR5cGUgPT09IGNvbnN0cy5TRUFSQ0hfU0lOR0xFX1RZUEUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbCsrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudHlwZSA9PT0gY29uc3RzLkJSQU5DSF9UWVBFKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vY291bnQgYWxsIHNlYXJjaCBpbnB1dCB0eXBlcyBvZiBhIGJyYW5jaFxuICAgICAgICAgICAgICAgICAgICAkKGlucHV0LmJyYW5jaCkuZWFjaChmdW5jdGlvbiAoYnJhbmNoSW5kZXgsIGJyYW5jaElucHV0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYnJhbmNoSW5wdXQudHlwZSA9PT0gY29uc3RzLlNFQVJDSF9NVUxUSVBMRV9UWVBFIHx8IGJyYW5jaElucHV0LnR5cGUgPT09IGNvbnN0cy5TRUFSQ0hfU0lOR0xFX1RZUEUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbCsrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgLy9uZXN0ZWQgZ3JvdXA/XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYnJhbmNoSW5wdXQudHlwZSA9PT0gY29uc3RzLkdST1VQX1RZUEUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKGJyYW5jaElucHV0Lmdyb3VwKS5lYWNoKGZ1bmN0aW9uIChncm91cEluZGV4LCBncm91cElucHV0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChncm91cElucHV0LnR5cGUgPT09IGNvbnN0cy5TRUFSQ0hfTVVMVElQTEVfVFlQRSB8fCBncm91cElucHV0LnR5cGUgPT09IGNvbnN0cy5TRUFSQ0hfU0lOR0xFX1RZUEUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsKys7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiB0b3RhbDtcbiAgICB9LFxuICAgIC8vanVtcCBkZXN0aW5hdGlvbnM6IGNhbm5vdCBqdW1wIG9uIHRoZSBuZXh0IG9uZSwgYnV0IGFsd2F5cyBuZXh0ICsgMVxuICAgIGdldEp1bXBBdmFpbGFibGVEZXN0aW5hdGlvbnM6IGZ1bmN0aW9uIChpbnB1dCwgaW5wdXRzKSB7XG5cbiAgICAgICAgdmFyIGN1cnJlbnRfaW5wdXRfaW5kZXg7XG4gICAgICAgIHZhciBvd25lcl9pbnB1dF9pbmRleDtcbiAgICAgICAgdmFyIGRlc3RpbmF0aW9ucyA9IFtdO1xuICAgICAgICB2YXIgYXZhaWxhYmxlX2lucHV0cztcblxuICAgICAgICBpZiAoZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19icmFuY2gpIHtcbiAgICAgICAgICAgIG93bmVyX2lucHV0X2luZGV4ID0gdXRpbHMuZ2V0SW5wdXRDdXJyZW50SW5kZXhCeVJlZihmb3JtYnVpbGRlci5icmFuY2guYWN0aXZlX2JyYW5jaF9yZWYpO1xuICAgICAgICAgICAgY3VycmVudF9pbnB1dF9pbmRleCA9IHV0aWxzLmdldEJyYW5jaElucHV0Q3VycmVudEluZGV4QnlSZWYob3duZXJfaW5wdXRfaW5kZXgsIGlucHV0LnJlZik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjdXJyZW50X2lucHV0X2luZGV4ID0gdXRpbHMuZ2V0SW5wdXRDdXJyZW50SW5kZXhCeVJlZihpbnB1dC5yZWYpO1xuICAgICAgICB9XG5cbiAgICAgICAgYXZhaWxhYmxlX2lucHV0cyA9IGlucHV0cy5zbGljZShjdXJyZW50X2lucHV0X2luZGV4ICsgMik7XG5cbiAgICAgICAgJChhdmFpbGFibGVfaW5wdXRzKS5lYWNoKGZ1bmN0aW9uIChpbmRleCwgaW5wdXQpIHtcbiAgICAgICAgICAgIGRlc3RpbmF0aW9ucy5wdXNoKHtcbiAgICAgICAgICAgICAgICByZWY6IGlucHV0LnJlZixcbiAgICAgICAgICAgICAgICBxdWVzdGlvbjogaW5wdXQucXVlc3Rpb24sXG4gICAgICAgICAgICAgICAgdHlwZTogaW5wdXQudHlwZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vYWRkIFwiRW5kIG9mIGZvcm1cIiBhcyBhbiBhdmFpbGFibGUgZGVzdGluYXRpb25cbiAgICAgICAgZGVzdGluYXRpb25zLnB1c2goe1xuICAgICAgICAgICAgcmVmOiBjb25zdHMuSlVNUF9UT19FTkRfT0ZfRk9STV9SRUYsXG4gICAgICAgICAgICBxdWVzdGlvbjogY29uc3RzLkpVTVBfVE9fRU5EX09GX0ZPUk1fTEFCRUwsXG4gICAgICAgICAgICB0eXBlOiBudWxsXG4gICAgICAgIH0pO1xuXG5cbiAgICAgICAgcmV0dXJuIGRlc3RpbmF0aW9ucztcbiAgICB9LFxuXG4gICAgLy9qdW1wIGRlc3RpbmF0aW9ucyBvYmplY3Q6IGZvciBxdWlja2VyIGxvb2sgdXBzLCB0aGlzIGlzIGZvciBleHRyYSB2YWxpZGF0aW9uIG9uIFwic2F2ZVwiXG4gICAgZ2V0SnVtcEF2YWlsYWJsZURlc3RpbmF0aW9uc0FzS2V5czogZnVuY3Rpb24gKGN1cnJlbnRfaW5wdXRfaW5kZXgsIGlucHV0LCBpbnB1dHMpIHtcblxuICAgICAgICB2YXIgZGVzdGluYXRpb25zID0ge307XG4gICAgICAgIHZhciBhdmFpbGFibGVfaW5wdXRzO1xuXG4gICAgICAgIGF2YWlsYWJsZV9pbnB1dHMgPSBpbnB1dHMuc2xpY2UoY3VycmVudF9pbnB1dF9pbmRleCArIDIpO1xuXG4gICAgICAgIC8vZmlsbCB3aXRoIGF2YWlsYWJsZSBpbnB1dHMgcmVmcyBhcyBrZXlzXG4gICAgICAgICQoYXZhaWxhYmxlX2lucHV0cykuZWFjaChmdW5jdGlvbiAoaW5kZXgsIGlucHV0KSB7XG4gICAgICAgICAgICBkZXN0aW5hdGlvbnNbaW5wdXQucmVmXSA9IDE7XG4gICAgICAgIH0pO1xuICAgICAgICAvL2FkZCBcIkVuZCBvZiBmb3JtXCIgYXMgYW4gYXZhaWxhYmxlIGRlc3RpbmF0aW9uXG4gICAgICAgIGRlc3RpbmF0aW9uc1tjb25zdHMuSlVNUF9UT19FTkRfT0ZfRk9STV9SRUZdID0gMTtcblxuICAgICAgICByZXR1cm4gZGVzdGluYXRpb25zO1xuICAgIH0sXG5cbiAgICAvL3JldHVybiB0cnVlIHdoZW4gdGhlIHZhbHVlIGlzIGxlc3Mgb3IgZXF1YWwgdG8gbWF4IHRpdGxlXG4gICAgaXNNYXhUaXRsZUxpbWl0UmVhY2hlZDogZnVuY3Rpb24gKGlucHV0cykge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRUaXRsZUNvdW50KGlucHV0cykgPj0gY29uc3RzLkxJTUlUUy50aXRsZXNfbWF4O1xuICAgIH0sXG4gICAgLy9yZXR1cm4gdHJ1ZSB3aGVuIHRoZSB2YWx1ZSBleGNlZWRzIG1heCB0aXRsZVxuICAgIGlzTWF4VGl0bGVMaW1pdEV4Y2VlZGVkOiBmdW5jdGlvbiAoaW5wdXRzKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFRpdGxlQ291bnQoaW5wdXRzKSA+IGNvbnN0cy5MSU1JVFMudGl0bGVzX21heDtcbiAgICB9LFxuXG4gICAgZ2V0VGl0bGVDb3VudDogZnVuY3Rpb24gKGlucHV0cykge1xuXG4gICAgICAgIHZhciBjb3VudCA9IDA7XG5cbiAgICAgICAgJChpbnB1dHMpLmVhY2goZnVuY3Rpb24gKGluZGV4LCBpbnB1dCkge1xuICAgICAgICAgICAgaWYgKGlucHV0LmlzX3RpdGxlKSB7XG4gICAgICAgICAgICAgICAgY291bnQrKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vbG9vcCBhbGwgZ3JvdXAgaW5wdXRzIGFzIHRoZXkgY291bnQgdG93YXJkcyB0aGUgbGltaXRcbiAgICAgICAgICAgIGlmIChpbnB1dC50eXBlID09PSBjb25zdHMuR1JPVVBfVFlQRSkge1xuICAgICAgICAgICAgICAgICQoaW5wdXQuZ3JvdXApLmVhY2goZnVuY3Rpb24gKGluZGV4LCBncm91cF9pbnB1dCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZ3JvdXBfaW5wdXQuaXNfdGl0bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50Kys7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBjb3VudDtcbiAgICB9LFxuICAgIC8vZnJvbSBodHRwOi8vZ29vLmdsL0Q3RnhHMFxuICAgIC8vICAvL2NvbnZlcnQgaHRtbCB0YWdzIHRvIGh0bWwgZW50aXRpZXNcbiAgICBlbmNvZGVIdG1sOiBmdW5jdGlvbiAoc3RyKSB7XG4gICAgICAgIHJldHVybiBzdHIucmVwbGFjZSgvWyY8PlwiJ10vZywgZnVuY3Rpb24gKCQwKSB7XG4gICAgICAgICAgICAvKiBqc2hpbnQgaWdub3JlOnN0YXJ0ICovXG4gICAgICAgICAgICAvLyBqc2NzOmRpc2FibGVcbiAgICAgICAgICAgIHJldHVybiBcIiZcIiArIHtcbiAgICAgICAgICAgICAgICBcIiZcIjogXCJhbXBcIixcbiAgICAgICAgICAgICAgICBcIjxcIjogXCJsdFwiLFxuICAgICAgICAgICAgICAgIFwiPlwiOiBcImd0XCIsXG4gICAgICAgICAgICAgICAgJ1wiJzogXCJxdW90XCIsXG4gICAgICAgICAgICAgICAgXCInXCI6IFwiIzM5XCJcbiAgICAgICAgICAgIH1bJDBdICsgXCI7XCI7XG4gICAgICAgICAgICAvKiBqc2hpbnQgaWdub3JlOmVuZCAqL1xuICAgICAgICAgICAgLy8ganNjczplbmFibGVcbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIC8vZnJvbSBodHRwOi8vZ29vLmdsL2h0Q3JvVVxuICAgIGRlY29kZUh0bWw6IGZ1bmN0aW9uIChodG1sKSB7XG4gICAgICAgIHZhciB0eHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZXh0YXJlYScpO1xuICAgICAgICB0eHQuaW5uZXJIVE1MID0gaHRtbDtcbiAgICAgICAgcmV0dXJuIHR4dC52YWx1ZTtcbiAgICB9LFxuXG4gICAgZ2V0UG9zc2libGVBbnN3ZXJMYWJlbDogZnVuY3Rpb24gKGlucHV0KSB7XG4gICAgICAgIHZhciBsYWJlbCA9ICcnO1xuICAgICAgICAkKGlucHV0LnBvc3NpYmxlX2Fuc3dlcnMpLmVhY2goZnVuY3Rpb24gKGFuc3dlcl9pbmRleCwgYW5zd2VyKSB7XG4gICAgICAgICAgICBpZiAoYW5zd2VyLmFuc3dlcl9yZWYgPT09IGlucHV0LmRlZmF1bHQpIHtcbiAgICAgICAgICAgICAgICBsYWJlbCA9IGFuc3dlci5hbnN3ZXI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gbGFiZWw7XG4gICAgfSxcbiAgICAvKipcbiAgICAgKiBAcGFyYW0gdmFsaWRTb3VyY2U6IHRoZSB2YWxpZCBvYmogc3RydWN0dXJlXG4gICAgICogQHBhcmFtIHdhbm5hQmU6IHRoZSBvYmogc3RydWN0dXJlIHRvIHZhbGlkYXRlXG4gICAgICogQHBhcmFtIHN0cmljdDogd2hldGhlciB0aGUgdHlwZSBtdXN0IGJlIHRoZSBzYW1lXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59XG4gICAgICogQ29tcGFyZSBwcm9wZXJ0aWVzIG9mIG9iamVjdHMgKG9ubHkga2V5czogd2FubmFCZSBtdXN0IGhhdmUgdGhlIHNhbWUga2V5cywgaW4gYW55IG9yZGVyLiBWYWx1ZXMgZG9uJ3QgbWF0dGVyLCB0aGV5IGFyZSBjaGVjayBzZXBhcmF0ZWx5KVxuICAgICAqIHdlIGRvIGNoZWNrIGZvciB0aGUgc2FtZSBuZXN0ZWQgcHJvcGVydGllcyB3aGVuIGFuIG9iamVjdCB7fSBidXQgYXJyYXlzIG11c3QgYmUgYXJyYXlzIFtdXG4gICAgICovXG4gICAgaGFzU2FtZVByb3BzOiBmdW5jdGlvbiAodmFsaWRTb3VyY2UsIHdhbm5hQmUsIHN0cmljdCkge1xuXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcblxuICAgICAgICAvL2ZhbHNlIHdoZW4gd2FubmFiZSBwcm9wZXJ0eSBpcyBhbiBhcnJheSBidXQgdmFsaWRTb3VyY2UgaXMgbm90XG4gICAgICAgIGlmICh0eXBlb2YgdmFsaWRTb3VyY2UgPT09ICdvYmplY3QnICYmIEFycmF5LmlzQXJyYXkod2FubmFCZSkpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vY2hlY2sgZm9yIHdhbm5hQmUgb3ZlcmxhcHBpbmcgcHJvcHNcbiAgICAgICAgaWYgKCFPYmplY3Qua2V5cyh3YW5uYUJlKS5ldmVyeShmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbGlkU291cmNlLmhhc093blByb3BlcnR5KGtleSk7XG4gICAgICAgICAgICB9KSkge1xuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ3dhbm5hQmUgaGFzIGV4dHJhIGtleXMnKVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9jaGVjayBldmVyeSBrZXkgZm9yIGJlaW5nIHNhbWVcbiAgICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKHZhbGlkU291cmNlKS5ldmVyeShmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgICAgICAvL2lmIG9iamVjdFxuICAgICAgICAgICAgaWYgKHR5cGVvZiB2YWxpZFNvdXJjZVtrZXldID09PSAnb2JqZWN0JyAmJiB0eXBlb2Ygd2FubmFCZVtrZXldID09PSAnb2JqZWN0JyAmJiB2YWxpZFNvdXJjZVtrZXldICE9PSBudWxsICYmIHdhbm5hQmVba2V5XSAhPT0gbnVsbCkge1xuXG4gICAgICAgICAgICAgICAgLy9jaGVjayBhcnJheSBpcyBhcnJheVxuICAgICAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KHZhbGlkU291cmNlW2tleV0pKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ211c3QgYmUgYXJyYXkga2V5OiAnICsga2V5KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEFycmF5LmlzQXJyYXkod2FubmFCZVtrZXldKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvL3JlY3Vyc2l2ZWx5IGNoZWNrIG5lc3RlZCBvYmplY3RcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuaGFzU2FtZVByb3BzKHZhbGlkU291cmNlW2tleV0sIHdhbm5hQmVba2V5XSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vY2hlY2sgZXZlcnkga2V5IGlzIHByZXNlbnQgaW4gdGhlIHdhbm5hIGJlIG9iamVjdFxuICAgICAgICAgICAgICAgIGlmICh3YW5uYUJlW2tleV0gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnd2FubmFCZSBkb2VzIG5vdCBoYXZlIGtleTonICsga2V5KVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9jaGVjayB0aGUgdHlwZSBvZiB2YWx1ZSBpcyB0aGUgc2FtZSAobm90IHRoZSBhY3R1YWwgdmFsdWUsIHdoaWNoIGNhbiBiZSBkaWZmZXJlbnQpXG4gICAgICAgICAgICAgICAgaWYgKHN0cmljdCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHZhbGlkU291cmNlW2tleV0gIT09IHR5cGVvZiB3YW5uYUJlW2tleV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ3dhbm5hQmUgdHlwZSBpcyB3cm9uZyBmb3Iga2V5OiAnICsga2V5KVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0sXG4gICAgLy9mcm9tIE1ETiBodHRwczovL2dvby5nbC92T2h6dGFcbiAgICBpc0ludGVnZXI6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJyAmJlxuICAgICAgICAgICAgaXNGaW5pdGUodmFsdWUpICYmXG4gICAgICAgICAgICBNYXRoLmZsb29yKHZhbHVlKSA9PT0gdmFsdWU7XG4gICAgfSxcblxuICAgIGdldEFjdGl2ZUlucHV0OiBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB2YXIgaW5wdXQ7XG4gICAgICAgIHZhciBjdXJyZW50X2JyYW5jaDtcbiAgICAgICAgdmFyIGN1cnJlbnRfaW5wdXRfcmVmID0gZm9ybWJ1aWxkZXIuY3VycmVudF9pbnB1dF9yZWY7XG5cbiAgICAgICAgLy9nZXQgY3VycmVudCBpbnB1dCBvYmplY3QgYmFzZWQgb24gZWRpdGluZyBzdGF0ZTpcblxuICAgICAgICAvL25lc3RlZCBncm91cD9cbiAgICAgICAgaWYgKGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfYnJhbmNoICYmIGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfZ3JvdXApIHtcbiAgICAgICAgICAgIC8vZ2V0IG5lc3RlZCBncm91cCBpbnB1dFxuICAgICAgICAgICAgY3VycmVudF9icmFuY2ggPSBzZWxmLmdldElucHV0T2JqZWN0QnlSZWYoZm9ybWJ1aWxkZXIuYnJhbmNoLmFjdGl2ZV9icmFuY2hfcmVmKTtcbiAgICAgICAgICAgIGlucHV0ID0gc2VsZi5nZXROZXN0ZWRHcm91cElucHV0T2JqZWN0QnlSZWYoY3VycmVudF9icmFuY2gsIGZvcm1idWlsZGVyLmdyb3VwLmN1cnJlbnRfaW5wdXRfcmVmKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vYnJhbmNoIGlucHV0XG4gICAgICAgIGlmIChmb3JtYnVpbGRlci5pc19lZGl0aW5nX2JyYW5jaCAmJiAhZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19ncm91cCkge1xuICAgICAgICAgICAgLy9nZXQgYnJhbmNoIGlucHV0XG4gICAgICAgICAgICBpbnB1dCA9IHNlbGYuZ2V0QnJhbmNoSW5wdXRPYmplY3RCeVJlZihmb3JtYnVpbGRlci5icmFuY2guY3VycmVudF9pbnB1dF9yZWYpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9ncm91cCBpbnB1dD9cbiAgICAgICAgaWYgKCFmb3JtYnVpbGRlci5pc19lZGl0aW5nX2JyYW5jaCAmJiBmb3JtYnVpbGRlci5pc19lZGl0aW5nX2dyb3VwKSB7XG4gICAgICAgICAgICAvL2dldCBncm91cCBpbnB1dFxuICAgICAgICAgICAgaW5wdXQgPSBzZWxmLmdldEdyb3VwSW5wdXRPYmplY3RCeVJlZihmb3JtYnVpbGRlci5ncm91cC5jdXJyZW50X2lucHV0X3JlZik7XG4gICAgICAgIH1cblxuICAgICAgICAvL3RvcCBsZXZlbCBpbnB1dD9cbiAgICAgICAgaWYgKCFmb3JtYnVpbGRlci5pc19lZGl0aW5nX2JyYW5jaCAmJiAhZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19ncm91cCkge1xuICAgICAgICAgICAgLy9nZXQgaW5wdXRcbiAgICAgICAgICAgIGlucHV0ID0gc2VsZi5nZXRJbnB1dE9iamVjdEJ5UmVmKGN1cnJlbnRfaW5wdXRfcmVmKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBpbnB1dDtcbiAgICB9LFxuICAgIC8vLyBSZXBsYWNlcyBjb21tb25seS11c2VkIFdpbmRvd3MgMTI1MiBlbmNvZGVkIGNoYXJzIHRoYXQgZG8gbm90IGV4aXN0IGluIEFTQ0lJIG9yIElTTy04ODU5LTEgd2l0aCBJU08tODg1OS0xIGNvZ25hdGVzLlxuICAgIHJlcGxhY2VXb3JkQ2hhcnM6IGZ1bmN0aW9uICh0ZXh0KSB7XG4gICAgICAgIHZhciBzID0gdGV4dDtcbiAgICAgICAgLy8gc21hcnQgc2luZ2xlIHF1b3RlcyBhbmQgYXBvc3Ryb3BoZVxuICAgICAgICBzID0gcy5yZXBsYWNlKC9bXFx1MjAxOFxcdTIwMTlcXHUyMDFBXS9nLCBcIlxcJ1wiKTtcbiAgICAgICAgLy8gc21hcnQgZG91YmxlIHF1b3Rlc1xuICAgICAgICBzID0gcy5yZXBsYWNlKC9bXFx1MjAxQ1xcdTIwMURcXHUyMDFFXS9nLCAnXFxcIicpO1xuICAgICAgICAvLyBlbGxpcHNpc1xuICAgICAgICBzID0gcy5yZXBsYWNlKC9cXHUyMDI2L2csICcuLi4nKTtcbiAgICAgICAgLy8gZGFzaGVzXG4gICAgICAgIHMgPSBzLnJlcGxhY2UoL1tcXHUyMDEzXFx1MjAxNF0vZywgJy0nKTtcbiAgICAgICAgLy8gY2lyY3VtZmxleFxuICAgICAgICBzID0gcy5yZXBsYWNlKC9cXHUwMkM2L2csICdeJyk7XG4gICAgICAgIC8vIG9wZW4gYW5nbGUgYnJhY2tldFxuICAgICAgICBzID0gcy5yZXBsYWNlKC9cXHUyMDM5L2csICcgJyk7XG4gICAgICAgIC8vIGNsb3NlIGFuZ2xlIGJyYWNrZXRcbiAgICAgICAgcyA9IHMucmVwbGFjZSgvXFx1MjAzQS9nLCAnICcpO1xuICAgICAgICAvLyBzcGFjZXNcbiAgICAgICAgcyA9IHMucmVwbGFjZSgvW1xcdTAyRENcXHUwMEEwXS9nLCAnICcpO1xuXG4gICAgICAgIC8vcmVtb3ZlIGludmFsaWQgY2hhcnNcbiAgICAgICAgcyA9IHMucmVwbGFjZSgvXFx1RkZGRC9nLCAnICcpO1xuXG4gICAgICAgIHJldHVybiBzO1xuICAgIH0sXG5cbiAgICBnZXRDdXJyZW50bHlTZWxlY3RlZElucHV0OiBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB2YXIgaW5wdXQgPSBzZWxmLmdldElucHV0T2JqZWN0QnlSZWYoZm9ybWJ1aWxkZXIuY3VycmVudF9pbnB1dF9yZWYpO1xuICAgICAgICB2YXIgb3duZXJfYnJhbmNoO1xuXG4gICAgICAgIC8vY2hlY2sgd2hldGhlciB3ZSBhcmUgdmFsaWRhdGluIGEgbmVzdGVkIGlucHV0IGkuZS4gQk9USCBicmFuY2ggQU5EIGdyb3VwIGVkaXQgZmxhZ3MgYXJlIHRydWVcbiAgICAgICAgaWYgKGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfYnJhbmNoICYmIGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfZ3JvdXApIHtcbiAgICAgICAgICAgIC8vZ2V0IG5lc3RlZCBncm91cCBpbnB1dFxuICAgICAgICAgICAgb3duZXJfYnJhbmNoID0gc2VsZi5nZXRJbnB1dE9iamVjdEJ5UmVmKGZvcm1idWlsZGVyLmJyYW5jaC5hY3RpdmVfYnJhbmNoX3JlZik7XG4gICAgICAgICAgICBpbnB1dCA9IHNlbGYuZ2V0TmVzdGVkR3JvdXBJbnB1dE9iamVjdEJ5UmVmKG93bmVyX2JyYW5jaCwgZm9ybWJ1aWxkZXIuZ3JvdXAuY3VycmVudF9pbnB1dF9yZWYpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaWYgKGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfYnJhbmNoKSB7XG4gICAgICAgICAgICAgICAgLy9nZXQgc2VsZWN0ZWQgYnJhbmNoIGlucHV0XG4gICAgICAgICAgICAgICAgaW5wdXQgPSBzZWxmLmdldEJyYW5jaElucHV0T2JqZWN0QnlSZWYoZm9ybWJ1aWxkZXIuYnJhbmNoLmN1cnJlbnRfaW5wdXRfcmVmKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfZ3JvdXApIHtcbiAgICAgICAgICAgICAgICAvL2dldCBzZWxlY3RlZCBncm91cCBpbnB1dFxuICAgICAgICAgICAgICAgIGlucHV0ID0gc2VsZi5nZXRHcm91cElucHV0T2JqZWN0QnlSZWYoZm9ybWJ1aWxkZXIuZ3JvdXAuY3VycmVudF9pbnB1dF9yZWYpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGlucHV0O1xuICAgIH0sXG4gICAgLy9odHRwOi8vbG9jdXR1cy5pby9waHAvc3RyaW5ncy9zdHJpcF90YWdzL1xuICAgIHN0cmlwVGFnczogZnVuY3Rpb24gKGlucHV0LCBhbGxvd2VkKSB7XG4gICAgICAgIGFsbG93ZWQgPSAoKChhbGxvd2VkIHx8ICcnKSArICcnKS50b0xvd2VyQ2FzZSgpLm1hdGNoKC88W2Etel1bYS16MC05XSo+L2cpIHx8IFtdKS5qb2luKCcnKTtcbiAgICAgICAgdmFyIHRhZ3MgPSAvPFxcLz8oW2Etel1bYS16MC05XSopXFxiW14+XSo+L2dpO1xuICAgICAgICB2YXIgY29tbWVudHNBbmRQaHBUYWdzID0gLzwhLS1bXFxzXFxTXSo/LS0+fDxcXD8oPzpwaHApP1tcXHNcXFNdKj9cXD8+L2dpO1xuICAgICAgICByZXR1cm4gaW5wdXQucmVwbGFjZShjb21tZW50c0FuZFBocFRhZ3MsICcnKS5yZXBsYWNlKHRhZ3MsIGZ1bmN0aW9uICgkMCwgJDEpIHtcbiAgICAgICAgICAgIHJldHVybiBhbGxvd2VkLmluZGV4T2YoJzwnICsgJDEudG9Mb3dlckNhc2UoKSArICc+JykgPiAtMSA/ICQwIDogJydcbiAgICAgICAgfSlcbiAgICB9LFxuICAgIC8vcmVwbGFjZSBhbGwgb2NjdXJlbmNlcyBvZiAnbmVlZGxlJyBpbiBzdHJpbmdcbiAgICByZXBsYWNlQWxsT2NjdXJyZW5jZXM6IGZ1bmN0aW9uIChzdHJpbmcsIG5lZWRsZSwgcmVwbGFjZW1lbnQpIHtcbiAgICAgICAgcmV0dXJuIHN0cmluZy5yZXBsYWNlKG5ldyBSZWdFeHAobmVlZGxlLCAnZycpLCByZXBsYWNlbWVudCk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFJhbmRvbWl6ZSBhcnJheSBlbGVtZW50IG9yZGVyIGluLXBsYWNlLlxuICAgICAqIFVzaW5nIER1cnN0ZW5mZWxkIHNodWZmbGUgYWxnb3JpdGhtLlxuICAgICAqL1xuICAgIHNodWZmbGVBcnJheTogZnVuY3Rpb24gKGFycmF5KSB7XG4gICAgICAgIGZvciAodmFyIGkgPSBhcnJheS5sZW5ndGggLSAxOyBpID4gMDsgaS0tKSB7XG4gICAgICAgICAgICB2YXIgaiA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChpICsgMSkpO1xuICAgICAgICAgICAgdmFyIHRlbXAgPSBhcnJheVtpXTtcbiAgICAgICAgICAgIGFycmF5W2ldID0gYXJyYXlbal07XG4gICAgICAgICAgICBhcnJheVtqXSA9IHRlbXA7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFycmF5O1xuICAgIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gdXRpbHM7XG4iLCIndXNlIHN0cmljdCc7XG52YXIgY29uc3RzID0gcmVxdWlyZSgnY29uZmlnL2NvbnN0cycpO1xudmFyIGVycm9ycyA9IHJlcXVpcmUoJ2FjdGlvbnMvZXJyb3JzJyk7XG52YXIganVtcHMgPSByZXF1aXJlKCdhY3Rpb25zL2p1bXBzJyk7XG52YXIgc2F2ZSA9IHJlcXVpcmUoJ2FjdGlvbnMvc2F2ZScpO1xudmFyIHZhbGlkYXRpb24gPSByZXF1aXJlKCdhY3Rpb25zL3ZhbGlkYXRpb24nKTtcbnZhciBpbnB1dF9wcm9wZXJ0aWVzID0gcmVxdWlyZSgnZmFjdG9yeS9pbnB1dC1wcm9wZXJ0aWVzJyk7XG52YXIgSW5wdXQgPSByZXF1aXJlKCdmYWN0b3J5L2lucHV0LXByb3RvdHlwZScpO1xudmFyIGZvcm1idWlsZGVyID0gcmVxdWlyZSgnY29uZmlnL2Zvcm1idWlsZGVyJyk7XG5cbnZhciBBdWRpb0lucHV0ID0gZnVuY3Rpb24gKHRoZV9pbnB1dF9yZWYpIHtcblxuICAgIC8vZXh0ZW5kIGJhc2ljIGlucHV0IHdpaCBjb21tb24gcHJvcGVydGllcyAoZWFzaWVyIHRoYW4gcGFzc2luZyBhIHByb3BlcnRpZXMgb2JqZWN0IHRvIE9iamVjdC5jcmVhdGUpXG4gICAgJC5leHRlbmQodHJ1ZSwgdGhpcywgaW5wdXRfcHJvcGVydGllcyk7XG5cbiAgICAvL3NldCBkZWZhdWx0IHByb3BlcnRpZXNcbiAgICAvL3RoaXMuaW5kZXggPSB0aGVfaW5kZXg7XG4gICAgdGhpcy5yZWYgPSB0aGVfaW5wdXRfcmVmO1xuICAgIHRoaXMudHlwZSA9IGNvbnN0cy5BVURJT19UWVBFO1xuXG4gICAgLyogcmVzZXQgRE9NIHByb3BlcnRpZXMgKGpxdWVyeSBzZWxlY3RvcnMgYXJlIG5vdCAnbGl2ZScsIHdlIG5lZWQgdG8gcnVuIHRoZW0gYWdhaW4gZm9yIG5ldyBvYmplY3QpXG4gICAgICpcbiAgICAgKiBpZiB0aGUgcHJvcGVydHkgYmVsb3cgaXMgbm90IHJlc2V0IGhlcmUsIGFsbCB0aGUgaW5wdXRzIHdpbGwgZ2V0IHRoZSBzYW1lIGRvbSByZWZlcmVuY2VcbiAgICAgKiAqL1xuICAgIHRoaXMuZG9tID0ge307XG4gICAgdGhpcy5kb20uaXNfdmFsaWQgPSBmYWxzZTtcbn07XG5cbi8vZXh0ZW5kIHByb3RvdHlwZSBmcm9tIGJhc2ljIGlucHV0IG9iamVjdFxuQXVkaW9JbnB1dC5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKElucHV0LnByb3RvdHlwZSk7XG5cbm1vZHVsZS5leHBvcnRzID0gQXVkaW9JbnB1dDtcbiIsIi8qIGdsb2JhbCAkKi9cbid1c2Ugc3RyaWN0JztcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgZXJyb3JzID0gcmVxdWlyZSgnYWN0aW9ucy9lcnJvcnMnKTtcbnZhciBqdW1wcyA9IHJlcXVpcmUoJ2FjdGlvbnMvanVtcHMnKTtcbnZhciBzYXZlID0gcmVxdWlyZSgnYWN0aW9ucy9zYXZlJyk7XG52YXIgaW5wdXRfcHJvcGVydGllcyA9IHJlcXVpcmUoJ2ZhY3RvcnkvaW5wdXQtcHJvcGVydGllcycpO1xudmFyIElucHV0ID0gcmVxdWlyZSgnZmFjdG9yeS9pbnB1dC1wcm90b3R5cGUnKTtcbnZhciB2YWxpZGF0aW9uID0gcmVxdWlyZSgnYWN0aW9ucy92YWxpZGF0aW9uJyk7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcbnZhciB1aSA9IHJlcXVpcmUoJ2hlbHBlcnMvdWknKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoJ2hlbHBlcnMvdXRpbHMnKTtcblxudmFyIEJhcmNvZGVJbnB1dCA9IGZ1bmN0aW9uICh0aGVfaW5wdXRfcmVmKSB7XG5cbiAgICAvL2V4dGVuZCBiYXNpYyBpbnB1dCB3aWggY29tbW9uIHByb3BlcnRpZXMgKGVhc2llciB0aGFuIHBhc3NpbmcgYSBwcm9wZXJ0aWVzIG9iamVjdCB0byBPYmplY3QuY3JlYXRlKVxuICAgICQuZXh0ZW5kKHRydWUsIHRoaXMsIGlucHV0X3Byb3BlcnRpZXMpO1xuXG4gICAgLy9zZXQgY3VycmVudCBpbnN0YW5jZSBwcm9wZXJ0aWVzXG4gICAvLyB0aGlzLmluZGV4ID0gdGhlX2luZGV4O1xuICAgIHRoaXMucmVmID0gdGhlX2lucHV0X3JlZjtcbiAgICB0aGlzLnR5cGUgPSBjb25zdHMuQkFSQ09ERV9UWVBFO1xuXG4gICAgLyogcmVzZXQgRE9NIHByb3BlcnRpZXMgKGpxdWVyeSBzZWxlY3RvcnMgYXJlIG5vdCAnbGl2ZScsIHdlIG5lZWQgdG8gcnVuIHRoZW0gYWdhaW4gZm9yIG5ldyBvYmplY3QpXG4gICAgICpcbiAgICAgKiBpZiB0aGUgcHJvcGVydHkgYmVsb3cgaXMgbm90IHJlc2V0IGhlcmUsIGFsbCB0aGUgaW5wdXRzIHdpbGwgZ2V0IHRoZSBzYW1lIGRvbSByZWZlcmVuY2VcbiAgICAgKiAqL1xuICAgIHRoaXMuZG9tID0ge307XG4gICAgdGhpcy5kb20uaXNfdmFsaWQgPSBmYWxzZTtcbn07XG5cbi8vZXh0ZW5kIHByb3RvdHlwZSBmcm9tIGJhc2ljIGlucHV0IG9iamVjdFxuQmFyY29kZUlucHV0LnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoSW5wdXQucHJvdG90eXBlKTtcblxuLypcbiBPdmVycmlkZXNcbiAqL1xuXG5CYXJjb2RlSW5wdXQucHJvdG90eXBlLnNldEFkdmFuY2VkSW5wdXRQcm9wZXJ0aWVzID0gZnVuY3Rpb24gKCkge1xuXG4gICAgdGhpcy5kb20uYWR2YW5jZWRfcHJvcGVydGllc193cmFwcGVyID0gZm9ybWJ1aWxkZXJcbiAgICAgICAgLmRvbVxuICAgICAgICAuaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyXG4gICAgICAgIC5maW5kKCdmb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIHRoaXMucmVmICsgJ1wiXScpXG4gICAgICAgIC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fYWR2YW5jZWQtcHJvcGVydGllcycpO1xuXG4gICAgLy9zZXQgICdkZWZhdWx0JyBvcHRpb25cbiAgICB0aGlzLmRvbS5hZHZhbmNlZF9wcm9wZXJ0aWVzX3dyYXBwZXIuZmluZCgnZGl2LmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2FkdmFuY2VkLXByb3BlcnRpZXNfX2RlZmF1bHQgaW5wdXQnKS52YWwodGhpcy5kZWZhdWx0KTtcblxuICAgIC8vc2V0ICdyZWdleCcgb3B0aW9uXG4gICAgdGhpcy5kb20uYWR2YW5jZWRfcHJvcGVydGllc193cmFwcGVyLmZpbmQoJ2Rpdi5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19hZHZhbmNlZC1wcm9wZXJ0aWVzX19yZWdleCBpbnB1dCcpLnZhbCh0aGlzLnJlZ2V4KTtcblxuICAgIC8vc2V0ICdpbnB1dF9yZWYnIG9uICdkb3VibGUgZW50cnkgdmVyaWZpY2F0aW9uJyBvcHRpb25cbiAgICB0aGlzLmRvbS5hZHZhbmNlZF9wcm9wZXJ0aWVzX3dyYXBwZXIuZmluZCgnZGl2LmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2FkdmFuY2VkLXByb3BlcnRpZXNfX2RvdWJsZS1lbnRyeSBpbnB1dCcpLnByb3AoJ2NoZWNrZWQnLCB0aGlzLnZlcmlmeSk7XG5cbiAgICB1aS5pbnB1dF9wcm9wZXJ0aWVzX3BhbmVsLnNldFVuaXF1ZW5lc3NQcm9wZXJ0eShmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXgsIHRoaXMpO1xufTtcblxuQmFyY29kZUlucHV0LnByb3RvdHlwZS5oaWRlQWR2YW5jZWRQcm9wZXJ0aWVzRXJyb3JzID0gZnVuY3Rpb24gKCkge1xuXG4gICAgLy9yZXNldCB2YWxpZGF0aW9uIGRvbSBmZWVkYmFjayAoaGlkZSBhbGwgZXJyb3JzIGZyb20gZG9tKVxuICAgIHZhciBwcm9wZXJ0aWVzX3RvX2hpZGVfZXJyb3IgPSBbXG4gICAgICAgIGNvbnN0cy5ERUZBVUxUX1BST1BFUlRZXG4gICAgXTtcbiAgICBlcnJvcnMuaGlkZUFkdmFuY2VkUHJvcGVydGllc0Vycm9ycyh0aGlzLCBwcm9wZXJ0aWVzX3RvX2hpZGVfZXJyb3IpO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBCYXJjb2RlSW5wdXQ7XG4iLCIvKiBnbG9iYWwgJCovXG4ndXNlIHN0cmljdCc7XG52YXIgY29uc3RzID0gcmVxdWlyZSgnY29uZmlnL2NvbnN0cycpO1xudmFyIGVycm9ycyA9IHJlcXVpcmUoJ2FjdGlvbnMvZXJyb3JzJyk7XG52YXIgbWVzc2FnZXMgPSByZXF1aXJlKCdjb25maWcvbWVzc2FnZXMnKTtcbnZhciBqdW1wcyA9IHJlcXVpcmUoJ2FjdGlvbnMvanVtcHMnKTtcbnZhciBzYXZlID0gcmVxdWlyZSgnYWN0aW9ucy9zYXZlJyk7XG52YXIgaW5wdXRfcHJvcGVydGllcyA9IHJlcXVpcmUoJ2ZhY3RvcnkvaW5wdXQtcHJvcGVydGllcycpO1xudmFyIElucHV0ID0gcmVxdWlyZSgnZmFjdG9yeS9pbnB1dC1wcm90b3R5cGUnKTtcbnZhciB2YWxpZGF0aW9uID0gcmVxdWlyZSgnYWN0aW9ucy92YWxpZGF0aW9uJyk7XG52YXIgdWkgPSByZXF1aXJlKCdoZWxwZXJzL3VpJyk7XG52YXIgdXRpbHMgPSByZXF1aXJlKCdoZWxwZXJzL3V0aWxzJyk7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcbnZhciBicmFuY2hfc29ydGFibGUgPSByZXF1aXJlKCd1aS1oYW5kbGVycy9icmFuY2gtc29ydGFibGUnKTtcbnZhciBpbnB1dF9jb2xsZWN0aW9uX2JyYW5jaF9zb3J0YWJsZV9tb3VzZWRvd25fY2FsbGJhY2sgPSByZXF1aXJlKCd1aS1oYW5kbGVycy9ldmVudC1oYW5kbGVyLWNhbGxiYWNrcy9pbnB1dC1jb2xsZWN0aW9uLWJyYW5jaC1zb3J0YWJsZS1tb3VzZWRvd24tY2FsbGJhY2snKTtcbnZhciBpbnB1dF9jb2xsZWN0aW9uX3NvcnRhYmxlX21vdXNlZG93bl9jYWxsYmFjayA9IHJlcXVpcmUoJ3VpLWhhbmRsZXJzL2V2ZW50LWhhbmRsZXItY2FsbGJhY2tzL2lucHV0LWNvbGxlY3Rpb24tc29ydGFibGUtbW91c2Vkb3duLWNhbGxiYWNrJyk7XG5cbnZhciBCcmFuY2hJbnB1dCA9IGZ1bmN0aW9uICh0aGVfaW5wdXRfcmVmKSB7XG5cbiAgICAvL2V4dGVuZCBiYXNpYyBpbnB1dCB3aWggY29tbW9uIHByb3BlcnRpZXMgKGVhc2llciB0aGFuIHBhc3NpbmcgYSBwcm9wZXJ0aWVzIG9iamVjdCB0byBPYmplY3QuY3JlYXRlKVxuICAgICQuZXh0ZW5kKHRydWUsIHRoaXMsIGlucHV0X3Byb3BlcnRpZXMpO1xuXG4gICAgLy9zZXQgY3VycmVudCBpbnN0YW5jZSBwcm9wZXJ0aWVzXG4gICAgLy90aGlzLmluZGV4ID0gdGhlX2luZGV4O1xuICAgIHRoaXMucmVmID0gdGhlX2lucHV0X3JlZjtcbiAgICB0aGlzLnR5cGUgPSBjb25zdHMuQlJBTkNIX1RZUEU7XG5cbiAgICAvKiByZXNldCBET00gcHJvcGVydGllcyAoanF1ZXJ5IHNlbGVjdG9ycyBhcmUgbm90ICdsaXZlJywgd2UgbmVlZCB0byBydW4gdGhlbSBhZ2FpbiBmb3IgbmV3IG9iamVjdClcbiAgICAgKlxuICAgICAqIGlmIHRoZSBwcm9wZXJ0eSBiZWxvdyBpcyBub3QgcmVzZXQgaGVyZSwgYWxsIHRoZSBpbnB1dHMgd2lsbCBnZXQgdGhlIHNhbWUgZG9tIHJlZmVyZW5jZVxuICAgICAqICovXG4gICAgdGhpcy5kb20gPSB7fTtcbiAgICB0aGlzLmRvbS5pc192YWxpZCA9IGZhbHNlO1xufTtcblxuLy9leHRlbmQgcHJvdG90eXBlIGZyb20gYmFzaWMgaW5wdXQgb2JqZWN0XG5CcmFuY2hJbnB1dC5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKElucHV0LnByb3RvdHlwZSk7XG5cbkJyYW5jaElucHV0LnByb3RvdHlwZS5pc0hlYWRlclRleHRWYWxpZCA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gdGhpcy5pc1F1ZXN0aW9uVGV4dFZhbGlkKCk7XG59O1xuXG5cbi8vdG9nZ2xlIGVkaXQgYnJhbmNoIGJ1dHRvblxuQnJhbmNoSW5wdXQucHJvdG90eXBlLnRvZ2dsZUVkaXRCdXR0b24gPSBmdW5jdGlvbiAodGhlX3N0YXRlKSB7XG4gICAgdWkuYnJhbmNoLnRvZ2dsZUVkaXRCcmFuY2hCdXR0b24odGhpcy5yZWYsIHRoZV9zdGF0ZSk7XG59O1xuXG5CcmFuY2hJbnB1dC5wcm90b3R5cGUuZW50ZXJCcmFuY2hTb3J0YWJsZSA9IGZ1bmN0aW9uICgpIHtcblxuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB2YXIgdW5kbyA9IHJlcXVpcmUoJ2FjdGlvbnMvdW5kbycpO1xuICAgIHZhciBhY3RpdmVfYnJhbmNoID0gZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uX3NvcnRhYmxlXG4gICAgICAgIC5maW5kKCdkaXYuaW5wdXRbZGF0YS1pbnB1dC1yZWY9XCInICsgc2VsZi5yZWYgKyAnXCJdJyk7XG4gICAgdmFyIGFjdGl2ZV9icmFuY2hfaW5uZXIgPSBhY3RpdmVfYnJhbmNoLmZpbmQoJyA+IC5pbnB1dC1pbm5lcicpO1xuICAgIHZhciBicmFuY2hfaG9sZGVyX2h0bWwgPSB1aS5pbnB1dHNfY29sbGVjdGlvbi5nZXRFbXB0eUNvbGxlY3Rpb25Tb3J0YWJsZUhUTUwoY29uc3RzLkJSQU5DSF9UWVBFKTtcbiAgICB2YXIgYnJhbmNoX2lucHV0cyA9IHV0aWxzLmdldElucHV0T2JqZWN0QnlSZWYoc2VsZi5yZWYpLmJyYW5jaDtcbiAgICB2YXIgZXhpdF9idG5faHRtbCA9ICcnO1xuICAgIGV4aXRfYnRuX2h0bWwgKz0gJzxidXR0b24gY2xhc3M9XCJidG4gYnRuLXNtIGJ0bi1kZWZhdWx0IGV4aXQtYnJhbmNoLWVkaXRpbmdcIj4nO1xuICAgIGV4aXRfYnRuX2h0bWwgKz0gJzxpIGNsYXNzPVwiZmEgZmEtMnggZmEtZncgZmEtY2hldnJvbi1sZWZ0IFwiPjwvaT4nO1xuICAgIGV4aXRfYnRuX2h0bWwgKz0gbWVzc2FnZXMubGFiZWxzLkVYSVRfRURJVElORztcbiAgICBleGl0X2J0bl9odG1sICs9ICc8L2J1dHRvbj4nO1xuXG4gICAgLy9yZXNldCBicmFuY2ggb2JqZWN0LCBhcyB3ZSBjYWNoZSBwcm9wZXJ0aWVzIG9mIHRoZSBjdXJyZW50IGVuYWJsZWQgYnJhbmNoIG9ubHlcbiAgICBmb3JtYnVpbGRlci5icmFuY2ggPSB7fTtcblxuICAgIC8vc2V0IGRyYWdnYWJsZSB0byB3b3JrIHdpdGggZW5hYmxlZCBicmFuY2ggb25seVxuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfdG9vbHNfZHJhZ2dhYmxlLmRyYWdnYWJsZSgnb3B0aW9uJywgJ2Nvbm5lY3RUb1NvcnRhYmxlJywgJy5icmFuY2gtc29ydGFibGUnKTtcblxuICAgIC8vc2V0IHVzZWZ1bCBmbGFnc1xuICAgIGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfYnJhbmNoID0gdHJ1ZTtcbiAgICBmb3JtYnVpbGRlci5icmFuY2guYWN0aXZlX2JyYW5jaF9yZWYgPSBzZWxmLnJlZjtcbiAgICBmb3JtYnVpbGRlci5icmFuY2guYWN0aXZlX2JyYW5jaF9oZWFkZXIgPSBzZWxmLnF1ZXN0aW9uO1xuXG4gICAgYWN0aXZlX2JyYW5jaC5vZmYoKS5vbignbW91c2Vkb3duJywgJ2Rpdi5pbnB1dCcsIGlucHV0X2NvbGxlY3Rpb25fYnJhbmNoX3NvcnRhYmxlX21vdXNlZG93bl9jYWxsYmFjayk7XG5cbiAgICAvLyBpZiBpdCBpcyBhIGJyYW5kIG5ldyBicmFuY2gsIGFwcGVuZCBzb3J0YWJsZSBtYXJrdXAgYW5kIHNob3cgaGVscCBtZXNzYWdlXG4gICAgaWYgKGFjdGl2ZV9icmFuY2guZmluZCgnLmJyYW5jaC1zb3J0YWJsZScpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBicmFuY2hfaG9sZGVyX2h0bWwgPSBicmFuY2hfaG9sZGVyX2h0bWwucmVwbGFjZSgne3ticmFuY2gtaW5wdXRzfX0nLCAnJyk7XG4gICAgICAgIGFjdGl2ZV9icmFuY2guYXBwZW5kKGJyYW5jaF9ob2xkZXJfaHRtbCk7XG4gICAgICAgIGFjdGl2ZV9icmFuY2guZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX25vLWJyYW5jaC1xdWVzdGlvbnMtbWVzc2FnZScpLnNob3coKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGlmIChmb3JtYnVpbGRlci5yZW5kZXJfYWN0aW9uID09PSBjb25zdHMuUkVOREVSX0FDVElPTl9VTkRPICYmIGFjdGl2ZV9icmFuY2guZmluZCgnLmJyYW5jaC1zb3J0YWJsZSA+IGRpdicpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgYWN0aXZlX2JyYW5jaC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fbm8tZ3JvdXAtcXVlc3Rpb25zLW1lc3NhZ2UnKS5zaG93KCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvL2VuYWJsZSBicmFuY2ggc29ydGFibGVcbiAgICBhY3RpdmVfYnJhbmNoLmZpbmQoJy5icmFuY2gtc29ydGFibGUnKS5zb3J0YWJsZShicmFuY2hfc29ydGFibGUpLmRpc2FibGVTZWxlY3Rpb24oKS5yZW1vdmVDbGFzcygnaGlkZGVuJyk7XG5cbiAgICAvL3JlbW92ZSBhbnkgcHJldmlvdXNseSBzZWxlY3RlZCBicmFuY2ggaW5wdXRcbiAgICBhY3RpdmVfYnJhbmNoLmZpbmQoJy5icmFuY2gtc29ydGFibGUnKS5maW5kKCcuaW5wdXQuYWN0aXZlJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuXG4gICAgLy9zaG93IGV4aXQgZWRpdGluZyBidXR0b25cbiAgICBhY3RpdmVfYnJhbmNoLmFkZENsYXNzKCdhY3RpdmUtYnJhbmNoJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuXG4gICAgLy9yZW1vdmUgZmlyc3QgdHdvIGVsZW1lbnRzXG4gICAgYWN0aXZlX2JyYW5jaF9pbm5lci5maW5kKCcuZmEtY2xvbmUnKS5yZW1vdmUoKTtcbiAgICBhY3RpdmVfYnJhbmNoX2lubmVyLmZpbmQoJz4gLnF1ZXN0aW9uLXByZXZpZXcnKS5yZW1vdmUoKTtcblxuICAgIC8vYXBwZW5kIGV4aXQgYnV0dG9uXG4gICAgYWN0aXZlX2JyYW5jaF9pbm5lci5wcmVwZW5kKGV4aXRfYnRuX2h0bWwpO1xuXG4gICAgLy9kaXNhYmxlIGZvcm0gdGFiIGJ1dHRvbnNcbiAgICB1aS5mb3Jtc190YWJzLnRvZ2dsZUZvcm1UYWJzQnV0dG9ucyh7ZW5hYmxlOiBmYWxzZX0pO1xuXG4gICAgLy9wcmVwYXJlIHVpIGZvciBlZGl0aW5nIGJyYW5jaFxuICAgIHNlbGYuc2hvd0VkaXRCcmFuY2hVSSgpO1xuXG4gICAgYWN0aXZlX2JyYW5jaFxuICAgICAgICAuZmluZCgnLmV4aXQtYnJhbmNoLWVkaXRpbmcnKVxuICAgICAgICAub25lKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHNlbGYuZXhpdEJyYW5jaFNvcnRhYmxlKCk7XG4gICAgICAgIH0pO1xuXG4gICAgLypcbiAgICAgY2hhbmdlIGJpbmRpbmcgd2hlbiBlZGl0aW5nIGEgYnJhbmNoLCBhcyB3ZSB3YW50IHRvIGluY2VyY2VwdCBvbmx5IGEgbW91c2Vkb3duIHRvIHRoZSBleGl0IGJ1dHRvbiBvbiB0aGUgYWN0aXZlIGJyYW5jaCBpbnB1dFxuICAgICAqL1xuICAgIC8vZGVzdHJveSBzb3J0YWJsZSBvbmx5IGlmIGl0IGlzIHNldCBhbHJlYWR5IChzZWUgaHR0cDovL2dvby5nbC9yaU40WWspXG4gICAgaWYgKGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbl9zb3J0YWJsZS5kYXRhKCd1aS1zb3J0YWJsZScpKSB7XG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbl9zb3J0YWJsZS5zb3J0YWJsZSgnZGVzdHJveScpOy8vUmVtb3ZlIHRoZSBwbHVnaW4gZnVuY3Rpb25hbGl0eVxuICAgIH1cblxuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbl9zb3J0YWJsZS5vZmYoJ21vdXNlZG93bicpLm9uKCdtb3VzZWRvd24nLCAnLmZhLWNoZXZyb24tbGVmdCcsIGlucHV0X2NvbGxlY3Rpb25fc29ydGFibGVfbW91c2Vkb3duX2NhbGxiYWNrKTtcblxuICAgIC8vaGlkZSBmb3JtIHRpdGxlIHdhcm5pbmcgcmVnYXJkbGVzcyAocGFzc2luZyAxKT0+IHRoaXMgaXMgZm9yIHRoZSBmb3JtIHdoaWNoIG93bnMgdGhlIGJyYW5jaFxuICAgIHVpLmlucHV0c19jb2xsZWN0aW9uLnRvZ2dsZVRpdGxlV2FybmluZygxLCBmYWxzZSk7XG5cbiAgICAvL3Nob3cvaGlkZSB3YXJuaW5nIGZvciB0aGUgYnJhbmNoXG4gICAgdWkuaW5wdXRzX2NvbGxlY3Rpb24udG9nZ2xlVGl0bGVXYXJuaW5nKHV0aWxzLmdldFRpdGxlQ291bnQoYnJhbmNoX2lucHV0cyksIHRydWUpO1xuXG4gICAgLy9wdXNoIHN0YXRlIHRvIGVuYWJsZSB1bmRvaW5nIHRoZSBhY3Rpb24gKGFkZGluZy9kcmFnZ2luZyBpbnB1dClcbiAgICB1bmRvLnB1c2hTdGF0ZSgpO1xufTtcblxuQnJhbmNoSW5wdXQucHJvdG90eXBlLmV4aXRCcmFuY2hTb3J0YWJsZSA9IGZ1bmN0aW9uICgpIHtcblxuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB2YXIgc29ydGFibGUgPSByZXF1aXJlKCd1aS1oYW5kbGVycy9zb3J0YWJsZScpO1xuICAgIHZhciBjdXJyZW50X2Zvcm1fbmFtZSA9IGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbi5kYXRhLnByb2plY3QuZm9ybXNbZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4XS5uYW1lO1xuICAgIHZhciBhY3RpdmVfYnJhbmNoID0gZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uX3NvcnRhYmxlLmZpbmQoJy5pbnB1dC5hY3RpdmUtYnJhbmNoJyk7XG4gICAgdmFyIGFjdGl2ZV9icmFuY2hfaW5wdXRfc29ydGFibGUgPSBhY3RpdmVfYnJhbmNoLmZpbmQoJy5icmFuY2gtc29ydGFibGUnKTtcbiAgICB2YXIgYWN0aXZlX2JyYW5jaF9pbm5lciA9IGFjdGl2ZV9icmFuY2guZmluZCgnID4gLmlucHV0LWlubmVyJyk7XG4gICAgdmFyIGFjdGl2ZV9icmFuY2hfaW5wdXQ7XG4gICAgdmFyIGlucHV0cyA9IGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbi5kYXRhLnByb2plY3QuZm9ybXNbZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4XS5pbnB1dHM7XG5cbiAgICBpZiAoZm9ybWJ1aWxkZXIuYnJhbmNoLmN1cnJlbnRfaW5wdXRfcmVmKSB7XG4gICAgICAgIGFjdGl2ZV9icmFuY2hfaW5wdXQgPSB1dGlscy5nZXRCcmFuY2hJbnB1dE9iamVjdEJ5UmVmKGZvcm1idWlsZGVyLmJyYW5jaC5jdXJyZW50X2lucHV0X3JlZik7XG4gICAgICAgIC8vdmFsaWRhdGUgbGFzdCBhY3RpdmUgZ3JvdXAgaW5wdXQgYW5kIHVwZGF0ZSBkb20gYWNjb3JkaW5nbHlcbiAgICAgICAgdmFsaWRhdGlvbi5wZXJmb3JtVmFsaWRhdGlvbihhY3RpdmVfYnJhbmNoX2lucHV0LCBmYWxzZSk7XG4gICAgfVxuXG4gICAgYWN0aXZlX2JyYW5jaC5yZW1vdmVDbGFzcygnYWN0aXZlLWJyYW5jaCcpLmFkZENsYXNzKCdhY3RpdmUnKTtcblxuXG4gICAgLy9yZW1vdmUgZXhpdCBidXR0b25cbiAgICBhY3RpdmVfYnJhbmNoX2lubmVyLmZpbmQoJy5leGl0LWJyYW5jaC1lZGl0aW5nJykucmVtb3ZlKCk7XG5cbiAgICAvL3Jlc3RvcmUgcXVlc3Rpb24gaW4gaW5wdXQgY29sbGVjdGlvblxuICAgIGFjdGl2ZV9icmFuY2hfaW5uZXIucHJlcGVuZCgnPHNwYW4gY2xhc3M9XCJxdWVzdGlvbi1wcmV2aWV3XCI+JyArIHNlbGYucXVlc3Rpb24gKyAnPC9zcGFuPicpO1xuICAgIGFjdGl2ZV9icmFuY2hfaW5uZXIucHJlcGVuZCgnPGkgY2xhc3M9XCJmYSBmYS0yeCBmYS1mdyBmYS1jbG9uZVwiPjwvaT4nKTtcblxuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbl9zb3J0YWJsZS5maW5kKCcuaW5wdXQnKS5ub3QoJy5hY3RpdmUnKS5zbGlkZURvd24oY29uc3RzLkFOSU1BVElPTl9OT1JNQUwpO1xuXG4gICAgLy91cGRhdGUgcGFuZWwgaGVhZGVyXG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uLmZpbmQoJy5pbnB1dHMtY29sbGVjdGlvbl9faGVhZGVyX19lZGl0LXN0YXRlJykudGV4dChtZXNzYWdlcy5sYWJlbHMuRURJVElOR19GT1JNKTtcbiAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb24uZmluZCgnLmlucHV0cy1jb2xsZWN0aW9uX19oZWFkZXJfX2VsZW1lbnQtbmFtZScpLnRleHQoY3VycmVudF9mb3JtX25hbWUudHJ1bmMoY29uc3RzLklOUFVUU19DT0xMRUNUSU9OX0JSQU5DSF9OQU1FX01BWF9ESVNQTEFZX0xFTkdIVCkpO1xuXG4gICAgLy9zaG93IGZvcm0gYWN0aW9uIGJ1dHRvbnMgaW4gcGFuZWwgaGVhZGluZ1xuICAgIHVpLmlucHV0c19jb2xsZWN0aW9uLnRvZ2dsZUZvcm1BY3Rpb25CdXR0b25zKHRydWUpO1xuXG4gICAgLy9lbmFibGUganVtcHMgdGFiXG4gICAgdWkuaW5wdXRfcHJvcGVydGllc19wYW5lbC50b2dnbGVKdW1wVGFiKHNlbGYucmVmLCB0cnVlKTtcblxuICAgIHNlbGYudG9nZ2xlRWRpdEJ1dHRvbih0cnVlKTtcblxuICAgIC8vc2V0IGRyYWdnYWJsZSB0byB3b3JrIHdpdGggbWFpbiBzb3J0YWJsZVxuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfdG9vbHNfZHJhZ2dhYmxlLmRyYWdnYWJsZSgnb3B0aW9uJywgJ2Nvbm5lY3RUb1NvcnRhYmxlJywgJy5zb3J0YWJsZScpO1xuXG4gICAgYWN0aXZlX2JyYW5jaF9pbnB1dF9zb3J0YWJsZS5hZGRDbGFzcygnaGlkZGVuJyk7XG5cbiAgICAvKlxuICAgICByZXN0b3JlIHBhcmVudCBiaW5kaW5nIGFmdGVyIGV4aXRpbmcgYnJhbmNoIGVkaXRpbmdcbiAgICAgKi9cbiAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25fc29ydGFibGUub2ZmKCdtb3VzZWRvd24nKS5vbignbW91c2Vkb3duJywgJ2Rpdi5pbnB1dCcsIGlucHV0X2NvbGxlY3Rpb25fc29ydGFibGVfbW91c2Vkb3duX2NhbGxiYWNrKTtcblxuXG4gICAgLy9yZS1iaW5kIHNvcnRhYmxlIHBsdWdpblxuICAgIHNvcnRhYmxlKCk7XG5cbiAgICBzZWxmLnZhbGlkYXRlQnJhbmNoSW5wdXRzKCk7XG5cbiAgICAvL3RvZG86IGhpZGUgY3VycmVudCBpbnB1dCBhbmQgc2hvdyBicmFuY2hcbiAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyXG4gICAgICAgIC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fbm8taW5wdXQtc2VsZWN0ZWQnKS5oaWRlKCk7XG5cbiAgICAvL2hpZGUgcHJldmlvdXNseSBzZWxlY3RlZCBicmFuY2ggaW5wdXQgcHJvcGVydGllcyBwYW5lbFxuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXJcbiAgICAgICAgLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIGZvcm1idWlsZGVyLmJyYW5jaC5jdXJyZW50X2lucHV0X3JlZiArICdcIl0nKS5oaWRlKCk7XG5cbiAgICAvL3Nob3cgYnJhbmNoIGlucHV0IHByb3BlcnRpZXMgcGFuZWxcbiAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyXG4gICAgICAgIC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fZm9ybVtkYXRhLWlucHV0LXJlZj1cIicgKyBmb3JtYnVpbGRlci5icmFuY2guYWN0aXZlX2JyYW5jaF9yZWYgKyAnXCJdJykuZmFkZUluKGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG5cbiAgICAvL2VuYWJsZSBicmFuY2ggaW5wdXQgdG9vbHMgaW4gbGVmdCBzaWRlYmFyLCBhcyB3ZSBjYW5ub3QgaGF2ZSBhIGJyYW5jaCB3aXRoaW5nIGEgYnJhbmNoXG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c190b29sc19kcmFnZ2FibGUuZmlsdGVyKCcuaW5wdXQtYnJhbmNoJykuc2hvdygpO1xuXG4gICAgZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19icmFuY2ggPSBmYWxzZTtcbiAgICBmb3JtYnVpbGRlci5icmFuY2guY3VycmVudF9pbnB1dF9yZWYgPSB1bmRlZmluZWQ7XG5cbiAgICAvL2VuYWJsZSBmb3JtIHRhYiBidXR0b25zXG4gICAgdWkuZm9ybXNfdGFicy50b2dnbGVGb3JtVGFic0J1dHRvbnMoe2VuYWJsZTogdHJ1ZX0pO1xuXG4gICAgLy9zaG93IGFjdGlvbiBidXR0b25zIGZvciBvd25lciBpbnB1dFxuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2J1dHRvbnMuZmFkZUluKGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG5cbiAgICAvL3Nob3cgdGl0bGUgd2FybmluZyBpZiBubyB0aXRsZSBzZXRcbiAgICAvL3RvZG8gaXMgdGhpcyBuZWVkZWQ/XG4gICAgdWkuaW5wdXRzX2NvbGxlY3Rpb24udG9nZ2xlVGl0bGVXYXJuaW5nKHV0aWxzLmdldFRpdGxlQ291bnQoaW5wdXRzKSwgZmFsc2UpO1xufTtcblxuXG5CcmFuY2hJbnB1dC5wcm90b3R5cGUuc2hvd0VkaXRCcmFuY2hVSSA9IGZ1bmN0aW9uICgpIHtcblxuICAgIHZhciBzZWxmID0gdGhpcztcblxuICAgIC8vaGlkZSBmaXJzdCBsZXZlbCBpbnB1dHMgZnJvbSB0aGUgaW5wdXQgY29sbGVjdGlvblxuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbl9zb3J0YWJsZS5maW5kKCcgPiAuaW5wdXQnKS5ub3QoJy5hY3RpdmUtYnJhbmNoJykuc2xpZGVVcChjb25zdHMuQU5JTUFUSU9OX05PUk1BTCk7XG5cbiAgICAvL3VwZGF0ZSBwYW5lbCBoZWFkZXJcbiAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb24uZmluZCgnLmlucHV0cy1jb2xsZWN0aW9uX19oZWFkZXJfX2VkaXQtc3RhdGUnKS50ZXh0KG1lc3NhZ2VzLmxhYmVscy5FRElUSU5HX0JSQU5DSCk7XG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uLmZpbmQoJy5pbnB1dHMtY29sbGVjdGlvbl9faGVhZGVyX19lbGVtZW50LW5hbWUnKS50ZXh0KHNlbGYucXVlc3Rpb24udHJ1bmMoY29uc3RzLklOUFVUU19DT0xMRUNUSU9OX0JSQU5DSF9OQU1FX01BWF9ESVNQTEFZX0xFTkdIVCkpO1xuXG4gICAgLy9kaXNhYmxlIGZvcm0gYWN0aW9uIGJ1dHRvbnMgaW4gcGFuZWwgaGVhZGluZ1xuICAgIHVpLmlucHV0c19jb2xsZWN0aW9uLnRvZ2dsZUZvcm1BY3Rpb25CdXR0b25zKGZhbHNlKTtcblxuICAgIC8vZGlzYWJsZSBqdW1wcyB0YWIgLy90b2RvIGlzIHRoaXMgbmVlZGVkP1xuICAgIHVpLmlucHV0X3Byb3BlcnRpZXNfcGFuZWwudG9nZ2xlSnVtcFRhYihzZWxmLnJlZiwgZmFsc2UpO1xuXG4gICAgLy9oaWRlIG93bmVyIGJyYW5jaCBpbnB1dCBwYW5lbCBhbmQgc2hvdyAnbm8gYnJhbmNoIGlucHV0cyBzZWxlY3RlZCcgYnkgZGVmYXVsdFxuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXJcbiAgICAgICAgLmZpbmQoJ2Zvcm1bZGF0YS1pbnB1dC1yZWY9XCInICsgc2VsZi5yZWYgKyAnXCJdJykuaGlkZSgpO1xuXG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlclxuICAgICAgICAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX25vLWlucHV0LXNlbGVjdGVkJykuc2hvdygpO1xuXG4gICAgLy9oaWRlIGlucHV0IHByb3BlcnRpZXMgcGFuZWwgYWN0aW9uIGJ1dHRvbnMgdW50aWwgYSBicmFuY2ggaW5wdXQgZ2V0cyBzZWxlY3RlZFxuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2J1dHRvbnMuZmFkZU91dChjb25zdHMuQU5JTUFUSU9OX0ZBU1QpO1xuXG5cbiAgICAvL2Rpc2FibGUgYnJhbmNoIGlucHV0IHRvb2xzIGluIGxlZnQgc2lkZWJhciwgYXMgd2UgY2Fubm90IGhhdmUgYSBicmFuY2ggd2l0aGluZyBhIGJyYW5jaFxuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfdG9vbHNfZHJhZ2dhYmxlLmZpbHRlcignLmlucHV0LWJyYW5jaCcpLmhpZGUoKTtcblxufTtcblxuQnJhbmNoSW5wdXQucHJvdG90eXBlLnZhbGlkYXRlQnJhbmNoSW5wdXRzID0gZnVuY3Rpb24gKCkge1xuXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHZhciBicmFuY2hfaW5wdXRzX3ZhbGlkYXRpb24gPSB2YWxpZGF0aW9uLnZhbGlkYXRlQnJhbmNoSW5wdXRzKHNlbGYpO1xuXG4gICAgc2VsZi5kb20ucHJvcGVydGllc19wYW5lbCA9IGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXIuZmluZCgnZm9ybVtkYXRhLWlucHV0LXJlZj1cIicgKyBzZWxmLnJlZiArICdcIl0nKTtcblxuICAgIGlmICghYnJhbmNoX2lucHV0c192YWxpZGF0aW9uLmlzX3ZhbGlkKSB7XG4gICAgICAgIC8vaGlnaGxpZ2h0IHdyb25nIGlucHV0IGFuZCBzaG93IGVycm9yIG1lc3NhZ2VcbiAgICAgICAgZXJyb3JzLnNob3dCcmFuY2hJbnB1dHNFcnJvcnMoc2VsZi5kb20ucHJvcGVydGllc19wYW5lbCwgYnJhbmNoX2lucHV0c192YWxpZGF0aW9uLmVycm9yLm1lc3NhZ2UpO1xuICAgICAgICAvL3NldCBlbGVtZW50IGFzIGludmFsaWRcbiAgICAgICAgc2VsZi5kb20uaXNfdmFsaWQgPSBmYWxzZTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIC8vc2V0IGVsZW1lbnQgYXMgdmFsaWRcbiAgICAgICAgc2VsZi5kb20uaXNfdmFsaWQgPSB0cnVlO1xuICAgICAgICBlcnJvcnMuaGlkZUJyYW5jaElucHV0c0Vycm9ycyhzZWxmLmRvbS5wcm9wZXJ0aWVzX3BhbmVsKTtcbiAgICB9XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IEJyYW5jaElucHV0O1xuIiwiLyogZ2xvYmFsICQqL1xuJ3VzZSBzdHJpY3QnO1xudmFyIGNvbnN0cyA9IHJlcXVpcmUoJ2NvbmZpZy9jb25zdHMnKTtcbnZhciBlcnJvcnMgPSByZXF1aXJlKCdhY3Rpb25zL2Vycm9ycycpO1xudmFyIGp1bXBzID0gcmVxdWlyZSgnYWN0aW9ucy9qdW1wcycpO1xudmFyIHNhdmUgPSByZXF1aXJlKCdhY3Rpb25zL3NhdmUnKTtcbnZhciBwb3NzaWJsZV9hbnN3ZXJzID0gcmVxdWlyZSgnYWN0aW9ucy9wb3NzaWJsZS1hbnN3ZXJzJyk7XG52YXIgaW5wdXRfcHJvcGVydGllcyA9IHJlcXVpcmUoJ2ZhY3RvcnkvaW5wdXQtcHJvcGVydGllcycpO1xudmFyIElucHV0ID0gcmVxdWlyZSgnZmFjdG9yeS9pbnB1dC1wcm90b3R5cGUnKTtcbnZhciBJbnB1dE11bHRpcGxlQW5zd2VycyA9IHJlcXVpcmUoJ2ZhY3RvcnkvaW5wdXQtbXVsdGlwbGUtYW5zd2Vycy1wcm90b3R5cGUnKTtcbnZhciB2YWxpZGF0aW9uID0gcmVxdWlyZSgnYWN0aW9ucy92YWxpZGF0aW9uJyk7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCcuLi9jb25maWcvZm9ybWJ1aWxkZXInKTtcbnZhciB1aSA9IHJlcXVpcmUoJ2hlbHBlcnMvdWknKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoJ2hlbHBlcnMvdXRpbHMnKTtcblxudmFyIENoZWNrYm94SW5wdXQgPSBmdW5jdGlvbiAodGhlX2lucHV0X3JlZikge1xuXG4gICAgLy9leHRlbmQgYmFzaWMgaW5wdXQgd2loIGNvbW1vbiBwcm9wZXJ0aWVzIChlYXNpZXIgdGhhbiBwYXNzaW5nIGEgcHJvcGVydGllcyBvYmplY3QgdG8gT2JqZWN0LmNyZWF0ZSlcbiAgICAkLmV4dGVuZCh0cnVlLCB0aGlzLCBpbnB1dF9wcm9wZXJ0aWVzKTtcblxuICAgIC8vc2V0IGRlZmF1bHQgcHJvcGVydGllc1xuICAgIC8vdGhpcy5pbmRleCA9IHRoZV9pbmRleDtcbiAgICB0aGlzLnJlZiA9IHRoZV9pbnB1dF9yZWY7XG4gICAgdGhpcy50eXBlID0gY29uc3RzLkNIRUNLQk9YX1RZUEU7XG5cbiAgICAvL3NldCBhIGRlZmF1bHQgYW5zd2VyIG9uIG5ld2x5IGNyZWF0ZWQgZHJvcGRvd25zIGlucHV0c1xuICAgIHRoaXMucG9zc2libGVfYW5zd2VycyA9IFt7XG4gICAgICAgIGFuc3dlcjogJ0kgYW0gYSBwbGFjZWhvbGRlciBhbnN3ZXInLFxuICAgICAgICBhbnN3ZXJfcmVmOiB1dGlscy5nZW5lcmF0ZVVuaXFJRCgpXG4gICAgfV07XG5cblxuICAgIC8qIHJlc2V0IERPTSBwcm9wZXJ0aWVzIChqcXVlcnkgc2VsZWN0b3JzIGFyZSBub3QgJ2xpdmUnLCB3ZSBuZWVkIHRvIHJ1biB0aGVtIGFnYWluIGZvciBuZXcgb2JqZWN0KVxuICAgICAqXG4gICAgICogaWYgdGhlIHByb3BlcnR5IGJlbG93IGlzIG5vdCByZXNldCBoZXJlLCBhbGwgdGhlIGlucHV0cyB3aWxsIGdldCB0aGUgc2FtZSBkb20gcmVmZXJlbmNlXG4gICAgICogKi9cbiAgICB0aGlzLmRvbSA9IHt9O1xuICAgIHRoaXMuZG9tLmlzX3ZhbGlkID0gZmFsc2U7XG5cbiAgICAvL3BhZ2luYXRpb24gZGVmYXVsdHNcbiAgICBmb3JtYnVpbGRlci5wb3NzaWJsZV9hbnN3ZXJzX3BhZ2luYXRpb25bdGhpcy5yZWZdID0ge307XG4gICAgZm9ybWJ1aWxkZXIucG9zc2libGVfYW5zd2Vyc19wYWdpbmF0aW9uW3RoaXMucmVmXS5wYWdlID0gMTtcbn07XG5cbi8vZXh0ZW5kIHByb3RvdHlwZSBmcm9tIGJhc2ljIGlucHV0IG9iamVjdCBhbmQgbXVsdGlwbGUgYW5zd2VyIG9iamVjdFxuQ2hlY2tib3hJbnB1dC5wcm90b3R5cGUgPSAkLmV4dGVuZCh7fSwgSW5wdXQucHJvdG90eXBlLCBJbnB1dE11bHRpcGxlQW5zd2Vycy5wcm90b3R5cGUpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IENoZWNrYm94SW5wdXQ7XG4iLCIndXNlIHN0cmljdCc7XG52YXIgY29uc3RzID0gcmVxdWlyZSgnLi4vY29uZmlnL2NvbnN0cycpO1xudmFyIGVycm9ycyA9IHJlcXVpcmUoJ2FjdGlvbnMvZXJyb3JzJyk7XG52YXIganVtcHMgPSByZXF1aXJlKCdhY3Rpb25zL2p1bXBzJyk7XG52YXIgc2F2ZSA9IHJlcXVpcmUoJ2FjdGlvbnMvc2F2ZScpO1xudmFyIGlucHV0X3Byb3BlcnRpZXMgPSByZXF1aXJlKCdmYWN0b3J5L2lucHV0LXByb3BlcnRpZXMnKTtcbnZhciBJbnB1dCA9IHJlcXVpcmUoJ2ZhY3RvcnkvaW5wdXQtcHJvdG90eXBlJyk7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCcuLi9jb25maWcvZm9ybWJ1aWxkZXInKTtcbnZhciB1aSA9IHJlcXVpcmUoJ2hlbHBlcnMvdWknKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoJ2hlbHBlcnMvdXRpbHMnKTtcblxudmFyIERhdGVJbnB1dCA9IGZ1bmN0aW9uICh0aGVfaW5wdXRfcmVmKSB7XG5cbiAgICAkLmV4dGVuZCh0cnVlLCB0aGlzLCBpbnB1dF9wcm9wZXJ0aWVzKTtcblxuICAgIC8vc2V0IGN1cnJlbnQgaW5zdGFuY2UgcHJvcGVydGllc1xuICAgIC8vdGhpcy5pbmRleCA9IHRoZV9pbmRleDtcbiAgICB0aGlzLnJlZiA9IHRoZV9pbnB1dF9yZWY7XG4gICAgdGhpcy50eXBlID0gY29uc3RzLkRBVEVfVFlQRTtcblxuICAgIC8qIHJlc2V0IERPTSBwcm9wZXJ0aWVzIChqcXVlcnkgc2VsZWN0b3JzIGFyZSBub3QgJ2xpdmUnLCB3ZSBuZWVkIHRvIHJ1biB0aGVtIGFnYWluIGZvciBuZXcgb2JqZWN0KVxuICAgICAqXG4gICAgICogaWYgdGhlIHByb3BlcnR5IGJlbG93IGlzIG5vdCByZXNldCBoZXJlLCBhbGwgdGhlIGlucHV0cyB3aWxsIGdldCB0aGUgc2FtZSBkb20gcmVmZXJlbmNlXG4gICAgICogKi9cbiAgICB0aGlzLmRvbSA9IHt9O1xuICAgIHRoaXMuZG9tLmlzX3ZhbGlkID0gZmFsc2U7XG59O1xuXG4vL2V4dGVuZCBwcm90b3R5cGUgZnJvbSBiYXNpYyBpbnB1dCBvYmplY3RcbkRhdGVJbnB1dC5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKElucHV0LnByb3RvdHlwZSk7XG5cbi8qXG4gT3ZlcnJpZGVzXG4gKi9cblxuRGF0ZUlucHV0LnByb3RvdHlwZS5zZXRBZHZhbmNlZElucHV0UHJvcGVydGllcyA9IGZ1bmN0aW9uICgpIHtcblxuICAgIHRoaXMuZG9tLmFkdmFuY2VkX3Byb3BlcnRpZXNfd3JhcHBlciA9IGZvcm1idWlsZGVyXG4gICAgICAgIC5kb21cbiAgICAgICAgLmlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlclxuICAgICAgICAuZmluZCgnZm9ybVtkYXRhLWlucHV0LXJlZj1cIicgKyB0aGlzLnJlZiArICdcIl0nKVxuICAgICAgICAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2FkdmFuY2VkLXByb3BlcnRpZXMnKTtcblxuICAgIC8vc2V0IGRlZmF1bHQgdG8gY3VycmVudCBkYXRldGltZT9cbiAgICB0aGlzLmRvbS5hZHZhbmNlZF9wcm9wZXJ0aWVzX3dyYXBwZXJcbiAgICAgICAgLmZpbmQoJ2Rpdi5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19hZHZhbmNlZC1wcm9wZXJ0aWVzX19kZWZhdWx0LXRvLWN1cnJlbnQgaW5wdXQnKS5wcm9wKCdjaGVja2VkJywgdGhpcy5zZXRfdG9fY3VycmVudF9kYXRldGltZSk7XG5cbiAgICAvL3NldCBkYXRldGltZSBmb3JtYXRcbiAgICB0aGlzLmRvbS5hZHZhbmNlZF9wcm9wZXJ0aWVzX3dyYXBwZXJcbiAgICAgICAgLmZpbmQoJ2Rpdi5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19hZHZhbmNlZC1wcm9wZXJ0aWVzX19kYXRlZm9ybWF0IGlucHV0W25hbWU9XCJkYXRlZm9ybWF0UmFkaW9cIl1bdmFsdWU9XCInICsgdGhpcy5kYXRldGltZV9mb3JtYXQgKyAnXCJdJylcbiAgICAgICAgLnByb3AoJ2NoZWNrZWQnLCB0cnVlKTtcblxuICAgIHVpLmlucHV0X3Byb3BlcnRpZXNfcGFuZWwuc2V0VW5pcXVlbmVzc1Byb3BlcnR5KGZvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleCwgdGhpcyk7XG59O1xuXG5cbkRhdGVJbnB1dC5wcm90b3R5cGUuc2F2ZUFkdmFuY2VkUHJvcGVydGllcyA9IGZ1bmN0aW9uICgpIHtcblxuICAgIHRoaXMuZG9tLmFkdmFuY2VkX3Byb3BlcnRpZXNfd3JhcHBlciA9IGZvcm1idWlsZGVyXG4gICAgICAgIC5kb21cbiAgICAgICAgLmlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlclxuICAgICAgICAuZmluZCgnZm9ybVtkYXRhLWlucHV0LXJlZj1cIicgKyB0aGlzLnJlZiArICdcIl0nKVxuICAgICAgICAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2FkdmFuY2VkLXByb3BlcnRpZXMnKTtcblxuICAgIC8vc2V0IGRlZmF1bHQgdG8gY3VycmVudCBkYXRldGltZT9cbiAgICB0aGlzLnNldF90b19jdXJyZW50X2RhdGV0aW1lID0gdGhpcy5kb20uYWR2YW5jZWRfcHJvcGVydGllc193cmFwcGVyXG4gICAgICAgIC5maW5kKCdkaXYuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fYWR2YW5jZWQtcHJvcGVydGllc19fZGVmYXVsdC10by1jdXJyZW50IGlucHV0JylcbiAgICAgICAgLmlzKCc6Y2hlY2tlZCcpO1xuXG4gICAgLy9zZXQgZGF0ZXRpbWUgZm9ybWF0XG4gICAgdGhpcy5kYXRldGltZV9mb3JtYXQgPSB0aGlzLmRvbS5hZHZhbmNlZF9wcm9wZXJ0aWVzX3dyYXBwZXJcbiAgICAgICAgLmZpbmQoJ2Rpdi5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19hZHZhbmNlZC1wcm9wZXJ0aWVzX19kYXRlZm9ybWF0IGlucHV0W25hbWU9XCJkYXRlZm9ybWF0UmFkaW9cIl06Y2hlY2tlZCcpXG4gICAgICAgIC52YWwoKTtcblxuICAgIC8vc2F2ZSB1bmlxdWVuZXNzXG4gICAgc2F2ZS5zYXZlVW5pcXVlbmVzcyh0aGlzKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gRGF0ZUlucHV0O1xuIiwiLyogZ2xvYmFsICQqL1xuJ3VzZSBzdHJpY3QnO1xudmFyIGNvbnN0cyA9IHJlcXVpcmUoJy4uL2NvbmZpZy9jb25zdHMnKTtcbnZhciBlcnJvcnMgPSByZXF1aXJlKCdhY3Rpb25zL2Vycm9ycycpO1xudmFyIGp1bXBzID0gcmVxdWlyZSgnYWN0aW9ucy9qdW1wcycpO1xudmFyIHNhdmUgPSByZXF1aXJlKCdhY3Rpb25zL3NhdmUnKTtcbnZhciBpbnB1dF9wcm9wZXJ0aWVzID0gcmVxdWlyZSgnZmFjdG9yeS9pbnB1dC1wcm9wZXJ0aWVzJyk7XG52YXIgSW5wdXQgPSByZXF1aXJlKCdmYWN0b3J5L2lucHV0LXByb3RvdHlwZScpO1xudmFyIElucHV0TXVsdGlwbGVBbnN3ZXJzID0gcmVxdWlyZSgnZmFjdG9yeS9pbnB1dC1tdWx0aXBsZS1hbnN3ZXJzLXByb3RvdHlwZScpO1xudmFyIHZhbGlkYXRpb24gPSByZXF1aXJlKCdhY3Rpb25zL3ZhbGlkYXRpb24nKTtcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJy4uL2NvbmZpZy9mb3JtYnVpbGRlcicpO1xudmFyIHVpID0gcmVxdWlyZSgnaGVscGVycy91aScpO1xudmFyIHV0aWxzID0gcmVxdWlyZSgnaGVscGVycy91dGlscycpO1xuXG52YXIgRHJvcGRvd25JbnB1dCA9IGZ1bmN0aW9uICh0aGVfaW5wdXRfcmVmKSB7XG5cbiAgICAvL2V4dGVuZCBiYXNpYyBpbnB1dCB3aWggY29tbW9uIHByb3BlcnRpZXMgKGVhc2llciB0aGFuIHBhc3NpbmcgYSBwcm9wZXJ0aWVzIG9iamVjdCB0byBPYmplY3QuY3JlYXRlKVxuICAgICQuZXh0ZW5kKHRydWUsIHRoaXMsIGlucHV0X3Byb3BlcnRpZXMpO1xuXG4gICAgLy9zZXQgZGVmYXVsdCBwcm9wZXJ0aWVzXG4gICAgLy90aGlzLmluZGV4ID0gdGhlX2luZGV4O1xuICAgIHRoaXMucmVmID0gdGhlX2lucHV0X3JlZjtcbiAgICB0aGlzLnR5cGUgPSBjb25zdHMuRFJPUERPV05fVFlQRTtcblxuICAgIC8vc2V0IGEgZGVmYXVsdCBhbnN3ZXIgb24gbmV3bHkgY3JlYXRlZCBkcm9wZG93bnMgaW5wdXRzXG4gICAgdGhpcy5wb3NzaWJsZV9hbnN3ZXJzID0gW3tcbiAgICAgICAgYW5zd2VyOiAnSSBhbSBhIHBsYWNlaG9sZGVyIGFuc3dlcicsXG4gICAgICAgIGFuc3dlcl9yZWY6IHV0aWxzLmdlbmVyYXRlVW5pcUlEKClcbiAgICB9XTtcblxuICAgIC8qIHJlc2V0IERPTSBwcm9wZXJ0aWVzIChqcXVlcnkgc2VsZWN0b3JzIGFyZSBub3QgJ2xpdmUnLCB3ZSBuZWVkIHRvIHJ1biB0aGVtIGFnYWluIGZvciBuZXcgb2JqZWN0KVxuICAgICAqXG4gICAgICogaWYgdGhlIHByb3BlcnR5IGJlbG93IGlzIG5vdCByZXNldCBoZXJlLCBhbGwgdGhlIGlucHV0cyB3aWxsIGdldCB0aGUgc2FtZSBkb20gcmVmZXJlbmNlXG4gICAgICogKi9cbiAgICB0aGlzLmRvbSA9IHt9O1xuICAgIHRoaXMuZG9tLmlzX3ZhbGlkID0gZmFsc2U7XG5cbiAgICAvL3BhZ2luYXRpb24gZGVmYXVsdHNcbiAgICBmb3JtYnVpbGRlci5wb3NzaWJsZV9hbnN3ZXJzX3BhZ2luYXRpb25bdGhpcy5yZWZdID0ge307XG4gICAgZm9ybWJ1aWxkZXIucG9zc2libGVfYW5zd2Vyc19wYWdpbmF0aW9uW3RoaXMucmVmXS5wYWdlID0gMTtcbn07XG5cbi8vZXh0ZW5kIHByb3RvdHlwZSBmcm9tIGJhc2ljIGlucHV0IG9iamVjdCBhbmQgbXVsdGlwbGUgYW5zd2VyIG9iamVjdFxuRHJvcGRvd25JbnB1dC5wcm90b3R5cGUgPSAkLmV4dGVuZCh7fSwgSW5wdXQucHJvdG90eXBlLCBJbnB1dE11bHRpcGxlQW5zd2Vycy5wcm90b3R5cGUpO1xuXG5cbm1vZHVsZS5leHBvcnRzID0gRHJvcGRvd25JbnB1dDtcbiIsIi8qIGdsb2JhbCAkKi9cbid1c2Ugc3RyaWN0JztcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgZXJyb3JzID0gcmVxdWlyZSgnYWN0aW9ucy9lcnJvcnMnKTtcbnZhciBtZXNzYWdlcyA9IHJlcXVpcmUoJ2NvbmZpZy9tZXNzYWdlcycpO1xudmFyIGp1bXBzID0gcmVxdWlyZSgnYWN0aW9ucy9qdW1wcycpO1xudmFyIHNhdmUgPSByZXF1aXJlKCdhY3Rpb25zL3NhdmUnKTtcbnZhciBpbnB1dF9wcm9wZXJ0aWVzID0gcmVxdWlyZSgnZmFjdG9yeS9pbnB1dC1wcm9wZXJ0aWVzJyk7XG52YXIgSW5wdXQgPSByZXF1aXJlKCdmYWN0b3J5L2lucHV0LXByb3RvdHlwZScpO1xudmFyIHZhbGlkYXRpb24gPSByZXF1aXJlKCdhY3Rpb25zL3ZhbGlkYXRpb24nKTtcbnZhciB1aSA9IHJlcXVpcmUoJ2hlbHBlcnMvdWknKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoJ2hlbHBlcnMvdXRpbHMnKTtcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJ2NvbmZpZy9mb3JtYnVpbGRlcicpO1xudmFyIGdyb3VwX3NvcnRhYmxlID0gcmVxdWlyZSgndWktaGFuZGxlcnMvZ3JvdXAtc29ydGFibGUnKTtcbnZhciBpbnB1dF9jb2xsZWN0aW9uX2JyYW5jaF9zb3J0YWJsZV9tb3VzZWRvd25fY2FsbGJhY2sgPSByZXF1aXJlKCd1aS1oYW5kbGVycy9ldmVudC1oYW5kbGVyLWNhbGxiYWNrcy9pbnB1dC1jb2xsZWN0aW9uLWJyYW5jaC1zb3J0YWJsZS1tb3VzZWRvd24tY2FsbGJhY2snKTtcbnZhciBpbnB1dF9jb2xsZWN0aW9uX2dyb3VwX3NvcnRhYmxlX21vdXNlZG93bl9jYWxsYmFjayA9IHJlcXVpcmUoJ3VpLWhhbmRsZXJzL2V2ZW50LWhhbmRsZXItY2FsbGJhY2tzL2lucHV0LWNvbGxlY3Rpb24tZ3JvdXAtc29ydGFibGUtbW91c2Vkb3duLWNhbGxiYWNrJyk7XG52YXIgaW5wdXRfY29sbGVjdGlvbl9uZXN0ZWRfZ3JvdXBfc29ydGFibGVfbW91c2Vkb3duX2NhbGxiYWNrID0gcmVxdWlyZSgndWktaGFuZGxlcnMvZXZlbnQtaGFuZGxlci1jYWxsYmFja3MvaW5wdXQtY29sbGVjdGlvbi1uZXN0ZWQtZ3JvdXAtc29ydGFibGUtbW91c2Vkb3duLWNhbGxiYWNrJyk7XG52YXIgaW5wdXRfY29sbGVjdGlvbl9zb3J0YWJsZV9tb3VzZWRvd25fY2FsbGJhY2sgPSByZXF1aXJlKCd1aS1oYW5kbGVycy9ldmVudC1oYW5kbGVyLWNhbGxiYWNrcy9pbnB1dC1jb2xsZWN0aW9uLXNvcnRhYmxlLW1vdXNlZG93bi1jYWxsYmFjaycpO1xuXG52YXIgR3JvdXBJbnB1dCA9IGZ1bmN0aW9uICh0aGVfaW5wdXRfcmVmKSB7XG5cbiAgICAvL2V4dGVuZCBiYXNpYyBpbnB1dCB3aWggY29tbW9uIHByb3BlcnRpZXMgKGVhc2llciB0aGFuIHBhc3NpbmcgYSBwcm9wZXJ0aWVzIG9iamVjdCB0byBPYmplY3QuY3JlYXRlKVxuICAgICQuZXh0ZW5kKHRydWUsIHRoaXMsIGlucHV0X3Byb3BlcnRpZXMpO1xuXG4gICAgLy9zZXQgY3VycmVudCBpbnN0YW5jZSBwcm9wZXJ0aWVzXG4gICAgLy90aGlzLmluZGV4ID0gdGhlX2luZGV4O1xuICAgIHRoaXMucmVmID0gdGhlX2lucHV0X3JlZjtcbiAgICB0aGlzLnR5cGUgPSBjb25zdHMuR1JPVVBfVFlQRTtcblxuICAgIC8qIHJlc2V0IERPTSBwcm9wZXJ0aWVzIChqcXVlcnkgc2VsZWN0b3JzIGFyZSBub3QgJ2xpdmUnLCB3ZSBuZWVkIHRvIHJ1biB0aGVtIGFnYWluIGZvciBuZXcgb2JqZWN0KVxuICAgICAqXG4gICAgICogaWYgdGhlIHByb3BlcnR5IGJlbG93IGlzIG5vdCByZXNldCBoZXJlLCBhbGwgdGhlIGlucHV0cyB3aWxsIGdldCB0aGUgc2FtZSBkb20gcmVmZXJlbmNlXG4gICAgICogKi9cbiAgICB0aGlzLmRvbSA9IHt9O1xuICAgIHRoaXMuZG9tLmlzX3ZhbGlkID0gZmFsc2U7XG59O1xuXG4vL2V4dGVuZCBwcm90b3R5cGUgZnJvbSBiYXNpYyBpbnB1dCBvYmplY3Rcbkdyb3VwSW5wdXQucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShJbnB1dC5wcm90b3R5cGUpO1xuXG5Hcm91cElucHV0LnByb3RvdHlwZS5pc0hlYWRlclRleHRWYWxpZCA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gdGhpcy5pc1F1ZXN0aW9uVGV4dFZhbGlkKCk7XG59O1xuXG4vL3RvZ2dsZSBlZGl0IGJyYW5jaCBidXR0b25cbkdyb3VwSW5wdXQucHJvdG90eXBlLnRvZ2dsZUVkaXRCdXR0b24gPSBmdW5jdGlvbiAodGhlX3N0YXRlKSB7XG4gICAgdWkuZ3JvdXAudG9nZ2xlRWRpdEdyb3VwQnV0dG9uKHRoaXMucmVmLCB0aGVfc3RhdGUpO1xufTtcblxuR3JvdXBJbnB1dC5wcm90b3R5cGUuZW50ZXJHcm91cFNvcnRhYmxlID0gZnVuY3Rpb24gKGlzX25lc3RlZCkge1xuXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHZhciB1bmRvID0gcmVxdWlyZSgnYWN0aW9ucy91bmRvJyk7XG4gICAgdmFyIGFjdGl2ZV9ncm91cCA9IGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbl9zb3J0YWJsZVxuICAgICAgICAuZmluZCgnZGl2LmlucHV0W2RhdGEtaW5wdXQtcmVmPVwiJyArIHNlbGYucmVmICsgJ1wiXScpO1xuICAgIHZhciBhY3RpdmVfZ3JvdXBfaW5uZXIgPSBhY3RpdmVfZ3JvdXAuZmluZCgnID4gLmlucHV0LWlubmVyJyk7XG4gICAgdmFyIGdyb3VwX2hvbGRlcl9odG1sID0gdWkuaW5wdXRzX2NvbGxlY3Rpb24uZ2V0RW1wdHlDb2xsZWN0aW9uU29ydGFibGVIVE1MKGNvbnN0cy5HUk9VUF9UWVBFKTtcbiAgICB2YXIgZXhpdF9idG5faHRtbCA9ICcnO1xuICAgIHZhciBleGl0X2J1dHRvbl9jbGFzcyA9IGlzX25lc3RlZCA/ICdleGl0LW5lc3RlZC1ncm91cC1lZGl0aW5nJyA6ICdleGl0LWdyb3VwLWVkaXRpbmcnO1xuICAgIGV4aXRfYnRuX2h0bWwgKz0gJzxidXR0b24gY2xhc3M9XCJidG4gYnRuLXNtIGJ0bi1kZWZhdWx0ICcgKyBleGl0X2J1dHRvbl9jbGFzcyArICdcIj4nO1xuICAgIGV4aXRfYnRuX2h0bWwgKz0gJzxpIGNsYXNzPVwiZmEgZmEtMnggZmEtZncgZmEtY2hldnJvbi1sZWZ0IFwiPjwvaT4nO1xuICAgIGV4aXRfYnRuX2h0bWwgKz0gbWVzc2FnZXMubGFiZWxzLkVYSVRfRURJVElORztcbiAgICBleGl0X2J0bl9odG1sICs9ICc8L2J1dHRvbj4nO1xuXG5cbiAgICAvL2Rpc2FibGUganVtcHMgdGFiIHdoZW4gZWRpdGluZyBhIGdyb3VwXG4gICAgJCgnLmp1bXAtdGFiJykuYWRkQ2xhc3MoJ2Rpc2FibGVkIGRpc2FibGVkLXRhYicpO1xuXG4gICAgLy9yZXNldCBncm91cCBvYmplY3QsIGFzIHdlIGNhY2hlIHByb3BlcnRpZXMgb2YgdGhlIGN1cnJlbnQgZW5hYmxlZCBncm91cCBvbmx5XG4gICAgZm9ybWJ1aWxkZXIuZ3JvdXAgPSB7fTtcblxuICAgIC8vc2V0IGRyYWdnYWJsZSB0byB3b3JrIHdpdGggZW5hYmxlZCBncm91cCBvbmx5XG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c190b29sc19kcmFnZ2FibGUuZHJhZ2dhYmxlKCdvcHRpb24nLCAnY29ubmVjdFRvU29ydGFibGUnLCAnLmdyb3VwLXNvcnRhYmxlJyk7XG5cbiAgICAvL3NldCB1c2VmdWwgZmxhZ3NcbiAgICBmb3JtYnVpbGRlci5pc19lZGl0aW5nX2dyb3VwID0gdHJ1ZTtcbiAgICBmb3JtYnVpbGRlci5ncm91cC5hY3RpdmVfZ3JvdXBfcmVmID0gc2VsZi5yZWY7XG5cbiAgICBpZiAoaXNfbmVzdGVkKSB7XG4gICAgICAgIGFjdGl2ZV9ncm91cC5vZmYoKS5vbignbW91c2Vkb3duJywgJ2Rpdi5pbnB1dCcsIGlucHV0X2NvbGxlY3Rpb25fbmVzdGVkX2dyb3VwX3NvcnRhYmxlX21vdXNlZG93bl9jYWxsYmFjayk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgYWN0aXZlX2dyb3VwLm9mZigpLm9uKCdtb3VzZWRvd24nLCAnZGl2LmlucHV0JywgaW5wdXRfY29sbGVjdGlvbl9ncm91cF9zb3J0YWJsZV9tb3VzZWRvd25fY2FsbGJhY2spO1xuICAgIH1cblxuICAgIC8vaWYgaXQgaXMgYSBicmFuZCBuZXcgZ3JvdXAsIGFwcGVuZCBzb3J0YWJsZSBtYXJrdXBcbiAgICBpZiAoYWN0aXZlX2dyb3VwLmZpbmQoJy5ncm91cC1zb3J0YWJsZScpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBncm91cF9ob2xkZXJfaHRtbCA9IGdyb3VwX2hvbGRlcl9odG1sLnJlcGxhY2UoJ3t7Z3JvdXAtaW5wdXRzfX0nLCAnJyk7XG4gICAgICAgIGFjdGl2ZV9ncm91cC5hcHBlbmQoZ3JvdXBfaG9sZGVyX2h0bWwpO1xuICAgICAgICBhY3RpdmVfZ3JvdXAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX25vLWdyb3VwLXF1ZXN0aW9ucy1tZXNzYWdlJykuc2hvdygpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgaWYgKGZvcm1idWlsZGVyLnJlbmRlcl9hY3Rpb24gPT09IGNvbnN0cy5SRU5ERVJfQUNUSU9OX1VORE8gJiYgYWN0aXZlX2dyb3VwLmZpbmQoJy5ncm91cC1zb3J0YWJsZSA+IGRpdicpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgYWN0aXZlX2dyb3VwLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19uby1ncm91cC1xdWVzdGlvbnMtbWVzc2FnZScpLnNob3coKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vZW5hYmxlIGdyb3VwIHNvcnRhYmxlXG4gICAgYWN0aXZlX2dyb3VwLmZpbmQoJy5ncm91cC1zb3J0YWJsZScpLnNvcnRhYmxlKGdyb3VwX3NvcnRhYmxlKS5kaXNhYmxlU2VsZWN0aW9uKCkucmVtb3ZlQ2xhc3MoJ2hpZGRlbicpO1xuXG4gICAgLy9yZW1vdmUgYW55IHByZXZpb3VzbHkgc2VsZWN0ZWQgZ3JvdXAgaW5wdXRcbiAgICBhY3RpdmVfZ3JvdXAuZmluZCgnLmdyb3VwLXNvcnRhYmxlJykuZmluZCgnLmlucHV0LmFjdGl2ZScpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcblxuICAgIC8vc2hvdyBleGl0IGVkaXRpbmcgYnV0dG9uXG4gICAgYWN0aXZlX2dyb3VwLmFkZENsYXNzKCdhY3RpdmUtZ3JvdXAnKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG5cbiAgICAvL3JlbW92ZSBmaXJzdCB0d28gZWxlbWVudHNcbiAgICBhY3RpdmVfZ3JvdXBfaW5uZXIuZmluZCgnLmZhLWFsaWduLWp1c3RpZnknKS5yZW1vdmUoKTtcbiAgICBhY3RpdmVfZ3JvdXBfaW5uZXIuZmluZCgnPiAucXVlc3Rpb24tcHJldmlldycpLnJlbW92ZSgpO1xuXG4gICAgLy9hcHBlbmQgZXhpdCBidXR0b25cbiAgICBhY3RpdmVfZ3JvdXBfaW5uZXIucHJlcGVuZChleGl0X2J0bl9odG1sKTtcblxuICAgIC8vZGlzYWJsZSBmb3JtIHRhYiBidXR0b25zXG4gICAgdWkuZm9ybXNfdGFicy50b2dnbGVGb3JtVGFic0J1dHRvbnMoe1xuICAgICAgICBlbmFibGU6IGZhbHNlXG4gICAgfSk7XG5cbiAgICAvL3ByZXBhcmUgdWkgZm9yIGVkaXRpbmcgZ3JvdXBcbiAgICBpZiAoaXNfbmVzdGVkKSB7XG4gICAgICAgIHNlbGYuc2hvd0VkaXROZXN0ZWRHcm91cFVJKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgc2VsZi5zaG93RWRpdEdyb3VwVUkoKTtcbiAgICB9XG5cbiAgICBhY3RpdmVfZ3JvdXBcbiAgICAgICAgLmZpbmQoJy4nICsgZXhpdF9idXR0b25fY2xhc3MpXG4gICAgICAgIC5vbmUoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKGlzX25lc3RlZCkge1xuICAgICAgICAgICAgICAgIHNlbGYuZXhpdE5lc3RlZEdyb3VwU29ydGFibGUoKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgc2VsZi5leGl0R3JvdXBTb3J0YWJsZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgIC8qXG4gICAgIGNoYW5nZSBiaW5kaW5nIHdoZW4gZWRpdGluZyBhIGdyb3VwLCBhcyB3ZSB3YW50IHRvIGluY2VyY2VwdCBvbmx5IGEgbW91c2Vkb3duIHRvIHRoZSBleGl0IGJ1dHRvbiBvbiB0aGUgYWN0aXZlIGdyb3VwIGlucHV0XG4gICAgICovXG4gICAgLy9kZXN0cm95IHRvcCBwYXJlbnQgc29ydGFibGVcbiAgICBjb25zb2xlLmxvZygnZ3JvdXAuanMgY2FsbHMgZGVzdHJveScpO1xuXG4gICAgLyoqKioqKioqIE5FRURFRCBCVUcgKioqKioqKioqL1xuICAgIC8qIFRoZSBjYWxsIHRvICdkZXN0cm95JyB3aWxsIHRyaWdnZXIgYW4gZXJyb3IgdGhlIGZpcnN0IHRpbWUsIGJ1dCBpZiBpdCBkb2VzIG5vdCAoY2F0Y2hpbmcgdGhlIGVycm9yIG9yIHVzaW5nIHRoZSBjb21tZW50ZWQgJ2lmIGVsc2UnIHN0YXRlbWVudClcbiAgICAgKiAgd2hlbiBleGl0aW5nIHRoZSBncm91cCB0aGUgcGFyZW50IHNvcnRhYmxlIHdpbGwgbm90IHdvcmsgYW55bW9yZSwgd2hldGhlciBpcyBhIHRvcCBsZXZlbCBzb3J0YWJsZSBvciBhIGJyYW5jaCBzb3J0YWJsZS5cbiAgICAgKiAgdG9kbyBsb29rIGludG8gaXRcbiAgICAgKlxuICAgICAqICovXG4gICAgaWYgKGZvcm1idWlsZGVyLnJlbmRlcl9hY3Rpb24gPT09IGNvbnN0cy5SRU5ERVJfQUNUSU9OX0RPKSB7XG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbl9zb3J0YWJsZS5zb3J0YWJsZSgnZGVzdHJveScpO1xuICAgIH1cbiAgICAvKioqKioqKiogRU5EIE5FRURFRCBCVUcgKioqKioqKioqL1xuXG4gICAgLy8gZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uX3NvcnRhYmxlLmZpbmQoJy5hY3RpdmUtYnJhbmNoLmhpZGRlbi1hY3RpdmUtYnJhbmNoIC5icmFuY2gtc29ydGFibGUnKS5zb3J0YWJsZSgnZGVzdHJveScpO1xuICAgIGlmIChpc19uZXN0ZWQpIHtcbiAgICAgICAgLy9kaXNhYmxlIG1vdXNlZG93blxuICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25fc29ydGFibGVcbiAgICAgICAgICAgIC5maW5kKCcuYWN0aXZlLWJyYW5jaC5oaWRkZW4tYWN0aXZlLWJyYW5jaCAuYnJhbmNoLXNvcnRhYmxlJylcbiAgICAgICAgICAgIC5vZmYoJ21vdXNlZG93bicpXG4gICAgICAgICAgICAub24oJ21vdXNlZG93bicsICcuZmEtY2hldnJvbi1sZWZ0JywgaW5wdXRfY29sbGVjdGlvbl9icmFuY2hfc29ydGFibGVfbW91c2Vkb3duX2NhbGxiYWNrKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25fc29ydGFibGUub24oJ21vdXNlZG93bicsICcuZmEtY2hldnJvbi1sZWZ0JywgaW5wdXRfY29sbGVjdGlvbl9zb3J0YWJsZV9tb3VzZWRvd25fY2FsbGJhY2spO1xuICAgIH1cblxuICAgIHVuZG8ucHVzaFN0YXRlKCk7XG59O1xuXG5Hcm91cElucHV0LnByb3RvdHlwZS5leGl0TmVzdGVkR3JvdXBTb3J0YWJsZSA9IGZ1bmN0aW9uICgpIHtcblxuICAgIC8vZXhpdCBuZXN0ZWQgZ3JvdXAgc29ydGFibGVcbiAgICBjb25zb2xlLmxvZygnZXhpdGluZyBuZXN0ZWQgZ3JvdXAsIGdvZXMgdXAgdG8gYnJhbmNoJyk7XG5cbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgdmFyIGJyYW5jaF9zb3J0YWJsZSA9IHJlcXVpcmUoJ3VpLWhhbmRsZXJzL2JyYW5jaC1zb3J0YWJsZScpO1xuICAgIHZhciBhY3RpdmVfYnJhbmNoID0gZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uX3NvcnRhYmxlLmZpbmQoJy5hY3RpdmUtYnJhbmNoJyk7XG4gICAgdmFyIGN1cnJlbnRfYnJhbmNoID0gdXRpbHMuZ2V0SW5wdXRPYmplY3RCeVJlZihmb3JtYnVpbGRlci5icmFuY2guYWN0aXZlX2JyYW5jaF9yZWYpO1xuICAgIHZhciBjdXJyZW50X2JyYW5jaF9uYW1lID0gY3VycmVudF9icmFuY2gucXVlc3Rpb247XG4gICAgdmFyIGFjdGl2ZV9ncm91cCA9IGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbl9zb3J0YWJsZS5maW5kKCcuaW5wdXQuYWN0aXZlLWdyb3VwJyk7XG4gICAgdmFyIGFjdGl2ZV9ncm91cF9pbnB1dF9zb3J0YWJsZSA9IGFjdGl2ZV9ncm91cC5maW5kKCcuZ3JvdXAtc29ydGFibGUnKTtcbiAgICB2YXIgYWN0aXZlX2dyb3VwX2lubmVyID0gYWN0aXZlX2dyb3VwLmZpbmQoJyA+IC5pbnB1dC1pbm5lcicpO1xuICAgIHZhciBhY3RpdmVfbmVzdGVkX2dyb3VwX2lucHV0O1xuXG4gICAgaWYgKGZvcm1idWlsZGVyLmdyb3VwLmN1cnJlbnRfaW5wdXRfcmVmKSB7XG4gICAgICAgIGFjdGl2ZV9uZXN0ZWRfZ3JvdXBfaW5wdXQgPSB1dGlscy5nZXROZXN0ZWRHcm91cElucHV0T2JqZWN0QnlSZWYoY3VycmVudF9icmFuY2gsIGZvcm1idWlsZGVyLmdyb3VwLmN1cnJlbnRfaW5wdXRfcmVmKTtcbiAgICAgICAgLy92YWxpZGF0ZSBsYXN0IGFjdGl2ZSBncm91cCBpbnB1dCBhbmQgdXBkYXRlIGRvbSBhY2NvcmRpbmdseSAoaWYgYW4gaW5wdXQgd2FzIHNlbGVjdGVkKVxuICAgICAgICB2YWxpZGF0aW9uLnBlcmZvcm1WYWxpZGF0aW9uKGFjdGl2ZV9uZXN0ZWRfZ3JvdXBfaW5wdXQsIGZhbHNlLCBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24pO1xuICAgIH1cblxuICAgIC8vZW5hYmxlIG93bmVyIGJyYW5jaCBzb3J0YWJsZVxuICAgIGFjdGl2ZV9icmFuY2guZmluZCgnLmJyYW5jaC1zb3J0YWJsZScpLnNvcnRhYmxlKGJyYW5jaF9zb3J0YWJsZSkuZGlzYWJsZVNlbGVjdGlvbigpO1xuXG4gICAgYWN0aXZlX2dyb3VwLnJlbW92ZUNsYXNzKCdhY3RpdmUtZ3JvdXAnKS5hZGRDbGFzcygnYWN0aXZlJyk7XG5cbiAgICAvL3JlbW92ZSBleGl0IGJ1dHRvblxuICAgIGFjdGl2ZV9ncm91cF9pbm5lci5maW5kKCcuZXhpdC1uZXN0ZWQtZ3JvdXAtZWRpdGluZycpLnJlbW92ZSgpO1xuXG4gICAgLy9yZXN0b3JlIHF1ZXN0aW9uIGluIGlucHV0IGNvbGxlY3Rpb25cbiAgICBhY3RpdmVfZ3JvdXBfaW5uZXIucHJlcGVuZCgnPHNwYW4gY2xhc3M9XCJxdWVzdGlvbi1wcmV2aWV3XCI+JyArIHNlbGYucXVlc3Rpb24gKyAnPC9zcGFuPicpO1xuICAgIGFjdGl2ZV9ncm91cF9pbm5lci5wcmVwZW5kKCc8aSBjbGFzcz1cImZhIGZhLTJ4IGZhLWZ3IGZhLWFsaWduLWp1c3RpZnlcIj48L2k+Jyk7XG5cbiAgICAvL3Nob3cgb3duZXIgYnJhbmNoXG4gICAgYWN0aXZlX2JyYW5jaFxuICAgICAgICAucmVtb3ZlQ2xhc3MoJ2hpZGRlbi1hY3RpdmUtYnJhbmNoJylcbiAgICAgICAgLmZpbmQoJyA+IC5pbnB1dC1pbm5lciA+IGknKVxuICAgICAgICAuZmFkZUluKGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG5cbiAgICBhY3RpdmVfYnJhbmNoLmZpbmQoJyA+IC5pbnB1dC1pbm5lciA+IC5leGl0LWJyYW5jaC1lZGl0aW5nJykuZmFkZUluKGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG5cbiAgICAvL3Nob3cgaW5hY3RpdmUgYnJhbmNoIGlucHV0c1xuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbl9zb3J0YWJsZVxuICAgICAgICAuZmluZCgnLmFjdGl2ZS1icmFuY2gnKVxuICAgICAgICAuZmluZCgnLmJyYW5jaC1zb3J0YWJsZScpXG4gICAgICAgIC5maW5kKCcgPiAuaW5wdXQnKVxuICAgICAgICAubm90KCcuYWN0aXZlLWdyb3VwJylcbiAgICAgICAgLnNsaWRlRG93bihjb25zdHMuQU5JTUFUSU9OX05PUk1BTCk7XG5cbiAgICAvL3VwZGF0ZSBtaWRkbGUgY29sdW0gcGFuZWwgaGVhZGVyIHNob3dpbmcgb3duZXIgYnJhbmNoIHF1ZXN0aW9uXG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uLmZpbmQoJy5pbnB1dHMtY29sbGVjdGlvbl9faGVhZGVyX19lZGl0LXN0YXRlJykudGV4dChtZXNzYWdlcy5sYWJlbHMuRURJVElOR19CUkFOQ0gpO1xuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbi5maW5kKCcuaW5wdXRzLWNvbGxlY3Rpb25fX2hlYWRlcl9fZWxlbWVudC1uYW1lJykudGV4dChjdXJyZW50X2JyYW5jaF9uYW1lLnRydW5jKGNvbnN0cy5JTlBVVFNfQ09MTEVDVElPTl9HUk9VUF9OQU1FX01BWF9ESVNQTEFZX0xFTkdIVCkpO1xuXG4gICAgc2VsZi50b2dnbGVFZGl0QnV0dG9uKHRydWUpO1xuXG4gICAgLy9zZXQgZHJhZ2dhYmxlIHRvIHdvcmsgd2l0aCB0aGUgYWN0aXZlIGJyYW5jaCBzb3J0YWJsZVxuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfdG9vbHNfZHJhZ2dhYmxlLmRyYWdnYWJsZSgnb3B0aW9uJywgJ2Nvbm5lY3RUb1NvcnRhYmxlJywgJy5icmFuY2gtc29ydGFibGUnKTtcblxuICAgIC8vaGlkZSBuZXN0ZWQgZ3JvdXAgc29ydGFibGVcbiAgICBhY3RpdmVfZ3JvdXBfaW5wdXRfc29ydGFibGUuYWRkQ2xhc3MoJ2hpZGRlbicpO1xuXG4gICAgLypcbiAgICAgcmVzdG9yZSBwYXJlbnQgYmluZGluZyBhZnRlciBleGl0aW5nIGdyb3VwIGVkaXRpbmdcbiAgICAgKi9cbiAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25fc29ydGFibGVcbiAgICAgICAgLmZpbmQoJy5hY3RpdmUtYnJhbmNoJylcbiAgICAgICAgLm9mZigpXG4gICAgICAgIC5vbignbW91c2Vkb3duJywgJ2Rpdi5pbnB1dCcsIGlucHV0X2NvbGxlY3Rpb25fYnJhbmNoX3NvcnRhYmxlX21vdXNlZG93bl9jYWxsYmFjayk7XG5cbiAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25fc29ydGFibGUuZmluZCgnLmFjdGl2ZS1icmFuY2ggPiAuYnJhbmNoLXNvcnRhYmxlJykuc29ydGFibGUoYnJhbmNoX3NvcnRhYmxlKTtcblxuICAgIC8vaWYgYm90aCBoZWFkZXIgYW5kIGdyb3VwcyBhcmUgdmFsaWQsIHNob3cgZ3JlZW4gY2hlY2sgb24gYWN0aXZlIGdyb3VwIGlucHV0XG4gICAgaWYgKHNlbGYuZG9tLmlzX3ZhbGlkKSB7XG4gICAgICAgIC8vcmVwbGFjZSB3YXJuaW5nIGljb24gd2l0aCBncmVlbiBjaGVja1xuICAgICAgICB1aS5pbnB1dHNfY29sbGVjdGlvbi5zaG93SW5wdXRWYWxpZEljb24oc2VsZi5yZWYpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIC8vcmVwbGFjZSB3YXJuaW5nIGljb24gd2l0aCBncmVlbiBjaGVja1xuICAgICAgICB1aS5pbnB1dHNfY29sbGVjdGlvbi5zaG93SW5wdXRJbnZhbGlkSWNvbihzZWxmLnJlZik7XG4gICAgfVxuXG4gICAgLy9zaG93IGEgcHJldmlldyBvZiB0aGUgbmVzdGVkIGdyb3VwIGhlYWRlciAobGltaXQgdG8gMjAgY2hhcnMpXG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXMuZmluZCgnLnBhbmVsLXRpdGxlIHNwYW4ucXVlc3Rpb24tcHJldmlldycpLnRleHQoc2VsZi5xdWVzdGlvbi50cnVuYygyMCkpO1xuXG4gICAgLy9oaWRlIG5vIGlucHV0cyBzZWxlY3RlZCAoanVzdCBpbiBjYXNlIG5vIGlucHV0IHdhcyBzZWxlY3RlZCBpbiB0aGUgbmVzdGVkIGdyb3VwKVxuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXJcbiAgICAgICAgLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19uby1pbnB1dC1zZWxlY3RlZCcpLmhpZGUoKTtcblxuICAgIC8vaGlkZSBhbnkgaW5wdXQgcHJldmlvdXNseSBzZWxlY3RlZFxuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXJcbiAgICAgICAgLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIGZvcm1idWlsZGVyLmdyb3VwLmN1cnJlbnRfaW5wdXRfcmVmICsgJ1wiXScpLmhpZGUoKTtcblxuICAgIC8vc2hvdyBuZXN0ZWQgZ3JvdXAgaW5wdXQgcHJvcGVydGllcyBwYW5lbFxuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXJcbiAgICAgICAgLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIGZvcm1idWlsZGVyLmdyb3VwLmFjdGl2ZV9ncm91cF9yZWYgKyAnXCJdJykuZmFkZUluKGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG5cbiAgICAvL2VuYWJsZSBncm91cCBpbnB1dCB0b29scyBpbiBsZWZ0IHNpZGViYXJcbiAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX3Rvb2xzX2RyYWdnYWJsZS5maWx0ZXIoJy5pbnB1dC1ncm91cCcpLnNob3coKTtcblxuICAgIGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfZ3JvdXAgPSBmYWxzZTtcbiAgICBmb3JtYnVpbGRlci5ncm91cC5jdXJyZW50X2lucHV0X3JlZiA9IHVuZGVmaW5lZDtcblxuICAgIC8vZW5hYmxlIGp1bXBzIHRhYiB3aGVuIGV4aXQgZWRpdGluZyBhIGdyb3VwXG4gICAgJCgnLmp1bXAtdGFiJykucmVtb3ZlQ2xhc3MoJ2Rpc2FibGVkIGRpc2FibGVkLXRhYicpO1xuXG4gICAgLy9zaG93IGFjdGlvbiBidXR0b25zIGZvciBvd25lciBpbnB1dFxuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2J1dHRvbnMuZmFkZUluKGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG59O1xuXG5Hcm91cElucHV0LnByb3RvdHlwZS5leGl0R3JvdXBTb3J0YWJsZSA9IGZ1bmN0aW9uICgpIHtcblxuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB2YXIgYWN0aXZlX2dyb3VwX2lucHV0O1xuICAgIHZhciBzb3J0YWJsZSA9IHJlcXVpcmUoJ3VpLWhhbmRsZXJzL3NvcnRhYmxlJyk7XG4gICAgdmFyIGN1cnJlbnRfZm9ybV9uYW1lID0gZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uLmRhdGEucHJvamVjdC5mb3Jtc1tmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXhdLm5hbWU7XG4gICAgdmFyIGFjdGl2ZV9ncm91cCA9IGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbl9zb3J0YWJsZS5maW5kKCcuaW5wdXQuYWN0aXZlLWdyb3VwJyk7XG4gICAgdmFyIGFjdGl2ZV9ncm91cF9pbnB1dF9zb3J0YWJsZSA9IGFjdGl2ZV9ncm91cC5maW5kKCcuZ3JvdXAtc29ydGFibGUnKTtcbiAgICB2YXIgYWN0aXZlX2dyb3VwX2lubmVyID0gYWN0aXZlX2dyb3VwLmZpbmQoJyA+IC5pbnB1dC1pbm5lcicpO1xuXG4gICAgaWYgKGZvcm1idWlsZGVyLmdyb3VwLmN1cnJlbnRfaW5wdXRfcmVmKSB7XG4gICAgICAgIGFjdGl2ZV9ncm91cF9pbnB1dCA9IHV0aWxzLmdldEdyb3VwSW5wdXRPYmplY3RCeVJlZihmb3JtYnVpbGRlci5ncm91cC5jdXJyZW50X2lucHV0X3JlZik7XG4gICAgICAgIC8vdmFsaWRhdGUgbGFzdCBhY3RpdmUgZ3JvdXAgaW5wdXQgYW5kIHVwZGF0ZSBkb20gYWNjb3JkaW5nbHlcbiAgICAgICAgdmFsaWRhdGlvbi5wZXJmb3JtVmFsaWRhdGlvbihhY3RpdmVfZ3JvdXBfaW5wdXQsIGZhbHNlLCBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24pO1xuICAgIH1cblxuICAgIGFjdGl2ZV9ncm91cC5yZW1vdmVDbGFzcygnYWN0aXZlLWdyb3VwJykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuXG4gICAgLy9yZW1vdmUgZXhpdCBidXR0b25cbiAgICBhY3RpdmVfZ3JvdXBfaW5uZXIuZmluZCgnLmV4aXQtZ3JvdXAtZWRpdGluZycpLnJlbW92ZSgpO1xuXG4gICAgLy9yZXN0b3JlIHF1ZXN0aW9uIGluIGlucHV0IGNvbGxlY3Rpb25cbiAgICBhY3RpdmVfZ3JvdXBfaW5uZXIucHJlcGVuZCgnPHNwYW4gY2xhc3M9XCJxdWVzdGlvbi1wcmV2aWV3XCI+JyArIHNlbGYucXVlc3Rpb24gKyAnPC9zcGFuPicpO1xuICAgIGFjdGl2ZV9ncm91cF9pbm5lci5wcmVwZW5kKCc8aSBjbGFzcz1cImZhIGZhLTJ4IGZhLWZ3IGZhLWFsaWduLWp1c3RpZnlcIj48L2k+Jyk7XG5cbiAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25fc29ydGFibGUuZmluZCgnLmlucHV0Jykubm90KCcuYWN0aXZlJykuc2xpZGVEb3duKGNvbnN0cy5BTklNQVRJT05fTk9STUFMKTtcblxuICAgIC8vdXBkYXRlIHBhbmVsIGhlYWRlclxuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbi5maW5kKCcuaW5wdXRzLWNvbGxlY3Rpb25fX2hlYWRlcl9fZWRpdC1zdGF0ZScpLnRleHQobWVzc2FnZXMubGFiZWxzLkVESVRJTkdfRk9STSk7XG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uLmZpbmQoJy5pbnB1dHMtY29sbGVjdGlvbl9faGVhZGVyX19lbGVtZW50LW5hbWUnKS50ZXh0KGN1cnJlbnRfZm9ybV9uYW1lLnRydW5jKGNvbnN0cy5JTlBVVFNfQ09MTEVDVElPTl9HUk9VUF9OQU1FX01BWF9ESVNQTEFZX0xFTkdIVCkpO1xuXG4gICAgLy9zaG93IGZvcm0gYWN0aW9uIGJ1dHRvbnMgaW4gcGFuZWwgaGVhZGluZ1xuICAgIHVpLmlucHV0c19jb2xsZWN0aW9uLnRvZ2dsZUZvcm1BY3Rpb25CdXR0b25zKHRydWUpO1xuXG4gICAgLy9lbmFibGUganVtcHMgdGFiXG4gICAgdWkuaW5wdXRfcHJvcGVydGllc19wYW5lbC50b2dnbGVKdW1wVGFiKHNlbGYucmVmLCB0cnVlKTtcblxuICAgIHNlbGYudG9nZ2xlRWRpdEJ1dHRvbih0cnVlKTtcblxuICAgIC8vc2V0IGRyYWdnYWJsZSB0byB3b3JrIHdpdGggbWFpbiBzb3J0YWJsZVxuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfdG9vbHNfZHJhZ2dhYmxlLmRyYWdnYWJsZSgnb3B0aW9uJywgJ2Nvbm5lY3RUb1NvcnRhYmxlJywgJy5zb3J0YWJsZScpO1xuXG4gICAgYWN0aXZlX2dyb3VwX2lucHV0X3NvcnRhYmxlLmFkZENsYXNzKCdoaWRkZW4nKTtcblxuICAgIC8qXG4gICAgIHJlc3RvcmUgcGFyZW50IGJpbmRpbmcgYW5kIHNvcnRhYmxlIGFmdGVyIGV4aXRpbmcgZ3JvdXAgZWRpdGluZ1xuICAgICAqL1xuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbl9zb3J0YWJsZS5vZmYoJ21vdXNlZG93bicpLm9uKCdtb3VzZWRvd24nLCAnZGl2LmlucHV0JywgaW5wdXRfY29sbGVjdGlvbl9zb3J0YWJsZV9tb3VzZWRvd25fY2FsbGJhY2spO1xuICAgIHNvcnRhYmxlKCk7XG5cbiAgICAvL2lmIGJvdGggaGVhZGVyIGFuZCBncm91cHMgYXJlIHZhbGlkLCBzaG93IGdyZWVuIGNoZWNrIG9uIGFjdGl2ZSBncm91cCBpbnB1dFxuICAgIGlmIChzZWxmLmRvbS5pc192YWxpZCkge1xuICAgICAgICAvL3VwZGF0ZSB0aGUganVzdCBzYXZlZCBpbnB1dCBzaG93aW5nIGEgcHJldmlldyBvZiB0aGUgcXVlc3Rpb24gdGV4dCAobGltaXQgdG8gNTAgY2hhcnMpXG4gICAgICAgIHVpLmlucHV0c19jb2xsZWN0aW9uLnNob3dJbnB1dFF1ZXN0aW9uUHJldmlldyhzZWxmLnJlZiwgc2VsZi5xdWVzdGlvbi50cnVuYyg1MCkpO1xuICAgICAgICAvL3JlcGxhY2Ugd2FybmluZyBpY29uIHdpdGggZ3JlZW4gY2hlY2tcbiAgICAgICAgdWkuaW5wdXRzX2NvbGxlY3Rpb24uc2hvd0lucHV0VmFsaWRJY29uKHNlbGYucmVmKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICAvL3JlcGxhY2Ugd2FybmluZyBpY29uIHdpdGggZ3JlZW4gY2hlY2tcbiAgICAgICAgdWkuaW5wdXRzX2NvbGxlY3Rpb24uc2hvd0lucHV0SW52YWxpZEljb24oc2VsZi5yZWYpO1xuICAgIH1cblxuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXJcbiAgICAgICAgLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19uby1pbnB1dC1zZWxlY3RlZCcpLmhpZGUoKTtcblxuICAgIC8vaGlkZSBhbnkgaW5wdXQgcHJldmlvdXNseSBzZWxlY3RlZFxuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXJcbiAgICAgICAgLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIGZvcm1idWlsZGVyLmdyb3VwLmN1cnJlbnRfaW5wdXRfcmVmICsgJ1wiXScpLmhpZGUoKTtcblxuICAgIC8vc2hvdyBicmFuY2ggaW5wdXQgcHJvcGVydGllcyBwYW5lbFxuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXJcbiAgICAgICAgLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIGZvcm1idWlsZGVyLmdyb3VwLmFjdGl2ZV9ncm91cF9yZWYgKyAnXCJdJykuZmFkZUluKGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG5cbiAgICAvL2VuYWJsZSBicmFuY2ggJiBncm91cCBpbnB1dCB0b29scyBpbiBsZWZ0IHNpZGViYXJcbiAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX3Rvb2xzX2RyYWdnYWJsZS5maWx0ZXIoJy5pbnB1dC1icmFuY2gsIC5pbnB1dC1ncm91cCcpLnNob3coKTtcblxuICAgIGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfZ3JvdXAgPSBmYWxzZTtcbiAgICBmb3JtYnVpbGRlci5ncm91cC5jdXJyZW50X2lucHV0X3JlZiA9IHVuZGVmaW5lZDtcblxuICAgIC8vZW5hYmxlIGp1bXBzIHRhYiB3aGVuIGV4aXQgZWRpdGluZyBhIGdyb3VwXG4gICAgJCgnLmp1bXAtdGFiJykucmVtb3ZlQ2xhc3MoJ2Rpc2FibGVkIGRpc2FibGVkLXRhYicpO1xuXG4gICAgLy9zaG93IHRpdGxlIGZsYWdcbiAgICAkKCcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fdGl0bGUtZmxhZycpLnJlbW92ZUNsYXNzKCdoaWRkZW4nKTtcblxuICAgIC8vZW5hYmxlIGZvcm0gdGFicyBidXR0b25zXG4gICAgdWkuZm9ybXNfdGFicy50b2dnbGVGb3JtVGFic0J1dHRvbnMoe1xuICAgICAgICBlbmFibGU6IHRydWVcbiAgICB9KTtcblxuICAgIC8vc2hvdyBhY3Rpb24gYnV0dG9ucyBmb3Igb3duZXIgaW5wdXRcbiAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc19idXR0b25zLmZhZGVJbihjb25zdHMuQU5JTUFUSU9OX0ZBU1QpO1xufTtcblxuR3JvdXBJbnB1dC5wcm90b3R5cGUuc2hvd0VkaXRHcm91cFVJID0gZnVuY3Rpb24gKCkge1xuXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgLy9oaWRlIGZpcnN0IGxldmVsIGlucHV0cyBmcm9tIHRoZSBpbnB1dCBjb2xsZWN0aW9uXG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uX3NvcnRhYmxlLmZpbmQoJyA+IC5pbnB1dCcpLm5vdCgnLmFjdGl2ZS1ncm91cCcpLnNsaWRlVXAoY29uc3RzLkFOSU1BVElPTl9OT1JNQUwpO1xuXG4gICAgLy91cGRhdGUgcGFuZWwgaGVhZGVyXG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uLmZpbmQoJy5pbnB1dHMtY29sbGVjdGlvbl9faGVhZGVyX19lZGl0LXN0YXRlJykudGV4dChtZXNzYWdlcy5sYWJlbHMuRURJVElOR19HUk9VUCk7XG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uLmZpbmQoJy5pbnB1dHMtY29sbGVjdGlvbl9faGVhZGVyX19lbGVtZW50LW5hbWUnKS50ZXh0KHNlbGYucXVlc3Rpb24udHJ1bmMoY29uc3RzLklOUFVUU19DT0xMRUNUSU9OX0dST1VQX05BTUVfTUFYX0RJU1BMQVlfTEVOR0hUKSk7XG5cbiAgICAvL2Rpc2FibGUgZm9ybSBhY3Rpb24gYnV0dG9ucyBpbiBwYW5lbCBoZWFkaW5nXG4gICAgdWkuaW5wdXRzX2NvbGxlY3Rpb24udG9nZ2xlRm9ybUFjdGlvbkJ1dHRvbnMoZmFsc2UpO1xuXG4gICAgLy9kaXNhYmxlIGp1bXBzIHRhYiAvL3RvZG8gaXMgdGhpcyBuZWVkZWQ/XG4gICAgdWkuaW5wdXRfcHJvcGVydGllc19wYW5lbC50b2dnbGVKdW1wVGFiKHNlbGYucmVmLCBmYWxzZSk7XG5cbiAgICAvL2hpZGUgb3duZXIgZ3JvdXAgaW5wdXQgcGFuZWwgYW5kIHNob3cgJ25vIGdyb3VwIGlucHV0cyBzZWxlY3RlZCcgYnkgZGVmYXVsdFxuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXJcbiAgICAgICAgLmZpbmQoJ2Zvcm1bZGF0YS1pbnB1dC1yZWY9XCInICsgc2VsZi5yZWYgKyAnXCJdJykuaGlkZSgpO1xuXG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlclxuICAgICAgICAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX25vLWlucHV0LXNlbGVjdGVkJykuc2hvdygpO1xuXG4gICAgLy9oaWRlIGlucHV0IHByb3BlcnRpZXMgcGFuZWwgYWN0aW9uIGJ1dHRvbnMgdW50aWwgYSBncm91cCBpbnB1dCBnZXRzIHNlbGVjdGVkXG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfYnV0dG9ucy5mYWRlT3V0KGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG5cbiAgICAvLy8vaGlkZSBicmFuY2ggJiBncm91cCBpbnB1dCB0b29scyBpbiBsZWZ0IHNpZGViYXIsIGFzIHdlIGNhbm5vdCBoYXZlIGEgYnJhbmNoIG9yIGEgZ3JvdXAgd2l0aGluZyBhIGdyb3VwXG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c190b29sc19kcmFnZ2FibGUuZmlsdGVyKCcuaW5wdXQtYnJhbmNoLCAuaW5wdXQtZ3JvdXAnKS5oaWRlKCk7XG5cbn07XG5cbkdyb3VwSW5wdXQucHJvdG90eXBlLnNob3dFZGl0TmVzdGVkR3JvdXBVSSA9IGZ1bmN0aW9uICgpIHtcblxuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB2YXIgYWN0aXZlX2JyYW5jaCA9IGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbl9zb3J0YWJsZS5maW5kKCcuYWN0aXZlLWJyYW5jaCcpO1xuXG4gICAgLy9yZW5kZXIgVUkgZm9yIGEgbmVzdGVkIGdyb3VwLCBhcyB3ZSBjYW5ub3QganVzdCBoaWRlIHRoZSBtYWluIHBhcmVudCBzaW5jZSBpdCBpcyBhIGJyYW5jaCBzb3J0YWJsZVxuICAgIC8vaGlkZSBpbmFjdGl2ZSBicmFuY2ggaW5wdXRzIGZyb20gdGhlIGlucHV0IGNvbGxlY3Rpb25cbiAgICBhY3RpdmVfYnJhbmNoXG4gICAgICAgIC5maW5kKCcuYnJhbmNoLXNvcnRhYmxlJylcbiAgICAgICAgLmZpbmQoJyA+IC5pbnB1dCcpXG4gICAgICAgIC5ub3QoJy5hY3RpdmUtZ3JvdXAnKVxuICAgICAgICAuc2xpZGVVcChjb25zdHMuQU5JTUFUSU9OX05PUk1BTCk7XG5cbiAgICAvL2hpZGUgb3duZXIgYnJhbmNoIGFudCBpdHMgaW5hY3RpdmUgaW5wdXRzICh3aXRob3V0IHVzaW5nIGRpc3BsYXk6bm9uZSBhcyB0aGF0IHdpbGwgaGlkZSB0aGUgbmVzdGVkIGdyb3VwIGFzIHdlbGwgOi8pXG4gICAgYWN0aXZlX2JyYW5jaFxuICAgICAgICAuYWRkQ2xhc3MoJ2hpZGRlbi1hY3RpdmUtYnJhbmNoJylcbiAgICAgICAgLmZpbmQoJyA+IC5pbnB1dC1pbm5lciA+IGknKVxuICAgICAgICAuaGlkZSgpO1xuXG4gICAgYWN0aXZlX2JyYW5jaC5maW5kKCcuZXhpdC1icmFuY2gtZWRpdGluZycpLmhpZGUoKTtcblxuICAgIC8vcmVtb3ZlIGFsbCBldmVudHMgZnJvbSBhY3RpdmUgYnJhbmNoIGFzIHdlIGFyZSBvbmx5IGludGVyZXN0ZWQgaW4gdGhlIG1vdXNlZG93biBldmVudCBvZiB0aGUgZ3JvdXAgc29ydGFibGVcbiAgICBhY3RpdmVfYnJhbmNoLm9mZigpO1xuXG4gICAgLy91cGRhdGUgcGFuZWwgaGVhZGVyLCBhcyBpdCBhIG5lc3RlZCBncm91cCBzaG93IGZ1bGwgYnJlYWRjcnVtYnNcbiAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25cbiAgICAgICAgLmZpbmQoJy5pbnB1dHMtY29sbGVjdGlvbl9faGVhZGVyX19lZGl0LXN0YXRlJylcbiAgICAgICAgLnRleHQobWVzc2FnZXMubGFiZWxzLkVESVRJTkdfQlJBTkNIICsgbWVzc2FnZXMubGFiZWxzLkVESVRJTkdfTkVTVEVEX0dST1VQKTtcblxuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbi5maW5kKCcuaW5wdXRzLWNvbGxlY3Rpb25fX2hlYWRlcl9fZWxlbWVudC1uYW1lJykudGV4dChzZWxmLnF1ZXN0aW9uLnRydW5jKGNvbnN0cy5JTlBVVFNfQ09MTEVDVElPTl9HUk9VUF9OQU1FX01BWF9ESVNQTEFZX0xFTkdIVCkpO1xuXG4gICAgLy9oaWRlIG93bmVyIGdyb3VwIGlucHV0IHBhbmVsIGFuZCBzaG93ICdubyBncm91cCBpbnB1dHMgc2VsZWN0ZWQnIGJ5IGRlZmF1bHRcbiAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyXG4gICAgICAgIC5maW5kKCdmb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIHNlbGYucmVmICsgJ1wiXScpLmhpZGUoKTtcbiAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyXG4gICAgICAgIC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fbm8taW5wdXQtc2VsZWN0ZWQnKS5zaG93KCk7XG5cbiAgICAvL2hpZGUgaW5wdXQgcHJvcGVydGllcyBwYW5lbCBhY3Rpb24gYnV0dG9ucyB1bnRpbCBhIGdyb3VwIGlucHV0IGdldHMgc2VsZWN0ZWRcbiAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc19idXR0b25zLmZhZGVPdXQoY29uc3RzLkFOSU1BVElPTl9GQVNUKTtcblxuICAgIC8vLy9kaXNhYmxlIGJyYW5jaCAmIGdyb3VwIGlucHV0IHRvb2xzIGluIGxlZnQgc2lkZWJhciwgYXMgd2UgY2Fubm90IGhhdmUgYSBicmFuY2ggb3IgYSBncm91cCB3aXRoaW5nIGEgZ3JvdXBcbiAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX3Rvb2xzX2RyYWdnYWJsZS5maWx0ZXIoJy5pbnB1dC1icmFuY2gsIC5pbnB1dC1ncm91cCcpLmhpZGUoKTtcbn07XG5cbkdyb3VwSW5wdXQucHJvdG90eXBlLnZhbGlkYXRlR3JvdXBJbnB1dHMgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgdmFyIGdyb3VwX2lucHV0c192YWxpZGF0aW9uID0gdmFsaWRhdGlvbi52YWxpZGF0ZUdyb3VwSW5wdXRzKHNlbGYpO1xuICAgIGlmICghZ3JvdXBfaW5wdXRzX3ZhbGlkYXRpb24uaXNfdmFsaWQpIHtcbiAgICAgICAgLy9oaWdobGlnaHQgd3JvbmcgaW5wdXQgYW5kIHNob3cgZXJyb3IgbWVzc2FnZVxuICAgICAgICBlcnJvcnMuc2hvd0dyb3VwSW5wdXRzRXJyb3JzKHNlbGYuZG9tLnByb3BlcnRpZXNfcGFuZWwsIGdyb3VwX2lucHV0c192YWxpZGF0aW9uLmVycm9yLm1lc3NhZ2UpO1xuICAgICAgICAvL3NldCBlbGVtZW50IGFzIGludmFsaWRcbiAgICAgICAgc2VsZi5kb20uaXNfdmFsaWQgPSBmYWxzZTtcbiAgICB9IGVsc2Uge1xuICAgICAgICAvL3NldCBlbGVtZW50IGFzIHZhbGlkXG4gICAgICAgIHNlbGYuZG9tLmlzX3ZhbGlkID0gdHJ1ZTtcbiAgICAgICAgZXJyb3JzLmhpZGVHcm91cElucHV0c0Vycm9ycyhzZWxmLmRvbS5wcm9wZXJ0aWVzX3BhbmVsKTtcbiAgICB9XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IEdyb3VwSW5wdXQ7XG4iLCIvKiBnbG9iYWwgJCovXG4ndXNlIHN0cmljdCc7XG52YXIgY29uc3RzID0gcmVxdWlyZSgnY29uZmlnL2NvbnN0cycpO1xudmFyIGVycm9ycyA9IHJlcXVpcmUoJ2FjdGlvbnMvZXJyb3JzJyk7XG52YXIganVtcHMgPSByZXF1aXJlKCdhY3Rpb25zL2p1bXBzJyk7XG52YXIgc2F2ZSA9IHJlcXVpcmUoJ2FjdGlvbnMvc2F2ZScpO1xudmFyIG1lc3NhZ2VzID0gcmVxdWlyZSgnY29uZmlnL21lc3NhZ2VzJyk7XG52YXIgaW5wdXRfcHJvcGVydGllcyA9IHJlcXVpcmUoJ2ZhY3RvcnkvaW5wdXQtcHJvcGVydGllcycpO1xudmFyIElucHV0ID0gcmVxdWlyZSgnZmFjdG9yeS9pbnB1dC1wcm90b3R5cGUnKTtcbnZhciB2YWxpZGF0aW9uID0gcmVxdWlyZSgnYWN0aW9ucy92YWxpZGF0aW9uJyk7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcbnZhciB1aSA9IHJlcXVpcmUoJ2hlbHBlcnMvdWknKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoJ2hlbHBlcnMvdXRpbHMnKTtcbnZhciB0ZW1wbGF0ZSA9IHJlcXVpcmUgKCd0ZW1wbGF0ZScpO1xuXG52YXIgTnVtZXJpY0lucHV0ID0gZnVuY3Rpb24gKHRoZV9pbnB1dF9yZWYpIHtcblxuICAgICQuZXh0ZW5kKHRydWUsIHRoaXMsIGlucHV0X3Byb3BlcnRpZXMpO1xuXG4gICAgLy9zZXQgZGVmYXVsdCBwcm9wZXJ0aWVzXG4gICAgLy90aGlzLmluZGV4ID0gdGhlX2luZGV4O1xuICAgIHRoaXMucmVmID0gdGhlX2lucHV0X3JlZjtcbiAgICB0aGlzLnR5cGUgPSBjb25zdHMuSU5URUdFUl9UWVBFO1xuXG4gICAgLyogcmVzZXQgRE9NIHByb3BlcnRpZXMgKGpxdWVyeSBzZWxlY3RvcnMgYXJlIG5vdCAnbGl2ZScsIHdlIG5lZWQgdG8gcnVuIHRoZW0gYWdhaW4gZm9yIG5ldyBvYmplY3QpXG4gICAgICpcbiAgICAgKiBpZiB0aGUgcHJvcGVydHkgYmVsb3cgaXMgbm90IHJlc2V0IGhlcmUsIGFsbCB0aGUgaW5wdXRzIHdpbGwgZ2V0IHRoZSBzYW1lIGRvbSByZWZlcmVuY2VcbiAgICAgKiAqL1xuICAgIHRoaXMuZG9tID0ge307XG4gICAgdGhpcy5kb20uaXNfdmFsaWQgPSBmYWxzZTtcbn07XG5cbi8vZXh0ZW5kIHByb3RvdHlwZSBmcm9tIGJhc2ljIGlucHV0IG9iamVjdFxuTnVtZXJpY0lucHV0LnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoSW5wdXQucHJvdG90eXBlKTtcblxuLypcbiBPdmVycmlkZXNcbiAqL1xuXG4vL3ZhbGlkYXRlIGluaXRpYWwgYW5zd2VyXG5OdW1lcmljSW5wdXQucHJvdG90eXBlLmlzSW5pdGlhbEFuc3dlclZhbGlkID0gZnVuY3Rpb24gKCkge1xuXG4gICAgdmFyIHZhbGlkYXRlID0gdmFsaWRhdGlvbi5pc0luaXRpYWxBbnN3ZXJWYWxpZCh0aGlzLnR5cGUsdGhpcy5kZWZhdWx0LCB0aGlzLnJlZ2V4KTtcblxuICAgIGlmICh2YWxpZGF0ZS5pc192YWxpZCkge1xuICAgICAgICAvL3ZhbGlkYXRlIGZvciBpbnRlZ2VyIHR5cGVcbiAgICAgICAgaWYgKHRoaXMudHlwZSA9PT0gY29uc3RzLklOVEVHRVJfVFlQRSAmJiB0aGlzLmRlZmF1bHQgIT09ICcnKSB7XG4gICAgICAgICAgICAvL2luaXRpYWwgYW5zd2VyIG11c3QgYmUgYW4gaW50ZWdlciwgbm90IGEgZmxvYXRcbiAgICAgICAgICAgIGlmICghdmFsaWRhdGlvbi5pc1ZhbHVlSW50KHRoaXMuZGVmYXVsdCkpIHtcbiAgICAgICAgICAgICAgICB2YWxpZGF0ZS5pc192YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHZhbGlkYXRlLmVycm9yLm1lc3NhZ2UgPSBtZXNzYWdlcy5lcnJvci5WQUxVRV9NVVNUX0JFX0lOVEVHRVI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHZhbGlkYXRlO1xufTtcblxuTnVtZXJpY0lucHV0LnByb3RvdHlwZS5pc01pblZhbHVlVmFsaWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgLy92YWxpZGF0ZSBtaW4gdmFsdWVcbiAgICByZXR1cm4gdmFsaWRhdGlvbi5pc01pbk1heFZhbHVlVmFsaWQodGhpcy50eXBlLCB0aGlzLm1pbik7XG59O1xuXG5OdW1lcmljSW5wdXQucHJvdG90eXBlLmlzTWF4VmFsdWVWYWxpZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAvL3ZhbGlkYXRlIG1heCB2YWx1ZVxuICAgIHJldHVybiB2YWxpZGF0aW9uLmlzTWluTWF4VmFsdWVWYWxpZCh0aGlzLnR5cGUsIHRoaXMubWF4KTtcbn07XG5cbk51bWVyaWNJbnB1dC5wcm90b3R5cGUuc2F2ZUFkdmFuY2VkUHJvcGVydGllcyA9IGZ1bmN0aW9uICgpIHtcblxuICAgIHZhciBpbml0aWFsX2Fuc3dlcl92YWxpZGF0aW9uO1xuICAgIHZhciBtaW5fdmFsdWVfdmFsaWRhdGlvbjtcbiAgICB2YXIgbWF4X3ZhbHVlX3ZhbGlkYXRpb247XG4gICAgdmFyIHVuaXF1ZW5lc3M7XG5cbiAgICB0aGlzLmRvbS5hZHZhbmNlZF9wcm9wZXJ0aWVzX3dyYXBwZXIgPSBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyXG4gICAgICAgIC5maW5kKCdmb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIHRoaXMucmVmICsgJ1wiXScpXG4gICAgICAgIC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fYWR2YW5jZWQtcHJvcGVydGllcycpO1xuXG4gICAgLy9jbGVhciBhbGwgYWR2YW5jZWQgcHJvcGVydGllcyBlcnJvcnMgZnJvbSBkb21cbiAgICB0aGlzLmhpZGVBZHZhbmNlZFByb3BlcnRpZXNFcnJvcnMoKTtcblxuICAgIC8vc2V0IGludGVnZXIgb3IgZGVjaW1hbCBudW1lcmljIHR5cGVcbiAgICB0aGlzLnR5cGUgPSB0aGlzLmRvbS5hZHZhbmNlZF9wcm9wZXJ0aWVzX3dyYXBwZXIuZmluZCgnZGl2LmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2FkdmFuY2VkLXByb3BlcnRpZXNfX251bWVyaWMgaW5wdXQ6Y2hlY2tlZCcpLnZhbCgpO1xuXG4gICAgLy9zZXQgZGVmYXVsdCAoaW5pdGlhbCBhbnN3ZXIpXG4gICAgdGhpcy5kZWZhdWx0ID0gdGhpcy5kb20uYWR2YW5jZWRfcHJvcGVydGllc193cmFwcGVyLmZpbmQoJ2Rpdi5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19hZHZhbmNlZC1wcm9wZXJ0aWVzX19kZWZhdWx0IGlucHV0JykudmFsKCk7XG5cbiAgICAvL3N0cmlwIGh0bWwgdGFnc1xuICAgIHRoaXMuZGVmYXVsdCA9IHRoaXMuZGVmYXVsdC5yZXBsYWNlKC8oPChbXj5dKyk+KS9pZywgJycpO1xuICAgIHRoaXMuZG9tLmFkdmFuY2VkX3Byb3BlcnRpZXNfd3JhcHBlci5maW5kKCdkaXYuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fYWR2YW5jZWQtcHJvcGVydGllc19fZGVmYXVsdCBpbnB1dCcpLnZhbCh0aGlzLmRlZmF1bHQpO1xuXG5cbiAgICAvL3NldCBtaW4gdmFsdWVcbiAgICB0aGlzLm1pbiA9IHRoaXMuZG9tLmFkdmFuY2VkX3Byb3BlcnRpZXNfd3JhcHBlci5maW5kKCdkaXYuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fYWR2YW5jZWQtcHJvcGVydGllc19fbWluIGlucHV0JykudmFsKCk7XG4gICAgdGhpcy5taW4gPSB0aGlzLm1pbi5yZXBsYWNlKC8oPChbXj5dKyk+KS9pZywgJycpO1xuICAgIHRoaXMuZG9tLmFkdmFuY2VkX3Byb3BlcnRpZXNfd3JhcHBlci5maW5kKCdkaXYuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fYWR2YW5jZWQtcHJvcGVydGllc19fbWluIGlucHV0JykudmFsKHRoaXMubWluKTtcblxuICAgIC8vc2V0IG1heCB2YWx1ZVxuICAgIHRoaXMubWF4ID0gdGhpcy5kb20uYWR2YW5jZWRfcHJvcGVydGllc193cmFwcGVyLmZpbmQoJ2Rpdi5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19hZHZhbmNlZC1wcm9wZXJ0aWVzX19tYXggaW5wdXQnKS52YWwoKTtcbiAgICB0aGlzLm1heCA9IHRoaXMubWF4LnJlcGxhY2UoLyg8KFtePl0rKT4pL2lnLCAnJyk7XG4gICAgdGhpcy5kb20uYWR2YW5jZWRfcHJvcGVydGllc193cmFwcGVyLmZpbmQoJ2Rpdi5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19hZHZhbmNlZC1wcm9wZXJ0aWVzX19tYXggaW5wdXQnKS52YWwodGhpcy5tYXgpO1xuXG4gICAgLy9zZXQgcmVnZXhcbiAgICB0aGlzLnJlZ2V4ID0gdGhpcy5kb20uYWR2YW5jZWRfcHJvcGVydGllc193cmFwcGVyLmZpbmQoJ2Rpdi5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19hZHZhbmNlZC1wcm9wZXJ0aWVzX19yZWdleCBpbnB1dCcpLnZhbCgpO1xuICAgIHRoaXMucmVnZXggPSB0aGlzLnJlZ2V4LnJlcGxhY2UoLyg8KFtePl0rKT4pL2lnLCAnJyk7XG4gICAgdGhpcy5kb20uYWR2YW5jZWRfcHJvcGVydGllc193cmFwcGVyLmZpbmQoJ2Rpdi5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19hZHZhbmNlZC1wcm9wZXJ0aWVzX19yZWdleCBpbnB1dCcpLnZhbCh0aGlzLnJlZ2V4KTtcblxuICAgIC8vc2V0IHZlcmlmeSBmbGFnXG4gICAgdGhpcy52ZXJpZnkgPSB0aGlzLmRvbS5hZHZhbmNlZF9wcm9wZXJ0aWVzX3dyYXBwZXIuZmluZCgnZGl2LmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2FkdmFuY2VkLXByb3BlcnRpZXNfX2RvdWJsZS1lbnRyeSBpbnB1dCcpLmlzKCc6Y2hlY2tlZCcpO1xuXG4gICAgLy92YWxpZGF0ZSBpbml0aWFsIGFuc3dlciAoYmFzZWQgYWxzbyBvbiBtaW4gbWF4IGFuZCBudW1lcmljIHR5cGUpXG4gICAgaW5pdGlhbF9hbnN3ZXJfdmFsaWRhdGlvbiA9IHRoaXMuaXNJbml0aWFsQW5zd2VyVmFsaWQoKTtcbiAgICBpZiAoIWluaXRpYWxfYW5zd2VyX3ZhbGlkYXRpb24uaXNfdmFsaWQpIHtcbiAgICAgICAgLy93YXJuIHVzZXIgaW5pdGlhbCBhbnN3ZXIgaXMgbm90IHZhbGlkXG4gICAgICAgIHRoaXMuZG9tLmlzX3ZhbGlkID0gZmFsc2U7XG4gICAgICAgIC8vaGlnaGxpZ2h0IHdyb25nIGlucHV0XG4gICAgICAgIHRoaXMuc2hvd0FkdmFuY2VkUHJvcGVydGllc0Vycm9ycyhjb25zdHMuREVGQVVMVF9QUk9QRVJUWSwgaW5pdGlhbF9hbnN3ZXJfdmFsaWRhdGlvbi5lcnJvci5tZXNzYWdlKTtcbiAgICB9XG5cbiAgICAvL3ZhbGlkYXRlIG1pbiB2YWx1ZVxuICAgIG1pbl92YWx1ZV92YWxpZGF0aW9uID0gdGhpcy5pc01pblZhbHVlVmFsaWQoKTtcbiAgICBpZiAoIW1pbl92YWx1ZV92YWxpZGF0aW9uLmlzX3ZhbGlkKSB7XG4gICAgICAgIC8vd2FybiB1c2VyIG1pbiB2YWx1ZSBpcyBub3QgdmFsaWRcbiAgICAgICAgdGhpcy5kb20uaXNfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgLy9oaWdobGlnaHQgd3JvbmcgaW5wdXRcbiAgICAgICAgdGhpcy5zaG93QWR2YW5jZWRQcm9wZXJ0aWVzRXJyb3JzKGNvbnN0cy5NSU5fVkFMVUVfUFJPUEVSVFksIG1pbl92YWx1ZV92YWxpZGF0aW9uLmVycm9yLm1lc3NhZ2UpO1xuICAgIH1cblxuICAgIC8vdmFsaWRhdGUgbWF4IHZhbHVlXG4gICAgbWF4X3ZhbHVlX3ZhbGlkYXRpb24gPSB0aGlzLmlzTWF4VmFsdWVWYWxpZCgpO1xuICAgIGlmICghbWF4X3ZhbHVlX3ZhbGlkYXRpb24uaXNfdmFsaWQpIHtcbiAgICAgICAgLy93YXJuIHVzZXIgbWluIHZhbHVlIGlzIG5vdCB2YWxpZFxuICAgICAgICB0aGlzLmRvbS5pc192YWxpZCA9IGZhbHNlO1xuICAgICAgICAvL2hpZ2hsaWdodCB3cm9uZyBpbnB1dFxuICAgICAgICB0aGlzLnNob3dBZHZhbmNlZFByb3BlcnRpZXNFcnJvcnMoY29uc3RzLk1BWF9WQUxVRV9QUk9QRVJUWSwgbWF4X3ZhbHVlX3ZhbGlkYXRpb24uZXJyb3IubWVzc2FnZSk7XG4gICAgfVxuXG4gICAgLy9hbGwgYWR2YW5jZWQgcHJvcGVydGllcyBhcmUgdmFsaWQsIHZhbGlkYXRlIGNvbWJpbmF0aW9ucyBhY3Jvc3MgcHJvcGVydGllc1xuICAgIC8vbWluIChpZiBzZXQpIG5lZWRzIHRvIGJlIHNtYWxsZXIgdGhhbiBtYXggKGlmIHNldClcbiAgICBpZiAobWluX3ZhbHVlX3ZhbGlkYXRpb24uaXNfdmFsaWQgJiYgbWF4X3ZhbHVlX3ZhbGlkYXRpb24uaXNfdmFsaWQgJiYgdGhpcy5taW4gIT09ICcnICYmIHRoaXMubWF4ICE9PSAnJykge1xuXG4gICAgICAgIGlmIChwYXJzZUZsb2F0KHRoaXMubWluKSA+PSBwYXJzZUZsb2F0KHRoaXMubWF4KSkge1xuICAgICAgICAgICAgLy93YXJuIHVzZXIgbWluIHZhbHVlIGlzIG5vdCB2YWxpZFxuICAgICAgICAgICAgdGhpcy5kb20uaXNfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgIC8vaGlnaGxpZ2h0IHdyb25nIGlucHV0XG4gICAgICAgICAgICB0aGlzLnNob3dBZHZhbmNlZFByb3BlcnRpZXNFcnJvcnMoY29uc3RzLk1JTl9WQUxVRV9QUk9QRVJUWSwgbWVzc2FnZXMuZXJyb3IuTUlOX01VU1RfQkVfU01BTExFUl9USEFOX01BWCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvL2ludGlhbCBhbnN3ZXIgKGlmIHNldCkgc2hvdWxkIGJlIHdpdGhpbiB0aGUgcmFuZ2Ugc2V0IGJ5IG1pbi9tYXggcHJvcGVydGllc1xuICAgIGlmIChpbml0aWFsX2Fuc3dlcl92YWxpZGF0aW9uLmlzX3ZhbGlkICYmIHRoaXMuZGVmYXVsdCAhPT0gJycpIHtcblxuICAgICAgICBpZiAobWluX3ZhbHVlX3ZhbGlkYXRpb24uaXNfdmFsaWQgJiYgdGhpcy5taW4gIT09ICcnKSB7XG4gICAgICAgICAgICBpZiAocGFyc2VGbG9hdCh0aGlzLmRlZmF1bHQpIDwgcGFyc2VGbG9hdCh0aGlzLm1pbikpIHtcbiAgICAgICAgICAgICAgICAvL3dhcm4gdXNlciBtaW4gdmFsdWUgaXMgbm90IHZhbGlkXG4gICAgICAgICAgICAgICAgdGhpcy5kb20uaXNfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAvL2hpZ2hsaWdodCB3cm9uZyBpbnB1dFxuICAgICAgICAgICAgICAgIHRoaXMuc2hvd0FkdmFuY2VkUHJvcGVydGllc0Vycm9ycyhjb25zdHMuREVGQVVMVF9QUk9QRVJUWSwgbWVzc2FnZXMuZXJyb3IuSU5JVElBTF9BTlNXRVJfT1VUX09GX1JBTkdFKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChtYXhfdmFsdWVfdmFsaWRhdGlvbi5pc192YWxpZCAmJiB0aGlzLm1heCAhPT0gJycpIHtcbiAgICAgICAgICAgIGlmIChwYXJzZUZsb2F0KHRoaXMuZGVmYXVsdCkgPiBwYXJzZUZsb2F0KHRoaXMubWF4KSkge1xuICAgICAgICAgICAgICAgIC8vd2FybiB1c2VyIG1pbiB2YWx1ZSBpcyBub3QgdmFsaWRcbiAgICAgICAgICAgICAgICB0aGlzLmRvbS5pc192YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIC8vaGlnaGxpZ2h0IHdyb25nIGlucHV0XG4gICAgICAgICAgICAgICAgdGhpcy5zaG93QWR2YW5jZWRQcm9wZXJ0aWVzRXJyb3JzKGNvbnN0cy5ERUZBVUxUX1BST1BFUlRZLCBtZXNzYWdlcy5lcnJvci5JTklUSUFMX0FOU1dFUl9PVVRfT0ZfUkFOR0UpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy9zYXZlIHVuaXF1ZW5lc3NcbiAgICBzYXZlLnNhdmVVbmlxdWVuZXNzKHRoaXMpO1xufTtcblxuTnVtZXJpY0lucHV0LnByb3RvdHlwZS5oaWRlQWR2YW5jZWRQcm9wZXJ0aWVzRXJyb3JzID0gZnVuY3Rpb24gKCkge1xuXG4gICAgLy9yZXNldCB2YWxpZGF0aW9uIGRvbSBmZWVkYmFjayAoaGlkZSBhbGwgZXJyb3JzIGZyb20gZG9tKVxuICAgIHZhciBwcm9wZXJ0aWVzX3RvX2hpZGVfZXJyb3IgPSBbXG4gICAgICAgIGNvbnN0cy5ERUZBVUxUX1BST1BFUlRZLFxuICAgICAgICBjb25zdHMuTUlOX1ZBTFVFX1BST1BFUlRZLFxuICAgICAgICBjb25zdHMuTUFYX1ZBTFVFX1BST1BFUlRZXG4gICAgXTtcblxuICAgIGVycm9ycy5oaWRlQWR2YW5jZWRQcm9wZXJ0aWVzRXJyb3JzKHRoaXMsIHByb3BlcnRpZXNfdG9faGlkZV9lcnJvcik7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IE51bWVyaWNJbnB1dDtcbiIsIi8qIGdsb2JhbCAkKi9cbid1c2Ugc3RyaWN0JztcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgZXJyb3JzID0gcmVxdWlyZSgnYWN0aW9ucy9lcnJvcnMnKTtcbnZhciBqdW1wcyA9IHJlcXVpcmUoJ2FjdGlvbnMvanVtcHMnKTtcbnZhciBzYXZlID0gcmVxdWlyZSgnYWN0aW9ucy9zYXZlJyk7XG52YXIgaW5wdXRfcHJvcGVydGllcyA9IHJlcXVpcmUoJ2ZhY3RvcnkvaW5wdXQtcHJvcGVydGllcycpO1xudmFyIElucHV0ID0gcmVxdWlyZSgnZmFjdG9yeS9pbnB1dC1wcm90b3R5cGUnKTtcbnZhciB2YWxpZGF0aW9uID0gcmVxdWlyZSgnYWN0aW9ucy92YWxpZGF0aW9uJyk7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcblxudmFyIExvY2F0aW9uSW5wdXQgPSBmdW5jdGlvbiAodGhlX2lucHV0X3JlZikge1xuXG4gICAgLy9leHRlbmQgYmFzaWMgaW5wdXQgd2loIGNvbW1vbiBwcm9wZXJ0aWVzIChlYXNpZXIgdGhhbiBwYXNzaW5nIGEgcHJvcGVydGllcyBvYmplY3QgdG8gT2JqZWN0LmNyZWF0ZSlcbiAgICAkLmV4dGVuZCh0cnVlLCB0aGlzLCBpbnB1dF9wcm9wZXJ0aWVzKTtcblxuICAgIC8vc2V0IGRlZmF1bHQgcHJvcGVydGllc1xuICAgLy8gdGhpcy5pbmRleCA9IHRoZV9pbmRleDtcbiAgICB0aGlzLnJlZiA9IHRoZV9pbnB1dF9yZWY7XG4gICAgdGhpcy50eXBlID0gY29uc3RzLkxPQ0FUSU9OX1RZUEU7XG5cbiAgICAvKiByZXNldCBET00gcHJvcGVydGllcyAoanF1ZXJ5IHNlbGVjdG9ycyBhcmUgbm90ICdsaXZlJywgd2UgbmVlZCB0byBydW4gdGhlbSBhZ2FpbiBmb3IgbmV3IG9iamVjdClcbiAgICAgKlxuICAgICAqIGlmIHRoZSBwcm9wZXJ0eSBiZWxvdyBpcyBub3QgcmVzZXQgaGVyZSwgYWxsIHRoZSBpbnB1dHMgd2lsbCBnZXQgdGhlIHNhbWUgZG9tIHJlZmVyZW5jZVxuICAgICAqICovXG4gICAgdGhpcy5kb20gPSB7fTtcbiAgICB0aGlzLmRvbS5pc192YWxpZCA9IGZhbHNlO1xufTtcblxuLy9leHRlbmQgcHJvdG90eXBlIGZyb20gYmFzaWMgaW5wdXQgb2JqZWN0XG5Mb2NhdGlvbklucHV0LnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoSW5wdXQucHJvdG90eXBlKTtcblxuLypcbiBPdmVycmlkZXNcbiAqL1xuLy9Mb2NhdGlvbklucHV0LnByb3RvdHlwZS5wcmVwYXJlQWR2YW5jZWRJbnB1dFByb3BlcnRpZXMgPSBmdW5jdGlvbiAoKSB7XG4vL307XG4vL1xuLy9Mb2NhdGlvbklucHV0LnByb3RvdHlwZS5oaWRlQWR2YW5jZWRQcm9wZXJ0aWVzRXJyb3JzID0gZnVuY3Rpb24gKCkge1xuLy8gICAgLy9kbyBub3RoaW5nXG4vL307XG5cbm1vZHVsZS5leHBvcnRzID0gTG9jYXRpb25JbnB1dDtcbiIsIi8qIGdsb2JhbCAkKi9cbid1c2Ugc3RyaWN0JztcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgZXJyb3JzID0gcmVxdWlyZSgnYWN0aW9ucy9lcnJvcnMnKTtcbnZhciBqdW1wcyA9IHJlcXVpcmUoJ2FjdGlvbnMvanVtcHMnKTtcbnZhciBzYXZlID0gcmVxdWlyZSgnYWN0aW9ucy9zYXZlJyk7XG52YXIgaW5wdXRfcHJvcGVydGllcyA9IHJlcXVpcmUoJ2ZhY3RvcnkvaW5wdXQtcHJvcGVydGllcycpO1xudmFyIElucHV0ID0gcmVxdWlyZSgnZmFjdG9yeS9pbnB1dC1wcm90b3R5cGUnKTtcbnZhciB2YWxpZGF0aW9uID0gcmVxdWlyZSgnYWN0aW9ucy92YWxpZGF0aW9uJyk7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcbnZhciB1aSA9IHJlcXVpcmUoJ2hlbHBlcnMvdWknKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoJ2hlbHBlcnMvdXRpbHMnKTtcblxudmFyIFBob25lSW5wdXQgPSBmdW5jdGlvbiAodGhlX2lucHV0X3JlZikge1xuXG4gICAgLy9leHRlbmQgYmFzaWMgaW5wdXQgKHVzaW5nIGEgY2xvbmUsIG5vdCBhIHJlZmVyZW5jZSkgd2loIGNvbW1vbiBwcm9wZXJ0aWVzIChlYXNpZXIgdGhhbiBwYXNzaW5nIGEgcHJvcGVydGllcyBvYmplY3QgdG8gT2JqZWN0LmNyZWF0ZSlcbiAgICAkLmV4dGVuZCh0cnVlLCB0aGlzLCBpbnB1dF9wcm9wZXJ0aWVzKTtcblxuICAgIC8vc2V0IGN1cnJlbnQgaW5zdGFuY2UgcHJvcGVydGllc1xuICAgIHRoaXMucmVmID0gdGhlX2lucHV0X3JlZjtcbiAgICB0aGlzLnR5cGUgPSBjb25zdHMuUEhPTkVfVFlQRTtcblxuICAgIC8qIHJlc2V0IERPTSBwcm9wZXJ0aWVzIChqcXVlcnkgc2VsZWN0b3JzIGFyZSBub3QgJ2xpdmUnKSovXG4gICAgdGhpcy5kb20gPSB7fTtcbiAgICB0aGlzLmRvbS5pc192YWxpZCA9IGZhbHNlO1xufTtcblxuLy9leHRlbmQgcHJvdG90eXBlIGZyb20gYmFzaWMgaW5wdXQgb2JqZWN0XG5QaG9uZUlucHV0LnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoSW5wdXQucHJvdG90eXBlKTtcblxuLypcbiBPdmVycmlkZXNcbiAqL1xuXG5QaG9uZUlucHV0LnByb3RvdHlwZS5zZXRBZHZhbmNlZElucHV0UHJvcGVydGllcyA9IGZ1bmN0aW9uICgpIHtcblxuICAgIC8vc2V0ICAnZGVmYXVsdCcgb3B0aW9uXG4gICAgdGhpcy5kb20uYWR2YW5jZWRfcHJvcGVydGllc193cmFwcGVyLmZpbmQoJ2Rpdi5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19hZHZhbmNlZC1wcm9wZXJ0aWVzX19kZWZhdWx0IGlucHV0JykudmFsKHRoaXMuZGVmYXVsdCk7XG5cbiAgICAvL3NldCAncmVnZXgnIG9wdGlvblxuICAgIHRoaXMuZG9tLmFkdmFuY2VkX3Byb3BlcnRpZXNfd3JhcHBlci5maW5kKCdkaXYuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fYWR2YW5jZWQtcHJvcGVydGllc19fcmVnZXggaW5wdXQnKS52YWwodGhpcy5yZWdleCk7XG5cbiAgICAvL3NldCAnaW5wdXRfcmVmJyBvbiAnZG91YmxlIGVudHJ5IHZlcmlmaWNhdGlvbicgb3B0aW9uXG4gICAgdGhpcy5kb20uYWR2YW5jZWRfcHJvcGVydGllc193cmFwcGVyLmZpbmQoJ2Rpdi5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19hZHZhbmNlZC1wcm9wZXJ0aWVzX19kb3VibGUtZW50cnkgaW5wdXQnKS5wcm9wKCdjaGVja2VkJywgdGhpcy52ZXJpZnkpO1xuXG4gICAgLy9zZXQgJ2lucHV0X3JlZicgb24gJ3VuaXF1ZW5lc3MnIG9wdGlvblxuICAgIHVpLmlucHV0X3Byb3BlcnRpZXNfcGFuZWwuc2V0VW5pcXVlbmVzc1Byb3BlcnR5KGZvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleCwgdGhpcyk7XG59O1xuXG5cblBob25lSW5wdXQucHJvdG90eXBlLmhpZGVBZHZhbmNlZFByb3BlcnRpZXNFcnJvcnMgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICAvL3Jlc2V0IHZhbGlkYXRpb24gZG9tIGZlZWRiYWNrIChoaWRlIGFsbCBlcnJvcnMgZnJvbSBkb20pXG4gICAgdmFyIHByb3BlcnRpZXNfdG9faGlkZV9lcnJvciA9IFtcbiAgICAgICAgY29uc3RzLkRFRkFVTFRfUFJPUEVSVFlcbiAgICBdO1xuICAgIGVycm9ycy5oaWRlQWR2YW5jZWRQcm9wZXJ0aWVzRXJyb3JzKHRoaXMsIHByb3BlcnRpZXNfdG9faGlkZV9lcnJvcik7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IFBob25lSW5wdXQ7XG4iLCIvKiBnbG9iYWwgJCovXG4ndXNlIHN0cmljdCc7XG52YXIgY29uc3RzID0gcmVxdWlyZSgnLi4vY29uZmlnL2NvbnN0cycpO1xudmFyIGVycm9ycyA9IHJlcXVpcmUoJ2FjdGlvbnMvZXJyb3JzJyk7XG52YXIganVtcHMgPSByZXF1aXJlKCdhY3Rpb25zL2p1bXBzJyk7XG52YXIgc2F2ZSA9IHJlcXVpcmUoJ2FjdGlvbnMvc2F2ZScpO1xudmFyIGlucHV0X3Byb3BlcnRpZXMgPSByZXF1aXJlKCdmYWN0b3J5L2lucHV0LXByb3BlcnRpZXMnKTtcbnZhciBJbnB1dCA9IHJlcXVpcmUoJ2ZhY3RvcnkvaW5wdXQtcHJvdG90eXBlJyk7XG52YXIgdmFsaWRhdGlvbiA9IHJlcXVpcmUoJ2FjdGlvbnMvdmFsaWRhdGlvbicpO1xudmFyIGZvcm1idWlsZGVyID0gcmVxdWlyZSgnLi4vY29uZmlnL2Zvcm1idWlsZGVyJyk7XG5cbnZhciBQaG90b0lucHV0ID0gZnVuY3Rpb24gKHRoZV9pbnB1dF9yZWYpIHtcblxuICAgIC8vZXh0ZW5kIGJhc2ljIGlucHV0IHdpaCBjb21tb24gcHJvcGVydGllcyAoZWFzaWVyIHRoYW4gcGFzc2luZyBhIHByb3BlcnRpZXMgb2JqZWN0IHRvIE9iamVjdC5jcmVhdGUpXG4gICAgJC5leHRlbmQodHJ1ZSwgdGhpcywgaW5wdXRfcHJvcGVydGllcyk7XG5cbiAgICAvL3NldCBjdXJyZW50IGluc3RhbmNlIHByb3BlcnRpZXNcbiAgICAvL3RoaXMuaW5kZXggPSB0aGVfaW5kZXg7XG4gICAgdGhpcy5yZWYgPSB0aGVfaW5wdXRfcmVmO1xuICAgIHRoaXMudHlwZSA9IGNvbnN0cy5QSE9UT19UWVBFO1xuXG4gICAgLyogcmVzZXQgRE9NIHByb3BlcnRpZXMgKGpxdWVyeSBzZWxlY3RvcnMgYXJlIG5vdCAnbGl2ZScsIHdlIG5lZWQgdG8gcnVuIHRoZW0gYWdhaW4gZm9yIG5ldyBvYmplY3QpXG4gICAgICpcbiAgICAgKiBpZiB0aGUgcHJvcGVydHkgYmVsb3cgaXMgbm90IHJlc2V0IGhlcmUsIGFsbCB0aGUgaW5wdXRzIHdpbGwgZ2V0IHRoZSBzYW1lIGRvbSByZWZlcmVuY2VcbiAgICAgKiAqL1xuICAgIHRoaXMuZG9tID0ge307XG4gICAgdGhpcy5kb20uaXNfdmFsaWQgPSBmYWxzZTtcbn07XG5cbi8vZXh0ZW5kIHByb3RvdHlwZSBmcm9tIGJhc2ljIGlucHV0IG9iamVjdFxuUGhvdG9JbnB1dC5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKElucHV0LnByb3RvdHlwZSk7XG4vKlxuIE92ZXJyaWRlc1xuICovXG4vL1Bob3RvSW5wdXQucHJvdG90eXBlLnByZXBhcmVBZHZhbmNlZElucHV0UHJvcGVydGllcyA9IGZ1bmN0aW9uICgpIHtcbi8vfTtcblxuLy9QaG90b0lucHV0LnByb3RvdHlwZS5oaWRlQWR2YW5jZWRQcm9wZXJ0aWVzRXJyb3JzID0gZnVuY3Rpb24gKCkge1xuLy8gICAgLy9kbyBub3RoaW5nXG4vL307XG5cbm1vZHVsZS5leHBvcnRzID0gUGhvdG9JbnB1dDtcbiIsIi8qIGdsb2JhbCAkKi9cbid1c2Ugc3RyaWN0JztcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgZXJyb3JzID0gcmVxdWlyZSgnYWN0aW9ucy9lcnJvcnMnKTtcbnZhciBqdW1wcyA9IHJlcXVpcmUoJ2FjdGlvbnMvanVtcHMnKTtcbnZhciBzYXZlID0gcmVxdWlyZSgnYWN0aW9ucy9zYXZlJyk7XG52YXIgcG9zc2libGVfYW5zd2VycyA9IHJlcXVpcmUoJ2FjdGlvbnMvcG9zc2libGUtYW5zd2VycycpO1xudmFyIGlucHV0X3Byb3BlcnRpZXMgPSByZXF1aXJlKCdmYWN0b3J5L2lucHV0LXByb3BlcnRpZXMnKTtcbnZhciBJbnB1dCA9IHJlcXVpcmUoJ2ZhY3RvcnkvaW5wdXQtcHJvdG90eXBlJyk7XG52YXIgSW5wdXRNdWx0aXBsZUFuc3dlcnMgPSByZXF1aXJlKCdmYWN0b3J5L2lucHV0LW11bHRpcGxlLWFuc3dlcnMtcHJvdG90eXBlJyk7XG52YXIgdmFsaWRhdGlvbiA9IHJlcXVpcmUoJ2FjdGlvbnMvdmFsaWRhdGlvbicpO1xudmFyIGZvcm1idWlsZGVyID0gcmVxdWlyZSgnY29uZmlnL2Zvcm1idWlsZGVyJyk7XG52YXIgdWkgPSByZXF1aXJlKCdoZWxwZXJzL3VpJyk7XG52YXIgdXRpbHMgPSByZXF1aXJlKCdoZWxwZXJzL3V0aWxzJyk7XG5cbnZhciBSYWRpb0lucHV0ID0gZnVuY3Rpb24gKHRoZV9pbnB1dF9yZWYpIHtcblxuICAgIC8vZXh0ZW5kIGJhc2ljIGlucHV0IHdpaCBjb21tb24gcHJvcGVydGllcyAoZWFzaWVyIHRoYW4gcGFzc2luZyBhIHByb3BlcnRpZXMgb2JqZWN0IHRvIE9iamVjdC5jcmVhdGUpXG4gICAgJC5leHRlbmQodHJ1ZSwgdGhpcywgaW5wdXRfcHJvcGVydGllcyk7XG5cbiAgICAvL3NldCBjdXJyZW50IGluc3RhbmNlIHByb3BlcnRpZXNcbiAgICAvL3RoaXMuaW5kZXggPSB0aGVfaW5kZXg7XG4gICAgdGhpcy5yZWYgPSB0aGVfaW5wdXRfcmVmO1xuICAgIHRoaXMudHlwZSA9IGNvbnN0cy5SQURJT19UWVBFO1xuXG4gICAgLy9zZXQgYSBkZWZhdWx0IGFuc3dlciBvbiBuZXdseSBjcmVhdGVkIGRyb3Bkb3ducyBpbnB1dHNcbiAgICB0aGlzLnBvc3NpYmxlX2Fuc3dlcnMgPSBbe1xuICAgICAgICBhbnN3ZXI6ICdJIGFtIGEgcGxhY2Vob2xkZXIgYW5zd2VyJyxcbiAgICAgICAgYW5zd2VyX3JlZjogdXRpbHMuZ2VuZXJhdGVVbmlxSUQoKVxuICAgIH1dO1xuXG5cbiAgICAvKiByZXNldCBET00gcHJvcGVydGllcyAoanF1ZXJ5IHNlbGVjdG9ycyBhcmUgbm90ICdsaXZlJywgd2UgbmVlZCB0byBydW4gdGhlbSBhZ2FpbiBmb3IgbmV3IG9iamVjdClcbiAgICAgKlxuICAgICAqIGlmIHRoZSBwcm9wZXJ0eSBiZWxvdyBpcyBub3QgcmVzZXQgaGVyZSwgYWxsIHRoZSBpbnB1dHMgd2lsbCBnZXQgdGhlIHNhbWUgZG9tIHJlZmVyZW5jZVxuICAgICAqICovXG4gICAgdGhpcy5kb20gPSB7fTtcbiAgICB0aGlzLmRvbS5pc192YWxpZCA9IGZhbHNlO1xuXG4gICAgLy9wYWdpbmF0aW9uIGRlZmF1bHRzXG4gICAgZm9ybWJ1aWxkZXIucG9zc2libGVfYW5zd2Vyc19wYWdpbmF0aW9uW3RoaXMucmVmXSA9IHt9O1xuICAgIGZvcm1idWlsZGVyLnBvc3NpYmxlX2Fuc3dlcnNfcGFnaW5hdGlvblt0aGlzLnJlZl0ucGFnZSA9IDE7XG5cbn07XG5cbi8vZXh0ZW5kIHByb3RvdHlwZSBmcm9tIGJhc2ljIGlucHV0IG9iamVjdCBhbmQgbXVsdGlwbGUgYW5zd2VyIG9iamVjdFxuUmFkaW9JbnB1dC5wcm90b3R5cGUgPSAkLmV4dGVuZCh7fSwgSW5wdXQucHJvdG90eXBlLCBJbnB1dE11bHRpcGxlQW5zd2Vycy5wcm90b3R5cGUpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IFJhZGlvSW5wdXQ7XG4iLCIvKiBnbG9iYWwgJCovXG4ndXNlIHN0cmljdCc7XG52YXIgY29uc3RzID0gcmVxdWlyZSgnY29uZmlnL2NvbnN0cycpO1xudmFyIGVycm9ycyA9IHJlcXVpcmUoJ2FjdGlvbnMvZXJyb3JzJyk7XG52YXIganVtcHMgPSByZXF1aXJlKCdhY3Rpb25zL2p1bXBzJyk7XG52YXIgc2F2ZSA9IHJlcXVpcmUoJ2FjdGlvbnMvc2F2ZScpO1xudmFyIGlucHV0X3Byb3BlcnRpZXMgPSByZXF1aXJlKCdmYWN0b3J5L2lucHV0LXByb3BlcnRpZXMnKTtcbnZhciBJbnB1dCA9IHJlcXVpcmUoJ2ZhY3RvcnkvaW5wdXQtcHJvdG90eXBlJyk7XG52YXIgdmFsaWRhdGlvbiA9IHJlcXVpcmUoJ2FjdGlvbnMvdmFsaWRhdGlvbicpO1xudmFyIGZvcm1idWlsZGVyID0gcmVxdWlyZSgnY29uZmlnL2Zvcm1idWlsZGVyJyk7XG52YXIgdWkgPSByZXF1aXJlKCdoZWxwZXJzL3VpJyk7XG52YXIgdXRpbHMgPSByZXF1aXJlKCdoZWxwZXJzL3V0aWxzJyk7XG5cbnZhciBSZWFkbWVJbnB1dCA9IGZ1bmN0aW9uICh0aGVfaW5wdXRfcmVmKSB7XG5cbiAgICAvL2V4dGVuZCBiYXNpYyBpbnB1dCAodXNpbmcgYSBjbG9uZSwgbm90IGEgcmVmZXJlbmNlKSB3aWggY29tbW9uIHByb3BlcnRpZXMgKGVhc2llciB0aGFuIHBhc3NpbmcgYSBwcm9wZXJ0aWVzIG9iamVjdCB0byBPYmplY3QuY3JlYXRlKVxuICAgICQuZXh0ZW5kKHRydWUsIHRoaXMsIGlucHV0X3Byb3BlcnRpZXMpO1xuXG4gICAgLy9zZXQgY3VycmVudCBpbnN0YW5jZSBwcm9wZXJ0aWVzXG4gICAgdGhpcy5yZWYgPSB0aGVfaW5wdXRfcmVmO1xuICAgIHRoaXMudHlwZSA9IGNvbnN0cy5SRUFETUVfVFlQRTtcblxuICAgIC8qIHJlc2V0IERPTSBwcm9wZXJ0aWVzIChqcXVlcnkgc2VsZWN0b3JzIGFyZSBub3QgJ2xpdmUnKSovXG4gICAgdGhpcy5kb20gPSB7fTtcbiAgICB0aGlzLmRvbS5pc192YWxpZCA9IGZhbHNlO1xuXG4gICAgLy9vdmVycmlkZSBhIGZldyBwcm9wZXJ0aWVzIGZvciB2YWxpZGF0aW9uIHB1cnBvc2VzIHNlcnZlciBzaWRlXG4gICAgdGhpcy5pc190aXRsZSA9IGZhbHNlO1xuICAgIHRoaXMudmVyaWZ5ID0gZmFsc2U7XG4gICAgdGhpcy5pc19yZXF1aXJlZCA9IGZhbHNlO1xuXG5cblxufTtcblxuLy9leHRlbmQgcHJvdG90eXBlIGZyb20gYmFzaWMgaW5wdXQgb2JqZWN0XG5SZWFkbWVJbnB1dC5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKElucHV0LnByb3RvdHlwZSk7XG5cblxuLypcbiBPdmVycmlkZXNcbiAqL1xuXG5cbm1vZHVsZS5leHBvcnRzID0gUmVhZG1lSW5wdXQ7XG4iLCIvKiBnbG9iYWwgJCovXG4ndXNlIHN0cmljdCc7XG52YXIgY29uc3RzID0gcmVxdWlyZSgnY29uZmlnL2NvbnN0cycpO1xudmFyIGVycm9ycyA9IHJlcXVpcmUoJ2FjdGlvbnMvZXJyb3JzJyk7XG52YXIganVtcHMgPSByZXF1aXJlKCdhY3Rpb25zL2p1bXBzJyk7XG52YXIgc2F2ZSA9IHJlcXVpcmUoJ2FjdGlvbnMvc2F2ZScpO1xudmFyIHBvc3NpYmxlX2Fuc3dlcnMgPSByZXF1aXJlKCdhY3Rpb25zL3Bvc3NpYmxlLWFuc3dlcnMnKTtcbnZhciBpbnB1dF9wcm9wZXJ0aWVzID0gcmVxdWlyZSgnZmFjdG9yeS9pbnB1dC1wcm9wZXJ0aWVzJyk7XG52YXIgSW5wdXQgPSByZXF1aXJlKCdmYWN0b3J5L2lucHV0LXByb3RvdHlwZScpO1xudmFyIElucHV0TXVsdGlwbGVBbnN3ZXJzID0gcmVxdWlyZSgnZmFjdG9yeS9pbnB1dC1tdWx0aXBsZS1hbnN3ZXJzLXByb3RvdHlwZScpO1xudmFyIHZhbGlkYXRpb24gPSByZXF1aXJlKCdhY3Rpb25zL3ZhbGlkYXRpb24nKTtcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJ2NvbmZpZy9mb3JtYnVpbGRlcicpO1xudmFyIHVpID0gcmVxdWlyZSgnaGVscGVycy91aScpO1xudmFyIHV0aWxzID0gcmVxdWlyZSgnaGVscGVycy91dGlscycpO1xuXG52YXIgU2VhcmNoSW5wdXQgPSBmdW5jdGlvbiAodGhlX2lucHV0X3JlZikge1xuXG4gICAgLy9leHRlbmQgYmFzaWMgaW5wdXQgd2loIGNvbW1vbiBwcm9wZXJ0aWVzIChlYXNpZXIgdGhhbiBwYXNzaW5nIGEgcHJvcGVydGllcyBvYmplY3QgdG8gT2JqZWN0LmNyZWF0ZSlcbiAgICAkLmV4dGVuZCh0cnVlLCB0aGlzLCBpbnB1dF9wcm9wZXJ0aWVzKTtcblxuICAgIC8vc2V0IGN1cnJlbnQgaW5zdGFuY2UgcHJvcGVydGllc1xuICAgIC8vdGhpcy5pbmRleCA9IHRoZV9pbmRleDtcbiAgICB0aGlzLnJlZiA9IHRoZV9pbnB1dF9yZWY7XG4gICAgdGhpcy50eXBlID0gY29uc3RzLlNFQVJDSF9TSU5HTEVfVFlQRTtcblxuICAgIC8vc2V0IGEgZGVmYXVsdCBhbnN3ZXIgb24gbmV3bHkgY3JlYXRlZCBkcm9wZG93bnMgaW5wdXRzXG4gICAgdGhpcy5wb3NzaWJsZV9hbnN3ZXJzID0gW3tcbiAgICAgICAgYW5zd2VyOiAnSSBhbSBhIHBsYWNlaG9sZGVyIGFuc3dlcicsXG4gICAgICAgIGFuc3dlcl9yZWY6IHV0aWxzLmdlbmVyYXRlVW5pcUlEKClcbiAgICB9XTtcblxuXG4gICAgLyogcmVzZXQgRE9NIHByb3BlcnRpZXMgKGpxdWVyeSBzZWxlY3RvcnMgYXJlIG5vdCAnbGl2ZScsIHdlIG5lZWQgdG8gcnVuIHRoZW0gYWdhaW4gZm9yIG5ldyBvYmplY3QpXG4gICAgICpcbiAgICAgKiBpZiB0aGUgcHJvcGVydHkgYmVsb3cgaXMgbm90IHJlc2V0IGhlcmUsIGFsbCB0aGUgaW5wdXRzIHdpbGwgZ2V0IHRoZSBzYW1lIGRvbSByZWZlcmVuY2VcbiAgICAgKiAqL1xuICAgIHRoaXMuZG9tID0ge307XG4gICAgdGhpcy5kb20uaXNfdmFsaWQgPSBmYWxzZTtcblxuICAgIGZvcm1idWlsZGVyLnBvc3NpYmxlX2Fuc3dlcnNfcGFnaW5hdGlvblt0aGlzLnJlZl0gPSB7fTtcbiAgICBmb3JtYnVpbGRlci5wb3NzaWJsZV9hbnN3ZXJzX3BhZ2luYXRpb25bdGhpcy5yZWZdLnBhZ2UgPSAxO1xuXG59O1xuXG4vL2V4dGVuZCBwcm90b3R5cGUgZnJvbSBiYXNpYyBpbnB1dCBvYmplY3QgYW5kIG11bHRpcGxlIGFuc3dlciBvYmplY3RcblNlYXJjaElucHV0LnByb3RvdHlwZSA9ICQuZXh0ZW5kKHt9LCBJbnB1dC5wcm90b3R5cGUsIElucHV0TXVsdGlwbGVBbnN3ZXJzLnByb3RvdHlwZSk7XG5cbm1vZHVsZS5leHBvcnRzID0gU2VhcmNoSW5wdXQ7XG4iLCIvKiBnbG9iYWwgJCovXG4ndXNlIHN0cmljdCc7XG52YXIgY29uc3RzID0gcmVxdWlyZSgnY29uZmlnL2NvbnN0cycpO1xudmFyIGVycm9ycyA9IHJlcXVpcmUoJ2FjdGlvbnMvZXJyb3JzJyk7XG52YXIganVtcHMgPSByZXF1aXJlKCdhY3Rpb25zL2p1bXBzJyk7XG52YXIgc2F2ZSA9IHJlcXVpcmUoJ2FjdGlvbnMvc2F2ZScpO1xudmFyIGlucHV0X3Byb3BlcnRpZXMgPSByZXF1aXJlKCdmYWN0b3J5L2lucHV0LXByb3BlcnRpZXMnKTtcbnZhciBJbnB1dCA9IHJlcXVpcmUoJ2ZhY3RvcnkvaW5wdXQtcHJvdG90eXBlJyk7XG52YXIgdmFsaWRhdGlvbiA9IHJlcXVpcmUoJ2FjdGlvbnMvdmFsaWRhdGlvbicpO1xudmFyIGZvcm1idWlsZGVyID0gcmVxdWlyZSgnY29uZmlnL2Zvcm1idWlsZGVyJyk7XG52YXIgdWkgPSByZXF1aXJlKCdoZWxwZXJzL3VpJyk7XG52YXIgdXRpbHMgPSByZXF1aXJlKCdoZWxwZXJzL3V0aWxzJyk7XG5cbnZhciBUZXh0SW5wdXQgPSBmdW5jdGlvbiAodGhlX2lucHV0X3JlZikge1xuXG4gICAgLy9leHRlbmQgYmFzaWMgaW5wdXQgKHVzaW5nIGEgY2xvbmUsIG5vdCBhIHJlZmVyZW5jZSkgd2loIGNvbW1vbiBwcm9wZXJ0aWVzIChlYXNpZXIgdGhhbiBwYXNzaW5nIGEgcHJvcGVydGllcyBvYmplY3QgdG8gT2JqZWN0LmNyZWF0ZSlcbiAgICAkLmV4dGVuZCh0cnVlLCB0aGlzLCBpbnB1dF9wcm9wZXJ0aWVzKTtcblxuICAgIC8vc2V0IGN1cnJlbnQgaW5zdGFuY2UgcHJvcGVydGllc1xuICAgIHRoaXMucmVmID0gdGhlX2lucHV0X3JlZjtcbiAgICB0aGlzLnR5cGUgPSBjb25zdHMuVEVYVF9UWVBFO1xuXG4gICAgLyogcmVzZXQgRE9NIHByb3BlcnRpZXMgKGpxdWVyeSBzZWxlY3RvcnMgYXJlIG5vdCAnbGl2ZScpKi9cbiAgICB0aGlzLmRvbSA9IHt9O1xuICAgIHRoaXMuZG9tLmlzX3ZhbGlkID0gZmFsc2U7XG59O1xuXG4vL2V4dGVuZCBwcm90b3R5cGUgZnJvbSBiYXNpYyBpbnB1dCBvYmplY3RcblRleHRJbnB1dC5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKElucHV0LnByb3RvdHlwZSk7XG5cbi8qXG4gT3ZlcnJpZGVzXG4gKi9cblxuVGV4dElucHV0LnByb3RvdHlwZS5zZXRBZHZhbmNlZElucHV0UHJvcGVydGllcyA9IGZ1bmN0aW9uICgpIHtcblxuICAgIC8vc2V0ICAnZGVmYXVsdCcgb3B0aW9uXG4gICAgdGhpcy5kb20uYWR2YW5jZWRfcHJvcGVydGllc193cmFwcGVyLmZpbmQoJ2Rpdi5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19hZHZhbmNlZC1wcm9wZXJ0aWVzX19kZWZhdWx0IGlucHV0JykudmFsKHRoaXMuZGVmYXVsdCk7XG5cbiAgICAvL3NldCAncmVnZXgnIG9wdGlvblxuICAgIHRoaXMuZG9tLmFkdmFuY2VkX3Byb3BlcnRpZXNfd3JhcHBlci5maW5kKCdkaXYuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fYWR2YW5jZWQtcHJvcGVydGllc19fcmVnZXggaW5wdXQnKS52YWwodGhpcy5yZWdleCk7XG5cbiAgICAvL3NldCAnaW5wdXRfcmVmJyBvbiAnZG91YmxlIGVudHJ5IHZlcmlmaWNhdGlvbicgb3B0aW9uXG4gICAgdGhpcy5kb20uYWR2YW5jZWRfcHJvcGVydGllc193cmFwcGVyLmZpbmQoJ2Rpdi5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19hZHZhbmNlZC1wcm9wZXJ0aWVzX19kb3VibGUtZW50cnkgaW5wdXQnKS5wcm9wKCdjaGVja2VkJywgdGhpcy52ZXJpZnkpO1xuXG4gICAgLy9zZXQgJ2lucHV0X3JlZicgb24gJ3VuaXF1ZW5lc3MnIG9wdGlvblxuICAgIHVpLmlucHV0X3Byb3BlcnRpZXNfcGFuZWwuc2V0VW5pcXVlbmVzc1Byb3BlcnR5KGZvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleCwgdGhpcyk7XG59O1xuXG5cblRleHRJbnB1dC5wcm90b3R5cGUuaGlkZUFkdmFuY2VkUHJvcGVydGllc0Vycm9ycyA9IGZ1bmN0aW9uICgpIHtcblxuICAgIC8vcmVzZXQgdmFsaWRhdGlvbiBkb20gZmVlZGJhY2sgKGhpZGUgYWxsIGVycm9ycyBmcm9tIGRvbSlcbiAgICB2YXIgcHJvcGVydGllc190b19oaWRlX2Vycm9yID0gW1xuICAgICAgICBjb25zdHMuREVGQVVMVF9QUk9QRVJUWVxuICAgIF07XG4gICAgZXJyb3JzLmhpZGVBZHZhbmNlZFByb3BlcnRpZXNFcnJvcnModGhpcywgcHJvcGVydGllc190b19oaWRlX2Vycm9yKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gVGV4dElucHV0O1xuIiwiLyogZ2xvYmFsICQqL1xuJ3VzZSBzdHJpY3QnO1xudmFyIGNvbnN0cyA9IHJlcXVpcmUoJ2NvbmZpZy9jb25zdHMnKTtcbnZhciBlcnJvcnMgPSByZXF1aXJlKCdhY3Rpb25zL2Vycm9ycycpO1xudmFyIGp1bXBzID0gcmVxdWlyZSgnYWN0aW9ucy9qdW1wcycpO1xudmFyIHNhdmUgPSByZXF1aXJlKCdhY3Rpb25zL3NhdmUnKTtcbnZhciBpbnB1dF9wcm9wZXJ0aWVzID0gcmVxdWlyZSgnZmFjdG9yeS9pbnB1dC1wcm9wZXJ0aWVzJyk7XG52YXIgSW5wdXQgPSByZXF1aXJlKCdmYWN0b3J5L2lucHV0LXByb3RvdHlwZScpO1xudmFyIHZhbGlkYXRpb24gPSByZXF1aXJlKCdhY3Rpb25zL3ZhbGlkYXRpb24nKTtcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJ2NvbmZpZy9mb3JtYnVpbGRlcicpO1xudmFyIHVpID0gcmVxdWlyZSgnaGVscGVycy91aScpO1xudmFyIHV0aWxzID0gcmVxdWlyZSgnaGVscGVycy91dGlscycpO1xuXG52YXIgVGV4dGFyZWFJbnB1dCA9IGZ1bmN0aW9uICh0aGVfaW5wdXRfcmVmKSB7XG5cbiAgICAvL2V4dGVuZCBiYXNpYyBpbnB1dCB3aWggY29tbW9uIHByb3BlcnRpZXMgKGVhc2llciB0aGFuIHBhc3NpbmcgYSBwcm9wZXJ0aWVzIG9iamVjdCB0byBPYmplY3QuY3JlYXRlKVxuICAgICQuZXh0ZW5kKHRydWUsIHRoaXMsIGlucHV0X3Byb3BlcnRpZXMpO1xuXG4gICAgLy9zZXQgZGVmYXVsdCBwcm9wZXJ0aWVzXG4gICAgLy90aGlzLmluZGV4ID0gdGhlX2luZGV4O1xuICAgIHRoaXMucmVmID0gdGhlX2lucHV0X3JlZjtcbiAgICB0aGlzLnR5cGUgPSBjb25zdHMuVEVYVEFSRUFfVFlQRTtcblxuICAgIC8qIHJlc2V0IERPTSBwcm9wZXJ0aWVzIChqcXVlcnkgc2VsZWN0b3JzIGFyZSBub3QgJ2xpdmUnLCB3ZSBuZWVkIHRvIHJ1biB0aGVtIGFnYWluIGZvciBuZXcgb2JqZWN0KVxuICAgICAqXG4gICAgICogaWYgdGhlIHByb3BlcnR5IGJlbG93IGlzIG5vdCByZXNldCBoZXJlLCBhbGwgdGhlIGlucHV0cyB3aWxsIGdldCB0aGUgc2FtZSBkb20gcmVmZXJlbmNlXG4gICAgICogKi9cbiAgICB0aGlzLmRvbSA9IHt9O1xuICAgIHRoaXMuZG9tLmlzX3ZhbGlkID0gZmFsc2U7XG59O1xuXG4vL2V4dGVuZCBwcm90b3R5cGUgZnJvbSBiYXNpYyBpbnB1dCBvYmplY3RcblRleHRhcmVhSW5wdXQucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShJbnB1dC5wcm90b3R5cGUpO1xuXG4vKlxuIE92ZXJyaWRlc1xuICovXG5cblRleHRhcmVhSW5wdXQucHJvdG90eXBlLnNldEFkdmFuY2VkSW5wdXRQcm9wZXJ0aWVzID0gZnVuY3Rpb24gKCkge1xuXG4gICAgdGhpcy5kb20uYWR2YW5jZWRfcHJvcGVydGllc193cmFwcGVyID0gZm9ybWJ1aWxkZXJcbiAgICAgICAgLmRvbVxuICAgICAgICAuaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyXG4gICAgICAgIC5maW5kKCdmb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIHRoaXMucmVmICsgJ1wiXScpXG4gICAgICAgIC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fYWR2YW5jZWQtcHJvcGVydGllcycpO1xuXG4gICAgLy9zZXQgICdkZWZhdWx0JyBvcHRpb25cbiAgICB0aGlzLmRvbS5hZHZhbmNlZF9wcm9wZXJ0aWVzX3dyYXBwZXIuZmluZCgnZGl2LmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2FkdmFuY2VkLXByb3BlcnRpZXNfX2RlZmF1bHQgaW5wdXQnKS52YWwodGhpcy5kZWZhdWx0KTtcblxuICAgIC8vc2V0ICdyZWdleCcgb3B0aW9uXG4gICAgdGhpcy5kb20uYWR2YW5jZWRfcHJvcGVydGllc193cmFwcGVyLmZpbmQoJ2Rpdi5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19hZHZhbmNlZC1wcm9wZXJ0aWVzX19yZWdleCBpbnB1dCcpLnZhbCh0aGlzLnJlZ2V4KTtcblxuICAgIC8vc2V0ICdpbnB1dF9yZWYnIG9uICdkb3VibGUgZW50cnkgdmVyaWZpY2F0aW9uJyBvcHRpb25cbiAgICB0aGlzLmRvbS5hZHZhbmNlZF9wcm9wZXJ0aWVzX3dyYXBwZXIuZmluZCgnZGl2LmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2FkdmFuY2VkLXByb3BlcnRpZXNfX2RvdWJsZS1lbnRyeSBpbnB1dCcpLnByb3AoJ2NoZWNrZWQnLCB0aGlzLnZlcmlmeSk7XG5cbiAgICAvL3NldCAnaW5wdXRfcmVmJyBvbiAndW5pcXVlbmVzcycgb3B0aW9uXG4gICAgdWkuaW5wdXRfcHJvcGVydGllc19wYW5lbC5zZXRVbmlxdWVuZXNzUHJvcGVydHkoZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4LCB0aGlzKTtcbn07XG5cblRleHRhcmVhSW5wdXQucHJvdG90eXBlLmhpZGVBZHZhbmNlZFByb3BlcnRpZXNFcnJvcnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgLy9yZXNldCB2YWxpZGF0aW9uIGRvbSBmZWVkYmFjayAoaGlkZSBhbGwgZXJyb3JzIGZyb20gZG9tKVxuICAgIHZhciBwcm9wZXJ0aWVzX3RvX2hpZGVfZXJyb3IgPSBbXG4gICAgICAgIGNvbnN0cy5ERUZBVUxUX1BST1BFUlRZXG4gICAgXTtcbiAgICBlcnJvcnMuaGlkZUFkdmFuY2VkUHJvcGVydGllc0Vycm9ycyh0aGlzLCBwcm9wZXJ0aWVzX3RvX2hpZGVfZXJyb3IpO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBUZXh0YXJlYUlucHV0O1xuIiwiLyogZ2xvYmFsICQqL1xuJ3VzZSBzdHJpY3QnO1xudmFyIGNvbnN0cyA9IHJlcXVpcmUoJ2NvbmZpZy9jb25zdHMnKTtcbnZhciBlcnJvcnMgPSByZXF1aXJlKCdhY3Rpb25zL2Vycm9ycycpO1xudmFyIGp1bXBzID0gcmVxdWlyZSgnYWN0aW9ucy9qdW1wcycpO1xudmFyIHNhdmUgPSByZXF1aXJlKCdhY3Rpb25zL3NhdmUnKTtcbnZhciBpbnB1dF9wcm9wZXJ0aWVzID0gcmVxdWlyZSgnZmFjdG9yeS9pbnB1dC1wcm9wZXJ0aWVzJyk7XG52YXIgSW5wdXQgPSByZXF1aXJlKCdmYWN0b3J5L2lucHV0LXByb3RvdHlwZScpO1xudmFyIHZhbGlkYXRpb24gPSByZXF1aXJlKCdhY3Rpb25zL3ZhbGlkYXRpb24nKTtcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJ2NvbmZpZy9mb3JtYnVpbGRlcicpO1xudmFyIHVpID0gcmVxdWlyZSgnaGVscGVycy91aScpO1xudmFyIHV0aWxzID0gcmVxdWlyZSgnaGVscGVycy91dGlscycpO1xuXG52YXIgVGltZUlucHV0ID0gZnVuY3Rpb24gKHRoZV9pbnB1dF9yZWYpIHtcblxuICAgIC8vZXh0ZW5kIGJhc2ljIGlucHV0IHdpaCBjb21tb24gcHJvcGVydGllcyAoZWFzaWVyIHRoYW4gcGFzc2luZyBhIHByb3BlcnRpZXMgb2JqZWN0IHRvIE9iamVjdC5jcmVhdGUpXG4gICAgJC5leHRlbmQodHJ1ZSwgdGhpcywgaW5wdXRfcHJvcGVydGllcyk7XG5cbiAgICAvL3NldCBjdXJyZW50IGluc3RhbmNlIHByb3BlcnRpZXNcbiAgICAvL3RoaXMuaW5kZXggPSB0aGVfaW5kZXg7XG4gICAgdGhpcy5yZWYgPSB0aGVfaW5wdXRfcmVmO1xuICAgIHRoaXMudHlwZSA9IGNvbnN0cy5USU1FX1RZUEU7XG5cbiAgICAvKiByZXNldCBET00gcHJvcGVydGllcyAoanF1ZXJ5IHNlbGVjdG9ycyBhcmUgbm90ICdsaXZlJywgd2UgbmVlZCB0byBydW4gdGhlbSBhZ2FpbiBmb3IgbmV3IG9iamVjdClcbiAgICAgKlxuICAgICAqIGlmIHRoZSBwcm9wZXJ0eSBiZWxvdyBpcyBub3QgcmVzZXQgaGVyZSwgYWxsIHRoZSBpbnB1dHMgd2lsbCBnZXQgdGhlIHNhbWUgZG9tIHJlZmVyZW5jZVxuICAgICAqICovXG4gICAgdGhpcy5kb20gPSB7fTtcbiAgICB0aGlzLmRvbS5pc192YWxpZCA9IGZhbHNlO1xufTtcblxuLy9leHRlbmQgcHJvdG90eXBlIGZyb20gYmFzaWMgaW5wdXQgb2JqZWN0XG5UaW1lSW5wdXQucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShJbnB1dC5wcm90b3R5cGUpO1xuXG4vKlxuIE92ZXJyaWRlc1xuICovXG5cblxuVGltZUlucHV0LnByb3RvdHlwZS5zZXRBZHZhbmNlZElucHV0UHJvcGVydGllcyA9IGZ1bmN0aW9uICgpIHtcblxuICAgIHRoaXMuZG9tLmFkdmFuY2VkX3Byb3BlcnRpZXNfd3JhcHBlciA9IGZvcm1idWlsZGVyXG4gICAgICAgIC5kb21cbiAgICAgICAgLmlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlclxuICAgICAgICAuZmluZCgnZm9ybVtkYXRhLWlucHV0LXJlZj1cIicgKyB0aGlzLnJlZiArICdcIl0nKVxuICAgICAgICAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2FkdmFuY2VkLXByb3BlcnRpZXMnKTtcblxuXG4gICAgLy9zZXQgZGVmYXVsdCB0byBjdXJyZW50IGRhdGV0aW1lP1xuICAgIHRoaXMuZG9tLmFkdmFuY2VkX3Byb3BlcnRpZXNfd3JhcHBlclxuICAgICAgICAuZmluZCgnZGl2LmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2FkdmFuY2VkLXByb3BlcnRpZXNfX2RlZmF1bHQtdG8tY3VycmVudCBsYWJlbCBpbnB1dCcpLnByb3AoJ2NoZWNrZWQnLCB0aGlzLnNldF90b19jdXJyZW50X2RhdGV0aW1lKTtcblxuICAgIC8vc2V0IGRhdGV0aW1lIGZvcm1hdFxuICAgIHRoaXMuZG9tLmFkdmFuY2VkX3Byb3BlcnRpZXNfd3JhcHBlclxuICAgICAgICAuZmluZCgnZGl2LmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2FkdmFuY2VkLXByb3BlcnRpZXNfX3RpbWVmb3JtYXQgaW5wdXRbbmFtZT1cInRpbWVmb3JtYXRSYWRpb1wiXVt2YWx1ZT1cIicgKyB0aGlzLmRhdGV0aW1lX2Zvcm1hdCArICdcIl0nKVxuICAgICAgICAucHJvcCgnY2hlY2tlZCcsIHRydWUpO1xuXG4gICAgLy9zZXQgJ3VuaXF1ZW5lc3MnIG9wdGlvblxuICAgIC8vc2V0ICdpbnB1dF9yZWYnIG9uICd1bmlxdWVuZXNzJyBvcHRpb25cbiAgICB1aS5pbnB1dF9wcm9wZXJ0aWVzX3BhbmVsLnNldFVuaXF1ZW5lc3NQcm9wZXJ0eShmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXgsIHRoaXMpO1xuXG59O1xuXG5UaW1lSW5wdXQucHJvdG90eXBlLnNhdmVBZHZhbmNlZFByb3BlcnRpZXMgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICB2YXIgZm9ybV9pbmRleCA9IGZvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleDtcbiAgICB2YXIgdW5pcXVlbmVzcztcblxuICAgIHRoaXMuZG9tLmFkdmFuY2VkX3Byb3BlcnRpZXNfd3JhcHBlciA9IGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXJcbiAgICAgICAgLmZpbmQoJ2Zvcm1bZGF0YS1pbnB1dC1yZWY9XCInICsgdGhpcy5yZWYgKyAnXCJdJylcbiAgICAgICAgLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19hZHZhbmNlZC1wcm9wZXJ0aWVzJyk7XG5cbiAgICAvL3NldCBkZWZhdWx0IHRvIGN1cnJlbnQgZGF0ZXRpbWU/XG4gICAgdGhpcy5zZXRfdG9fY3VycmVudF9kYXRldGltZSA9IHRoaXMuZG9tLmFkdmFuY2VkX3Byb3BlcnRpZXNfd3JhcHBlclxuICAgICAgICAuZmluZCgnZGl2LmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2FkdmFuY2VkLXByb3BlcnRpZXNfX2RlZmF1bHQtdG8tY3VycmVudCBpbnB1dCcpXG4gICAgICAgIC5pcygnOmNoZWNrZWQnKTtcblxuICAgIC8vc2V0IGRhdGV0aW1lIGZvcm1hdFxuICAgIHRoaXMuZGF0ZXRpbWVfZm9ybWF0ID0gdGhpcy5kb20uYWR2YW5jZWRfcHJvcGVydGllc193cmFwcGVyXG4gICAgICAgIC5maW5kKCdkaXYuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fYWR2YW5jZWQtcHJvcGVydGllc19fdGltZWZvcm1hdCBpbnB1dFtuYW1lPVwidGltZWZvcm1hdFJhZGlvXCJdOmNoZWNrZWQnKVxuICAgICAgICAudmFsKCk7XG5cbiAgICAvL3NhdmUgdW5pcXVlbmVzc1xuICAgIHNhdmUuc2F2ZVVuaXF1ZW5lc3ModGhpcyk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IFRpbWVJbnB1dDtcbiIsIi8qIGdsb2JhbCAkKi9cbid1c2Ugc3RyaWN0JztcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgZXJyb3JzID0gcmVxdWlyZSgnYWN0aW9ucy9lcnJvcnMnKTtcbnZhciBqdW1wcyA9IHJlcXVpcmUoJ2FjdGlvbnMvanVtcHMnKTtcbnZhciBzYXZlID0gcmVxdWlyZSgnYWN0aW9ucy9zYXZlJyk7XG52YXIgaW5wdXRfcHJvcGVydGllcyA9IHJlcXVpcmUoJ2ZhY3RvcnkvaW5wdXQtcHJvcGVydGllcycpO1xudmFyIElucHV0ID0gcmVxdWlyZSgnZmFjdG9yeS9pbnB1dC1wcm90b3R5cGUnKTtcbnZhciB2YWxpZGF0aW9uID0gcmVxdWlyZSgnYWN0aW9ucy92YWxpZGF0aW9uJyk7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcbnZhciB1aSA9IHJlcXVpcmUoJ2hlbHBlcnMvdWknKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoJ2hlbHBlcnMvdXRpbHMnKTtcblxudmFyIFZpZGVvSW5wdXQgPSBmdW5jdGlvbiAodGhlX2lucHV0X3JlZikge1xuXG4gICAgLy9leHRlbmQgYmFzaWMgaW5wdXQgd2loIGNvbW1vbiBwcm9wZXJ0aWVzIChlYXNpZXIgdGhhbiBwYXNzaW5nIGEgcHJvcGVydGllcyBvYmplY3QgdG8gT2JqZWN0LmNyZWF0ZSlcbiAgICAkLmV4dGVuZCh0cnVlLCB0aGlzLCBpbnB1dF9wcm9wZXJ0aWVzKTtcblxuICAgIC8vc2V0IGN1cnJlbnQgaW5zdGFuY2UgcHJvcGVydGllc1xuICAgIC8vdGhpcy5pbmRleCA9IHRoZV9pbmRleDtcbiAgICB0aGlzLnJlZiA9IHRoZV9pbnB1dF9yZWY7XG4gICAgdGhpcy50eXBlID0gY29uc3RzLlZJREVPX1RZUEU7XG5cbiAgICAvKiByZXNldCBET00gcHJvcGVydGllcyAoanF1ZXJ5IHNlbGVjdG9ycyBhcmUgbm90ICdsaXZlJywgd2UgbmVlZCB0byBydW4gdGhlbSBhZ2FpbiBmb3IgbmV3IG9iamVjdClcbiAgICAgKlxuICAgICAqIGlmIHRoZSBwcm9wZXJ0eSBiZWxvdyBpcyBub3QgcmVzZXQgaGVyZSwgYWxsIHRoZSBpbnB1dHMgd2lsbCBnZXQgdGhlIHNhbWUgZG9tIHJlZmVyZW5jZVxuICAgICAqICovXG4gICAgdGhpcy5kb20gPSB7fTtcbiAgICB0aGlzLmRvbS5pc192YWxpZCA9IGZhbHNlO1xufTtcblxuLy9leHRlbmQgcHJvdG90eXBlIGZyb20gYmFzaWMgaW5wdXQgb2JqZWN0XG5WaWRlb0lucHV0LnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoSW5wdXQucHJvdG90eXBlKTtcblxubW9kdWxlLmV4cG9ydHMgPSBWaWRlb0lucHV0O1xuIiwiJ3VzZSBzdHJpY3QnO1xudmFyIGNvbnN0cyA9IHJlcXVpcmUoJ2NvbmZpZy9jb25zdHMuanMnKTtcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJ2NvbmZpZy9mb3JtYnVpbGRlcicpO1xudmFyIHV0aWxzID0gcmVxdWlyZSgnaGVscGVycy91dGlscycpO1xuXG52YXIgbG9hZF9jaGlsZF9mb3JtX2NvbnRhaW5lcnMgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICB2YXIgZGVmZXJyZWQgPSBuZXcgJC5EZWZlcnJlZCgpO1xuICAgIHZhciB2aWV3cyA9IHt9O1xuICAgIHZhciBwYXRoID0gdXRpbHMuZ2V0Q29udGFpbmVyc1BhdGgoKTtcblxuICAgICQud2hlbihcbiAgICAgICAgLy9pbnB1dHMgY29sbGVjdGlvbiAoc29ydGFibGUpLCBob2xkaW5nIGFsbCB0aGUgaW5wdXRzIGZvciBhIGNoaWxkIGZvcm1cbiAgICAgICAgJC5nZXQocGF0aCArICdpbnB1dHMtY29sbGVjdGlvbi5odG1sJywgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHZpZXdzLmlucHV0c19jb2xsZWN0aW9uID0gZGF0YTtcbiAgICAgICAgfSksXG4gICAgICAgIC8vaW5wdXRzIHByb3BlcnRpZXMsIHNob3dpbmcgcHJvcGVydGllcyBmb3Igc2VsZWN0ZWQgaW5wdXRcbiAgICAgICAgJC5nZXQocGF0aCArICdpbnB1dHMtcHJvcGVydGllcy5odG1sJywgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHZpZXdzLmlucHV0c19wcm9wZXJ0aWVzID0gZGF0YTtcbiAgICAgICAgfSlcbiAgICApLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHZpZXdzKTtcbiAgICB9KTtcbiAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZSgpO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBsb2FkX2NoaWxkX2Zvcm1fY29udGFpbmVycztcbiIsIid1c2Ugc3RyaWN0JztcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcbnZhciBsb2FkX3BhcnRpYWxzID0gcmVxdWlyZSgnbG9hZGVycy9sb2FkLXBhcnRpYWxzJyk7XG52YXIgbG9hZF9jb250YWluZXJzID0gcmVxdWlyZSgnbG9hZGVycy9sb2FkLWNvbnRhaW5lcnMnKTtcbnZhciBsb2FkX2lucHV0X3Byb3BlcnRpZXNfdmlld3MgPSByZXF1aXJlKCdsb2FkZXJzL2xvYWQtaW5wdXQtcHJvcGVydGllcy12aWV3cycpO1xudmFyIHVpID0gcmVxdWlyZSgnaGVscGVycy91aScpO1xuXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiBMb2FkIGh0bWwgY29tcG9uZW50c1xuICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG52YXIgbG9hZF9jb21wb25lbnRzID0gZnVuY3Rpb24gKCkge1xuXG4gICAgdmFyIGRlZmVycmVkID0gbmV3ICQuRGVmZXJyZWQoKTtcblxuICAgIC8vbG9hZCBtYWluIGNvbnRhaW5lcnMgKGlucHV0cyB0b29scywgaW5wdXRzIGNvbGxlY3Rpb24gYW5kIGlucHV0cyBwcm9wZXJ0aWVzKSAoXCJjb250YWluZXJzIHdpbGwgYmUgdW5kZWZpbmVkXCIpXG4gICAgLy9sb2FkIHBhcnRpYWxzIGZvciBpbnB1dCBwcm9wZXJ0aWVzIHRhYnMgKFwicGFydGlhbHNcIilcbiAgICAvL2xvYWQgdmlld3MgZm9yIGlucHV0IHByb3BlcnRpZXMgKFwidmlld3NcIilcbiAgICAkLndoZW4obG9hZF9jb250YWluZXJzKCksIGxvYWRfcGFydGlhbHMoKSwgbG9hZF9pbnB1dF9wcm9wZXJ0aWVzX3ZpZXdzKCkpLnRoZW4oZnVuY3Rpb24gKGNvbnRhaW5lcnMsIHBhcnRpYWxzLCB2aWV3cykge1xuXG4gICAgICAgIC8vaW5pdCB3aXRoIGZpcnN0IGZvcm0gcmVmXG4gICAgICAgIHZhciBmb3JtX3JlZiA9IGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbi5kYXRhLnByb2plY3QuZm9ybXNbMF0ucmVmO1xuXG4gICAgICAgIC8vaW5qZWN0IHJlZiBpbnRvIGZpcnN0IGZvcm0gaW4gdGhlIGRvbVxuICAgICAgICB1aS5mb3Jtc190YWJzLmluamVjdFJlZkludG9Gb3JtVGFiKGZvcm1fcmVmKTtcblxuICAgICAgICAvL3NldHVwIGZvcm1idWlsZGVyIG9iamVjdFxuICAgICAgICBmb3JtYnVpbGRlci5zZXR1cChmb3JtX3JlZiwgcGFydGlhbHMsIHZpZXdzKTtcblxuXG4gICAgICAgIGRlZmVycmVkLnJlc29sdmUoKTtcbiAgICB9KTtcbiAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZSgpO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBsb2FkX2NvbXBvbmVudHM7XG4iLCIndXNlIHN0cmljdCc7XG52YXIgY29uc3RzID0gcmVxdWlyZSgnY29uZmlnL2NvbnN0cy5qcycpO1xudmFyIHV0aWxzID0gcmVxdWlyZSgnaGVscGVycy91dGlscycpO1xuXG52YXIgZ2V0X2NvbnRhaW5lcnMgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICB2YXIgZGVmZXJyZWQgPSBuZXcgJC5EZWZlcnJlZCgpO1xuICAgIHZhciBwYXRoID0gdXRpbHMuZ2V0Q29udGFpbmVyc1BhdGgoKTtcblxuICAgIC8vbG9hZCBjb250YWluZXIgdmlld3MgZm9yIGluZGV4Lmh0bWwgKG1haW4gZW50cnkgcG9pbnQpXG4gICAgJC53aGVuKFxuICAgICAgICAvL25hdmJhclxuICAgICAgICAkLmdldChwYXRoICsgJ25hdmJhci5odG1sJywgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICQoJy5uYXZiYXInKS5odG1sKGRhdGEpO1xuICAgICAgICB9KSxcbiAgICAgICAgLy9pbnB1dHMgdG9vbHMgbGlzdCAoc291cmNlIGlucHV0cyB0byBkcmFnLCBkcmFnZ2FibGUpXG4gICAgICAgICQuZ2V0KHBhdGggKyAnaW5wdXRzLXRvb2xzLmh0bWwnLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgJCgnLmlucHV0cy10b29scycpLmh0bWwoZGF0YSk7XG4gICAgICAgIH0pLFxuICAgICAgICAvL2lucHV0cyBjb2xsZWN0aW9uIChzb3J0YWJsZSksIGhvbGRpbmcgYWxsIHRoZSBpbnB1dHMgZm9yIGEgZm9ybVxuICAgICAgICAkLmdldChwYXRoICsgJ2lucHV0cy1jb2xsZWN0aW9uLmh0bWwnLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgJCgnLmlucHV0cy1jb2xsZWN0aW9uJykuaHRtbChkYXRhKTtcbiAgICAgICAgfSksXG4gICAgICAgIC8vaW5wdXRzIHByb3BlcnRpZXMsIHNob3dpbmcgcHJvcGVydGllcyBmb3Igc2VsZWN0ZWQgaW5wdXRcbiAgICAgICAgJC5nZXQocGF0aCArICdpbnB1dHMtcHJvcGVydGllcy5odG1sJywgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICQoJy5pbnB1dC1wcm9wZXJ0aWVzJykuaHRtbChkYXRhKTtcbiAgICAgICAgfSlcbiAgICApLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZSgpO1xuICAgICAgICB9KTtcblxuICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlKCk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGdldF9jb250YWluZXJzO1xuIiwiJ3VzZSBzdHJpY3QnO1xudmFyIGNvbnN0cyA9IHJlcXVpcmUoJ2NvbmZpZy9jb25zdHMuanMnKTtcbnZhciB1aSA9IHJlcXVpcmUoJ2hlbHBlcnMvdWknKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoJ2hlbHBlcnMvdXRpbHMnKTtcblxuXG52YXIgbG9hZF9pbnB1dF9wcm9wZXJ0aWVzX3ZpZXdzID0gZnVuY3Rpb24gKCkge1xuXG4gICAgdmFyIHZpZXdzID0ge307XG4gICAgdmFyIGRlZmVycmVkID0gbmV3ICQuRGVmZXJyZWQoKTtcbiAgICB2YXIgcGF0aCA9IHV0aWxzLmdldFByb3BlcnRpZXNQYXRoKCk7XG5cbiAgICAkLndoZW4oXG4gICAgICAgICQuZ2V0KHBhdGggKyAncHJvcGVydGllcy1hdWRpby5odG1sJywgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHZpZXdzLmF1ZGlvID0gZGF0YTtcbiAgICAgICAgfSksXG4gICAgICAgICQuZ2V0KHBhdGggKyAncHJvcGVydGllcy1iYXJjb2RlLmh0bWwnLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgdmlld3MuYmFyY29kZSA9IGRhdGE7XG4gICAgICAgIH0pLFxuICAgICAgICAkLmdldChwYXRoICsgJ3Byb3BlcnRpZXMtYnJhbmNoLmh0bWwnLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgdmlld3MuYnJhbmNoID0gZGF0YTtcbiAgICAgICAgfSksXG4gICAgICAgICQuZ2V0KHBhdGggKyAncHJvcGVydGllcy1jaGVja2JveC5odG1sJywgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHZpZXdzLmNoZWNrYm94ID0gZGF0YTtcbiAgICAgICAgfSksXG4gICAgICAgICQuZ2V0KHBhdGggKyAncHJvcGVydGllcy1kYXRlLmh0bWwnLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgdmlld3MuZGF0ZSA9IGRhdGE7XG4gICAgICAgIH0pLFxuICAgICAgICAkLmdldChwYXRoICsgJ3Byb3BlcnRpZXMtZHJvcGRvd24uaHRtbCcsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICB2aWV3cy5kcm9wZG93biA9IGRhdGE7XG4gICAgICAgIH0pLFxuICAgICAgICAkLmdldChwYXRoICsgJ3Byb3BlcnRpZXMtZ3JvdXAuaHRtbCcsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICB2aWV3cy5ncm91cCA9IGRhdGE7XG4gICAgICAgIH0pLFxuICAgICAgICAkLmdldChwYXRoICsgJ3Byb3BlcnRpZXMtaW50ZWdlci5odG1sJywgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHZpZXdzLmludGVnZXIgPSBkYXRhO1xuICAgICAgICAgICAgdmlld3MuZGVjaW1hbCA9IGRhdGE7XG4gICAgICAgIH0pLFxuICAgICAgICAkLmdldChwYXRoICsgJ3Byb3BlcnRpZXMtbG9jYXRpb24uaHRtbCcsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICB2aWV3cy5sb2NhdGlvbiA9IGRhdGE7XG4gICAgICAgIH0pLFxuICAgICAgICAkLmdldChwYXRoICsgJ3Byb3BlcnRpZXMtcGhvdG8uaHRtbCcsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICB2aWV3cy5waG90byA9IGRhdGE7XG4gICAgICAgIH0pLFxuICAgICAgICAkLmdldChwYXRoICsgJ3Byb3BlcnRpZXMtcGhvbmUuaHRtbCcsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICB2aWV3cy5waG9uZSA9IGRhdGE7XG4gICAgICAgIH0pLFxuICAgICAgICAkLmdldChwYXRoICsgJ3Byb3BlcnRpZXMtcmFkaW8uaHRtbCcsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICB2aWV3cy5yYWRpbyA9IGRhdGE7XG4gICAgICAgIH0pLFxuICAgICAgICAkLmdldChwYXRoICsgJ3Byb3BlcnRpZXMtdGV4dGFyZWEuaHRtbCcsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICB2aWV3cy50ZXh0YXJlYSA9IGRhdGE7XG4gICAgICAgIH0pLFxuICAgICAgICAkLmdldChwYXRoICsgJ3Byb3BlcnRpZXMtcmVhZG1lLmh0bWwnLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgdmlld3MucmVhZG1lID0gZGF0YTtcbiAgICAgICAgfSksXG4gICAgICAgICQuZ2V0KHBhdGggKyAncHJvcGVydGllcy10ZXh0Lmh0bWwnLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgdmlld3MudGV4dCA9IGRhdGE7XG4gICAgICAgIH0pLFxuICAgICAgICAkLmdldChwYXRoICsgJ3Byb3BlcnRpZXMtdGltZS5odG1sJywgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHZpZXdzLnRpbWUgPSBkYXRhO1xuICAgICAgICB9KSxcbiAgICAgICAgJC5nZXQocGF0aCArICdwcm9wZXJ0aWVzLXZpZGVvLmh0bWwnLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgdmlld3MudmlkZW8gPSBkYXRhO1xuICAgICAgICB9KSxcbiAgICAgICAgJC5nZXQocGF0aCArICdwcm9wZXJ0aWVzLXNlYXJjaHNpbmdsZS5odG1sJywgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHZpZXdzLnNlYXJjaHNpbmdsZSA9IGRhdGE7XG4gICAgICAgIH0pLFxuICAgICAgICAkLmdldChwYXRoICsgJ3Byb3BlcnRpZXMtc2VhcmNoc2luZ2xlLmh0bWwnLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgdmlld3Muc2VhcmNobXVsdGlwbGUgPSBkYXRhO1xuICAgICAgICB9KVxuICAgICkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgIGRlZmVycmVkLnJlc29sdmUodmlld3MpO1xuICAgIH0pO1xuICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlKCk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGxvYWRfaW5wdXRfcHJvcGVydGllc192aWV3cztcbiIsIid1c2Ugc3RyaWN0JztcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzLmpzJyk7XG52YXIgdWkgPSByZXF1aXJlKCdoZWxwZXJzL3VpJyk7XG52YXIgdXRpbHMgPSByZXF1aXJlKCdoZWxwZXJzL3V0aWxzJyk7XG5cbnZhciBnZXRfcGFydGlhbHMgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICB2YXIgcGFydGlhbHMgPSB7fTtcbiAgICB2YXIgZGVmZXJyZWQgPSBuZXcgJC5EZWZlcnJlZCgpO1xuICAgIHZhciBwYXRoID0gdXRpbHMuZ2V0UGFydGlhbHNQYXRoKCk7XG5cbiAgICAkLndoZW4oXG4gICAgICAgICQuZ2V0KHBhdGggKyAnbmF2LXRhYnMuaHRtbCcsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBwYXJ0aWFscy5uYXZ0YWJzID0gZGF0YTtcbiAgICAgICAgfSksXG4gICAgICAgICQuZ2V0KHBhdGggKyAnYmFzaWMtcHJvcGVydGllcy5odG1sJywgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHBhcnRpYWxzLmJhc2ljX3Byb3BlcnRpZXMgPSBkYXRhO1xuICAgICAgICB9KSxcbiAgICAgICAgJC5nZXQocGF0aCArICd1bmlxdWVuZXNzLWZvcm0tY2hlY2tib3guaHRtbCcsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBwYXJ0aWFscy51bmlxdWVuZXNzX2Zvcm1fY2hlY2tib3ggPSBkYXRhO1xuICAgICAgICB9KSxcbiAgICAgICAgJC5nZXQocGF0aCArICd1bmlxdWVuZXNzLWhpZXJhcmNoeS1jaGVja2JveGVzLmh0bWwnLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgcGFydGlhbHMudW5pcXVlbmVzc19oaWVyYXJjaHlfY2hlY2tib3hlcyA9IGRhdGE7XG4gICAgICAgIH0pLFxuICAgICAgICAkLmdldChwYXRoICsgJ3VuaXF1ZW5lc3MtYnJhbmNoLWNoZWNrYm94Lmh0bWwnLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgcGFydGlhbHMudW5pcXVlbmVzc19icmFuY2hfY2hlY2tib3ggPSBkYXRhO1xuICAgICAgICB9KSxcbiAgICAgICAgJC5nZXQocGF0aCArICdleGl0LWJyYW5jaGdyb3VwLWVkaXRpbmcuaHRtbCcsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBwYXJ0aWFscy5leGl0X2JyYW5jaGdyb3VwX2VkaXRpbmcgPSBkYXRhO1xuICAgICAgICB9KSxcbiAgICAgICAgJC5nZXQocGF0aCArICdiYXNpYy1tZWRpYS1wcm9wZXJ0aWVzLmh0bWwnLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgcGFydGlhbHMuYmFzaWNfbWVkaWFfcHJvcGVydGllcyA9IGRhdGE7XG4gICAgICAgIH0pLFxuICAgICAgICAkLmdldChwYXRoICsgJ2Jhc2ljLWJyYW5jaC1wcm9wZXJ0aWVzLmh0bWwnLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgcGFydGlhbHMuYmFzaWNfYnJhbmNoX3Byb3BlcnRpZXMgPSBkYXRhO1xuICAgICAgICB9KSxcbiAgICAgICAgJC5nZXQocGF0aCArICdiYXNpYy1ncm91cC1wcm9wZXJ0aWVzLmh0bWwnLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgcGFydGlhbHMuYmFzaWNfZ3JvdXBfcHJvcGVydGllcyA9IGRhdGE7XG4gICAgICAgIH0pLFxuICAgICAgICAkLmdldChwYXRoICsgJ2Jhc2ljLXJlYWRtZS1wcm9wZXJ0aWVzLmh0bWwnLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgcGFydGlhbHMuYmFzaWNfcmVhZG1lX3Byb3BlcnRpZXMgPSBkYXRhO1xuICAgICAgICB9KSxcbiAgICAgICAgJC5nZXQocGF0aCArICdwb3NzaWJsZS1hbnN3ZXJzLXdyYXBwZXIuaHRtbCcsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBwYXJ0aWFscy5wb3NzaWJsZV9hbnN3ZXJzX3dyYXBwZXIgPSBkYXRhO1xuICAgICAgICB9KSxcbiAgICAgICAgJC5nZXQocGF0aCArICdwb3NzaWJsZS1hbnN3ZXItbGlzdC1pdGVtLmh0bWwnLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgcGFydGlhbHMucG9zc2libGVfYW5zd2VyX2xpc3RfaXRlbSA9IGRhdGE7XG4gICAgICAgIH0pLFxuICAgICAgICAkLmdldChwYXRoICsgJ2p1bXBzLXdyYXBwZXIuaHRtbCcsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBwYXJ0aWFscy5qdW1wc193cmFwcGVyID0gZGF0YTtcbiAgICAgICAgfSksXG4gICAgICAgICQuZ2V0KHBhdGggKyAnanVtcC1saXN0LWl0ZW0uaHRtbCcsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBwYXJ0aWFscy5qdW1wX2xpc3RfaXRlbSA9IGRhdGE7XG4gICAgICAgIH0pLFxuICAgICAgICAkLmdldChwYXRoICsgJ2p1bXAtbGlzdC1pdGVtLWFsd2F5cy1qdW1wLmh0bWwnLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgcGFydGlhbHMuanVtcF9saXN0X2l0ZW1fYWx3YXlzX2p1bXAgPSBkYXRhO1xuICAgICAgICB9KSxcbiAgICAgICAgJC5nZXQocGF0aCArICdtb2RhbC1mb3JtLmh0bWwnLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgcGFydGlhbHMubW9kYWxfZWRpdF9mb3JtX25hbWUgPSBkYXRhO1xuICAgICAgICB9KSxcbiAgICAgICAgJC5nZXQocGF0aCArICdpbnB1dC10b29sLmh0bWwnLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgcGFydGlhbHMuaW5wdXRfdG9vbCA9IGRhdGE7XG4gICAgICAgIH0pXG4gICAgKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocGFydGlhbHMpO1xuICAgICAgICB9KTtcbiAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZSgpO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBnZXRfcGFydGlhbHM7XG4iLCIndXNlIHN0cmljdCc7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgdWkgPSByZXF1aXJlKCdoZWxwZXJzL3VpJyk7XG52YXIgdXRpbHMgPSByZXF1aXJlKCdoZWxwZXJzL3V0aWxzJyk7XG5cbnZhciBsb2FkX3Byb2plY3QgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICB2YXIgZGVmZXJyZWQgPSBuZXcgJC5EZWZlcnJlZCgpO1xuXG4gICAgdXRpbHMuc2V0UHJvamVjdFVSTCgpO1xuXG4gICAgY29uc29sZS5sb2coY29uc3RzLlBST0pFQ1RfVVJMKTtcblxuICAgIC8vbG9hZCBjb250YWluZXIgdmlld3MgZm9yIGluZGV4Lmh0bWwgKG1haW4gZW50cnkgcG9pbnQpXG4gICAgJC53aGVuKFxuICAgICAgICAkLmFqYXgoe1xuICAgICAgICAgICAgdXJsOiBjb25zdHMuUFJPSkVDVF9VUkwsXG4gICAgICAgICAgICB0eXBlOiAnR0VUJyxcbiAgICAgICAgICAgIC8vY29udGVudFR5cGU6ICdhcHBsaWNhdGlvbi92bmQuYXBpK2pzb24nLFxuICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24gPSBkYXRhO1xuICAgICAgICAgICAgICAgLy8gZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uID0gZGF0YVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbihlcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24gPSBKU09OLnBhcnNlKHBha28udW5nemlwKHdpbmRvdy5hdG9iKGVycm9yLnJlc3BvbnNlVGV4dCksIHsndG8nOiAnc3RyaW5nJ30pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICApLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKCk7XG4gICAgfSkuZmFpbChmdW5jdGlvbigpe1xuICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKCk7XG4gICAgfSk7XG4gICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2UoKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbG9hZF9wcm9qZWN0O1xuIiwiJ3VzZSBzdHJpY3QnO1xudmFyIGNvbnN0cyA9IHJlcXVpcmUoJ2NvbmZpZy9jb25zdHMnKTtcbnZhciB1aSA9IHJlcXVpcmUoJ2hlbHBlcnMvdWknKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoJ2hlbHBlcnMvdXRpbHMnKTtcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJ2NvbmZpZy9mb3JtYnVpbGRlcicpO1xudmFyIG1ldGhvZHMgPSB7fTtcblxubWV0aG9kcy5yZXBsYWNlQ29tbW9uQWR2YW5jZWRQcm9wZXJ0aWVzID0gcmVxdWlyZSgndGVtcGxhdGUvbWV0aG9kcy9yZXBsYWNlQ29tbW9uQWR2YW5jZWRQcm9wZXJ0aWVzJyk7XG5tZXRob2RzLmNyZWF0ZUlucHV0VG9vbEhUTUwgPSByZXF1aXJlKCd0ZW1wbGF0ZS9tZXRob2RzL2NyZWF0ZUlucHV0VG9vbEhUTUwnKTtcbm1ldGhvZHMucHJlcGFyZUFkdmFuY2VkSW5wdXRQcm9wZXJ0aWVzSFRNTCA9IHJlcXVpcmUoJ3RlbXBsYXRlL21ldGhvZHMvcHJlcGFyZUFkdmFuY2VkSW5wdXRQcm9wZXJ0aWVzSFRNTCcpO1xubWV0aG9kcy5nZXRKdW1wVGFiQnRuSFRNTCA9IHJlcXVpcmUoJ3RlbXBsYXRlL21ldGhvZHMvZ2V0SnVtcFRhYkJ0bkhUTUwnKTtcbm1ldGhvZHMuZ2V0QWR2YW5jZWRUYWJCdG5IVE1MID0gcmVxdWlyZSgndGVtcGxhdGUvbWV0aG9kcy9nZXRBZHZhbmNlZFRhYkJ0bkhUTUwnKTtcbm1ldGhvZHMuY3JlYXRlQmFzaWNQcm9wZXJ0aWVzSFRNTCA9IHJlcXVpcmUoJ3RlbXBsYXRlL21ldGhvZHMvY3JlYXRlQmFzaWNQcm9wZXJ0aWVzSFRNTCcpO1xubWV0aG9kcy5nZXRVbmlxdWVuZXNzSFRNTCA9IHJlcXVpcmUoJ3RlbXBsYXRlL21ldGhvZHMvZ2V0VW5pcXVlbmVzc0hUTUwnKTtcbm1ldGhvZHMuZ2V0UG9zc2libGVBbnN3ZXJzSFRNTCA9IHJlcXVpcmUoJ3RlbXBsYXRlL21ldGhvZHMvZ2V0UG9zc2libGVBbnN3ZXJzSFRNTCcpO1xubWV0aG9kcy5nZXRJbnB1dFByb3BlcnRpZXNQYW5lbEhUTUwgPSByZXF1aXJlKCd0ZW1wbGF0ZS9tZXRob2RzL2dldElucHV0UHJvcGVydGllc1BhbmVsSFRNTCcpO1xubWV0aG9kcy5jcmVhdGVJbnB1dFByb3BlcnRpZXNIVE1MID0gcmVxdWlyZSgndGVtcGxhdGUvbWV0aG9kcy9jcmVhdGVJbnB1dFByb3BlcnRpZXNIVE1MJyk7XG5tZXRob2RzLmdldEp1bXBzTGlzdEhUTUwgPSByZXF1aXJlKCd0ZW1wbGF0ZS9tZXRob2RzL2dldEp1bXBzTGlzdEhUTUwnKTtcblxudmFyIHRlbXBsYXRlID0ge1xuXG4gICAgcmVwbGFjZUNvbW1vbkFkdmFuY2VkUHJvcGVydGllczogZnVuY3Rpb24gKHRoZV9tYXJrdXAsIHRoZV9pbnB1dCkge1xuICAgICAgICByZXR1cm4gbWV0aG9kcy5yZXBsYWNlQ29tbW9uQWR2YW5jZWRQcm9wZXJ0aWVzKHRoZV9tYXJrdXAsIHRoZV9pbnB1dCk7XG4gICAgfSxcbiAgICBjcmVhdGVJbnB1dFRvb2xIVE1MOiBmdW5jdGlvbiAoaW5wdXQpIHtcbiAgICAgICAgcmV0dXJuIG1ldGhvZHMuY3JlYXRlSW5wdXRUb29sSFRNTChpbnB1dCk7XG4gICAgfSxcbiAgICBwcmVwYXJlQWR2YW5jZWRJbnB1dFByb3BlcnRpZXNIVE1MOiBmdW5jdGlvbiAodmlldywgaW5wdXQpIHtcbiAgICAgICAgcmV0dXJuIG1ldGhvZHMucHJlcGFyZUFkdmFuY2VkSW5wdXRQcm9wZXJ0aWVzSFRNTCh2aWV3LCBpbnB1dCk7XG4gICAgfSxcbiAgICBnZXRBZHZhbmNlZFRhYkJ0bkhUTUw6IGZ1bmN0aW9uIChyZWYsIGlzX2FjdGl2ZSkge1xuICAgICAgICByZXR1cm4gbWV0aG9kcy5nZXRBZHZhbmNlZFRhYkJ0bkhUTUwocmVmLCBpc19hY3RpdmUpO1xuICAgIH0sXG4gICAgZ2V0SnVtcFRhYkJ0bkhUTUw6IGZ1bmN0aW9uIChyZWYsIGlzX2FjdGl2ZSkge1xuICAgICAgICByZXR1cm4gbWV0aG9kcy5nZXRKdW1wVGFiQnRuSFRNTChyZWYsIGlzX2FjdGl2ZSk7XG4gICAgfSxcbiAgICBjcmVhdGVCYXNpY1Byb3BlcnRpZXNIVE1MOiBmdW5jdGlvbiAoaW5wdXQpIHtcbiAgICAgICAgcmV0dXJuIG1ldGhvZHMuY3JlYXRlQmFzaWNQcm9wZXJ0aWVzSFRNTChpbnB1dCk7XG4gICAgfSxcbiAgICBnZXRVbmlxdWVuZXNzSFRNTDogZnVuY3Rpb24gKGlucHV0KSB7XG4gICAgICAgIHJldHVybiBtZXRob2RzLmdldFVuaXF1ZW5lc3NIVE1MKGlucHV0KTtcbiAgICB9LFxuICAgIGdldFBvc3NpYmxlQW5zd2Vyc0hUTUw6IGZ1bmN0aW9uIChpbnB1dCkge1xuICAgICAgICByZXR1cm4gbWV0aG9kcy5nZXRQb3NzaWJsZUFuc3dlcnNIVE1MKGlucHV0KTtcbiAgICB9LFxuICAgIGdldElucHV0UHJvcGVydGllc1BhbmVsSFRNTDogZnVuY3Rpb24gKGlucHV0KSB7XG4gICAgICAgIHJldHVybiBtZXRob2RzLmdldElucHV0UHJvcGVydGllc1BhbmVsSFRNTChpbnB1dCk7XG4gICAgfSxcbiAgICBjcmVhdGVJbnB1dFByb3BlcnRpZXNIVE1MOiBmdW5jdGlvbiAoaW5wdXQsIHZpZXcpIHtcbiAgICAgICAgcmV0dXJuIG1ldGhvZHMuY3JlYXRlSW5wdXRQcm9wZXJ0aWVzSFRNTChpbnB1dCwgdmlldyk7XG4gICAgfSxcbiAgICBnZXRKdW1wc0xpc3RIVE1MOiBmdW5jdGlvbiAoaW5wdXQpIHtcbiAgICAgICAgcmV0dXJuIG1ldGhvZHMuZ2V0SnVtcHNMaXN0SFRNTChpbnB1dCk7XG4gICAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSB0ZW1wbGF0ZTtcbiIsIid1c2Ugc3RyaWN0JztcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoJ2hlbHBlcnMvdXRpbHMnKTtcblxudmFyIGNyZWF0ZUJhc2ljUHJvcGVydGllc0hUTUwgPSBmdW5jdGlvbiAoaW5wdXQpIHtcblxuICAgIHZhciBodG1sO1xuICAgIHZhciBwYXJ0aWFscyA9IGZvcm1idWlsZGVyLmRvbS5wYXJ0aWFscztcbiAgICB2YXIgcXVlc3Rpb24gPSBpbnB1dC5xdWVzdGlvbjtcbiAgICB2YXIgaXNfcmVxdWlyZWRfY2hlY2tlZCA9IChpbnB1dC5pc19yZXF1aXJlZCkgPyAnY2hlY2tlZCcgOiAnJztcbiAgICB2YXIgaXNfdGl0bGVfY2hlY2tlZCA9IChpbnB1dC5pc190aXRsZSkgPyAnY2hlY2tlZCcgOiAnJztcbiAgICB2YXIgaXNfYnJhbmNoX2VkaXRfZGlzYWJsZWQgPSAoaW5wdXQucXVlc3Rpb24gPT09ICcnKSA/ICdkaXNhYmxlZCcgOiAnJztcbiAgICB2YXIgaXNfZ3JvdXBfZWRpdF9kaXNhYmxlZCA9IChpbnB1dC5xdWVzdGlvbiA9PT0gJycpID8gJ2Rpc2FibGVkJyA6ICcnO1xuICAgIHZhciBpbnB1dHMgPSBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0LmZvcm1zW2Zvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleF0uaW5wdXRzO1xuICAgIHZhciBicmFuY2hfaW5wdXRzID0gW107XG5cbiAgICAvL3doZW4gZWRpdGluZyBhIGJyYW5jaCwgY2hlY2sgdGhlIHRpdGxlIGxpbWl0IGFnYWluc3QgdGhlIGlucHV0cyB3aXRoaW4gYSBicmFuY2ggKGV2ZW4gdGhlIGdyb3VwIGlucHV0cylcbiAgICBpZiAoZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19icmFuY2gpIHtcbiAgICAgICAgYnJhbmNoX2lucHV0cyA9IHV0aWxzLmdldElucHV0T2JqZWN0QnlSZWYoZm9ybWJ1aWxkZXIuYnJhbmNoLmFjdGl2ZV9icmFuY2hfcmVmKS5icmFuY2g7XG4gICAgfVxuXG4gICAgLy9pZiB0aGUgaW5wdXQgaXMgTk9UIG1lZGlhIHR5cGUsIGdldCBiYXNpYyBwcm9wZXJ0aWVzXG4gICAgaWYgKGNvbnN0cy5TSU5HTEVfQU5TV0VSX1RZUEVTLmluZGV4T2YoaW5wdXQudHlwZSkgIT09IC0xIHx8IGNvbnN0cy5NVUxUSVBMRV9BTlNXRVJfVFlQRVMuaW5kZXhPZihpbnB1dC50eXBlKSAhPT0gLTEpIHtcblxuICAgICAgICAvL2lmIGlucHV0IGlzIGEgcmVhZG1lIHR5cGUsIGdldCByZWFkbWUgcHJvcGVydHlcbiAgICAgICAgaWYgKGlucHV0LnR5cGUgPT09IGNvbnN0cy5SRUFETUVfVFlQRSkge1xuICAgICAgICAgICAgaHRtbCA9IHBhcnRpYWxzLmJhc2ljX3JlYWRtZV9wcm9wZXJ0aWVzO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaHRtbCA9IHBhcnRpYWxzLmJhc2ljX3Byb3BlcnRpZXM7XG5cbiAgICAgICAgICAgIGh0bWwgPSBodG1sLnJlcGxhY2UoJ3t7cmVxdWlyZWQtZmxhZy1jaGVja2VkfX0nLCBpc19yZXF1aXJlZF9jaGVja2VkKTtcbiAgICAgICAgICAgIGh0bWwgPSBodG1sLnJlcGxhY2UoJ3t7dGl0bGUtZmxhZy1jaGVja2VkfX0nLCBpc190aXRsZV9jaGVja2VkKTtcblxuICAgICAgICAgICAgLy9pZiAzIHRpdGxlcyBhcmUgYWxyZWFkeSBzZXQsIGRpc2FibGUgdGl0bGUgY2hlY2tib3ggYW5kIHNob3cgcHJvcGVyIG1lc3NhZ2VcbiAgICAgICAgICAgIC8vaWYgd2UgYXJlIGVkaXRpbmcgYSBicmFuY2gsIGNoZWNrIGJyYW5jaCBpbnB1dHMgZm9yIHRpdGxlc1xuXG4gICAgICAgICAgICBpZiAoZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19icmFuY2ggPyB1dGlscy5pc01heFRpdGxlTGltaXRSZWFjaGVkKGJyYW5jaF9pbnB1dHMpIDogdXRpbHMuaXNNYXhUaXRsZUxpbWl0UmVhY2hlZChpbnB1dHMpKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFpbnB1dC5pc190aXRsZSkge1xuICAgICAgICAgICAgICAgICAgICBodG1sID0gaHRtbC5yZXBsYWNlKCd7e2lzLXRpdGxlLWRpc2FibGVkfX0nLCAnZGlzYWJsZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgaHRtbCA9IGh0bWwucmVwbGFjZSgve3tpcy1jaGVja2JveC1kaXNhYmxlZH19L2csICdkaXNhYmxlZC1jaGVja2JveCcpO1xuICAgICAgICAgICAgICAgICAgICBodG1sID0gaHRtbC5yZXBsYWNlKCd7e2NoZWNrYm94LXRpdGxlLWxhYmVsfX0nLCBjb25zdHMuTUFYX1RJVExFX0xJTUlUX1JFQUNIRUQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaHRtbCA9IGh0bWwucmVwbGFjZSgne3tpcy10aXRsZS1kaXNhYmxlZH19JywgJycpO1xuICAgICAgICAgICAgICAgICAgICBodG1sID0gaHRtbC5yZXBsYWNlKC97e2lzLWNoZWNrYm94LWRpc2FibGVkfX0vZywgJycpO1xuICAgICAgICAgICAgICAgICAgICBodG1sID0gaHRtbC5yZXBsYWNlKCd7e2NoZWNrYm94LXRpdGxlLWxhYmVsfX0nLCBjb25zdHMuVVNFX0FOU1dFUl9BU19USVRMRSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaHRtbCA9IGh0bWwucmVwbGFjZSgne3tpcy10aXRsZS1kaXNhYmxlZH19JywgJycpO1xuICAgICAgICAgICAgICAgIGh0bWwgPSBodG1sLnJlcGxhY2UoL3t7aXMtY2hlY2tib3gtZGlzYWJsZWR9fS9nLCAnJyk7XG4gICAgICAgICAgICAgICAgaHRtbCA9IGh0bWwucmVwbGFjZSgne3tjaGVja2JveC10aXRsZS1sYWJlbH19JywgY29uc3RzLlVTRV9BTlNXRVJfQVNfVElUTEUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy9pZiBpbnB1dCBpcyBhIG1lZGlhIHR5cGUsIGdldCBtZWRpYSBwcm9wZXJ0aWVzXG4gICAgaWYgKGNvbnN0cy5NRURJQV9BTlNXRVJfVFlQRVMuaW5kZXhPZihpbnB1dC50eXBlKSAhPT0gLTEpIHtcbiAgICAgICAgaHRtbCA9IHBhcnRpYWxzLmJhc2ljX21lZGlhX3Byb3BlcnRpZXM7XG4gICAgfVxuXG4gICAgLy9pcyBhIGJyYW5jaD8gY2hlY2sgdGhlIGVkaXQgYnV0dG9uIHN0YXR1c1xuICAgIGlmIChpbnB1dC50eXBlID09PSBjb25zdHMuQlJBTkNIX1RZUEUpIHtcbiAgICAgICAgaHRtbCA9IHBhcnRpYWxzLmJhc2ljX2JyYW5jaF9wcm9wZXJ0aWVzO1xuICAgICAgICBodG1sID0gaHRtbC5yZXBsYWNlKCd7e2JyYW5jaC1lZGl0LWRpc2FibGVkfX0nLCBpc19icmFuY2hfZWRpdF9kaXNhYmxlZCk7XG4gICAgfVxuXG4gICAgLy9pcyBhIGdyb3VwPyBjaGVjayB0aGUgZWRpdCBidXR0b24gc3RhdHVzXG4gICAgaWYgKGlucHV0LnR5cGUgPT09IGNvbnN0cy5HUk9VUF9UWVBFKSB7XG4gICAgICAgIGh0bWwgPSBwYXJ0aWFscy5iYXNpY19ncm91cF9wcm9wZXJ0aWVzO1xuICAgICAgICBodG1sID0gaHRtbC5yZXBsYWNlKCd7e2dyb3VwLWVkaXQtZGlzYWJsZWR9fScsIGlzX2dyb3VwX2VkaXRfZGlzYWJsZWQpO1xuICAgIH1cblxuICAgIGh0bWwgPSBodG1sLnJlcGxhY2UoL3t7aW5wdXQtcmVmLXF1ZXN0aW9ufX0vZywgaW5wdXQucmVmICsgJy1xdWVzdGlvbicpO1xuICAgIGh0bWwgPSBodG1sLnJlcGxhY2UoJ3t7YmFzaWMtaW5wdXQtcmVmfX0nLCAnYmFzaWMtJyArIGlucHV0LnJlZik7XG4gICAgaHRtbCA9IGh0bWwucmVwbGFjZSgne3tpbnB1dC1xdWVzdGlvbi12YWx1ZX19JywgcXVlc3Rpb24pO1xuXG4gICAgcmV0dXJuIGh0bWw7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGNyZWF0ZUJhc2ljUHJvcGVydGllc0hUTUw7XG4iLCIndXNlIHN0cmljdCc7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgdXRpbHMgPSByZXF1aXJlKCdoZWxwZXJzL3V0aWxzJyk7XG5cbnZhciBjcmVhdGVJbnB1dFByb3BlcnRpZXNIVE1MID0gZnVuY3Rpb24gKHRoZV9pbnB1dCwgdGhlX3ZpZXcpIHtcblxuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB2YXIgaHRtbCA9IHRoZV92aWV3O1xuICAgIHZhciBpbnB1dCA9IHRoZV9pbnB1dDtcbiAgICB2YXIgcGFydGlhbHMgPSBmb3JtYnVpbGRlci5kb20ucGFydGlhbHM7XG4gICAgdmFyIGlzX21lZGlhX3R5cGUgPSBjb25zdHMuTUVESUFfQU5TV0VSX1RZUEVTLmluZGV4T2YoaW5wdXQudHlwZSkgIT09IC0xO1xuICAgIHZhciBuYXZfdGFicyA9IHBhcnRpYWxzLm5hdnRhYnM7XG4gICAgdmFyIGFkdmFuY2VkX3RhYl9idG47XG4gICAgdmFyIGp1bXBfdGFiX2J1dHRvbjtcbiAgICB2YXIgcHJvcGVydGllcztcbiAgICB2YXIganVtcHNfaHRtbDtcbiAgICB2YXIganVtcF9saXN0X2h0bWw7XG5cbiAgICBodG1sID0gaHRtbC5yZXBsYWNlKCd7e2lucHV0LXJlZn19JywgaW5wdXQucmVmKTtcbiAgICBodG1sID0gaHRtbC5yZXBsYWNlKCd7e2FkdmFuY2VkLWlucHV0LXJlZn19JywgJ2FkdmFuY2VkLScgKyBpbnB1dC5yZWYpO1xuXG4gICAgLy9nZXQgbmF2dGFicyBodG1sXG4gICAgbmF2X3RhYnMgPSBuYXZfdGFicy5yZXBsYWNlKCd7eyNiYXNpYy1pbnB1dC1yZWZ9fScsICcjYmFzaWMtJyArIGlucHV0LnJlZik7XG5cbiAgICAvL2ZvciBtZWRpYSBpbnB1dHMsIGJyYW5jaCBhbmQgZ3JvdXBzLCByZWFkbWUsIGdldCBkaXNhYmxlZCAnQWR2YW5jZWQgdGFiJyBidXR0b25cbiAgICBpZiAoaXNfbWVkaWFfdHlwZSB8fCBpbnB1dC50eXBlID09PSBjb25zdHMuQlJBTkNIX1RZUEUgfHwgaW5wdXQudHlwZSA9PT0gY29uc3RzLkdST1VQX1RZUEUgfHwgaW5wdXQudHlwZSA9PT0gY29uc3RzLlJFQURNRV9UWVBFKSB7XG4gICAgICAgIGFkdmFuY2VkX3RhYl9idG4gPSBzZWxmLmdldEFkdmFuY2VkVGFiQnRuSFRNTChpbnB1dC5yZWYsIGZhbHNlKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIC8vZ2V0IGVuYWJsZSBhZHZhbmNlZCB0YWIgYnV0dG9uXG4gICAgICAgIGFkdmFuY2VkX3RhYl9idG4gPSBzZWxmLmdldEFkdmFuY2VkVGFiQnRuSFRNTChpbnB1dC5yZWYsIHRydWUpO1xuICAgIH1cblxuICAgIG5hdl90YWJzID0gbmF2X3RhYnMucmVwbGFjZSgne3thZHZhbmNlZC10YWItYnRufX0nLCBhZHZhbmNlZF90YWJfYnRuKTtcblxuICAgIC8vZm9yIGlucHV0cyBORVNURUQgd2l0aGluIGEgZ3JvdXAsIGRpc2FibGUganVtcHMgdGFiLCBhcyB3ZSBjYW5ub3QgaGF2ZSBqdW1wcyBpbiBncm91cHNcbiAgICBpZiAoZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19ncm91cCkge1xuICAgICAgICBqdW1wX3RhYl9idXR0b24gPSBzZWxmLmdldEp1bXBUYWJCdG5IVE1MKGlucHV0LnJlZiwgZmFsc2UpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAganVtcF90YWJfYnV0dG9uID0gc2VsZi5nZXRKdW1wVGFiQnRuSFRNTChpbnB1dC5yZWYsIHRydWUpO1xuICAgIH1cblxuICAgIG5hdl90YWJzID0gbmF2X3RhYnMucmVwbGFjZSgne3tqdW1wcy10YWItYnRufX0nLCBqdW1wX3RhYl9idXR0b24pO1xuXG4gICAgaHRtbCA9IGh0bWwucmVwbGFjZSgne3tuYXYtdGFic319JywgbmF2X3RhYnMpO1xuXG4gICAgLy9nZXQgcHJvcGVydGllcyBodG1sXG4gICAgcHJvcGVydGllcyA9IHNlbGYuY3JlYXRlQmFzaWNQcm9wZXJ0aWVzSFRNTChpbnB1dCk7XG4gICAgaHRtbCA9IGh0bWwucmVwbGFjZSgne3twcm9wZXJ0aWVzfX0nLCBwcm9wZXJ0aWVzKTtcblxuICAgIC8vZ2V0IGp1bXBzIGh0bWxcbiAgICBqdW1wc19odG1sID0gcGFydGlhbHMuanVtcHNfd3JhcHBlcjtcbiAgICBqdW1wc19odG1sID0ganVtcHNfaHRtbC5yZXBsYWNlKCd7e2p1bXBzLWlucHV0LXJlZn19JywgJ2p1bXBzLScgKyBpbnB1dC5yZWYpO1xuXG4gICAgLy9idWlsZCBqdW1wIGxpc3QgaHRtbFxuICAgIGlmIChpbnB1dC5qdW1wcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIC8vZ2V0IGxpc3Qgb2YganVtcHMgbWFya3VwXG4gICAgICAgIGp1bXBfbGlzdF9odG1sID0gc2VsZi5nZXRKdW1wc0xpc3RIVE1MKGlucHV0KTtcbiAgICAgICAganVtcHNfaHRtbCA9IGp1bXBzX2h0bWwucmVwbGFjZSgne3tuby1qdW1wc19tZXNzYWdlLWhpZGRlbn19JywgJ2hpZGRlbicpO1xuXG4gICAgICAgIGp1bXBzX2h0bWwgPSBqdW1wc19odG1sLnJlcGxhY2UoJ3t7anVtcHMtbGlzdH19JywganVtcF9saXN0X2h0bWwpO1xuXG4gICAgICAgIC8vaWYgd2UgcmVhY2hlZCB0aGUgbWF4IG51bWJlciBvZiBqdW1wcyBvciB0aGlzIGlucHV0IGRvZXMgbm90IGFsbG93IG11bHRpcGxlIGp1bXBzLCBkaXNhYmxlIGJ1dHRvblxuICAgICAgICBpZiAoY29uc3RzLk1VTFRJUExFX0FOU1dFUl9UWVBFUy5pbmRleE9mKGlucHV0LnR5cGUpID4gLTEpIHtcbiAgICAgICAgICAgIC8vbXVsdGlwbGUgYW5zd2VyIGlucHV0LCBkaXNhYmxlIGFkZCBqdW1wIGlmIHRoZSBtYXhpbXVtIG51bWJlciBvZiBqdW1wcyBmb3IgdGhlIGlucHV0IGlzIHJlYWNoZWRcbiAgICAgICAgICAgIC8vIG9yIGV4Y2VlZGVkLCB0aGUgbGF0dGVyIGJlY2F1c2Ugd2UgaGFkIGEgYnVnLlxuICAgICAgICAgICAgaWYgKGlucHV0Lmp1bXBzLmxlbmd0aCA+PSBpbnB1dC5wb3NzaWJsZV9hbnN3ZXJzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGp1bXBzX2h0bWwgPSBqdW1wc19odG1sLnJlcGxhY2UoJ3t7YWRkLWp1bXAtYnRuLXN0YXRlfX0nLCAnZGlzYWJsZWQnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGp1bXBzX2h0bWwgPSBqdW1wc19odG1sLnJlcGxhY2UoJ3t7YWRkLWp1bXAtYnRuLXN0YXRlfX0nLCAnJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvL3NpbmdsZSBhbnN3ZXIgaW5wdXRcbiAgICAgICAgICAgIGp1bXBzX2h0bWwgPSBqdW1wc19odG1sLnJlcGxhY2UoJ3t7YWRkLWp1bXAtYnRuLXN0YXRlfX0nLCAnZGlzYWJsZWQnKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgLy9ubyBqdW1wcyBsaXN0IHRvIHJlbmRlclxuICAgICAgICBqdW1wc19odG1sID0ganVtcHNfaHRtbC5yZXBsYWNlKCd7e2p1bXBzLWxpc3R9fScsICcnKTtcbiAgICAgICAganVtcHNfaHRtbCA9IGp1bXBzX2h0bWwucmVwbGFjZSgne3thZGQtanVtcC1idG4tc3RhdGV9fScsICcnKTtcbiAgICAgICAganVtcHNfaHRtbCA9IGp1bXBzX2h0bWwucmVwbGFjZSgne3tuby1qdW1wc19tZXNzYWdlLWhpZGRlbn19JywgJycpO1xuICAgIH1cblxuICAgIGh0bWwgPSBodG1sLnJlcGxhY2UoJ3t7anVtcHN9fScsIGp1bXBzX2h0bWwpO1xuXG4gICAgLy9kaXNhYmxlIFwiQWRkIEp1bXBcIiBidXR0b24gaWYgdGhlIG1heCBudW1iZXIgb2YganVtcHMgaXMgcmVhY2hlZFxuICAgIGlmIChjb25zdHMuTVVMVElQTEVfQU5TV0VSX1RZUEVTLmluZGV4T2YoaW5wdXQudHlwZSkgIT09IC0xKSB7XG4gICAgICAgIC8vbXVsdGlwbGUganVtcHMgYWxsb3dlZCwgY2hlY2sgaWYgbGltaXQgbWV0IChudW1iZXIgb2YganVtcHMgbXVzdCBiZSBsZXNzIG9yIGVxdWFsIHRvIHBvc3NpYmxlIGFuc3dlcnMpXG4gICAgICAgIGlmIChpbnB1dC5qdW1wcy5sZW5ndGggPj0gaW5wdXQucG9zc2libGVfYW5zd2Vycy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGh0bWwgPSBodG1sLnJlcGxhY2UoJ3t7YWRkLWp1bXAtYnRuLXN0YXRlfX0nLCAnZGlzYWJsZWQ9XCJkaXNhYmxlZFwiJyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBodG1sID0gaHRtbC5yZXBsYWNlKCd7e2FkZC1qdW1wLWJ0bi1zdGF0ZX19JywgJycpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICAvL3NpbmdsZSBqdW1wIGFsbG93ZWQsIGVuYWJsZSBhZGQganVtcCBidXR0b25cbiAgICAgICAgaHRtbCA9IGh0bWwucmVwbGFjZSgne3thZGQtanVtcC1idG4tc3RhdGV9fScsICcnKTtcbiAgICB9XG5cbiAgICAvL2lmIG11bHRpcGxlIGNob2ljZSBpbnB1dCB0eXBlLCBhcHBlbmQgcG9zc2libGUgYW5zd2VyIHdyYXBwZXJcbiAgICBpZiAoY29uc3RzLk1VTFRJUExFX0FOU1dFUl9UWVBFUy5pbmRleE9mKGlucHV0LnR5cGUpICE9PSAtMSkge1xuXG4gICAgICAgIGh0bWwgPSBodG1sLnJlcGxhY2UoJ3t7cG9zc2libGUtYW5zd2Vyc319Jywgc2VsZi5nZXRQb3NzaWJsZUFuc3dlcnNIVE1MKGlucHV0KSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBodG1sID0gaHRtbC5yZXBsYWNlKCd7e3Bvc3NpYmxlLWFuc3dlcnN9fScsICcnKTtcbiAgICB9XG5cbiAgICAvL2NoZWNrIGlmIGlucHV0IGFsbG93cyB1bmlxdWVuZXNzXG4gICAgaWYgKGNvbnN0cy5VTklRVUVORVNTX0FMTE9XRURfVFlQRVMuaW5kZXhPZihpbnB1dC50eXBlKSAhPT0gLTEpIHtcbiAgICAgICAgaHRtbCA9IGh0bWwucmVwbGFjZSgne3t1bmlxdWVuZXNzfX0nLCBzZWxmLmdldFVuaXF1ZW5lc3NIVE1MKGlucHV0KSk7XG4gICAgfVxuICAgIHJldHVybiBodG1sO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBjcmVhdGVJbnB1dFByb3BlcnRpZXNIVE1MO1xuXG5cbiIsIid1c2Ugc3RyaWN0JztcbnZhciB1dGlscyA9IHJlcXVpcmUoJ2hlbHBlcnMvdXRpbHMnKTtcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgbWVzc2FnZXMgPSByZXF1aXJlKCdjb25maWcvbWVzc2FnZXMnKTtcblxudmFyIGNyZWF0ZUlucHV0VG9vbEhUTUwgPSBmdW5jdGlvbiAoaW5wdXQpIHtcblxuICAgIHZhciBodG1sID0gJyc7XG4gICAgdmFyIGljb24gPSB1dGlscy5nZXRJbnB1dFRvb2xJY29uKGlucHV0LnR5cGUpO1xuICAgIHZhciBpc19pbnB1dF9icmFuY2ggPSAoaW5wdXQudHlwZSA9PT0gY29uc3RzLkJSQU5DSF9UWVBFKSA/ICdpbnB1dC1icmFuY2gnIDogJyc7XG4gICAgdmFyIGlzX2lucHV0X2dyb3VwID0gKGlucHV0LnR5cGUgPT09IGNvbnN0cy5HUk9VUF9UWVBFKSA/ICdpbnB1dC1ncm91cCcgOiAnJztcbiAgICB2YXIgcXVlc3Rpb24gPSBpbnB1dC5xdWVzdGlvbiA9PT0gJycgPyBtZXNzYWdlcy5lcnJvci5OT19RVUVTVElPTl9URVhUX1lFVCA6IGlucHV0LnF1ZXN0aW9uO1xuICAgIHZhciBpbnZpc2libGVfY2xhc3MgPSBpbnB1dC5qdW1wcy5sZW5ndGggPiAwID8gJycgOiAnaW52aXNpYmxlJztcblxuICAgIC8vY29udmVydCBodG1sIGVudGl0aWVzIHRvIHRhZ3MgYW5kIHN0cmlwIGh0bWwgdGFncyBmcm9tIHJlYWRtZSB0eXBlIGlmIGFueVxuICAgIGlmIChpbnB1dC50eXBlID09PSBjb25zdHMuUkVBRE1FX1RZUEUpIHtcbiAgICAgICAgcXVlc3Rpb24gPSB1dGlscy5kZWNvZGVIdG1sKGlucHV0LnF1ZXN0aW9uKTtcbiAgICAgICAgcXVlc3Rpb24gPSBxdWVzdGlvbi5yZXBsYWNlKC8oPChbXj5dKyk+KS9pZywgJyAnKTtcbiAgICB9XG5cbiAgICBodG1sICs9ICc8ZGl2IGNsYXNzPVwiaW5wdXQgJyArIGlzX2lucHV0X2JyYW5jaCArIGlzX2lucHV0X2dyb3VwICsgJyB1aS1kcmFnZ2FibGUgdWktZHJhZ2dhYmxlLWhhbmRsZVwiICc7XG4gICAgaHRtbCArPSAnZGF0YS10eXBlPVwiJyArIGlucHV0LnR5cGUgKyAnXCIgZGF0YS1pbnB1dC1yZWY9XCInICsgaW5wdXQucmVmICsgJ1wiPic7XG4gICAgaHRtbCArPSAnPGRpdiBjbGFzcz1cImlucHV0LWlubmVyXCI+JztcbiAgICBodG1sICs9ICc8aSBjbGFzcz1cImZhIGZhLTJ4IGZhLWZ3ICcgKyBpY29uICsgJ1wiPjwvaT4nO1xuICAgIGh0bWwgKz0gJzxzcGFuIGNsYXNzPVwicXVlc3Rpb24tcHJldmlld1wiPicgKyBxdWVzdGlvbi50cnVuYyhjb25zdHMuTElNSVRTLnF1ZXN0aW9uX3ByZXZpZXdfbGVuZ3RoKSArICc8L3NwYW4+JztcbiAgICBodG1sICs9ICc8aSBjbGFzcz1cInF1ZXN0aW9uLXN0YXRlIGZhIGZhLWNoZWNrIGZhLTJ4IGZhLWZ3IHB1bGwtcmlnaHRcIj48L2k+JztcbiAgICBodG1sICs9ICc8aSBjbGFzcz1cImp1bXAtc3RhdGUgZmEgZmEtYXJyb3ctY2lyY2xlLW8tZG93biBmYS0yeCBmYS1mdyBwdWxsLXJpZ2h0ICcgKyBpbnZpc2libGVfY2xhc3MgKyAnXCI+PC9pPic7XG5cbiAgICBpZiAoaW5wdXQudHlwZSA9PT0gY29uc3RzLkJSQU5DSF9UWVBFKSB7XG4gICAgICAgIGh0bWwgKz0gJ3t7YnJhbmNoLWNvbnRlbnR9fSc7XG4gICAgfVxuICAgIGlmIChpbnB1dC50eXBlID09PSBjb25zdHMuR1JPVVBfVFlQRSkge1xuICAgICAgICBodG1sICs9ICd7e2dyb3VwLWNvbnRlbnR9fSc7XG4gICAgfVxuICAgIGh0bWwgKz0gJzwvZGl2Pic7XG4gICAgaHRtbCArPSAnPC9kaXY+JztcblxuICAgIHJldHVybiBodG1sO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBjcmVhdGVJbnB1dFRvb2xIVE1MO1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgZ2V0QWR2YW5jZWRUYWJCdG5IVE1MID0gZnVuY3Rpb24gKHJlZiwgaXNfYWN0aXZlKSB7XG5cbiAgICB2YXIgaHRtbCA9ICcnO1xuXG4gICAgaWYgKGlzX2FjdGl2ZSkge1xuICAgICAgICBodG1sICs9ICc8bGkgcm9sZT1cInByZXNlbnRhdGlvblwiIGNsYXNzPVwibmF2LXRhYnNfX3RhYi1idG4taXRlbSBhZHZhbmNlZC10YWJcIj4nO1xuICAgICAgICBodG1sICs9ICc8YSBocmVmPVwiI2FkdmFuY2VkLScgKyByZWYgKyAnXCIgcm9sZT1cInRhYlwiIGRhdGEtdG9nZ2xlPVwidGFiXCI+IEFkdmFuY2VkJm5ic3A7JztcbiAgICAgICAgaHRtbCArPSAnPGkgY2xhc3M9XCJmYSBmYS1leGNsYW1hdGlvbiBmYS0yeCBpbnZpc2libGUgYWR2YW5jZWQtZXJyb3JcIj48L2k+JztcbiAgICAgICAgaHRtbCArPSAnPC9hPic7XG4gICAgICAgIGh0bWwgKz0gJzwvbGk+JztcbiAgICB9XG4gICAgZWxzZSB7XG5cbiAgICAgICAgaHRtbCArPSAnPGxpIHJvbGU9XCJwcmVzZW50YXRpb25cIiBjbGFzcz1cImRpc2FibGVkIGRpc2FibGVkLXRhYiBuYXYtdGFic19fdGFiLWJ0bi1pdGVtXCI+JztcbiAgICAgICAgaHRtbCArPSAnPGEgaHJlZj1cIiNcIiByb2xlPVwidGFiXCIgPiBBZHZhbmNlZCZuYnNwOyc7XG4gICAgICAgIGh0bWwgKz0gJzxpIGNsYXNzPVwiZmEgZmEtZXhjbGFtYXRpb24gZmEtMnggIGludmlzaWJsZSBhZHZhbmNlZC1lcnJvclwiPjwvaT4nO1xuICAgICAgICBodG1sICs9ICc8L2E+JztcbiAgICAgICAgaHRtbCArPSAnPC9saT4nO1xuICAgIH1cbiAgICByZXR1cm4gaHRtbDtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gZ2V0QWR2YW5jZWRUYWJCdG5IVE1MO1xuIiwiJ3VzZSBzdHJpY3QnO1xudmFyIGNvbnN0cyA9IHJlcXVpcmUoJ2NvbmZpZy9jb25zdHMnKTtcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJ2NvbmZpZy9mb3JtYnVpbGRlcicpO1xuXG52YXIgZ2V0SW5wdXRQcm9wZXJ0aWVzUGFuZWxIVE1MID0gZnVuY3Rpb24gKHRoZV9pbnB1dCkge1xuXG4gICAgLy90b2RvIHVzZSB0aGUgZnVuY3Rpb24gaGVyZSBodHRwOi8vanNmaWRkbGUubmV0L2pmcmllbmQwMC9EeUN3ay9cbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgdmFyIGlucHV0ID0gdGhlX2lucHV0O1xuICAgIHZhciBpc19tZWRpYV90eXBlID0gY29uc3RzLk1FRElBX0FOU1dFUl9UWVBFUy5pbmRleE9mKGlucHV0LnR5cGUpICE9PSAtMTtcbiAgICB2YXIgaHRtbCA9IGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX3ZpZXdzW2lucHV0LnR5cGVdO1xuXG4gICAgLy9nZXQgZHluYW1pYyBodG1sIGZvciBpbnB1dCBwcm9wZXJ0aWVzIHBhbmVsXG4gICAgaHRtbCA9IHNlbGYuY3JlYXRlSW5wdXRQcm9wZXJ0aWVzSFRNTChpbnB1dCwgaHRtbCk7XG5cbiAgICAvL3ByZXBhcmUgYWR2YW5jZWQgcHJvcGVydGllcyAoTk9UIGZvciBicmFuY2ggb3IgZ3JvdXBzIG9yIG1lZGlhIHR5cGVzKVxuICAgIGlmIChpbnB1dC50eXBlICE9PSBjb25zdHMuQlJBTkNIX1RZUEUgfHwgaW5wdXQudHlwZSAhPT0gY29uc3RzLkdST1VQX1RZUEUgfHwgIWlzX21lZGlhX3R5cGUpIHtcbiAgICAgICAgLy9tYW5pcHVsYXRlIGRvbSBmb3IgYWR2YW5jZWQgb3B0aW9ucywgd2hpY2ggYXJlIHVuaXF1ZSAobW9zdCBvZiB0aGUgdGltZSkgdG8gdGhlIGlucHV0IHR5cGVcbiAgICAgICAgaHRtbCA9IHNlbGYucHJlcGFyZUFkdmFuY2VkSW5wdXRQcm9wZXJ0aWVzSFRNTChodG1sLCBpbnB1dCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGh0bWw7XG5cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gZ2V0SW5wdXRQcm9wZXJ0aWVzUGFuZWxIVE1MO1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgZ2V0SnVtcFRhYkJ0bkhUTUwgPSAgZnVuY3Rpb24gKHJlZiwgaXNfYWN0aXZlKSB7XG5cbiAgICB2YXIgaHRtbCA9ICcnO1xuXG4gICAgaWYgKGlzX2FjdGl2ZSkge1xuXG4gICAgICAgIGh0bWwgKz0gJzxsaSByb2xlPVwicHJlc2VudGF0aW9uXCIgY2xhc3M9XCJqdW1wLXRhYiBuYXYtdGFic19fdGFiLWJ0bi1pdGVtXCI+JztcbiAgICAgICAgaHRtbCArPSAnPGEgaHJlZj1cIiNqdW1wcy0nICsgcmVmICsgJ1wiIHJvbGU9XCJ0YWJcIiBkYXRhLXRvZ2dsZT1cInRhYlwiID4gSnVtcHMmbmJzcDsnO1xuICAgICAgICBodG1sICs9ICc8aSBjbGFzcz1cImZhIGZhLWV4Y2xhbWF0aW9uIGZhLTJ4IGludmlzaWJsZSBqdW1wcy1lcnJvclwiPjwvaT4nO1xuICAgICAgICBodG1sICs9ICc8L2E+JztcbiAgICAgICAgaHRtbCArPSAnPC9saT4nO1xuXG4gICAgfVxuICAgIGVsc2Uge1xuXG4gICAgICAgIGh0bWwgKz0gJzxsaSByb2xlPVwicHJlc2VudGF0aW9uXCIgY2xhc3M9XCJqdW1wLXRhYiBkaXNhYmxlZCBkaXNhYmxlZC10YWIgbmF2LXRhYnNfX3RhYi1idG4taXRlbVwiPic7XG4gICAgICAgIGh0bWwgKz0gJzxhIGhyZWY9XCIjXCIgY2xhc3M9XCJuYXYtdGFic19fanVtcFwiIHJvbGU9XCJ0YWJcIiA+IEp1bXBzJm5ic3A7JztcbiAgICAgICAgaHRtbCArPSAnPGkgY2xhc3M9XCJmYSBmYS1leGNsYW1hdGlvbiBmYS0yeCBpbnZpc2libGUganVtcHMtZXJyb3JcIj48L2k+JztcbiAgICAgICAgaHRtbCArPSAnPC9hPic7XG4gICAgICAgIGh0bWwgKz0gJzwvbGk+JztcbiAgICB9XG4gICAgcmV0dXJuIGh0bWw7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGdldEp1bXBUYWJCdG5IVE1MO1xuIiwiLypqc2hpbnQgZXhwcjp0cnVlICovXG4ndXNlIHN0cmljdCc7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgdXRpbHMgPSByZXF1aXJlKCdoZWxwZXJzL3V0aWxzJyk7XG5cbmZ1bmN0aW9uIF9nZXRTZWxlY3RlZEp1bXBBbnN3ZXJIVE1MKHBvc3NpYmxlX2Fuc3dlcikge1xuICAgIHJldHVybiAnPG9wdGlvbiB2YWx1ZT1cIicgKyBwb3NzaWJsZV9hbnN3ZXIuYW5zd2VyX3JlZiArICdcIiBzZWxlY3RlZD1cInNlbGVjdGVkXCI+JyArIHBvc3NpYmxlX2Fuc3dlci5hbnN3ZXIgKyAnPC9vcHRpb24+Jztcbn1cblxuZnVuY3Rpb24gX2dldFNlbGVjdGVkSnVtcENvbmRpdGlvbkhUTUwoanVtcCkge1xuXG4gICAgdmFyIHRleHQgPSAnJztcblxuICAgICQoY29uc3RzLkpVTVBfQ09ORElUSU9OUykuZWFjaChmdW5jdGlvbiAoaW5kZXgsIGNvbmRpdGlvbikge1xuICAgICAgICBpZiAoY29uZGl0aW9uLmtleSA9PT0ganVtcC53aGVuKSB7XG4gICAgICAgICAgICB0ZXh0ID0gY29uZGl0aW9uLnRleHQ7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gJzxvcHRpb24gdmFsdWU9XCInICsganVtcC53aGVuICsgJ1wiIHNlbGVjdGVkPVwic2VsZWN0ZWRcIj4nICsgdGV4dCArICc8L29wdGlvbj4nO1xufVxuXG5mdW5jdGlvbiBfZ2V0U2VsZWN0ZWRKdW1wRGVzdGluYXRpb25IVE1MKGRlc3RpbmF0aW9uX2lucHV0KSB7XG4gICAgcmV0dXJuICc8b3B0aW9uIHZhbHVlPVwiJyArIGRlc3RpbmF0aW9uX2lucHV0LnJlZiArICdcIiBzZWxlY3RlZD1cInNlbGVjdGVkXCI+JyArIGRlc3RpbmF0aW9uX2lucHV0LnF1ZXN0aW9uICsgJzwvb3B0aW9uPic7XG59XG5cbnZhciBnZXRKdW1wc0xpc3RIVE1MID0gZnVuY3Rpb24gKGlucHV0KSB7XG5cbiAgICB2YXIgaHRtbCA9ICcnO1xuICAgIHZhciBpbnB1dHMgPSBbXTtcbiAgICB2YXIgc2VsZWN0ZWRfY29uZGl0aW9uX2h0bWw7XG4gICAgdmFyIHNlbGVjdGVkX3Bvc3NpYmxlX2Fuc3dlcl9odG1sO1xuXG4gICAgLy9nZXQgaW5wdXQgbGlzdCAoaGllcmFyY2h5IG9yIGJyYW5jaClcbiAgICB2YXIgcGFydHMgPSBpbnB1dC5yZWYuc3BsaXQoJ18nKTtcbiAgICBpZiAocGFydHMubGVuZ3RoID4gMykge1xuICAgICAgICAvL3RoaXMgaXMgYSBicmFuY2ggcmVmXG4gICAgICAgIHBhcnRzLnBvcCgpO1xuICAgICAgICBpbnB1dHMgPSB1dGlscy5nZXRJbnB1dE9iamVjdEJ5UmVmKHBhcnRzLmpvaW4oJ18nKSkuYnJhbmNoO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgaW5wdXRzID0gZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uLmRhdGEucHJvamVjdC5mb3Jtc1tmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXhdLmlucHV0cztcbiAgICB9XG4gICAgLy9qdW1wIGRlc3RpbmF0aW9uczogY2Fubm90IGp1bXAgb24gdGhlIG5leHQgb25lLCBidXQgYWx3YXlzIG5leHQgKyAxXG4gICAgdmFyIGp1bXBfZGVzdGluYXRpb25zID0gdXRpbHMuZ2V0SnVtcEF2YWlsYWJsZURlc3RpbmF0aW9ucyhpbnB1dCwgaW5wdXRzKTtcblxuICAgICQoaW5wdXQuanVtcHMpLmVhY2goZnVuY3Rpb24gKGluZGV4LCBqdW1wKSB7XG5cbiAgICAgICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgICAgICogc2V0IGB3aGVuIG9wdGlvbmBcbiAgICAgICAgICovXG4gICAgICAgIGlmIChjb25zdHMuTVVMVElQTEVfQU5TV0VSX1RZUEVTLmluZGV4T2YoaW5wdXQudHlwZSkgPT09IC0xKSB7XG4gICAgICAgICAgICAvL2FwcGVuZCBhIGp1bXAgd2l0aCBjb25kaXRpb24gZGlzYWJsZWQgYW5kIHNldCB0byAnYWx3YXlzJyBqdW1wXG4gICAgICAgICAgICAvL3dlIGRvIHRoaXMgYmVjYXVzZSBvbiBFQzUgd2hlbiB0aGUgcXVlc3Rpb24gaXMgYW4gb3BlbiBhbnN3ZXIsIGEganVtcCB3aWxsIGFsd2F5cyBqdW1wIG5vIG1hdHRlciB0aGUgYW5zd2VyIGdpdmVuXG4gICAgICAgICAgICBodG1sICs9IGZvcm1idWlsZGVyLmRvbS5wYXJ0aWFscy5qdW1wX2xpc3RfaXRlbV9hbHdheXNfanVtcDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIC8vanVtcHMgZ2V0IGZ1bGwgZnVuY3Rpb25hbGl0eSB3aXRoIG11bHRpcGxlIGFuc3dlcnMgaW5wdXQgdHlwZXNcbiAgICAgICAgICAgIGh0bWwgKz0gZm9ybWJ1aWxkZXIuZG9tLnBhcnRpYWxzLmp1bXBfbGlzdF9pdGVtO1xuXG4gICAgICAgICAgICBzZWxlY3RlZF9jb25kaXRpb25faHRtbCA9IF9nZXRTZWxlY3RlZEp1bXBDb25kaXRpb25IVE1MKGp1bXApO1xuICAgICAgICAgICAgaHRtbCA9IGh0bWwucmVwbGFjZSgne3tsb2dpYy13aGVuLXNhdmVkLW9wdGlvbn19Jywgc2VsZWN0ZWRfY29uZGl0aW9uX2h0bWwpO1xuXG4gICAgICAgICAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAgICAgICAgICogIHNldCBzZWxlY3RlZCBgYW5zd2VyYFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICAkKGlucHV0LnBvc3NpYmxlX2Fuc3dlcnMpLmVhY2goZnVuY3Rpb24gKGluZGV4LCBwb3NzaWJsZV9hbnN3ZXIpIHtcbiAgICAgICAgICAgICAgICBpZiAocG9zc2libGVfYW5zd2VyLmFuc3dlcl9yZWYgPT09IGp1bXAuYW5zd2VyX3JlZikge1xuICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZF9wb3NzaWJsZV9hbnN3ZXJfaHRtbCA9IF9nZXRTZWxlY3RlZEp1bXBBbnN3ZXJIVE1MKHBvc3NpYmxlX2Fuc3dlcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBodG1sID0gaHRtbC5yZXBsYWNlKCd7e2xvZ2ljLWFuc3dlci1zYXZlZC1vcHRpb259fScsIHNlbGVjdGVkX3Bvc3NpYmxlX2Fuc3dlcl9odG1sKTtcbiAgICAgICAgICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgfVxuICAgICAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAgICAgKiAgc2V0IHNlbGVjdGVkIGBnb3RvYFxuICAgICAgICAgKi9cbiAgICAgICAgdmFyIHNlbGVjdGVkX2dvdG9faHRtbCA9ICcnO1xuICAgICAgICBpZiAoanVtcC50byA9PT0gJ0VORCcpIHtcbiAgICAgICAgICAgIHNlbGVjdGVkX2dvdG9faHRtbCA9IF9nZXRTZWxlY3RlZEp1bXBEZXN0aW5hdGlvbkhUTUwoeyByZWY6ICdFTkQnLCBxdWVzdGlvbjogJ0VuZCBvZiBmb3JtJyB9KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICQoanVtcF9kZXN0aW5hdGlvbnMpLmVhY2goZnVuY3Rpb24gKGluZGV4LCBqdW1wX2Rlc3RpbmF0aW9uKSB7XG4gICAgICAgICAgICAgICAgaWYgKGp1bXBfZGVzdGluYXRpb24ucmVmID09PSBqdW1wLnRvKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkX2dvdG9faHRtbCA9IF9nZXRTZWxlY3RlZEp1bXBEZXN0aW5hdGlvbkhUTUwoanVtcF9kZXN0aW5hdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGh0bWwgPSBodG1sLnJlcGxhY2UoJ3t7bG9naWMtZ290by1zYXZlZC1vcHRpb259fScsIHNlbGVjdGVkX2dvdG9faHRtbCk7XG4gICAgICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgaHRtbCA9IGh0bWwucmVwbGFjZSgve3tpbnB1dC1yZWYtbG9naWMtd2hlbn19L2csIGluZGV4ICsgJy0nICsgaW5wdXQucmVmICsgJy1sb2dpYy13aGVuJyk7XG4gICAgICAgIGh0bWwgPSBodG1sLnJlcGxhY2UoL3t7aW5wdXQtcmVmLWxvZ2ljLWdvdG99fS9nLCBpbmRleCArICctJyArIGlucHV0LnJlZiArICctbG9naWMtZ290bycpO1xuICAgICAgICBodG1sID0gaHRtbC5yZXBsYWNlKC97e2lucHV0LXJlZi1sb2dpYy1hbnN3ZXJ9fS9nLCBpbmRleCArICctJyArIGlucHV0LnJlZiArICctbG9naWMtYW5zd2VyJyk7XG5cbiAgICB9KTtcblxuXG4gICAgcmV0dXJuIGh0bWw7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGdldEp1bXBzTGlzdEhUTUw7XG4iLCIndXNlIHN0cmljdCc7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgZ2V0UG9zc2libGVBbnN3ZXJzTGlzdCA9IHJlcXVpcmUoJ3RlbXBsYXRlL21ldGhvZHMvZ2V0UG9zc2libGVBbnN3ZXJzTGlzdCcpO1xuXG4vL2dlbmVyYXRlIGxpc3Qgb2YgcG9zc2libGUgYW5zd2VycyBhbmQgaW5qZWN0IGl0IGludG8gaXRzIHdyYXBwZXIsIHRoZW4gcmV0dXJuIGl0XG52YXIgZ2V0UG9zc2libGVBbnN3ZXJzSFRNTCA9IGZ1bmN0aW9uICh0aGVfaW5wdXQpIHtcblxuICAgIHZhciBpbnB1dCA9IHRoZV9pbnB1dDtcbiAgICB2YXIgd3JhcHBlciA9IGZvcm1idWlsZGVyLmRvbS5wYXJ0aWFscy5wb3NzaWJsZV9hbnN3ZXJzX3dyYXBwZXI7XG4gICAgdmFyIGxpc3QgPSBnZXRQb3NzaWJsZUFuc3dlcnNMaXN0KGlucHV0LnBvc3NpYmxlX2Fuc3dlcnMpO1xuXG4gICAgd3JhcHBlciA9IHdyYXBwZXIucmVwbGFjZSgne3twb3NzaWJsZS1hbnN3ZXJzLWxpc3R9fScsIGxpc3QpO1xuXG4gICAgLy90b2dnbGUgXCJhZGQgYW5zd2Vyc1wiIGJ1dHRvblxuICAgIGlmIChpbnB1dC5wb3NzaWJsZV9hbnN3ZXJzLmxlbmd0aCA+PSBjb25zdHMuTElNSVRTLnBvc3NpYmxlX2Fuc3dlcnNfbWF4KSB7XG4gICAgICAgIC8vaXMgaXQgYSBzZWFyY2ggdHlwZT8gbGltaXQgaXMgaGlnaGVyIGZvciBzZWFyY2ggdHlwZVxuICAgICAgICBpZihpbnB1dC50eXBlID09PSBjb25zdHMuU0VBUkNIX1NJTkdMRV9UWVBFIHx8IGlucHV0LnR5cGUgPT09IGNvbnN0cy5TRUFSQ0hfTVVMVElQTEVfVFlQRSkge1xuICAgICAgICAgICAgaWYgKGlucHV0LnBvc3NpYmxlX2Fuc3dlcnMubGVuZ3RoID49IGNvbnN0cy5MSU1JVFMucG9zc2libGVfYW5zd2Vyc19tYXhfc2VhcmNoKSB7XG4gICAgICAgICAgICAgICAgd3JhcHBlciA9IHdyYXBwZXIucmVwbGFjZSgne3tkaXNhYmxlZH19JywgJ2Rpc2FibGVkJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB3cmFwcGVyID0gd3JhcHBlci5yZXBsYWNlKCd7e2Rpc2FibGVkfX0nLCAnJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB3cmFwcGVyID0gd3JhcHBlci5yZXBsYWNlKCd7e2Rpc2FibGVkfX0nLCAnZGlzYWJsZWQnKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgd3JhcHBlciA9IHdyYXBwZXIucmVwbGFjZSgne3tkaXNhYmxlZH19JywgJycpO1xuICAgIH1cblxuICAgIHJldHVybiB3cmFwcGVyO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBnZXRQb3NzaWJsZUFuc3dlcnNIVE1MO1xuIiwiJ3VzZSBzdHJpY3QnO1xudmFyIGZvcm1idWlsZGVyID0gcmVxdWlyZSgnY29uZmlnL2Zvcm1idWlsZGVyJyk7XG52YXIgY29uc3RzID0gcmVxdWlyZSgnY29uZmlnL2NvbnN0cycpO1xuXG4vL2dlbmVyYXRlIGxpc3Qgb2YgcG9zc2libGUgYW5zd2VycyBhbmQgcmV0dXJuIGh0bWxcbnZhciBnZXRQb3NzaWJsZUFuc3dlcnNMaXN0ID0gZnVuY3Rpb24gKHBvc3NpYmxlX2Fuc3dlcnMpIHtcblxuICAgIHZhciBsaXN0ID0gJyc7XG4gICAgdmFyIGxpc3RfaXRlbSA9ICcnO1xuXG4gICAgLy9nZW5lcmF0ZSBtYXJrdXAgZm9yIGZpcnN0IHBvc3NpYmxlIGFuc3dlcnMgcGFnZVxuICAgICQocG9zc2libGVfYW5zd2VycykuZWFjaChmdW5jdGlvbiAoaW5kZXgsIHBvc3NpYmxlX2Fuc3dlcikge1xuXG4gICAgICAgIGlmIChpbmRleCA9PT0gY29uc3RzLkxJTUlUUy5wb3NzaWJsZV9hbnN3ZXJzX3Blcl9wYWdlKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICBsaXN0X2l0ZW0gPSBmb3JtYnVpbGRlci5kb20ucGFydGlhbHMucG9zc2libGVfYW5zd2VyX2xpc3RfaXRlbTtcbiAgICAgICAgbGlzdF9pdGVtID0gbGlzdF9pdGVtLnJlcGxhY2UoJ3t7YW5zd2VyLXJlZn19JywgcG9zc2libGVfYW5zd2VyLmFuc3dlcl9yZWYpO1xuICAgICAgICBsaXN0X2l0ZW0gPSBsaXN0X2l0ZW0ucmVwbGFjZSgne3thbnN3ZXJ9fScsIHBvc3NpYmxlX2Fuc3dlci5hbnN3ZXIpO1xuXG4gICAgICAgIGlmIChpbmRleCA9PT0gMCAmJiBwb3NzaWJsZV9hbnN3ZXJzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgbGlzdF9pdGVtID0gbGlzdF9pdGVtLnJlcGxhY2UoJ3t7ZGlzYWJsZWR9fScsICdkaXNhYmxlZCcpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbGlzdF9pdGVtID0gbGlzdF9pdGVtLnJlcGxhY2UoJ3t7ZGlzYWJsZWR9fScsICcnKTtcbiAgICAgICAgfVxuICAgICAgICBsaXN0ICs9IGxpc3RfaXRlbTtcbiAgICB9KTtcblxuICAgIHJldHVybiBsaXN0O1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBnZXRQb3NzaWJsZUFuc3dlcnNMaXN0O1xuIiwiJ3VzZSBzdHJpY3QnO1xudmFyIGZvcm1idWlsZGVyID0gcmVxdWlyZSgnY29uZmlnL2Zvcm1idWlsZGVyJyk7XG52YXIgdXRpbHMgPSByZXF1aXJlKCdoZWxwZXJzL3V0aWxzJyk7XG52YXIgY29uc3RzID0gcmVxdWlyZSgnY29uZmlnL2NvbnN0cycpO1xuXG4vL2dlbmVyYXRlIGxpc3Qgb2YgcG9zc2libGUgYW5zd2VycyBhbmQgaW5qZWN0IGl0IGludG8gaXRzIHdyYXBwZXIsIHRoZW4gcmV0dXJuIGl0XG52YXIgZ2V0UG9zc2libGVBbnN3ZXJzUGFnZSA9IGZ1bmN0aW9uICh0aGVfaW5wdXQsIHRoZV9wYWdlKSB7XG5cbiAgICB2YXIgaW5wdXQgPSB0aGVfaW5wdXQ7XG4gICAgdmFyIGN1cnJlbnRfcGFnZSA9IHRoZV9wYWdlO1xuICAgIHZhciBsaXN0X2l0ZW0gPSAnJztcbiAgICB2YXIgbGlzdCA9ICcnO1xuICAgIHZhciBwcm9wZXJ0aWVzX3BhbmVsID0gZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlci5maW5kKCdmb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIGlucHV0LnJlZiArICdcIl0nKTtcbiAgICB2YXIgcG9zc2libGVfYW5zd2Vyc193cmFwcGVyID0gcHJvcGVydGllc19wYW5lbC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fcG9zc2libGUtYW5zd2VycyBkaXYgdWwuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fcG9zc2libGUtYW5zd2Vyc19fbGlzdCcpO1xuICAgIHZhciBmcm9tX2luZGV4ID0gKGN1cnJlbnRfcGFnZSAtIDEpICogY29uc3RzLkxJTUlUUy5wb3NzaWJsZV9hbnN3ZXJzX3Blcl9wYWdlO1xuICAgIHZhciB0b19pbmRleCA9IGN1cnJlbnRfcGFnZSAqIGNvbnN0cy5MSU1JVFMucG9zc2libGVfYW5zd2Vyc19wZXJfcGFnZTtcblxuICAgIC8vcmVtb3ZlIHBvc3NpYmxlIGFzd2VycyBmcm9tIGRvbVxuICAgIHBvc3NpYmxlX2Fuc3dlcnNfd3JhcHBlci5maW5kKCdsaScpLnJlbW92ZSgpO1xuXG4gICAgLy9nZXQgbmV4dCBwb3NzaWJsZSBhbnN3ZXJzXG4gICAgdmFyIHBvc3NpYmxlX2Fuc3dlcnMgPSAgaW5wdXQucG9zc2libGVfYW5zd2Vycy5zbGljZShmcm9tX2luZGV4LCB0b19pbmRleCk7XG5cbiAgICAkKHBvc3NpYmxlX2Fuc3dlcnMpLmVhY2goZnVuY3Rpb24gKGluZGV4LCBwb3NzaWJsZV9hbnN3ZXIpIHtcblxuICAgICAgICAvL3JlcGxhY2UgZG91YmxlIHF1b3RlcyB3aXRoIGh0bWwgZW50aXRpZXNcbiAgICAgICAgcG9zc2libGVfYW5zd2VyLmFuc3dlciA9IHBvc3NpYmxlX2Fuc3dlci5hbnN3ZXIucmVwbGFjZSgvXCIvZ2ksICcmcXVvdDsnKTtcblxuICAgICAgICBsaXN0X2l0ZW0gPSBmb3JtYnVpbGRlci5kb20ucGFydGlhbHMucG9zc2libGVfYW5zd2VyX2xpc3RfaXRlbTtcbiAgICAgICAgbGlzdF9pdGVtID0gbGlzdF9pdGVtLnJlcGxhY2UoJ3t7YW5zd2VyLXJlZn19JywgcG9zc2libGVfYW5zd2VyLmFuc3dlcl9yZWYpO1xuICAgICAgICBsaXN0X2l0ZW0gPSBsaXN0X2l0ZW0ucmVwbGFjZSgne3thbnN3ZXJ9fScsIHBvc3NpYmxlX2Fuc3dlci5hbnN3ZXIpO1xuXG4gICAgICAgIGlmIChpbmRleCA9PT0gMCAmJiBpbnB1dC5wb3NzaWJsZV9hbnN3ZXJzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgbGlzdF9pdGVtID0gbGlzdF9pdGVtLnJlcGxhY2UoJ3t7ZGlzYWJsZWR9fScsICdkaXNhYmxlZCcpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbGlzdF9pdGVtID0gbGlzdF9pdGVtLnJlcGxhY2UoJ3t7ZGlzYWJsZWR9fScsICcnKTtcbiAgICAgICAgfVxuICAgICAgICBsaXN0ICs9IGxpc3RfaXRlbTtcblxuICAgICAgICAvL2lmIHRoZSBwb3NzaWJsZSBhbnN3ZXIgaXMgaW52YWxpZCwgYWRkIGVycm9yIGluIHRoZSBkb21cbiAgICAgICAgaWYocG9zc2libGVfYW5zd2VyLmFuc3dlciA9PT0gJycpIHtcbiAgICAgICAgICAgIC8vdG9kb1xuXG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vYXBwZW5kIG5ldyBwYWdlIHRvIGRvbVxuICAgIHBvc3NpYmxlX2Fuc3dlcnNfd3JhcHBlci5oaWRlKCkuaHRtbChsaXN0KS5mYWRlSW4oY29uc3RzLkFOSU1BVElPTl9TTE9XKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gZ2V0UG9zc2libGVBbnN3ZXJzUGFnZTtcbiIsIid1c2Ugc3RyaWN0JztcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJ2NvbmZpZy9mb3JtYnVpbGRlcicpO1xudmFyIGNvbnN0cyA9IHJlcXVpcmUoJ2NvbmZpZy9jb25zdHMnKTtcblxudmFyIGdldFVuaXF1ZW5lc3NIVE1MID0gZnVuY3Rpb24gKHRoZV9pbnB1dCkge1xuXG4gICAgdmFyIGh0bWwgPSAnJztcbiAgICB2YXIgaW5wdXQgPSB0aGVfaW5wdXQ7XG4gICAgdmFyIGZvcm1faW5kZXggPSBmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXg7XG4gICAgdmFyIGN1cnJlbnRfZm9ybV9uYW1lID0gZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uLmRhdGEucHJvamVjdC5mb3Jtc1tmb3JtX2luZGV4XS5uYW1lO1xuICAgIHZhciBwYXJ0aWFscyA9IGZvcm1idWlsZGVyLmRvbS5wYXJ0aWFscztcbiAgICB2YXIgcGFyZW50X2Zvcm1fbmFtZTtcbiAgICB2YXIgaXNfdW5pcXVlbmVzc19mb3JtX2NoZWNrZWQ7XG4gICAgdmFyIGlzX3VuaXF1ZW5lc3NfaGllcmFyY2h5X2NoZWNrZWQ7XG5cbiAgICBmdW5jdGlvbiBnZXRTdGFuZGFyZFVuaXF1ZXNzTWFya3VwKG1hcmt1cCkge1xuXG4gICAgICAgIG1hcmt1cCA9IHBhcnRpYWxzLnVuaXF1ZW5lc3NfaGllcmFyY2h5X2NoZWNrYm94ZXM7XG4gICAgICAgIHBhcmVudF9mb3JtX25hbWUgPSBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0LmZvcm1zW2Zvcm1faW5kZXggLSAxXS5uYW1lO1xuICAgICAgICBtYXJrdXAgPSBtYXJrdXAucmVwbGFjZSgve3twYXJlbnQtZm9ybS1uYW1lfX0vZywgcGFyZW50X2Zvcm1fbmFtZSk7XG4gICAgICAgIG1hcmt1cCA9IG1hcmt1cC5yZXBsYWNlKCd7e2lucHV0LXJlZi11bmlxdWVuZXNzLWhpZXJhcmNoeX19JywgaW5wdXQucmVmICsgJy11bmlxdWVuZXNzLWhpZXJhcmNoeScpO1xuXG4gICAgICAgIGlzX3VuaXF1ZW5lc3NfaGllcmFyY2h5X2NoZWNrZWQgPSAoaW5wdXQudW5pcXVlbmVzcyA9PT0gY29uc3RzLlVOSVFVRVNTX0hJRVJBUkNIWSkgPyAnY2hlY2tlZCcgOiAnJztcbiAgICAgICAgbWFya3VwID0gbWFya3VwLnJlcGxhY2UoJ3t7aW5wdXQtcmVmLXVuaXF1ZW5lc3MtaGllcmFyY2h5LWNoZWNrZWR9fScsIGlzX3VuaXF1ZW5lc3NfaGllcmFyY2h5X2NoZWNrZWQpO1xuXG4gICAgICAgIHJldHVybiBtYXJrdXA7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0QnJhbmNoVW5pcXVlbmVzc01hcmt1cChtYXJrdXApIHtcbiAgICAgICAgLy9icmFuY2ggdW5pcXVlc3MgaXMgd2l0aGluIGZvciBhbGwgdGhlICd7YnJhbmNoIGhlYWRlcn0nIGVudHJpZXMgZm9yIGEgYnJhbmNoIHF1ZXN0aW9uIHdpdGhpbiBhIHNpbmdsZSBlbnRyeSAoJ2Zvcm0nKVxuICAgICAgICBtYXJrdXAgPSBwYXJ0aWFscy51bmlxdWVuZXNzX2JyYW5jaF9jaGVja2JveDtcbiAgICAgICAgbWFya3VwID0gbWFya3VwLnJlcGxhY2UoJ3t7YnJhbmNoLWhlYWRlcn19JywgZm9ybWJ1aWxkZXIuYnJhbmNoLmFjdGl2ZV9icmFuY2hfaGVhZGVyKTtcblxuICAgICAgICByZXR1cm4gbWFya3VwO1xuICAgIH1cblxuICAgIC8vYWRkIHVuaXF1ZW5lc3MgY29uc3RyYWludCBiYXNlZCBvbiBmb3JtIGhpZXJhcmNoeVxuICAgIGlmIChmb3JtX2luZGV4ID4gMCkge1xuICAgICAgICAvL2NoaWxkIGZvcm1zLCB1c2VyIGNuIHNlbGVjdCBmb3JtIG9yIGhpZXJhcmNoeSB1bmlxdWVuZXNzXG4gICAgICAgIGlmIChmb3JtYnVpbGRlci5pc19lZGl0aW5nX2JyYW5jaCkge1xuICAgICAgICAgICAgLy9pZiAoZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19ncm91cCkge1xuICAgICAgICAgICAgLy8gICAgLy9uZXN0ZWQgZ3JvdXAgZ2V0cyBzdGFuZGFyZCB1bmlxdWVuZXNzXG4gICAgICAgICAgICAvLyAgICBodG1sID0gZ2V0U3RhbmRhcmRVbmlxdWVzc01hcmt1cChodG1sKTtcbiAgICAgICAgICAgIC8vfVxuICAgICAgICAgICAgLy8gIGVsc2Uge1xuICAgICAgICAgICAgLy9icmFuY2hlcyBnZXQgaXRzIG93biB1bmlxdWVuZXNzXG4gICAgICAgICAgICBodG1sID0gZ2V0QnJhbmNoVW5pcXVlbmVzc01hcmt1cChodG1sKTtcbiAgICAgICAgICAgIC8vICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvL3N0YW5kYXJkIHVuaXF1ZW5lc3NcbiAgICAgICAgICAgIGh0bWwgPSBnZXRTdGFuZGFyZFVuaXF1ZXNzTWFya3VwKGh0bWwpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZWxzZSB7XG4gICAgICAgIC8vc3RhbmRhcmQgdW5pcXVlbmVzcywgdG9wIHBhcmVudCBmb3JtIGlucHV0c2NhbiBiZSBzZXQgdG8gZm9ybSB1bmlxdWVuZXNzIG9ubHlcbiAgICAgICAgaWYgKCFmb3JtYnVpbGRlci5pc19lZGl0aW5nX2JyYW5jaCkge1xuICAgICAgICAgICAgaHRtbCA9IHBhcnRpYWxzLnVuaXF1ZW5lc3NfZm9ybV9jaGVja2JveDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIC8vYnJhbmNoZXMgZ2V0IGl0cyBvd24gdW5pcXVlbmVzc1xuICAgICAgICAgICAgLy9pZiAoZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19ncm91cCkge1xuICAgICAgICAgICAgLy8gICAgLy9ncm91cCBnZXRzIHN0YW5kYXJkIHVuaXF1ZW5lc3NcbiAgICAgICAgICAgIC8vICAgIGh0bWwgPSBwYXJ0aWFscy51bmlxdWVuZXNzX2Zvcm1fY2hlY2tib3g7XG4gICAgICAgICAgICAvL31cbiAgICAgICAgICAgIC8vZWxzZSB7XG4gICAgICAgICAgICAvL2JyYW5jaCB1bmlxdWVzcyBpcyB3aXRoaW4gZm9yIGFsbCB0aGUgYnJhbmNoZXMgd2l0aGluIGEgc2luZ2xlIGVudHJ5ICgnZm9ybScpXG4gICAgICAgICAgICBodG1sID0gZ2V0QnJhbmNoVW5pcXVlbmVzc01hcmt1cChodG1sKTtcbiAgICAgICAgICAgIC8vIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vY29tbW9uIG1hcmt1cFxuICAgIGh0bWwgPSBodG1sLnJlcGxhY2UoJ3t7aW5wdXQtcmVmLXVuaXF1ZW5lc3MtZm9ybX19JywgaW5wdXQucmVmICsgJy11bmlxdWVuZXNzLWZvcm0nKTtcbiAgICBpc191bmlxdWVuZXNzX2Zvcm1fY2hlY2tlZCA9IChpbnB1dC51bmlxdWVuZXNzID09PSBjb25zdHMuVU5JUVVFU1NfRk9STSkgPyAnY2hlY2tlZCcgOiAnJztcbiAgICBodG1sID0gaHRtbC5yZXBsYWNlKCd7e2lucHV0LXJlZi11bmlxdWVuZXNzLWZvcm0tY2hlY2tlZH19JywgaXNfdW5pcXVlbmVzc19mb3JtX2NoZWNrZWQpO1xuICAgIGh0bWwgPSBodG1sLnJlcGxhY2UoL3t7Zm9ybS1uYW1lfX0vZywgY3VycmVudF9mb3JtX25hbWUpO1xuXG4gICAgcmV0dXJuIGh0bWw7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGdldFVuaXF1ZW5lc3NIVE1MO1xuIiwiJ3VzZSBzdHJpY3QnO1xudmFyIGNvbnN0cyA9IHJlcXVpcmUoJ2NvbmZpZy9jb25zdHMnKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoJ2hlbHBlcnMvdXRpbHMnKTtcblxudmFyIHByZXBhcmVBZHZhbmNlZElucHV0UHJvcGVydGllc0hUTUwgPSBmdW5jdGlvbiAodmlldywgaW5wdXQpIHtcblxuICAgIHZhciBodG1sID0gdmlldztcbiAgICB2YXIgcmVmID0gaW5wdXQucmVmO1xuICAgIHZhciB0eXBlID0gaW5wdXQudHlwZTtcbiAgICB2YXIgZGF0ZXRpbWVfZm9ybWF0ID0ge1xuICAgICAgICBpc19jaGVja2VkX2RhdGV0aW1lX2Zvcm1hdF8xOiAnJywvL3NldCBmaXJzdCBmb3JtYXQgYXMgZGVmYXVsdFxuICAgICAgICBpc19jaGVja2VkX2RhdGV0aW1lX2Zvcm1hdF8yOiAnJyxcbiAgICAgICAgaXNfY2hlY2tlZF9kYXRldGltZV9mb3JtYXRfMzogJycsXG4gICAgICAgIGlzX2NoZWNrZWRfZGF0ZXRpbWVfZm9ybWF0XzQ6ICcnLFxuICAgICAgICBpc19jaGVja2VkX2RhdGV0aW1lX2Zvcm1hdF81OiAnJ1xuICAgIH07XG5cbiAgICB2YXIgaXNfaW50ZWdlcl9jaGVja2VkO1xuICAgIHZhciBpc19kZWNpbWFsX2NoZWNrZWQ7XG4gICAgdmFyIGlzX3NlYXJjaF9zaW5nbGVfY2hlY2tlZDtcbiAgICB2YXIgaXNfc2VhcmNoX211bHRpcGxlX2NoZWNrZWQ7XG5cbiAgICBmdW5jdGlvbiBfcmVwbGFjZURhdGV0aW1lQWR2YW5jZWRQcm9wZXJ0aWVzKHR5cGUpIHtcblxuICAgICAgICB2YXIgaTtcbiAgICAgICAgdmFyIGlMZW5ndGggPSA2O1xuXG4gICAgICAgIC8vaWYgaXQgaXMgYSBuZXcgaW5wdXQsIHNldCBkYXRhdGltZSBmb3JtYXQgdG8gZGVmYXVsdFxuICAgICAgICBpZiAoaW5wdXQuZGF0ZXRpbWVfZm9ybWF0ID09PSBudWxsKSB7XG4gICAgICAgICAgICBpbnB1dC5kYXRldGltZV9mb3JtYXQgPSBjb25zdHNbdHlwZS50b1VwcGVyQ2FzZSgpICsgJ19GT1JNQVRfMSddO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9zZXQgZGF0ZXRpbWUgZm9ybWF0IHRvIHRoZSBvbmUgc2F2ZWRcbiAgICAgICAgZm9yIChpID0gMTsgaSA8IGlMZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgZGF0ZXRpbWVfZm9ybWF0Wydpc19jaGVja2VkX2RhdGV0aW1lX2Zvcm1hdF8nICsgaV0gPSBpbnB1dC5kYXRldGltZV9mb3JtYXQgPT09IGNvbnN0c1t0eXBlLnRvVXBwZXJDYXNlKCkgKyAnX0ZPUk1BVF8nICsgaV0gPyAnY2hlY2tlZCcgOiAnJztcbiAgICAgICAgICAgIGh0bWwgPSBodG1sLnJlcGxhY2UoJ3t7aXMtY2hlY2tlZC1kYXRldGltZS1mb3JtYXQtJyArIGkgKyAnfX0nLCBkYXRldGltZV9mb3JtYXRbJ2lzX2NoZWNrZWRfZGF0ZXRpbWVfZm9ybWF0XycgKyBpXSk7XG4gICAgICAgIH1cbiAgICAgICAgaHRtbCA9IGh0bWwucmVwbGFjZSgne3tpbnB1dC1yZWYtZGVmYXVsdC10by1jdXJyZW50fX0nLCByZWYgKyAnLWRlZmF1bHQtdG8tY3VycmVudCcpO1xuICAgICAgICBodG1sID0gaHRtbC5yZXBsYWNlKCd7e3NldC10by1jdXJyZW50LWRhdGV0aW1lfX0nLCBzZXRfdG9fY3VycmVudF9kYXRldGltZSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gX3JlcGxhY2VOdW1lcmljQWR2YW5jZWRQcm9wZXJ0aWVzKHR5cGUpIHtcblxuICAgICAgICBpc19pbnRlZ2VyX2NoZWNrZWQgPSAnY2hlY2tlZCc7XG4gICAgICAgIGlzX2RlY2ltYWxfY2hlY2tlZCA9ICcnO1xuXG4gICAgICAgIGlmICh0eXBlID09PSBjb25zdHMuREVDSU1BTF9UWVBFKSB7XG4gICAgICAgICAgICBpc19pbnRlZ2VyX2NoZWNrZWQgPSAnJztcbiAgICAgICAgICAgIGlzX2RlY2ltYWxfY2hlY2tlZCA9ICdjaGVja2VkJztcbiAgICAgICAgfVxuXG4gICAgICAgIGh0bWwgPSBodG1sLnJlcGxhY2UoJ3t7aXMtaW50ZWdlci1jaGVja2VkfX0nLCBpc19pbnRlZ2VyX2NoZWNrZWQpO1xuICAgICAgICBodG1sID0gaHRtbC5yZXBsYWNlKCd7e2lzLWRlY2ltYWwtY2hlY2tlZH19JywgaXNfZGVjaW1hbF9jaGVja2VkKTtcbiAgICAgICAgaHRtbCA9IGh0bWwucmVwbGFjZSgne3tpbnB1dC1yZWYtbWluLXZhbHVlfX0nLCBpbnB1dC5taW4pO1xuICAgICAgICBodG1sID0gaHRtbC5yZXBsYWNlKCd7e2lucHV0LXJlZi1tYXgtdmFsdWV9fScsIGlucHV0Lm1heCk7XG4gICAgICAgIGh0bWwgPSBodG1sLnJlcGxhY2UoL3t7aW5wdXQtcmVmLWludGVnZXJ9fS9nLCByZWYgKyAnLWludGVnZXInKTtcbiAgICAgICAgaHRtbCA9IGh0bWwucmVwbGFjZSgve3tpbnB1dC1yZWYtZGVjaW1hbH19L2csIHJlZiArICctZGVjaW1hbCcpO1xuICAgICAgICBodG1sID0gaHRtbC5yZXBsYWNlKC97e2lucHV0LXJlZi1taW59fS9nLCByZWYgKyAnLW1pbicpO1xuICAgICAgICBodG1sID0gaHRtbC5yZXBsYWNlKC97e2lucHV0LXJlZi1tYXh9fS9nLCByZWYgKyAnLW1heCcpO1xuXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gX3JlcGxhY2VTZWFyY2hBZHZhbmNlZFByb3BlcnRpZXModHlwZSkge1xuXG4gICAgICAgIGlzX3NlYXJjaF9zaW5nbGVfY2hlY2tlZCA9ICdjaGVja2VkJztcbiAgICAgICAgaXNfc2VhcmNoX211bHRpcGxlX2NoZWNrZWQgPSAnJztcblxuICAgICAgICBpZiAodHlwZSA9PT0gY29uc3RzLlNFQVJDSF9NVUxUSVBMRV9UWVBFKSB7XG4gICAgICAgICAgICBpc19zZWFyY2hfc2luZ2xlX2NoZWNrZWQgPSAnJztcbiAgICAgICAgICAgIGlzX3NlYXJjaF9tdWx0aXBsZV9jaGVja2VkID0gJ2NoZWNrZWQnO1xuICAgICAgICB9XG5cbiAgICAgICAgaHRtbCA9IGh0bWwucmVwbGFjZSgne3tpcy1zZWFyY2hzaW5nbGUtY2hlY2tlZH19JywgaXNfc2VhcmNoX3NpbmdsZV9jaGVja2VkKTtcbiAgICAgICAgaHRtbCA9IGh0bWwucmVwbGFjZSgne3tpcy1zZWFyY2htdWx0aXBsZS1jaGVja2VkfX0nLCBpc19zZWFyY2hfbXVsdGlwbGVfY2hlY2tlZCk7XG5cblxuICAgIH1cblxuICAgIGZ1bmN0aW9uIF9nZXRJbml0aWFsQW5zd2VySFRNTChpbnB1dCwgdGhlX2h0bWwpIHtcblxuICAgICAgICB2YXIgaHRtbCA9IHRoZV9odG1sO1xuICAgICAgICB2YXIgYW5zd2VyX2xhYmVsID0gJyc7XG5cbiAgICAgICAgaHRtbCA9IGh0bWwucmVwbGFjZSgve3tpbnB1dC1yZWYtZGVmYXVsdH19L2csIGlucHV0LnJlZiArICctZGVmYXVsdCcpO1xuXG4gICAgICAgIGlmIChpbnB1dC5kZWZhdWx0ID09PSAnJyB8fCBpbnB1dC5kZWZhdWx0ID09PSBudWxsKSB7XG4gICAgICAgICAgICAvL25vLCBzZXQgJ25vbmUnXG4gICAgICAgICAgICBodG1sID0gaHRtbC5yZXBsYWNlKC97e3NlbGVjdGVkfX0vZywgJ3NlbGVjdGVkJyk7XG4gICAgICAgICAgICBodG1sID0gaHRtbC5yZXBsYWNlKC97e2luaXRpYWwtYW5zd2VyfX0vZywgJycpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuXG4gICAgICAgICAgICAvL2dldCBwb3NzaWJsZSBhbnN3ZXIgbGFiZWxcbiAgICAgICAgICAgIGFuc3dlcl9sYWJlbCA9IHV0aWxzLmdldFBvc3NpYmxlQW5zd2VyTGFiZWwoaW5wdXQpO1xuXG4gICAgICAgICAgICBodG1sID0gaHRtbC5yZXBsYWNlKC97e3NlbGVjdGVkfX0vZywgJycpO1xuICAgICAgICAgICAgaHRtbCA9IGh0bWwucmVwbGFjZSgve3tpbml0aWFsLWFuc3dlcn19L2csICc8b3B0aW9uIHZhbHVlPVwiJyArIGlucHV0LmRlZmF1bHQgKyAnXCIgIHNlbGVjdGVkID4nICsgYW5zd2VyX2xhYmVsICsgJzwvb3B0aW9uPicpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBodG1sO1xuICAgIH1cblxuICAgIHZhciBzZXRfdG9fY3VycmVudF9kYXRldGltZSA9IChpbnB1dC5zZXRfdG9fY3VycmVudF9kYXRldGltZSkgPyAnY2hlY2tlZCcgOiAnJztcblxuICAgIHN3aXRjaCAodHlwZSkge1xuXG4gICAgICAgIGNhc2UgY29uc3RzLkRST1BET1dOX1RZUEU6XG4gICAgICAgICAgICAvL3NldCBpbml0aWFsIGFuc3dlclxuICAgICAgICAgICAgaHRtbCA9IF9nZXRJbml0aWFsQW5zd2VySFRNTChpbnB1dCwgaHRtbCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBjb25zdHMuUkFESU9fVFlQRTpcbiAgICAgICAgICAgIC8vc2V0IGluaXRpYWwgYW5zd2VyXG4gICAgICAgICAgICBodG1sID0gX2dldEluaXRpYWxBbnN3ZXJIVE1MKGlucHV0LCBodG1sKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIGNvbnN0cy5DSEVDS0JPWF9UWVBFOlxuICAgICAgICAgICAgLy9zZXQgaW5pdGlhbCBhbnN3ZXJcbiAgICAgICAgICAgIGh0bWwgPSBfZ2V0SW5pdGlhbEFuc3dlckhUTUwoaW5wdXQsIGh0bWwpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgY29uc3RzLklOVEVHRVJfVFlQRTpcbiAgICAgICAgICAgIGh0bWwgPSB0aGlzLnJlcGxhY2VDb21tb25BZHZhbmNlZFByb3BlcnRpZXMoaHRtbCwgaW5wdXQpO1xuICAgICAgICAgICAgX3JlcGxhY2VOdW1lcmljQWR2YW5jZWRQcm9wZXJ0aWVzKHR5cGUpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgY29uc3RzLkRFQ0lNQUxfVFlQRTpcbiAgICAgICAgICAgIGh0bWwgPSB0aGlzLnJlcGxhY2VDb21tb25BZHZhbmNlZFByb3BlcnRpZXMoaHRtbCwgaW5wdXQpO1xuICAgICAgICAgICAgX3JlcGxhY2VOdW1lcmljQWR2YW5jZWRQcm9wZXJ0aWVzKHR5cGUpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgY29uc3RzLkRBVEVfVFlQRTpcbiAgICAgICAgICAgIF9yZXBsYWNlRGF0ZXRpbWVBZHZhbmNlZFByb3BlcnRpZXMoY29uc3RzLkRBVEVfVFlQRSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBjb25zdHMuVElNRV9UWVBFOlxuICAgICAgICAgICAgX3JlcGxhY2VEYXRldGltZUFkdmFuY2VkUHJvcGVydGllcyhjb25zdHMuVElNRV9UWVBFKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIGNvbnN0cy5TRUFSQ0hfU0lOR0xFX1RZUEU6XG4gICAgICAgICAgICBfcmVwbGFjZVNlYXJjaEFkdmFuY2VkUHJvcGVydGllcyhjb25zdHMuU0VBUkNIX1NJTkdMRV9UWVBFKTtcbiAgICAgICAgICAgIC8vc2V0IGluaXRpYWwgYW5zd2VyXG4gICAgICAgICAgICBodG1sID0gX2dldEluaXRpYWxBbnN3ZXJIVE1MKGlucHV0LCBodG1sKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIGNvbnN0cy5TRUFSQ0hfTVVMVElQTEVfVFlQRTpcbiAgICAgICAgICAgIF9yZXBsYWNlU2VhcmNoQWR2YW5jZWRQcm9wZXJ0aWVzKGNvbnN0cy5TRUFSQ0hfTVVMVElQTEVfVFlQRSk7XG4gICAgICAgICAgICAvL3NldCBpbml0aWFsIGFuc3dlclxuICAgICAgICAgICAgaHRtbCA9IF9nZXRJbml0aWFsQW5zd2VySFRNTChpbnB1dCwgaHRtbCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIGh0bWwgPSB0aGlzLnJlcGxhY2VDb21tb25BZHZhbmNlZFByb3BlcnRpZXMoaHRtbCwgaW5wdXQpO1xuXG4gICAgfVxuICAgIHJldHVybiBodG1sO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBwcmVwYXJlQWR2YW5jZWRJbnB1dFByb3BlcnRpZXNIVE1MO1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgcmVwbGFjZUNvbW1vbkFkdmFuY2VkUHJvcGVydGllcyA9IGZ1bmN0aW9uICh0aGVfbWFya3VwLCB0aGVfaW5wdXQpIHtcblxuICAgIHZhciBodG1sID0gdGhlX21hcmt1cDtcbiAgICB2YXIgaW5wdXQgPSB0aGVfaW5wdXQ7XG5cbiAgICB2YXIgcmVwbGFjZW1lbnRzID0gW1xuICAgICAgICB7XG4gICAgICAgICAgICB0b19iZV9yZXBsYWNlZDogL3t7aW5wdXQtcmVmLWRlZmF1bHR9fS9nLFxuICAgICAgICAgICAgd2l0aF90aGlzOiBpbnB1dC5yZWYgKyAnLWRlZmF1bHQnXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRvX2JlX3JlcGxhY2VkOiAve3tpbnB1dC1yZWYtcmVnZXh9fS9nLFxuICAgICAgICAgICAgd2l0aF90aGlzOiBpbnB1dC5yZWYgKyAnLXJlZ2V4J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICB0b19iZV9yZXBsYWNlZDogL3t7aW5wdXQtcmVmLWRvdWJsZS1lbnRyeX19L2csXG4gICAgICAgICAgICB3aXRoX3RoaXM6IGlucHV0LnJlZiArICctZG91YmxlLWVudHJ5J1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICB0b19iZV9yZXBsYWNlZDogJ3t7aW5wdXQtcmVmLWRlZmF1bHQtdmFsdWV9fScsXG4gICAgICAgICAgICB3aXRoX3RoaXM6IChpbnB1dC5kZWZhdWx0ID09PSBudWxsKSA/ICcnIDogaW5wdXQuZGVmYXVsdFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICB0b19iZV9yZXBsYWNlZDogJ3t7aW5wdXQtcmVmLXJlZ2V4LXZhbHVlfX0nLFxuICAgICAgICAgICAgd2l0aF90aGlzOiAoaW5wdXQucmVnZXggPT09IG51bGwpID8gJycgOiBpbnB1dC5yZWdleFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICB0b19iZV9yZXBsYWNlZDogJ3t7aW5wdXQtcmVmLWRvdWJsZS1lbnRyeS1jaGVja2VkfX0nLFxuICAgICAgICAgICAgd2l0aF90aGlzOiBpbnB1dC52ZXJpZnkgPyAnY2hlY2tlZCcgOiAnJ1xuICAgICAgICB9XG4gICAgXTtcblxuICAgIC8vcmVwbGFjZSBwbGFjZWhvbGRlciB3aXRoIHZhbHVlcyBmcm9tIGlucHV0XG4gICAgJChyZXBsYWNlbWVudHMpLmVhY2goZnVuY3Rpb24gKGluZGV4LCByZXBsYWNlbWVudCkge1xuICAgICAgICBodG1sID0gaHRtbC5yZXBsYWNlKHJlcGxhY2VtZW50LnRvX2JlX3JlcGxhY2VkLCByZXBsYWNlbWVudC53aXRoX3RoaXMpO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIGh0bWw7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IHJlcGxhY2VDb21tb25BZHZhbmNlZFByb3BlcnRpZXM7XG5cbiIsIid1c2Ugc3RyaWN0JztcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJ2NvbmZpZy9mb3JtYnVpbGRlcicpO1xudmFyIG1lc3NhZ2VzID0gcmVxdWlyZSgnY29uZmlnL21lc3NhZ2VzJyk7XG52YXIgdmFsaWRhdGlvbiA9IHJlcXVpcmUoJ2FjdGlvbnMvdmFsaWRhdGlvbicpO1xudmFyIHVpID0gcmVxdWlyZSgnaGVscGVycy91aScpO1xudmFyIHV0aWxzID0gcmVxdWlyZSgnaGVscGVycy91dGlscycpO1xudmFyIGNvbnN0cyA9IHJlcXVpcmUoJ2NvbmZpZy9jb25zdHMnKTtcbnZhciB0ZW1wbGF0ZSA9IHJlcXVpcmUoJ3RlbXBsYXRlJyk7XG52YXIgdG9hc3QgPSByZXF1aXJlKCdjb25maWcvdG9hc3QnKTtcbnZhciBwb3NzaWJsZUFuc3dlcnNTb3J0YWJsZSA9IHJlcXVpcmUoJ3VpLWhhbmRsZXJzL3Bvc3NpYmxlLWFuc3dlcnMtc29ydGFibGUnKTtcblxudmFyIGJyYW5jaF9zb3J0YWJsZSA9IGZ1bmN0aW9uICgpIHtcblxuICAgIHZhciBicmFuY2hfaW5wdXQ7XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBjdXJzb3I6ICdtb3ZlJyxcbiAgICAgICAgaXRlbXM6ICcuaW5wdXQnLFxuICAgICAgICByZXZlcnQ6IDEwMCxcbiAgICAgICAgLy9heGlzOiAneScsLy8gaXQgY2F1c2VzIHRoZSBwbGFjZWhvbGRlciB0byBiZSBhbHdheXMgYWN0aXZlXG4gICAgICAgIGNvbnRhaW5tZW50OiAncGFyZW50JyxcbiAgICAgICAgdG9sZXJhbmNlOiAncG9pbnRlcicsXG4gICAgICAgIC8vIGZvcmNlUGxhY2Vob2xkZXJTaXplOiB0cnVlLFxuICAgICAgICBwbGFjZWhvbGRlcjogJ2lucHV0LWNvbGxlY3Rpb24tZHJvcC1wbGFjZWhvbGRlcicsXG5cbiAgICAgICAgLy90cmlnZ2VyZWQgd2hlbiBhIG5ldyBpbnB1dCBpcyBkcm9wcGVkIG92ZXIgdGhlIHNvcnRhYmxlXG4gICAgICAgIHJlY2VpdmU6IGZ1bmN0aW9uIChlLCBqcXVlcnlfdWkpIHtcblxuICAgICAgICAgICAgdmFyIGZvcm1faW5kZXggPSBmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXg7XG4gICAgICAgICAgICB2YXIgcHJldmlvdXNfYnJhbmNoX2lucHV0X3JlZiA9IGZvcm1idWlsZGVyLmJyYW5jaC5jdXJyZW50X2lucHV0X3JlZjtcbiAgICAgICAgICAgIHZhciBjdXJyZW50X2VsZW1lbnQ7XG4gICAgICAgICAgICB2YXIgYnJhbmNoX2lucHV0cyA9IHV0aWxzLmdldElucHV0T2JqZWN0QnlSZWYoZm9ybWJ1aWxkZXIuY3VycmVudF9pbnB1dF9yZWYpLmJyYW5jaDtcbiAgICAgICAgICAgIHZhciBicmFuY2hfaW5wdXRfcmVmID0gdXRpbHMuZ2VuZXJhdGVCcmFuY2hHcm91cElucHV0UmVmKGZvcm1idWlsZGVyLmN1cnJlbnRfaW5wdXRfcmVmKTtcbiAgICAgICAgICAgIHZhciBicmFuY2hfaW5wdXRfaW5kZXggPSBicmFuY2hfaW5wdXRzLmxlbmd0aDtcbiAgICAgICAgICAgIHZhciBicmFuY2hfaW5wdXRfdHlwZSA9IGpxdWVyeV91aS5pdGVtLmF0dHIoJ2RhdGEtdHlwZScpO1xuICAgICAgICAgICAgdmFyIGlucHV0X2ZhY3RvcnkgPSByZXF1aXJlKCdmYWN0b3J5L2lucHV0LWZhY3RvcnknKTtcblxuICAgICAgICAgICAgLy9kbyBub3QgY29uc2lkZXIgYnJhbmNoIGlucHV0cyB3aXRoaW4gYSBicmFuY2hcbiAgICAgICAgICAgIGlmIChicmFuY2hfaW5wdXRfdHlwZSA9PT0gY29uc3RzLkJSQU5DSF9UWVBFKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG5cbiAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5icmFuY2guY3VycmVudF9pbnB1dF9yZWYgPSBicmFuY2hfaW5wdXRfcmVmO1xuXG4gICAgICAgICAgICAgICAgLy92YWxpZGF0ZSBwcmV2aW91cyBpbnB1dCAoaWYgYW55KSB0byBzaG93IGVtYmVkZGVkIGVycm9ycyAoaW4gY2FzZSB0aGUgc2VyIGRpZCBub3QgcHJlc3MgdmFsaWRhdGUgYnV0dG9uKVxuICAgICAgICAgICAgICAgIC8vdG9kbyBpcyB0aGlzIGFuIG92ZXJraWxsP1xuICAgICAgICAgICAgICAgIGlmIChwcmV2aW91c19icmFuY2hfaW5wdXRfcmVmKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbGlkYXRpb24ucGVyZm9ybVZhbGlkYXRpb24odXRpbHMuZ2V0QnJhbmNoSW5wdXRPYmplY3RCeVJlZihwcmV2aW91c19icmFuY2hfaW5wdXRfcmVmKSwgZmFsc2UpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAvLyAgY29uc29sZS5sb2coJ2JyYW5jaCBzb3J0YWJsZSByZWNlaXZlJyk7XG5cbiAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5icmFuY2guY29sbGVjdGlvbl9pc19iZWluZ19zb3J0ZWQgPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgIC8vZ2VuZXJhdGUgaW5wdXQgb2JqZWN0IGJhc2VkIG9uIHR5cGUgYW5kIHNldCBpbmRleCBpbmNyZW1lbnRhbGx5XG4gICAgICAgICAgICAgICAgYnJhbmNoX2lucHV0ID0gaW5wdXRfZmFjdG9yeS5jcmVhdGVJbnB1dChicmFuY2hfaW5wdXRfdHlwZSwgYnJhbmNoX2lucHV0X3JlZik7XG4gICAgICAgICAgICAgICAgLy9mb3JtYnVpbGRlci5jdXJyZW50X2lucHV0X3JlZiA9IGlucHV0LnJlZjtcbiAgICAgICAgICAgICAvLyAgIGNvbnNvbGUubG9nKGJyYW5jaF9pbnB1dCk7XG5cbiAgICAgICAgICAgICAgICAvL2Rpc2FibGUgY3VycmVudCBhY3RpdmUgZWxlbWVudFxuICAgICAgICAgICAgICAgIGN1cnJlbnRfZWxlbWVudCA9IGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbl9zb3J0YWJsZS5maW5kKCcuYWN0aXZlJyk7XG4gICAgICAgICAgICAgICAgY3VycmVudF9lbGVtZW50LnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcblxuICAgICAgICAgICAgICAgIC8vYWRkIGlucHV0IHRvIGNvbGxlY3Rpb24gYXMgdGhlIGxhc3Qgb25lXG4gICAgICAgICAgICAgICAgYnJhbmNoX2lucHV0cy5wdXNoKGJyYW5jaF9pbnB1dCk7XG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhicmFuY2hfaW5wdXRzKTtcbiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbi5kYXRhLnByb2plY3QuZm9ybXNbZm9ybV9pbmRleF0uaW5wdXRzKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy9kaXNhYmxlIHNhdmUgcHJvamVjdCBidXR0b24gYXMgYnkgZGVmYXVsdCBhbiBpbnB1dCBpcyBpbnZhbGlkIHdoZW4gaXQgaXMgY3JlYXRlZFxuICAgICAgICAgICAgdWkubmF2YmFyLnRvZ2dsZVNhdmVQcm9qZWN0QnRuKGNvbnN0cy5CVE5fRElTQUJMRUQpO1xuXG4gICAgICAgICAgICAvL3NldCBmb3JtIHRhYiBhcyBpbnZhbGlkLCBhcyB0aGUgbmV3IGlucHV0IHdpbGwgYmUgaW52YWxpZCBieSBkZWZhdWx0XG4gICAgICAgICAgICB1aS5mb3Jtc190YWJzLnNob3dGb3JtSW52YWxpZEljb24oZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4KTtcbiAgICAgICAgfSxcbiAgICAgICAgc3RvcDogZnVuY3Rpb24gKGUsIGpxdWVyeV91aSkge1xuXG4gICAgICAgICAgICB2YXIgdW5kbyA9IHJlcXVpcmUoJ2FjdGlvbnMvdW5kbycpO1xuICAgICAgICAgICAgdmFyIGZvcm1faW5kZXggPSBmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXg7XG4gICAgICAgICAgICB2YXIgYnJhbmNoX2lucHV0X3JlZiA9IGZvcm1idWlsZGVyLmJyYW5jaC5jdXJyZW50X2lucHV0X3JlZjtcbiAgICAgICAgICAgIHZhciBvd25lcl9pbnB1dF9yZWYgPSBmb3JtYnVpbGRlci5jdXJyZW50X2lucHV0X3JlZjtcbiAgICAgICAgICAgIHZhciBvd25lcl9pbnB1dF9pbmRleCA9IHV0aWxzLmdldElucHV0Q3VycmVudEluZGV4QnlSZWYob3duZXJfaW5wdXRfcmVmKTtcbiAgICAgICAgICAgIHZhciBpbnB1dHMgPSBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0LmZvcm1zW2Zvcm1faW5kZXhdLmlucHV0cztcbiAgICAgICAgICAgIHZhciBicmFuY2hfaW5wdXRzID0gaW5wdXRzW293bmVyX2lucHV0X2luZGV4XS5icmFuY2g7XG4gICAgICAgICAgICB2YXIgcGxhY2Vob2xkZXJfdGV4dCA9IG1lc3NhZ2VzLmVycm9yLk5PX1FVRVNUSU9OX1RFWFRfWUVUO1xuICAgICAgICAgICAgdmFyIGlucHV0X3R5cGUgPSBqcXVlcnlfdWkuaXRlbS5hdHRyKCdkYXRhLXR5cGUnKTtcbiAgICAgICAgICAgIHZhciBhY3RpdmVfYnJhbmNoO1xuICAgICAgICAgICAgdmFyIHByb3BlcnRpZXNfcGFuZWxfaHRtbDtcblxuICAgICAgICAgICAgLy9kaXNhYmxlIGRyYWdnYWJsZSBpZiB3ZSBoaXQgdGhlIG1heCBhbW91bnQgb2YgaW5wdXRzIGFsbG93ZWRcbiAgICAgICAgICAgIGlmICh1dGlscy5nZXRJbnB1dHNUb3RhbChpbnB1dHMpID49IGNvbnN0cy5JTlBVVFNfTUFYX0FMTE9XRUQpIHtcbiAgICAgICAgICAgICAgICB1aS5pbnB1dF90b29scy5kaXNhYmxlKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vcmVqZWN0IGJyYW5jaCBpbnB1dHMgaGVyZVxuICAgICAgICAgICAgaWYgKGlucHV0X3R5cGUgPT09IGNvbnN0cy5CUkFOQ0hfVFlQRSkge1xuICAgICAgICAgICAgICAgIGpxdWVyeV91aS5pdGVtLnJlbW92ZSgpO1xuXG4gICAgICAgICAgICAgICAgLy9pZiBicmFuY2ggaW5wdXRzIGxlbmd0aCBpcyB6ZXJvLCBzaG93IGhlbHAgdGV4dCBwbGFjZWhvbGRlclxuICAgICAgICAgICAgICAgIC8vdG9kb1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAvL2NvdW50IHNlYXJjaCBpbnB1dHNcbiAgICAgICAgICAgICAgICBpZihpbnB1dF90eXBlID09PSBjb25zdHMuU0VBUkNIX1NJTkdMRV9UWVBFICYmICFmb3JtYnVpbGRlci5icmFuY2guY29sbGVjdGlvbl9pc19iZWluZ19zb3J0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9pZiB0aGUgbGltaXQgaXMgcmVhY2hlZCwgaGlkZSBzZWFyY2ggZnJvbSBpbnB1dCB0b29sc1xuICAgICAgICAgICAgICAgICAgICBpZiAodXRpbHMuZ2V0U2VhcmNoSW5wdXRzVG90YWwoKSA+PSBjb25zdHMuTElNSVRTLnNlYXJjaF9pbnB1dHNfbWF4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB1aS5pbnB1dF90b29scy5oaWRlU2VhcmNoSW5wdXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdzZWFyY2ggbGltaXQgcmVhY2hlZCcpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvL3Nob3cgd2FybmluZyB0byB1c2VyXG4gICAgICAgICAgICAgICAgICAgICAgICB0b2FzdC5zaG93V2FybmluZyhtZXNzYWdlcy53YXJuaW5nLlNFQVJDSF9JTlBVVFNfTElNSVRfUkVBQ0hFRCArICcoJyArIGNvbnN0cy5MSU1JVFMuc2VhcmNoX2lucHV0c19tYXggKyAnKScpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyAgICBjb25zb2xlLmxvZygnc29ydGFibGUgc3RvcCcpO1xuICAgICAgICAgICAgICAgIGpxdWVyeV91aS5pdGVtLnJlbW92ZUF0dHIoJ3N0eWxlJyk7IC8vIHVuZG8gc3R5bGluZyBzZXQgYnkganF1ZXJ5VUkgKGh0dHA6Ly9nb28uZ2wvRUt6OHRDKVxuXG4gICAgICAgICAgICAgICAgLy9nZXQgdGhlIGluZGV4IHdoZXJlIHRoZSBpbnB1dCB3YXMgZHJvcHBlZCAoc2tpcCB3aGVuIGxpc3QgaXMgZW1wdHkpXG4gICAgICAgICAgICAgICAgLy9uYiB0aGUgLTIgaXMgdG8gcmVtb3ZlIHRoZSBlbGVtZW50IHdoaWNoIGFyZSBubyBpbnB1dCAod2FybmluZyBtZXNzYWdlcylcbiAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5icmFuY2gudG9faW5kZXggPSBqcXVlcnlfdWkuaXRlbS5pbmRleCgpID09PSAwID8ganF1ZXJ5X3VpLml0ZW0uaW5kZXgoKSA6IGpxdWVyeV91aS5pdGVtLmluZGV4KCkgLSAyO1xuXG4gICAgICAgICAgICAgICAgLy9oaWRlIG1lc3NhZ2UgYWJvdXQgbm8gaW5wdXQgc2VsZWN0ZWQsIGFzIGRyb3BwZWQgaW5wdXQgZ2V0cyBmb2N1c1xuICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX25vX2lucHV0X3NlbGVjdGVkLmhpZGUoKTtcblxuICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgIGlmIHRoZSB1c2VyIGlzIGRyYWdnaW5nIGEgbmV3IGlucHV0IG92ZXIsIGl0IHdhcyBhZGRlZCBhcyB0aGUgbGFzdCBlbGVtZW50IG9mIHRoZSBhcnJheVxuICAgICAgICAgICAgICAgICBvdGhlcndpc2UgdGhlIGN1cnJlbnQgaW5wdXQgcG9zaXRpb24gaXMgc2V0IGluIHRoZSBzdGFydCBldmVudFxuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGlmICghZm9ybWJ1aWxkZXIuYnJhbmNoLmNvbGxlY3Rpb25faXNfYmVpbmdfc29ydGVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgLy9vdmVycmlkZSAnZnJvbV9pbmRleCcgYXMgd2UgYXJlIGRyb3BwaW5nIGEgbmV3IGVsZW1lbnQgKG1pbiB2YWx1ZSBmb3IgbGVuZ3RoIGlzIDEsIGFzIHdlIGFkZCB0aGUgaW5wdXQgaW4gdGhlIGByZWNlaXZlYCBmdW5jdGlvbilcbiAgICAgICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIuYnJhbmNoLmZyb21faW5kZXggPSBicmFuY2hfaW5wdXRzLmxlbmd0aCAtIDE7XG5cbiAgICAgICAgICAgICAgICAgICAgLy9tb3ZlIGlucHV0cyB0byBrZWVwIHRoZSBhcnJheSBzZXF1ZW5jZSBsaWtlIHRoZSBpbnB1dCBzZXF1ZW5jZSBvbiBzY3JlZW5cbiAgICAgICAgICAgICAgICAgICAgYnJhbmNoX2lucHV0cy5tb3ZlKGZvcm1idWlsZGVyLmJyYW5jaC5mcm9tX2luZGV4LCBmb3JtYnVpbGRlci5icmFuY2gudG9faW5kZXgpO1xuICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKGJyYW5jaF9pbnB1dHMpO1xuICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKGJyYW5jaF9pbnB1dHMubGVuZ3RoKTtcblxuICAgICAgICAgICAgICAgICAgICBqcXVlcnlfdWkuaXRlbS5hZGRDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgICAgICAgICAgICAgIGpxdWVyeV91aS5pdGVtLmF0dHIoJ2RhdGEtaW5wdXQtcmVmJywgYnJhbmNoX2lucHV0X3JlZik7XG5cbiAgICAgICAgICAgICAgICAgICAgLy9hcHBlbmQgaW5wdXQgaWQgYW5kIGEgd2FybmluZyBpY29uLCBhcyBieSBkZWZhdWx0IHRoZSBxdWVzdGlvbiBkb2VzIG5vdCBoYXZlIGFueSB0ZXh0XG4gICAgICAgICAgICAgICAgICAgIGpxdWVyeV91aS5pdGVtLmZpbmQoJy5pbnB1dC1pbm5lcicpLmFwcGVuZCh1aS5pbnB1dHNfY29sbGVjdGlvbi5nZXRJbnB1dFN0YXRlSWNvbnNIVE1MKCkpO1xuICAgICAgICAgICAgICAgICAgICBqcXVlcnlfdWkuaXRlbS5maW5kKCdzcGFuLnF1ZXN0aW9uLXByZXZpZXcnKS50ZXh0KHBsYWNlaG9sZGVyX3RleHQpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vc2V0IG93bmVyIGJyYW5jaCBhcyBpbnZhbGlkIGFzIHdlIGFyZSBhZGRpbmcgYW4gaW52YWxpZCBpbnB1dFxuICAgICAgICAgICAgICAgICAgICBhY3RpdmVfYnJhbmNoID0gdXRpbHMuZ2V0SW5wdXRPYmplY3RCeVJlZihmb3JtYnVpbGRlci5icmFuY2guYWN0aXZlX2JyYW5jaF9yZWYpO1xuICAgICAgICAgICAgICAgICAgICB1aS5pbnB1dHNfY29sbGVjdGlvbi5zaG93SW5wdXRJbnZhbGlkSWNvbihhY3RpdmVfYnJhbmNoLnJlZik7XG5cbiAgICAgICAgICAgICAgICAgICAgLy9zaG93IGlucHV0IHByb3BlcnRpZXMgZm9yIHRoZSBuZXcgZHJvcHBlZCBpbnB1dFxuICAgICAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllcy5maW5kKCcucGFuZWwtYm9keSBmb3JtJykuaGlkZSgpO1xuICAgICAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllcy5maW5kKCcucGFuZWwtdGl0bGUgc3BhbicpLnRleHQocGxhY2Vob2xkZXJfdGV4dCk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy9jcmVhdGUgcHJvcGVydGllcyBwYW5lbCBpbiByaWdodCBzaWRlYmFyIGZvciB0aGlzIGlucHV0IChjb21tb24gcHJvcGVydGllcylcbiAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllc19wYW5lbF9odG1sID0gdGVtcGxhdGUuZ2V0SW5wdXRQcm9wZXJ0aWVzUGFuZWxIVE1MKGJyYW5jaF9pbnB1dCk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy9hcHBlbmQgaW5wdXQgYW5kIHNob3cgaXQgYXMgaXQgZ2V0cyBzZWxlY3RlZCBieSBkZWZhdWx0XG4gICAgICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXIuaGlkZSgpO1xuICAgICAgICAgICAgICAgICAgICAkKHByb3BlcnRpZXNfcGFuZWxfaHRtbCkucmVtb3ZlQ2xhc3MoJ2hpZGRlbicpLmFwcGVuZFRvKGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXIpO1xuICAgICAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyLmZhZGVJbihjb25zdHMuQU5JTUFUSU9OX0ZBU1QpO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgLy9zaG93IGFjdGlvbiBidXR0b25zIGZvciBpbnB1dFxuICAgICAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc19idXR0b25zLmZhZGVJbihjb25zdHMuQU5JTUFUSU9OX0ZBU1QpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vZm9yIG5lc3RlZCBncm91cCwgZW5hYmxlIGtleXVwIHRvIGNoZWNrIGZvciB2YWxpZGF0aW9uIG9mIGhlYWRlciB0ZXh0XG4gICAgICAgICAgICAgICAgICAgIC8vdHJpZ2dlcmVkIHdoZW4gdXNlcnMgdHlwZSBpbiB0aGUgaGVhZGVyIGlucHV0IGZpZWxkIGZvciBuZXN0ZWQgZ3JvdXBcbiAgICAgICAgICAgICAgICAgICAgLy90b2RvIGNoZWNrIHRoaXNcbiAgICAgICAgICAgICAgICAgICAgaWYgKGJyYW5jaF9pbnB1dC50eXBlID09PSBjb25zdHMuR1JPVVBfVFlQRSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9mb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllcy5vZmYoJ2tleXVwJykub24oJ2tleXVwJywgJ2lucHV0JywgaW5wdXRfcHJvcGVydGllc19rZXl1cF9jYWxsYmFjayk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL2Zvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzLm9mZigna2V5dXAnKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8vZW5hYmxlIHNvcnRhYmxlIG9uIGN1cnJlbnQgaW5wdXQgKG9ubHkgd2hlbiBmaXJzdCBjcmVhdGVkKVxuICAgICAgICAgICAgICAgICAgICBwb3NzaWJsZUFuc3dlcnNTb3J0YWJsZShicmFuY2hfaW5wdXQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcblxuICAgICAgICAgICAgICAgICAgICAvLydmcm9tX2luZGV4IGlzIHNldCBpbiBzdGFydCBldmVudCBvZiBzb3J0YWJsZSdcbiAgICAgICAgICAgICAgICAgICAgLy9tb3ZlIGJyYW5jaCBpbnB1dHMgdG8ga2VlcCB0aGUgYXJyYXkgc2VxdWVuY2UgbGlrZSB0aGUgaW5wdXQgc2VxdWVuY2Ugb24gc2NyZWVuXG4gICAgICAgICAgICAgICAgICAgIGJyYW5jaF9pbnB1dHMubW92ZShmb3JtYnVpbGRlci5icmFuY2guZnJvbV9pbmRleCwgZm9ybWJ1aWxkZXIuYnJhbmNoLnRvX2luZGV4KTtcbiAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhicmFuY2hfaW5wdXRzKTtcblxuICAgICAgICAgICAgICAgICAgICAvL3J1biB0aGUgdmFsaWRhdGlvbiBvbiBhbGwgYnJhbmNoIGp1bXBzLCBhcyB3ZSBtaWdodCBoYXZlIHNvbWUgaW52YWxpZCBkZXN0aW5hdGlvbnMgYWZ0ZXIgcmUtb3JkZXJpbmdcbiAgICAgICAgICAgICAgICAgICAgLy9JIGFtIGZvcmNlZCB0byBkbyB0aGlzIGFnYWluc3QgYWxsIHRoZSBicmFuY2ggaW5wdXRzXG4gICAgICAgICAgICAgICAgICAgIHZhbGlkYXRpb24udmFsaWRhdGVKdW1wc0FmdGVyU29ydGluZyhicmFuY2hfaW5wdXRzKTtcblxuICAgICAgICAgICAgICAgICAgICBqcXVlcnlfdWkuaXRlbS5hZGRDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL3RvZG8gdGVzdCB0aGlzIHRoaW5nXG4gICAgICAgICAgICAvL2FkZCB0aGlzIHN0YXRlIGZvciB1bmRvaW5nLCBzbyBpdCBpcyBlYXNpZXIgdG8gcmViaW5kIGV2ZXJ5dGhpbmdcbiAgICAgICAgICAgIGZvcm1idWlsZGVyLnJlbmRlcl9hY3Rpb24gPSBjb25zdHMuUkVOREVSX0FDVElPTl9ETztcbiAgICAgICAgICAgIHVuZG8ucHVzaFN0YXRlKCk7XG5cbiAgICAgICAgICAgIGlmIChpbnB1dF90eXBlID09PSBjb25zdHMuUkVBRE1FX1RZUEUpIHtcbiAgICAgICAgICAgICAgICAkKCcuc3VtbWVybm90ZScpLnN1bW1lcm5vdGUoY29uc3RzLlNVTU1FUk5PVEVfT1BUSU9OUyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vaWYgdGhlcmUgaXMgbm90IGFueSB0aXRsZSBzZXQsIHNob3cgd2FybmluZ1xuICAgICAgICAgICAgdWkuaW5wdXRzX2NvbGxlY3Rpb24udG9nZ2xlVGl0bGVXYXJuaW5nKHV0aWxzLmdldFRpdGxlQ291bnQoYnJhbmNoX2lucHV0cyksIHRydWUpO1xuXG4gICAgICAgIH0sXG4gICAgICAgIC8vdGhpcyBjYWxsYmFjayBpcyB0cmlnZ2VyZWQgd2hlbiB0aGUgdXNlciBzdGFydCBkcmFnZ2luZyBhbiBleGlzdGluZyBpbnB1dCBmcm9tIHRoZSAgICAgIHNvcnRhYmxlXG4gICAgICAgIHN0YXJ0OiBmdW5jdGlvbiAoZSwganF1ZXJ5X3VpKSB7XG5cblxuICAgICAgICAgICAgY29uc29sZS5sb2coJ3NvcnRhYmxlIHN0YXJ0Jyk7XG4gICAgICAgICAgICAvL2dldCBjdXJyZW50IGlucHV0IHBvc2l0aW9uLCBhcyB3ZSBuZWVkIHRvIG1vdmUgZnJvbSBoZXJlXG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKCdicmFuY2ggaW5wdXQgaW5kZXg6ICcgKyBqcXVlcnlfdWkuaXRlbS5pbmRleCgpKTtcblxuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuYnJhbmNoLmNvbGxlY3Rpb25faXNfYmVpbmdfc29ydGVkID0gdHJ1ZTtcblxuICAgICAgICAgICAgLy9uYiB0aGUgLTIgaXMgdG8gcmVtb3ZlIHRoZSBlbGVtZW50IHdoaWNoIGFyZSBubyBpbnB1dCAod2FybmluZyBtZXNzYWdlcylcbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmJyYW5jaC5mcm9tX2luZGV4ID0ganF1ZXJ5X3VpLml0ZW0uaW5kZXgoKSA9PT0gMCA/IDAgOiBqcXVlcnlfdWkuaXRlbS5pbmRleCgpIC0gMjtcblxuICAgICAgICAgICAgLy9kZS1hY3RpdmF0ZSBhbGwgaW5wdXRzIGluIGNvbGxlY3Rpb25cbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbl9zb3J0YWJsZS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG5cbiAgICAgICAgfSxcbiAgICAgICAgc2Nyb2xsOiB0cnVlLFxuICAgICAgICBzbmFwOiBmYWxzZSxcbiAgICAgICAgb3ZlcjogZnVuY3Rpb24gKGUsIGpxdWVyeV91aSkge1xuXG4gICAgICAgICAgICB2YXIgb3duZXJfaW5wdXRfcmVmID0gZm9ybWJ1aWxkZXIuYnJhbmNoLmFjdGl2ZV9icmFuY2hfcmVmO1xuICAgICAgICAgICAgdmFyIG93bmVyX2lucHV0ID0gdXRpbHMuZ2V0SW5wdXRPYmplY3RCeVJlZihvd25lcl9pbnB1dF9yZWYpO1xuXG4gICAgICAgICAgICAvL2hpZGUgaGVscCB0ZXh0IGlmIHRoZSBsaXN0IGlzIGVtcHR5IGFuZCB3ZSBhcmUgaG92ZXJpbmcgd2l0aCBhbiBpbnB1dFxuICAgICAgICAgICAgaWYgKG93bmVyX2lucHV0LmJyYW5jaC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAvL3JlbW92ZSBpbnB1dCBmcm9tIGRvbSBjb2xsZWN0aW9uIChtaWRkbGUgY29sdW1uKVxuICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbl9zb3J0YWJsZVxuICAgICAgICAgICAgICAgICAgICAuZmluZCgnZGl2LmlucHV0W2RhdGEtaW5wdXQtcmVmPVwiJyArIG93bmVyX2lucHV0X3JlZiArICdcIl0nKVxuICAgICAgICAgICAgICAgICAgICAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX25vLWJyYW5jaC1xdWVzdGlvbnMtbWVzc2FnZScpXG4gICAgICAgICAgICAgICAgICAgIC5oaWRlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBicmFuY2hfc29ydGFibGUoKTtcbiIsIid1c2Ugc3RyaWN0JztcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJy4uL2NvbmZpZy9mb3JtYnVpbGRlcicpO1xudmFyIGRyYWdnYWJsZSA9IGZ1bmN0aW9uICgpIHtcblxuICAgICQoJ3VsI2lucHV0cy10b29scy1saXN0IGxpIGRpdi5pbnB1dCcpLmRyYWdnYWJsZSh7XG4gICAgICAgIGNvbm5lY3RUb1NvcnRhYmxlOiAnLnNvcnRhYmxlJyxcbiAgICAgICAgLy9jbG9uZSBlbGVtZW50IGtlZXBpbmcgc2FtZSB3aWR0aCB3aGVuIGRyYWdnaW5nXG4gICAgICAgIC8vbWluZDogYGV2dGAgaXMganF1ZXJ5IGdlbmVyYXRlZCwgaXQgY2Fubm90IGJlIGNhbGxlZCBhbnl0aGluZyBlbHNlIVxuICAgICAgICBoZWxwZXI6IGZ1bmN0aW9uIChldnQpIHtcblxuICAgICAgICAgICAgdmFyIGV2ZW50ID0gZXZ0IHx8IHdpbmRvdy5ldmVudDtcblxuICAgICAgICAgICAgLypcbiAgICAgICAgICAgICBjbG9uZSBhbHdheXMgdGhlIGlucHV0IHdyYXBwZXIsIGNoZWNraW5nIHdoaWNoIGVsZW1lbnQgdGhlIHVzZXIgaXMgYWN0dWFsbHkgZHJhZ2dpbmdcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgaWYgKCQoZXZlbnQudGFyZ2V0KS5wcm9wKCd0YWdOYW1lJykgPT09ICdTUEFOJyB8fCAkKGV2ZW50LnRhcmdldCkucHJvcCgndGFnTmFtZScpID09PSAnSScpIHtcbiAgICAgICAgICAgICAgICAvL2RyYWdnaW5nIGVsZW1lbnRzIGluc2lkZSBpbm5lciBkaXZcbiAgICAgICAgICAgICAgICByZXR1cm4gJChldmVudC50YXJnZXQpLnBhcmVudCgpLnBhcmVudCgpLmNsb25lKCkuY3NzKHtcbiAgICAgICAgICAgICAgICAgICAgd2lkdGg6ICQoZXZlbnQudGFyZ2V0KS5wYXJlbnQoKS53aWR0aCgpXG5cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvL2RyYWdnaW5nIGlubmVyIGRpdlxuICAgICAgICAgICAgICAgIGlmICgkKGV2ZW50LnRhcmdldCkuaGFzQ2xhc3MoJ2lucHV0LWlubmVyJykpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICQoZXZlbnQudGFyZ2V0KS5wYXJlbnQoKS5jbG9uZSgpLmNzcyh7XG4gICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogJChldmVudC50YXJnZXQpLndpZHRoKClcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vZHJhZ2dpbmcgb3V0ZXIgZGl2IChpbnB1dCB3cmFwcGVyKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJChldmVudC50YXJnZXQpLmNsb25lKCkuY3NzKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiAkKGV2ZW50LnRhcmdldCkud2lkdGgoKVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHNuYXA6IGZhbHNlLFxuICAgICAgICAvL2N1cnNvckF0OiB7bGVmdDogJzUwJScsIHRvcDogJzUwJSd9LCBnZXQgbW91c2UgeCBhbmQgeSBkaW5hbWljYWxseVxuICAgICAgICAvL2hhbmRsZTogJ2knLFxuICAgICAgICAvLyBjYW5jZWw6ICdpJywgLy90aGlzIHN0b3AgdGhlIGRyYWdnaW5nIG92ZXIgdGhlIGljb24sIG5vdCBnb29kXG4gICAgICAgIC8vYmV0dGVyIHN0b3AgcHJvcGFnYXRpb24gb24gbW91c2Vkb3duIGxpa2VcbiAgICAgICAgLy8gY3Vyc29yOiAnbW92ZScsIHRoaXMga2VlcCB0aGUgY3Vyc29yICdtb3ZlJyBhZnRlciBkcm9wcGluZywgbm90IGdvb2RcbiAgICAgICAgcmV2ZXJ0OiAnaW52YWxpZCcsXG4gICAgICAgIHJldmVydER1cmF0aW9uOiAxMDAsXG4gICAgICAgIHpJbmRleDogOTk5OSxcbiAgICAgICAgYXBwZW5kVG86ICdib2R5JywvL2FwcGVuZCBvdXRzaWRlIHNvcnRhYmxlIHRvIGF2b2lkIGZsaWNrZXJpbmdcbiAgICAgICAgc3RvcDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuY29sbGVjdGlvbl9pc19iZWluZ19zb3J0ZWQgPSBmYWxzZTtcblxuXG4gICAgICAgIH0sXG4gICAgICAgIHN0YXJ0OiBmdW5jdGlvbiAoZSwgdWkpIHtcblxuXG4gICAgICAgICAgICBpZiAoJChlLnRhcmdldCkucHJvcCgndGFnTmFtZScpID09PSAnU1BBTicgfHwgJChlLnRhcmdldCkucHJvcCgndGFnTmFtZScpID09PSAnSScpIHtcbiAgICAgICAgICAgICAgICAkKHRoaXMpLndpZHRoKCQoZS50YXJnZXQpLnBhcmVudCgpLndpZHRoKCkpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAkKHRoaXMpLndpZHRoKCQoZS50YXJnZXQpLndpZHRoKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy9rZWVwIHRyYWNrIHdlIGFyZSBkcmFnZ2luZyBmcm9tIHNpZGViYXIgYSBuZXcgaW5wdXQgdG8gdGhlIGlucHV0IGxpc3RcbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmNvbGxlY3Rpb25faXNfYmVpbmdfc29ydGVkID0gZmFsc2U7XG4gICAgICAgIH0sXG4gICAgICAgIHNjcm9sbDogdHJ1ZVxuICAgIH0pLmRpc2FibGVTZWxlY3Rpb24oKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gZHJhZ2dhYmxlO1xuIiwiLyogZ2xvYmFsICQsIHRvYXN0ciovXG4ndXNlIHN0cmljdCc7XG52YXIgY29uc3RzID0gcmVxdWlyZSgnY29uZmlnL2NvbnN0cycpO1xudmFyIGZvcm1idWlsZGVyID0gcmVxdWlyZSgnY29uZmlnL2Zvcm1idWlsZGVyJyk7XG52YXIgdXRpbHMgPSByZXF1aXJlKCdoZWxwZXJzL3V0aWxzJyk7XG52YXIgcG9zc2libGVfYW5zd2Vyc19wYWdlciA9IHJlcXVpcmUoJ2FjdGlvbnMvcG9zc2libGUtYW5zd2Vycy1wYWdlcicpO1xudmFyIGdldFBvc3NpYmxlQW5zd2Vyc0xpc3QgPSByZXF1aXJlKCd0ZW1wbGF0ZS9tZXRob2RzL2dldFBvc3NpYmxlQW5zd2Vyc0xpc3QnKTtcblxudmFyIGNhbGxiYWNrID0gZnVuY3Rpb24gKHBhcmFtcykge1xuXG4gICAgdmFyIHNlbGVjdGVkSGVhZGVySW5kZXggPSBwYXJhbXMuc2VsZWN0ZWRIZWFkZXJJbmRleDtcbiAgICB2YXIgaW5wdXQgPSBwYXJhbXMuaW5wdXQ7XG4gICAgdmFyIGltcG9ydGVkSnNvbiA9IHBhcmFtcy5pbXBvcnRlZEpzb247XG4gICAgdmFyIGxpc3Q7XG4gICAgdmFyIHByb3BlcnRpZXNfcGFuZWw7XG4gICAgdmFyIHBvc3NpYmxlX2Fuc3dlcnNfbGlzdDtcbiAgICB2YXIgaGVhZGVycyA9IGltcG9ydGVkSnNvbi5tZXRhLmZpZWxkcztcbiAgICB2YXIgdXNlcldhbnRzdG9SZXBsYWNlQW5zd2VycyA9IHBhcmFtcy51c2VyV2FudHN0b1JlcGxhY2VBbnN3ZXJzO1xuICAgIHZhciBkb2VzRmlyc3RSb3dDb250YWluc0hlYWRlcnMgPSBwYXJhbXMuZG9lc0ZpcnN0Um93Q29udGFpbnNIZWFkZXJzO1xuICAgIHZhciBwb3NzaWJsZV9hbnN3ZXJzX21heCA9IGNvbnN0cy5MSU1JVFMucG9zc2libGVfYW5zd2Vyc19tYXg7XG5cbiAgICBpZihpbnB1dC50eXBlID09PSBjb25zdHMuU0VBUkNIX1NJTkdMRV9UWVBFIHx8IGlucHV0LnR5cGUgPT09IGNvbnN0cy5TRUFSQ0hfTVVMVElQTEVfVFlQRSkge1xuICAgICAgICBwb3NzaWJsZV9hbnN3ZXJzX21heCA9IGNvbnN0cy5MSU1JVFMucG9zc2libGVfYW5zd2Vyc19tYXhfc2VhcmNoO1xuICAgIH1cblxuICAgIC8vaWYgbm8gY29sdW1uIGlzIHNlbGVjdGVkIGFib3J0XG4gICAgaWYgKHNlbGVjdGVkSGVhZGVySW5kZXggPT09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8vcmVwbGFjZSBvciBhcHBlbmQ/XG4gICAgaWYgKHVzZXJXYW50c3RvUmVwbGFjZUFuc3dlcnMpIHtcbiAgICAgICAgLy9yZXNldCBhbnN3ZXJzIGFycmF5XG4gICAgICAgIGlucHV0LnBvc3NpYmxlX2Fuc3dlcnMgPSBbXTtcbiAgICB9XG5cbiAgICAvL2hlYWRlcnMgb24gZmlyc3Qgcm93IG9yIG5vdD9cbiAgICBpZiAoIWRvZXNGaXJzdFJvd0NvbnRhaW5zSGVhZGVycykge1xuXG4gICAgICAgIHZhciBmaXJzdF9yb3cgPSB7fTtcbiAgICAgICAgZmlyc3Rfcm93W2ltcG9ydGVkSnNvbi5tZXRhLmZpZWxkc1tzZWxlY3RlZEhlYWRlckluZGV4XV0gPSBpbXBvcnRlZEpzb24ubWV0YS5maWVsZHNbc2VsZWN0ZWRIZWFkZXJJbmRleF07XG4gICAgICAgIC8vY3N2IGZpbGUgZG9lcyBub3QgaGF2ZSBhbnkgaGVhZGVycywgcHJlcGVuZCBtZXRhLmZpZWxkcyAod2hpY2ggaXMgdGhlIGhlYWRlcnMpXG4gICAgICAgIGltcG9ydGVkSnNvbi5kYXRhLnVuc2hpZnQoZmlyc3Rfcm93KTtcbiAgICB9XG5cbiAgICAvL2FwcGVuZCBpbXBvcnRlZCBwb3NzaWJsZSBhbnN3ZXJzIGJhc2VkIG9uIHNlbGVjdGVkIGNvbHVtbiAodXAgdG8gbWF4IG51bWJlciBhbGxvd2VkKVxuICAgICQoaW1wb3J0ZWRKc29uLmRhdGEpLmVhY2goZnVuY3Rpb24gKGluZGV4LCBpdGVtKSB7XG5cbiAgICAgICAgdmFyIGltcG9ydGVkX2Fuc3dlciA9IGl0ZW1baGVhZGVyc1tzZWxlY3RlZEhlYWRlckluZGV4XV07XG5cbiAgICAgICAgLy9pbXBvcnQgYXMgbWFueSBhcyB3ZSBjYW5cbiAgICAgICAgaWYgKGlucHV0LnBvc3NpYmxlX2Fuc3dlcnMubGVuZ3RoIDwgcG9zc2libGVfYW5zd2Vyc19tYXggJiYgaW1wb3J0ZWRfYW5zd2VyICE9PSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgLy9zdHJpcCBodG1sIHRhZ3NcbiAgICAgICAgICAgIGltcG9ydGVkX2Fuc3dlciA9IGltcG9ydGVkX2Fuc3dlci5yZXBsYWNlKC8oPChbXj5dKyk+KS9pZywgJyAnKTtcblxuICAgICAgICAgICAgLy9lc2NhcGUgZG91YmxlIHF1b3Rlc1xuICAgICAgICAgICAgaW1wb3J0ZWRfYW5zd2VyID0gaW1wb3J0ZWRfYW5zd2VyLnJlcGxhY2UoL1wiL2dpLCAnJnF1b3Q7Jyk7XG5cbiAgICAgICAgICAgIC8vZmlsdGVyIG91dCBlbXB0eSBhbnN3ZXJzXG4gICAgICAgICAgICBpZiAoaW1wb3J0ZWRfYW5zd2VyLnRyaW0oKSAhPT0gJycpIHtcblxuICAgICAgICAgICAgICAgIC8vdHJ1bmNhdGUgaWYgdG9vIGxvbmdcbiAgICAgICAgICAgICAgICBpZiAoaW1wb3J0ZWRfYW5zd2VyLmxlbmd0aCA+IGNvbnN0cy5MSU1JVFMucG9zc2libGVfYW5zd2VyX21heF9sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgaW1wb3J0ZWRfYW5zd2VyID0gaW1wb3J0ZWRfYW5zd2VyLnN1YnN0cmluZygwLGNvbnN0cy5MSU1JVFMucG9zc2libGVfYW5zd2VyX21heF9sZW5ndGgpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vYWRkIHRvIG9iamVjdFxuICAgICAgICAgICAgICAgIGlucHV0LnBvc3NpYmxlX2Fuc3dlcnMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIGFuc3dlcjogaW1wb3J0ZWRfYW5zd2VyLFxuICAgICAgICAgICAgICAgICAgICBhbnN3ZXJfcmVmOiB1dGlscy5nZW5lcmF0ZVVuaXFJRCgpXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvL3RvbyBtYW55LCBleGl0XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnZXhpdCBhdCAnICsgcG9zc2libGVfYW5zd2Vyc19tYXgpO1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlOy8vanVzdCB0byBleGl0IGxvb3BcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy9nZXQgcG9zc2libGUgYW5zd2VycyBsaXN0IG1hcmt1cFxuICAgIGxpc3QgPSBnZXRQb3NzaWJsZUFuc3dlcnNMaXN0KGlucHV0LnBvc3NpYmxlX2Fuc3dlcnMpO1xuXG4gICAgcHJvcGVydGllc19wYW5lbCA9IGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXJcbiAgICAgICAgLmZpbmQoJ2Zvcm1bZGF0YS1pbnB1dC1yZWY9XCInICsgaW5wdXQucmVmICsgJ1wiXScpO1xuXG4gICAgcG9zc2libGVfYW5zd2Vyc19saXN0ID0gcHJvcGVydGllc19wYW5lbFxuICAgICAgICAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX3Bvc3NpYmxlLWFuc3dlcnMgZGl2IHVsLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX3Bvc3NpYmxlLWFuc3dlcnNfX2xpc3QnKTtcblxuICAgIC8vZW1wdHkgY3VycmVudCBsaXN0IGFuZCBhcHBlbmQgbmV3IG9uZSB0byBkb21cbiAgICBwb3NzaWJsZV9hbnN3ZXJzX2xpc3RcbiAgICAgICAgLmVtcHR5KClcbiAgICAgICAgLmhpZGUoKVxuICAgICAgICAuYXBwZW5kKGxpc3QpXG4gICAgICAgIC5mYWRlSW4oY29uc3RzLkFOSU1BVElPTl9GQVNUKTtcblxuICAgIC8vd2hlbiB0aGVyZSBpcyBtb3JlIHRoYW4gMSBwb3NzaWJsZSBhbnN3ZXJzLCBlbmFibGUgYWxsIHJlbW92ZSBidXR0b25zXG4gICAgcG9zc2libGVfYW5zd2Vyc19saXN0LmZpbmQoJ2xpIGRpdiBzcGFuIGJ1dHRvbicpLnByb3AoJ2Rpc2FibGVkJywgZmFsc2UpO1xuXG4gICAgLy9zaG93IHBhZ2luYXRpb24gaWYgbmVlZGVkLCBzdGFydGluZyBmcm9tIHBhZ2UgMVxuICAgIGlmKGlucHV0LnBvc3NpYmxlX2Fuc3dlcnMubGVuZ3RoID4gY29uc3RzLkxJTUlUUy5wb3NzaWJsZV9hbnN3ZXJzX3Blcl9wYWdlKSB7XG4gICAgICAgIGZvcm1idWlsZGVyLnBvc3NpYmxlX2Fuc3dlcnNfcGFnaW5hdGlvbltpbnB1dC5yZWZdLnBhZ2UgPSAxO1xuICAgICAgICBwb3NzaWJsZV9hbnN3ZXJzX3BhZ2VyLmluaXQoaW5wdXQpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgLy9yZXNldCBwYWdpbmF0aW9uXG4gICAgICAgIHBvc3NpYmxlX2Fuc3dlcnNfcGFnZXIudGVhckRvd24oaW5wdXQpO1xuICAgIH1cblxuICAgIHJldHVybiB0cnVlO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBjYWxsYmFjaztcbiIsIi8qIGdsb2JhbCAkLCB0b2FzdHIqL1xuJ3VzZSBzdHJpY3QnO1xudmFyIGNvbnN0cyA9IHJlcXVpcmUoJ2NvbmZpZy9jb25zdHMnKTtcbnZhciBtZXNzYWdlcyA9IHJlcXVpcmUoJ2NvbmZpZy9tZXNzYWdlcycpO1xudmFyIGZvcm1idWlsZGVyID0gcmVxdWlyZSgnY29uZmlnL2Zvcm1idWlsZGVyJyk7XG52YXIgdWkgPSByZXF1aXJlKCdoZWxwZXJzL3VpJyk7XG52YXIgdG9hc3QgPSByZXF1aXJlKCdjb25maWcvdG9hc3QnKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoJ2hlbHBlcnMvdXRpbHMnKTtcblxudmFyIGNhbGxiYWNrID0gZnVuY3Rpb24gKGZpbGVzKSB7XG5cbiAgICB2YXIgdW5kbyA9IHJlcXVpcmUoJ2FjdGlvbnMvdW5kbycpO1xuICAgIHZhciBpbnB1dHMgPSBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0LmZvcm1zW2Zvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleF0uaW5wdXRzO1xuXG5cbiAgICAvL3Nob3cgb3ZlcmxheSBhbmQgY3Vyc29yXG4gICAgZm9ybWJ1aWxkZXIuZG9tLm92ZXJsYXkuZmFkZUluKGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG5cbiAgICAvL2RlbGV0ZSBhbGwgaW5wdXRzIGZyb20gZG9tXG4gICAgJChpbnB1dHMpLmVhY2goZnVuY3Rpb24gKGluZGV4LCBpbnB1dCkge1xuICAgICAgICAvL3JlbW92ZSBwcm9wZXJ0aWVzIGRvbSBlbGVtZW50cyAocmlnaHQgc2lkZWJhcilcbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNcbiAgICAgICAgICAgIC5maW5kKCdkaXYucGFuZWwtYm9keSBmb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIGlucHV0LnJlZiArICdcIl0nKVxuICAgICAgICAgICAgLmZhZGVPdXQoY29uc3RzLkFOSU1BVElPTl9GQVNUKS5yZW1vdmUoKTtcblxuICAgICAgICAvL3JlbW92ZSBpbnB1dCBmcm9tIGRvbSBjb2xsZWN0aW9uIChtaWRkbGUgY29sdW1uKVxuICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25fc29ydGFibGVcbiAgICAgICAgICAgIC5maW5kKCdkaXYuaW5wdXRbZGF0YS1pbnB1dC1yZWY9XCInICsgaW5wdXQucmVmICsgJ1wiXScpXG4gICAgICAgICAgICAuZmFkZU91dChjb25zdHMuQU5JTUFUSU9OX0ZBU1QpLnJlbW92ZSgpO1xuICAgIH0pO1xuXG4gICAgLy9kZWxldGUgYWxsIHF1ZXN0aW9uIGZyb20gcHJvamVjdCBkZWZpbml0aW9uXG4gICAgZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uLmRhdGEucHJvamVjdC5mb3Jtc1tmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXhdLmlucHV0cyA9IFtdO1xuXG4gICAgLy9hZnRlciBkZWxldGlvbiBubyBpbnB1dCBpcyBzZWxlY3RlZCwgc2hvdyBtZXNzYWdlIGFuZCBoaWRlIGNvbnRleHQgYnV0dG9uc1xuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX25vX2lucHV0X3NlbGVjdGVkLmZhZGVJbihjb25zdHMuQU5JTUFUSU9OX0ZBU1QpO1xuICAgIC8vaGlkZSBhY3Rpb24gYnV0dG9uIGZvciBpbnB1dFxuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2J1dHRvbnMuZmFkZU91dChjb25zdHMuQU5JTUFUSU9OX0ZBU1QpO1xuXG4gICAgLy9yZW1vdmUgdHJhY2sgb2YgYW55IGlucHV0c1xuICAgIGZvcm1idWlsZGVyLmN1cnJlbnRfaW5wdXRfcmVmID0gdW5kZWZpbmVkO1xuXG4gICAgLy9yZSBjYWxjdWxhdGUgc2VhcmNoIHF1ZXN0aW9ucyB0b3RhbFxuICAgIGlmICh1dGlscy5nZXRTZWFyY2hJbnB1dHNUb3RhbCgpIDw9IChjb25zdHMuTElNSVRTLnNlYXJjaF9pbnB1dHNfbWF4IC0gMSkpIHtcbiAgICAgICAgdWkuaW5wdXRfdG9vbHMuc2hvd1NlYXJjaElucHV0KCk7XG4gICAgfVxuXG4gICAgLy9yZW1vdmUgdGl0bGUgd2FybmluZyBpZiBhbnlcbiAgICB1aS5pbnB1dHNfY29sbGVjdGlvbi50b2dnbGVUaXRsZVdhcm5pbmcoMSxmYWxzZSk7XG5cbiAgICAvL3NldCBmb3JtIGFzIGludmFsaWRcbiAgICB1aS5mb3Jtc190YWJzLnNob3dGb3JtSW52YWxpZEljb24oZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4KTtcblxuICAgIC8vZGlzYWJsZSBzYXZlIHByb2plY3QgYnV0dG9uXG4gICAgdWkubmF2YmFyLnRvZ2dsZVNhdmVQcm9qZWN0QnRuKGNvbnN0cy5CVE5fRElTQUJMRUQpO1xuXG4gICAgLy9zaG93IGltcG9ydCBmb3JtIGJ1dHRvblxuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbi5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fbm8tcXVlc3Rpb25zLW1lc3NhZ2UnKS5yZW1vdmVDbGFzcygnaGlkZGVuJyk7XG5cbiAgICAvL2hhbmRsZSB0aGUgdW5kby4uLmNhbiB3ZSBnbyBiYWNrP1xuICAgIHVpLm5hdmJhci50b2dnbGVVbmRvQnRuKGNvbnN0cy5CVE5fRU5BQkxFRCk7XG5cbiAgICAvL2hpZGUgb3ZlcmxheVxuICAgIHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLm92ZXJsYXkuZmFkZU91dChjb25zdHMuQU5JTUFUSU9OX0ZBU1QpO1xuICAgIH0sIDEwMDApO1xuXG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGNhbGxiYWNrO1xuIiwiLyogZ2xvYmFsICQsIHRvYXN0ciovXG4ndXNlIHN0cmljdCc7XG52YXIgY29uc3RzID0gcmVxdWlyZSgnY29uZmlnL2NvbnN0cycpO1xudmFyIG1lc3NhZ2VzID0gcmVxdWlyZSgnY29uZmlnL21lc3NhZ2VzJyk7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcbnZhciB1aSA9IHJlcXVpcmUoJ2hlbHBlcnMvdWknKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoJ2hlbHBlcnMvdXRpbHMnKTtcbnZhciB2YWxpZGF0aW9uID0gcmVxdWlyZSgnYWN0aW9ucy92YWxpZGF0aW9uJyk7XG5cblxudmFyIGNhbGxiYWNrID0gZnVuY3Rpb24gKGUpIHtcblxuICAgIHZhciB1bmRvID0gcmVxdWlyZSgnYWN0aW9ucy91bmRvJyk7XG4gICAgdmFyIGZvcm1fZmFjdG9yeSA9IHJlcXVpcmUoJ2ZhY3RvcnkvZm9ybS1mYWN0b3J5Jyk7XG4gICAgdmFyIGZvcm1fcmVmID0gZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX3JlZjtcbiAgICB2YXIgZm9ybV90YWIgPSBmb3JtYnVpbGRlci5kb20uZm9ybXNfdGFicy5maW5kKCcuYWN0aXZlJyk7XG4gICAgdmFyIHByZXZpb3VzX3RhYl90cmlnZ2VyID0gZm9ybV90YWIucHJldigpLmZpbmQoJ2EnKTtcbiAgICB2YXIgcHJldmlvdXNfZm9ybV9yZWYgPSBwcmV2aW91c190YWJfdHJpZ2dlci5hdHRyKCdocmVmJyk7XG4gICAgdmFyIGZvcm1zID0gZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uLmRhdGEucHJvamVjdC5mb3JtcztcblxuICAgIC8vaWYgY3VycmVudCBmb3JtIGluZGV4ID09PSAwLCBkbyBub3QgZGVsZXRlIGFzIHRoaXMgaXMgdGhlIGZpcnN0IGZvcm1cbiAgICBpZihmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXggPT09IDApIHtcbiAgICAgICAgLy9jYW5ub3QgZGVsZXRlIHRvcCBwYXJlbnQgZm9ybVxuICAgICAgICB0b2FzdHIuZXJyb3IobWVzc2FnZXMuZXJyb3IuRk9STV9DQU5OT1RfQkVfREVMRVRFRCk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvL2lmIHRoZSBjdXJyZW50IGZvcm0gaXMgbm90IHRoZSBsYXN0IGluIHRoZSBoaWVyYXJjaHksIGRvIG5vdCBkZWxldGUgaXRcbiAgICBpZihmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXggIT09IChmb3Jtcy5sZW5ndGggLSAxKSkge1xuICAgICAgICAvL2Nhbm5vdCBkZWxldGUgdG9wIHBhcmVudCBmb3JtXG4gICAgICAgIHRvYXN0ci5lcnJvcihtZXNzYWdlcy5lcnJvci5GT1JNX0NBTk5PVF9CRV9ERUxFVEVEKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHByZXZpb3VzX2Zvcm1fcmVmID0gcHJldmlvdXNfZm9ybV9yZWYuc3Vic3RyaW5nKDEsIHByZXZpb3VzX2Zvcm1fcmVmLmxlbmd0aCAtIDkpO1xuICAgIC8vYWZ0ZXIgdGhlIGZvcm0gdG8gYmUgZGVsZXRlZCBpcyBoaWRkZW4sIGRlbGV0ZSBpdCBhbmQgdW5iaW5kIHRoZSBjYWxsYmFja1xuICAgIHByZXZpb3VzX3RhYl90cmlnZ2VyLm9uKCdzaG93bi5icy50YWInLCBmdW5jdGlvbiAoZSkge1xuXG4gICAgICAgIGZvcm1fZmFjdG9yeS5yZW1vdmVGb3JtKHByZXZpb3VzX2Zvcm1fcmVmLCBmb3JtX3JlZiwgZm9ybV90YWIpO1xuXG4gICAgICAgIC8vc2hvdyB0b2FzdFxuICAgICAgICB0b2FzdHIud2FybmluZyhtZXNzYWdlcy53YXJuaW5nLkZPUk1fREVMRVRFRCk7XG4gICAgICAgIHVuZG8ucHVzaFN0YXRlKCk7XG5cbiAgICAgICAgcHJldmlvdXNfdGFiX3RyaWdnZXIub2ZmKCk7XG5cbiAgICAgICAgLy9ydW4gdmFsaWRhdGlvbiwgdGhlIHJlbW92ZWQgZm9ybSBuaWdodCBoYXZlIGJlZW4gdGhlIG9ubHkgb25lIHdpdGggaW52YWxpZCBpbnB1dHNcbiAgICAgICAgaWYgKHZhbGlkYXRpb24uYXJlQWxsSW5wdXRzVmFsaWQoZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uKSkge1xuICAgICAgICAgICAgdWkubmF2YmFyLnRvZ2dsZVNhdmVQcm9qZWN0QnRuKGNvbnN0cy5CVE5fRU5BQkxFRCk7XG4gICAgICAgIH1cblxuICAgICAgICAvL3Nob3cgc2VhcmNoIGlucHV0IGlmIHdlIGRlbGV0ZWQgc29tZSBzZWFyY2ggcWVzdGlvbnNcbiAgICAgICAgaWYgKHV0aWxzLmdldFNlYXJjaElucHV0c1RvdGFsKCkgPD0gY29uc3RzLkxJTUlUUy5zZWFyY2hfaW5wdXRzX21heCkge1xuICAgICAgICAgICAgdWkuaW5wdXRfdG9vbHMuc2hvd1NlYXJjaElucHV0KCk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vdW5iaW5kIGN1cnJlbnQgcGFuZWwgaGFuZGxlcnMgYmVmb3JlIHN3aXRjaGluZ1xuICAgIGZvcm1fZmFjdG9yeS51bmJpbmRGb3JtUGFuZWxzRXZlbnRzKCk7XG5cbiAgICAvL3VwZGF0ZSBmb3JtYnVpbGRlciBkb20gcmVmZXJlbmNlcyB0byBwb2ludCB0byB0aGUgc2VsZWN0ZWQgZm9ybSBtYXJrdXBcbiAgICBmb3JtX2ZhY3RvcnkudXBkYXRlRm9ybWJ1aWxkZXJEb21SZWZlcmVuY2VzKHByZXZpb3VzX2Zvcm1fcmVmKTtcblxuICAgIC8vYmluZCBldmVudHMgdG8gYWN0aXZlIGZvcm1cbiAgICBmb3JtX2ZhY3RvcnkuYmluZEZvcm1QYW5lbHNFdmVudHMoKTtcblxuICAgIC8vc3dpdGNoIHRvIHByZXZpb3VzIGZvcm1cbiAgICBmb3JtX3RhYi5wcmV2KCkuZmluZCgnYScpLnRhYignc2hvdycpO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBjYWxsYmFjaztcbiIsIi8qIGdsb2JhbCAkLCB0b2FzdHIqL1xuJ3VzZSBzdHJpY3QnO1xudmFyIGNvbnN0cyA9IHJlcXVpcmUoJ2NvbmZpZy9jb25zdHMnKTtcbnZhciBtZXNzYWdlcyA9IHJlcXVpcmUoJ2NvbmZpZy9tZXNzYWdlcycpO1xudmFyIGZvcm1idWlsZGVyID0gcmVxdWlyZSgnY29uZmlnL2Zvcm1idWlsZGVyJyk7XG52YXIgdWkgPSByZXF1aXJlKCdoZWxwZXJzL3VpJyk7XG52YXIgdXRpbHMgPSByZXF1aXJlKCdoZWxwZXJzL3V0aWxzJyk7XG52YXIgdmFsaWRhdGlvbiA9IHJlcXVpcmUoJ2FjdGlvbnMvdmFsaWRhdGlvbicpO1xudmFyIHRvYXN0ID0gcmVxdWlyZSgnY29uZmlnL3RvYXN0Jyk7XG5cbnZhciBjYWxsYmFjayA9IGZ1bmN0aW9uIChlKSB7XG5cbiAgICB2YXIgdW5kbyA9IHJlcXVpcmUoJ2FjdGlvbnMvdW5kbycpO1xuICAgIC8vIHZhciBnZW5lcmF0ZV9zZWFyY2hfdHlwZV9wcm9qZWN0ID0gcmVxdWlyZSgnaGVscGVycy9nZW5lcmF0ZS1zZWFyY2gtdHlwZS1wcm9qZWN0Jyk7XG4gICAgLy9cbiAgICAvLyBnZW5lcmF0ZV9zZWFyY2hfdHlwZV9wcm9qZWN0LmRvSXQoKTtcbiAgICAvLyByZXR1cm4gZmFsc2U7XG5cbiAgICB2YXIgaW5kZXggPSBmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXg7XG4gICAgdmFyIGZvcm1Ub0V4cG9ydCA9IHtcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgaWQ6ICcnLFxuICAgICAgICAgICAgdHlwZTogJ2Zvcm0nLFxuICAgICAgICAgICAgZm9ybToge31cbiAgICAgICAgfVxuICAgIH07XG4gICAgLy9jcmVhdGUgYSBkZWVwIGNvcHkgb2YgdGhlIHByb2plY3Qgb2JqZWN0IHByb3BlcnRpZXNcbiAgICB2YXIgcHJvamVjdF9kZWZpbml0aW9uX2pzb24gPSBDaXJjdWxhckpTT04ucGFyc2UoQ2lyY3VsYXJKU09OLnN0cmluZ2lmeShmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24pKTtcbiAgICB2YXIgaXNfdmFsaWRfZm9ybSA9IHRydWU7XG4gICAgdmFyIHByb2plY3Rfc2x1ZyA9IHByb2plY3RfZGVmaW5pdGlvbl9qc29uLmRhdGEucHJvamVjdC5zbHVnO1xuICAgIHZhciBmb3JtID0gcHJvamVjdF9kZWZpbml0aW9uX2pzb24uZGF0YS5wcm9qZWN0LmZvcm1zW2luZGV4XTtcbiAgICB2YXIgZmlsZW5hbWUgPSBwcm9qZWN0X3NsdWcgKyAnX18nICsgZm9ybS5zbHVnICsgJ19fZm9ybS5qc29uJztcblxuICAgIGlmIChmb3JtLmlucHV0cy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgdG9hc3Quc2hvd0Vycm9yKG1lc3NhZ2VzLmVycm9yLkZPUk1fSVNfSU5WQUxJRCk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAkKGZvcm0uaW5wdXRzKS5lYWNoKGZ1bmN0aW9uIChpbnB1dEluZGV4LCBpbnB1dCkge1xuXG4gICAgICAgIC8vZ2V0IHZhbGlkIGp1bXAgZGVzdGluYXRpb25zXG4gICAgICAgIHZhciBqdW1wX2Rlc3RpbmF0aW9ucyA9IHV0aWxzLmdldEp1bXBBdmFpbGFibGVEZXN0aW5hdGlvbnNBc0tleXMoaW5wdXRJbmRleCwgaW5wdXQsIGZvcm0uaW5wdXRzLCBmYWxzZSk7XG5cbiAgICAgICAgLy9leHRyYSB2YWxpZGF0aW9uIGZvciBqdW1wcywgY2hlY2sgaWYgdGhlIGRlc3RpbmF0aW9uIHN0aWxsIGV4aXN0cyBhbmQgaXQgaXMgdmFsaWRcbiAgICAgICAgJChpbnB1dC5qdW1wcykuZWFjaChmdW5jdGlvbiAoanVtcEluZGV4LCBqdW1wKSB7XG4gICAgICAgICAgICAvL2RvZXMgdGhlIGp1bXAgXCJ0b1wiIHByb3BlcnR5IHJlZmVyZW5jZSBhIHZhbGlkIGRlc3RpbmF0aW9uIGlucHV0P1xuICAgICAgICAgICAgaWYgKCFqdW1wX2Rlc3RpbmF0aW9uc1tqdW1wLnRvXSkge1xuICAgICAgICAgICAgICAgIC8vaW52YWxpZCBkZXN0aW5hdGlvbiBmb3VuZFxuICAgICAgICAgICAgICAgIGlzX3ZhbGlkX2Zvcm0gPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgJChpbnB1dC5icmFuY2gpLmVhY2goZnVuY3Rpb24gKGJyYW5jaElucHV0SW5kZXgsIGJyYW5jaF9pbnB1dCkge1xuXG4gICAgICAgICAgICBpZiAoIWJyYW5jaF9pbnB1dC5kb20uaXNfdmFsaWQpIHtcbiAgICAgICAgICAgICAgICBpc192YWxpZF9mb3JtID0gZmFsc2U7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGRlbGV0ZSBicmFuY2hfaW5wdXQuZG9tO1xuXG4gICAgICAgICAgICAvL3RvZG8gdmFsaWRhdGUgYnJhbmNoIGp1bXBzXG4gICAgICAgICAgICBqdW1wX2Rlc3RpbmF0aW9ucyA9IHV0aWxzLmdldEp1bXBBdmFpbGFibGVEZXN0aW5hdGlvbnNBc0tleXMoYnJhbmNoSW5wdXRJbmRleCwgYnJhbmNoX2lucHV0LCBpbnB1dC5icmFuY2gsIHRydWUpO1xuXG4gICAgICAgICAgICAvL2V4dHJhIHZhbGlkYXRpb24gZm9yIGp1bXBzLCBjaGVjayBpZiB0aGUgZGVzdGluYXRpb24gc3RpbGwgZXhpc3RzIGFuZCBpdCBpcyB2YWxpZFxuICAgICAgICAgICAgJChicmFuY2hfaW5wdXQuanVtcHMpLmVhY2goZnVuY3Rpb24gKGJyYW5jaEp1bXBJbmRleCwgYnJhbmNoSnVtcCkge1xuICAgICAgICAgICAgICAgIC8vZG9lcyB0aGUganVtcCBcInRvXCIgcHJvcGVydHkgcmVmZXJlbmNlIGEgdmFsaWQgZGVzdGluYXRpb24gaW5wdXQ/XG4gICAgICAgICAgICAgICAgaWYgKCFqdW1wX2Rlc3RpbmF0aW9uc1ticmFuY2hKdW1wLnRvXSkge1xuICAgICAgICAgICAgICAgICAgICAvL2ludmFsaWQgZGVzdGluYXRpb24gZm91bmRcbiAgICAgICAgICAgICAgICAgICAgaXNfdmFsaWRfZm9ybSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAkKGJyYW5jaF9pbnB1dC5ncm91cCkuZWFjaChmdW5jdGlvbiAoaW5kZXgsIGdyb3VwX2lucHV0KSB7XG5cbiAgICAgICAgICAgICAgICBpZiAoIWdyb3VwX2lucHV0LmRvbS5pc192YWxpZCkge1xuICAgICAgICAgICAgICAgICAgICBpc192YWxpZF9mb3JtID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGRlbGV0ZSBncm91cF9pbnB1dC5kb207XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgICQoaW5wdXQuZ3JvdXApLmVhY2goZnVuY3Rpb24gKGluZGV4LCBncm91cF9pbnB1dCkge1xuICAgICAgICAgICAgaWYgKCFncm91cF9pbnB1dC5kb20uaXNfdmFsaWQpIHtcbiAgICAgICAgICAgICAgICBpc192YWxpZF9mb3JtID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkZWxldGUgZ3JvdXBfaW5wdXQuZG9tO1xuICAgICAgICB9KTtcblxuICAgICAgICBpZiAoIWlucHV0LmRvbS5pc192YWxpZCkge1xuICAgICAgICAgICAgaXNfdmFsaWRfZm9ybSA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGRlbGV0ZSBpbnB1dC5kb207XG4gICAgfSk7XG5cbiAgICAvL3dyYXAgZm9ybSBpbiBcImRhdGEge31cIiBhY2NvcmRpbiB0byBqc29uIGFwaVxuICAgIGZvcm1Ub0V4cG9ydC5kYXRhLmlkID0gZm9ybS5yZWY7XG4gICAgZm9ybVRvRXhwb3J0LmRhdGEuZm9ybSA9IGZvcm07XG5cbiAgICBpZiAoaXNfdmFsaWRfZm9ybSkge1xuICAgICAgICAvL2RvIGV4cG9ydFxuXG4gICAgICAgIHZhciBmaWxlO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBmaWxlID0gbmV3IEZpbGUoW0pTT04uc3RyaW5naWZ5KGZvcm1Ub0V4cG9ydCldLCBmaWxlbmFtZSwgeyB0eXBlOiAndGV4dC9wbGFpbjpjaGFyc2V0PXV0Zi04JyB9KTtcbiAgICAgICAgICAgIHNhdmVBcyhmaWxlKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcblxuICAgICAgICAgICAgLy9NaWNyb3NvZnQgYnJvd3NlcnM/XG4gICAgICAgICAgIGlmKG5hdmlnYXRvci5tc1NhdmVCbG9iKSB7XG4gICAgICAgICAgICAgICByZXR1cm4gbmF2aWdhdG9yLm1zU2F2ZUJsb2IobmV3IEJsb2IoW0pTT04uc3RyaW5naWZ5KGZvcm1Ub0V4cG9ydCldLCB7IHR5cGU6ICd0ZXh0L3BsYWluOmNoYXJzZXQ9dXRmLTgnICB9KSwgZmlsZW5hbWUpO1xuICAgICAgICAgICB9XG4gICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgLy9icm93c2VyIG5vdCBzdXBwb3J0ZWQgeWV0XG4gICAgICAgICAgICAgICB0b2FzdC5zaG93RXJyb3IobWVzc2FnZXMuZXJyb3IuQlJPV1NFUl9OT1RfU1VQUE9SVEVEKTtcbiAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHRvYXN0LnNob3dFcnJvcihtZXNzYWdlcy5lcnJvci5GT1JNX0lTX0lOVkFMSUQpO1xuICAgIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gY2FsbGJhY2s7XG4iLCIvKiBnbG9iYWwgJCwgdG9hc3RyKi9cbid1c2Ugc3RyaWN0JztcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgbWVzc2FnZXMgPSByZXF1aXJlKCdjb25maWcvbWVzc2FnZXMnKTtcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJ2NvbmZpZy9mb3JtYnVpbGRlcicpO1xudmFyIHVpID0gcmVxdWlyZSgnaGVscGVycy91aScpO1xudmFyIHV0aWxzID0gcmVxdWlyZSgnaGVscGVycy91dGlscycpO1xudmFyIHZhbGlkYXRpb24gPSByZXF1aXJlKCdhY3Rpb25zL3ZhbGlkYXRpb24nKTtcbnZhciBmb3JtX2ZhY3RvcnkgPSByZXF1aXJlKCdmYWN0b3J5L2Zvcm0tZmFjdG9yeScpO1xuXG52YXIgY2FsbGJhY2sgPSBmdW5jdGlvbiAoZSkge1xuXG4gICAgdmFyIHRhcmdldCA9ICQodGhpcyk7XG4gICAgdmFyIGhyZWYgPSB0YXJnZXQuYXR0cignaHJlZicpO1xuICAgIHZhciBmb3JtX3JlZiA9IHRhcmdldC5hdHRyKCdocmVmJykuc3Vic3RyaW5nKDEsIGhyZWYubGVuZ3RoIC0gOSk7XG4gICAgdmFyIGZvcm1zID0gZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uLmRhdGEucHJvamVjdC5mb3JtcztcbiAgICB2YXIgaW5wdXRzO1xuICAgIHZhciBpc19sYXN0X2NoaWxkX2Zvcm07XG4gICAgdmFyIGFjdGl2ZV9pbnB1dDtcblxuXG4gICAgLy9pZ25vcmUgY2xpY2tzIG9uIGFjdGl2ZSB0YWJcbiAgICBpZiAodGFyZ2V0LnBhcmVudCgpLmhhc0NsYXNzKCdhY3RpdmUnKSkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy92YWxpZGF0ZSBhY3RpdmUgaW5wdXQgKGlmIGFueSkgYmVmb3JlIHN3aXRjaGluZ1xuICAgIGlmIChmb3JtYnVpbGRlci5jdXJyZW50X2lucHV0X3JlZikge1xuICAgICAgICBhY3RpdmVfaW5wdXQgPSB1dGlscy5nZXRJbnB1dE9iamVjdEJ5UmVmKGZvcm1idWlsZGVyLmN1cnJlbnRfaW5wdXRfcmVmKTtcbiAgICB9XG5cbiAgICAvL3ZhbGlkYXRlIHByZXZpb3VzIGlucHV0IChpZiBhbnksIEkgbWlnaHQgaGF2ZSBvbmx5IG9uZSBsZWZ0KSB3aGVuIHVzZXIgZ29lcyB0byBhbm90aGVyIGlucHV0LCBidXQgZG8gbm90IHNob3cgdG9hc3RcbiAgICBpZiAoYWN0aXZlX2lucHV0KSB7XG4gICAgICAgIHZhbGlkYXRpb24ucGVyZm9ybVZhbGlkYXRpb24oYWN0aXZlX2lucHV0LCBmYWxzZSk7XG4gICAgfVxuXG4gICAgLy91bmJpbmQgY3VycmVudCBwYW5lbCBoYW5kbGVycyBiZWZvcmUgc3dpdGNoaW5nXG4gICAgZm9ybV9mYWN0b3J5LnVuYmluZEZvcm1QYW5lbHNFdmVudHMoKTtcblxuICAgIC8vdXBkYXRlIGZvcm1idWlsZGVyIGRvbSByZWZlcmVuY2VzIHRvIHBvaW50IHRvIHRoZSBzZWxlY3RlZCBmb3JtIG1hcmt1cFxuICAgIGZvcm1fZmFjdG9yeS51cGRhdGVGb3JtYnVpbGRlckRvbVJlZmVyZW5jZXMoZm9ybV9yZWYpO1xuXG4gICAgLy9iaW5kIGV2ZW50cyB0byBhY3RpdmUgZm9ybVxuICAgIGZvcm1fZmFjdG9yeS5iaW5kRm9ybVBhbmVsc0V2ZW50cygpO1xuXG4gICAgLy9nZXQgYWN0aXZlIGlucHV0IGZvciB0aGUgc2VsZWN0ZWQgZm9ybSAoaWYgYW55KVxuICAgIHZhciBhY3RpdmVfaW5wdXRfcmVmID0gZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uX3NvcnRhYmxlLmZpbmQoJy5hY3RpdmUnKS5hdHRyKCdkYXRhLWlucHV0LXJlZicpO1xuXG4gICAgLy9zd2l0Y2ggZm9ybSB0byBzZWxlY3RlZCBvbmVcbiAgICBmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXggPSBwYXJzZUludCh0YXJnZXQuYXR0cignZGF0YS1mb3JtLWluZGV4JyksIDEwKTtcbiAgICBmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1fcmVmID0gZm9ybXNbZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4XS5yZWY7XG5cbiAgICAvL3JlbW92ZSBhbnkgcmVmZXJlbmNlIHRvIHNlbGVjdGVkIGlucHV0XG4gICAgLy90b2RvIGNoZWNrIHRoaXMgYXMgd2UgbWlnaHQgbmVlZCB0byBydW4gYSB2YWxpZGF0aW9uIGJlZm9yZSBzd2l0Y2hpbmcgdGFiXG4gICAgZm9ybWJ1aWxkZXIuY3VycmVudF9pbnB1dF9yZWYgPSBhY3RpdmVfaW5wdXRfcmVmO1xuXG4gICAgaXNfbGFzdF9jaGlsZF9mb3JtID0gZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4ID09PSBmb3Jtcy5sZW5ndGggLSAxO1xuICAgIC8vZW5hYmxlIGRlbGV0ZSBidXR0b24gaWYgdGhlIGFjdGl2ZSBjaGlsZCBmb3JtIGlzIHRoZSBsYXN0IGNoaWxkXG4gICAgaWYgKGlzX2xhc3RfY2hpbGRfZm9ybSkge1xuICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25cbiAgICAgICAgICAgIC5maW5kKCcuaW5wdXRzLWNvbGxlY3Rpb25fX2J1dHRvbnMtLXJlbW92ZS1mb3JtJylcbiAgICAgICAgICAgIC5hdHRyKCdkaXNhYmxlZCcsIGZhbHNlKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvblxuICAgICAgICAgICAgLmZpbmQoJy5pbnB1dHMtY29sbGVjdGlvbl9fYnV0dG9ucy0tcmVtb3ZlLWZvcm0nKVxuICAgICAgICAgICAgLmF0dHIoJ2Rpc2FibGVkJywgdHJ1ZSk7XG4gICAgfVxuXG4gICAgaW5wdXRzID0gZm9ybXNbZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4XS5pbnB1dHM7XG5cbiAgICAvL2lmIHRoZSBuZXcgYWN0aXZlIGZvcm0gZG9lcyBub3QgaGF2ZSBhIHRpdGxlIHNldCwgc2hvdyB3YXJuaW5nXG4gICAgLy9zaG93IG5vIHRpdGxlIHdhcm5pbmcgKGlmIG5vIHRpdGxlIHNldCBmb3IgdGhlIGZpcnN0IGZvcm0pXG4gICAgaWYgKHV0aWxzLmdldFRpdGxlQ291bnQoaW5wdXRzKSA9PT0gMCAmJiBpbnB1dHMubGVuZ3RoID4gMCkge1xuICAgICAgICB1aS5pbnB1dHNfY29sbGVjdGlvbi50b2dnbGVUaXRsZVdhcm5pbmcoMCwgZmFsc2UpO1xuICAgIH1cblxuICAgIC8vaWYgbm8gaW5wdXRzLCBkaXNhYmxlIGRvd25sb2FkIGZvcm0gYnV0dG9uXG4gICAgaWYgKGlucHV0cy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uXG4gICAgICAgICAgICAuZmluZCgnLmlucHV0cy1jb2xsZWN0aW9uX19leHBvcnQtZm9ybScpLmFkZENsYXNzKCdkaXNhYmxlZCcpO1xuXG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvblxuICAgICAgICAgICAgLmZpbmQoJy5pbnB1dHMtY29sbGVjdGlvbl9fcHJpbnQtYXMtcGRmJykuYWRkQ2xhc3MoJ2Rpc2FibGVkJyk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25cbiAgICAgICAgICAgIC5maW5kKCcuaW5wdXRzLWNvbGxlY3Rpb25fX2V4cG9ydC1mb3JtJykucmVtb3ZlQ2xhc3MoJ2Rpc2FibGVkJyk7XG5cbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uXG4gICAgICAgICAgICAuZmluZCgnLmlucHV0cy1jb2xsZWN0aW9uX19wcmludC1hcy1wZGYnKS5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTtcbiAgICB9XG5cbiAgICAvL3RvZ2dsZSBmb3JtIGljb24gdG8gYSBncmVlbiBjaGNrIGlmIHRoZSB0b3AgcGFyZW50IGZvcm0gaXMgdmFsaWRcbiAgICBpZiAodmFsaWRhdGlvbi5hcmVGb3JtSW5wdXRzVmFsaWQoZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4KSkge1xuICAgICAgICB1aS5mb3Jtc190YWJzLnNob3dGb3JtVmFsaWRJY29uKGZvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleCk7XG5cbiAgICAgICAgLy9lbmFibGUgZG93bmxvYWQgZm9ybSBidXR0b25cbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uXG4gICAgICAgICAgICAuZmluZCgnLmlucHV0cy1jb2xsZWN0aW9uX19leHBvcnQtZm9ybScpLnJlbW92ZUNsYXNzKCdkaXNhYmxlZCcpO1xuXG4gICAgICAgIC8vZW5hYmxlIHByaW50IGFzIHBkZiBmb3JtIGJ1dHRvblxuICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25cbiAgICAgICAgICAgIC5maW5kKCcuaW5wdXRzLWNvbGxlY3Rpb25fX3ByaW50LWFzLXBkZicpLnJlbW92ZUNsYXNzKCdkaXNhYmxlZCcpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgLy9kaXNhYmxlIGRvd25sb2FkIGZvcm0gYnV0dG9uXG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvblxuICAgICAgICAgICAgLmZpbmQoJy5pbnB1dHMtY29sbGVjdGlvbl9fZXhwb3J0LWZvcm0nKS5hZGRDbGFzcygnZGlzYWJsZWQnKTtcblxuICAgICAgICAvL2Rpc2FibGUgcHJpbnQgYXMgcGRmIGZvcm0gYnV0dG9uXG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvblxuICAgICAgICAgICAgLmZpbmQoJy5pbnB1dHMtY29sbGVjdGlvbl9fcHJpbnQtYXMtcGRmJykuYWRkQ2xhc3MoJ2Rpc2FibGVkJyk7XG4gICAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBjYWxsYmFjaztcbiIsIi8qIGdsb2JhbCAkLCB0b2FzdHIqL1xuJ3VzZSBzdHJpY3QnO1xudmFyIGNvbnN0cyA9IHJlcXVpcmUoJ2NvbmZpZy9jb25zdHMnKTtcbnZhciBtZXNzYWdlcyA9IHJlcXVpcmUoJ2NvbmZpZy9tZXNzYWdlcycpO1xudmFyIGZvcm1idWlsZGVyID0gcmVxdWlyZSgnY29uZmlnL2Zvcm1idWlsZGVyJyk7XG52YXIgdWkgPSByZXF1aXJlKCdoZWxwZXJzL3VpJyk7XG52YXIgdG9hc3QgPSByZXF1aXJlKCdjb25maWcvdG9hc3QnKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoJ2hlbHBlcnMvdXRpbHMnKTtcbnZhciB2YWxpZGF0aW9uID0gcmVxdWlyZSgnYWN0aW9ucy92YWxpZGF0aW9uJyk7XG52YXIgcGFyc2VyID0ge1xuICAgIGdldEJyYW5jaElucHV0c0hUTUw6IHJlcXVpcmUoJ2FjdGlvbnMvcGFyc2UvbWV0aG9kcy9nZXRCcmFuY2hJbnB1dHNIVE1MJyksXG4gICAgZ2V0R3JvdXBJbnB1dHNIVE1MOiByZXF1aXJlKCdhY3Rpb25zL3BhcnNlL21ldGhvZHMvZ2V0R3JvdXBJbnB1dHNIVE1MJyksXG4gICAgcmVuZGVySW5wdXRzOiByZXF1aXJlKCdhY3Rpb25zL3BhcnNlL21ldGhvZHMvcmVuZGVySW5wdXRzJyksXG4gICAgcmVuZGVyUHJvamVjdDogcmVxdWlyZSgnYWN0aW9ucy9wYXJzZS9tZXRob2RzL3JlbmRlclByb2plY3QnKSxcbiAgICByZW5kZXJDaGlsZEZvcm1zOiByZXF1aXJlKCdhY3Rpb25zL3BhcnNlL21ldGhvZHMvcmVuZGVyQ2hpbGRGb3JtcycpLFxuICAgIGluaXRGb3JtYnVpbGRlcjogcmVxdWlyZSgnYWN0aW9ucy9wYXJzZS9tZXRob2RzL2luaXRGb3JtYnVpbGRlcicpXG59O1xuXG52YXIgaW1wb3J0X2Zvcm1fdmFsaWRhdGlvbiA9IHJlcXVpcmUoJ2hlbHBlcnMvaW1wb3J0LWZvcm0tdmFsaWRhdGlvbicpO1xudmFyIHNhdmVfcHJvamVjdF9jbGlja19jYWxsYmFjayA9IHJlcXVpcmUoJ3VpLWhhbmRsZXJzL2V2ZW50LWhhbmRsZXItY2FsbGJhY2tzL3NhdmUtcHJvamVjdC1jbGljay1jYWxsYmFjaycpO1xuXG52YXIgY2FsbGJhY2sgPSBmdW5jdGlvbiAoZmlsZXMpIHtcblxuICAgIHZhciB1bmRvID0gcmVxdWlyZSgnYWN0aW9ucy91bmRvJyk7XG4gICAgdmFyIGZpbGUgPSBmaWxlc1swXTtcbiAgICB2YXIgZmlsZV9wYXJ0cztcbiAgICB2YXIgZmlsZV9leHQ7XG5cbiAgICAvL3Nob3cgb3ZlcmxheSBhbmQgY3Vyc29yXG4gICAgZm9ybWJ1aWxkZXIuZG9tLm92ZXJsYXkuZmFkZUluKGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG5cbiAgICAvL2lmIHRoZSB1c2VyIGNhbmNlbHMgdGhlIGFjdGlvblxuICAgIGlmICghZmlsZSkge1xuICAgICAgICAvL2hpZGUgb3ZlcmxheVxuICAgICAgICBmb3JtYnVpbGRlci5kb20ub3ZlcmxheS5mYWRlT3V0KGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG4gICAgICAgIHRvYXN0ci5lcnJvcihtZXNzYWdlcy5lcnJvci5GT1JNX0ZJTEVfSU5WQUxJRCk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBmaWxlX3BhcnRzID0gZmlsZS5uYW1lLnNwbGl0KCcuJyk7XG4gICAgZmlsZV9leHQgPSBmaWxlX3BhcnRzW2ZpbGVfcGFydHMubGVuZ3RoIC0gMV07XG5cbiAgICBjb25zb2xlLmxvZyhmaWxlKTtcblxuICAgIC8vaXQgbXVzdCBiZSBqc29uXG4gICAgaWYgKGZpbGVfZXh0ICE9PSBjb25zdHMuRk9STV9GSUxFX0VYVEVOU0lPTikge1xuICAgICAgICAvL2hpZGUgb3ZlcmxheVxuICAgICAgICBmb3JtYnVpbGRlci5kb20ub3ZlcmxheS5mYWRlT3V0KGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG4gICAgICAgIHRvYXN0ci5lcnJvcihtZXNzYWdlcy5lcnJvci5GT1JNX0ZJTEVfSU5WQUxJRCk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvL3RvZG8gc2tpcCBNSU1FIHR5cGUgdmFsaWRhdGlvbiBvbiB0aGUgZnJvbnQgZW5kIGFzIGl0IGlzIGEgbWVzc1xuICAgIC8vanNvbiBmb3JtYXQgYWNjb3JkaW5nIHRvIGVwaWNvbGxlY3Q1IGFwaVxuICAgIC8vaWYgKGZpbGUudHlwZSAhPT0gY29uc3RzLkZPUk1fRklMRV9BQ0NFUFRFRF9UWVBFKSB7XG4gICAgLy9oaWRlIG92ZXJsYXlcbiAgICAvLyAgICAgZm9ybWJ1aWxkZXIuZG9tLm92ZXJsYXkuZmFkZU91dChjb25zdHMuQU5JTUFUSU9OX0ZBU1QpO1xuICAgIC8vICAgICB0b2FzdHIuZXJyb3IobWVzc2FnZXMuZXJyb3IuRk9STV9GSUxFX0lOVkFMSUQpO1xuICAgIC8vICAgICByZXR1cm47XG4gICAgLy8gfVxuXG4gICAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XG5cbiAgICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24gKGUpIHtcblxuICAgICAgICB2YXIganNvbl90ZXh0ID0gZS50YXJnZXQucmVzdWx0O1xuICAgICAgICB2YXIgZm9ybTtcbiAgICAgICAgdmFyIGN1cnJlbnRfZm9ybV9yZWY7XG4gICAgICAgIHZhciBpbXBvcnRlZF9mb3JtX3JlZjtcbiAgICAgICAgdmFyIHJlZ2V4O1xuICAgICAgICB2YXIgaW5wdXRzO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgZm9ybSA9IEpTT04ucGFyc2UoanNvbl90ZXh0KTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIC8vaGlkZSBvdmVybGF5XG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20ub3ZlcmxheS5mYWRlT3V0KGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG4gICAgICAgICAgICAvL2l0IG1lYW5zIHRoZSBqc29uIGlzIGluIGludmFsaWQgZm9ybWF0XG4gICAgICAgICAgICB0b2FzdHIuZXJyb3IobWVzc2FnZXMuZXJyb3IuRk9STV9GSUxFX0lOVkFMSUQpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cblxuICAgICAgICAvL3ZhbGlkYXRlIGZvcm0gc3RydWN0dXJlXG4gICAgICAgIGlmICghaW1wb3J0X2Zvcm1fdmFsaWRhdGlvbi5oYXNWYWxpZEZvcm1TdHJ1Y3R1cmUoZm9ybSkpIHtcbiAgICAgICAgICAgIC8vaGlkZSBvdmVybGF5XG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20ub3ZlcmxheS5mYWRlT3V0KGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG4gICAgICAgICAgICAvL2l0IG1lYW5zIHRoZSBzdHJ1Y3R1cmUgaXMgaW52YWxpZFxuICAgICAgICAgICAgdG9hc3RyLmVycm9yKG1lc3NhZ2VzLmVycm9yLkZPUk1fRklMRV9JTlZBTElEKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vZ3JhYiBpbnB1dHNcbiAgICAgICAgaW5wdXRzID0gZm9ybS5kYXRhLmZvcm0uaW5wdXRzO1xuXG4gICAgICAgIC8vYXJlIHRoZXJlIGFueSBpbnB1dHM/XG4gICAgICAgIGlmIChpbnB1dHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20ub3ZlcmxheS5mYWRlT3V0KGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG4gICAgICAgICAgICB0b2FzdHIuZXJyb3IobWVzc2FnZXMuZXJyb3IuRk9STV9GSUxFX0lOVkFMSUQpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9pcyBpbnB1dHMgYXJyYXk/XG4gICAgICAgIGlmICghJC5pc0FycmF5KGlucHV0cykpIHtcbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5vdmVybGF5LmZhZGVPdXQoY29uc3RzLkFOSU1BVElPTl9GQVNUKTtcbiAgICAgICAgICAgIHRvYXN0ci5lcnJvcihtZXNzYWdlcy5lcnJvci5GT1JNX0ZJTEVfSU5WQUxJRCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgYXJlX3ZhbGlkX2lucHV0cyA9IHRydWU7XG4gICAgICAgICAgICAkKGlucHV0cykuZWFjaChmdW5jdGlvbiAoaW5kZXgsIGlucHV0KSB7XG4gICAgICAgICAgICAgICAgaWYgKCFpbXBvcnRfZm9ybV92YWxpZGF0aW9uLmlzVmFsaWRJbnB1dChmb3JtLmRhdGEuZm9ybS5yZWYsIGlucHV0LCBmYWxzZSwgZmFsc2UpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGlucHV0KTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkoaW5wdXQpKTtcbiAgICAgICAgICAgICAgICAgICAgYXJlX3ZhbGlkX2lucHV0cyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGlmICghYXJlX3ZhbGlkX2lucHV0cykge1xuICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5vdmVybGF5LmZhZGVPdXQoY29uc3RzLkFOSU1BVElPTl9GQVNUKTtcbiAgICAgICAgICAgICAgICB0b2FzdHIuZXJyb3IobWVzc2FnZXMuZXJyb3IuRk9STV9GSUxFX0lOVkFMSUQpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy9jaGVjayB0b3RhbCBudW1iZXIgb2YgcXVlc3Rpb25zL2JyYW5jaGVzXG4gICAgICAgICAgICBpZiAodXRpbHMuZ2V0SW5wdXRzVG90YWwoaW5wdXRzKSA+IGNvbnN0cy5JTlBVVFNfTUFYX0FMTE9XRUQpIHtcbiAgICAgICAgICAgICAgICAvL2hpZGUgb3ZlcmxheVxuICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5vdmVybGF5LmZhZGVPdXQoY29uc3RzLkFOSU1BVElPTl9GQVNUKTtcbiAgICAgICAgICAgICAgICB0b2FzdHIuZXJyb3IobWVzc2FnZXMuZXJyb3IuRk9STV9GSUxFX0lOVkFMSUQpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy9jaGVjayB0b3RhbCBudW1iZXIgb2YgdGl0bGVzIChtYWluIGZvcm0pXG4gICAgICAgICAgICBpZiAodXRpbHMuaXNNYXhUaXRsZUxpbWl0RXhjZWVkZWQoaW5wdXRzKSkge1xuICAgICAgICAgICAgICAgIC8vaGlkZSBvdmVybGF5XG4gICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLm92ZXJsYXkuZmFkZU91dChjb25zdHMuQU5JTUFUSU9OX0ZBU1QpO1xuICAgICAgICAgICAgICAgIHRvYXN0ci5lcnJvcihtZXNzYWdlcy5lcnJvci5GT1JNX0ZJTEVfSU5WQUxJRCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy9jaGVjayB0b3RhbCBudW1iZXIgb2YgdGl0bGVzIChicmFuY2hlcylcbiAgICAgICAgICAgIHZhciBhcmVfYnJhbmNoX2lucHV0c192YWxpZCA9IHRydWU7XG4gICAgICAgICAgICAkKGlucHV0cykuZWFjaChmdW5jdGlvbiAoaW5kZXgsIGlucHV0KSB7XG4gICAgICAgICAgICAgICAgaWYgKHV0aWxzLmlzTWF4VGl0bGVMaW1pdEV4Y2VlZGVkKGlucHV0LmJyYW5jaCkpIHtcbiAgICAgICAgICAgICAgICAgICAgYXJlX2JyYW5jaF9pbnB1dHNfdmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpZiAoIWFyZV9icmFuY2hfaW5wdXRzX3ZhbGlkKSB7XG4gICAgICAgICAgICAgICAgLy9oaWRlIG92ZXJsYXlcbiAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5kb20ub3ZlcmxheS5mYWRlT3V0KGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG4gICAgICAgICAgICAgICAgdG9hc3RyLmVycm9yKG1lc3NhZ2VzLmVycm9yLkZPUk1fRklMRV9JTlZBTElEKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vY2hlY2sganVtcHMgZGVzdGluYXRpb25zXG4gICAgICAgICAgICBpZiAoIWltcG9ydF9mb3JtX3ZhbGlkYXRpb24uYXJlSnVtcHNEZXN0aW5hdGlvbnNWYWxpZChpbnB1dHMpKSB7XG4gICAgICAgICAgICAgICAgLy9oaWRlIG92ZXJsYXlcbiAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5kb20ub3ZlcmxheS5mYWRlT3V0KGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG4gICAgICAgICAgICAgICAgdG9hc3RyLmVycm9yKG1lc3NhZ2VzLmVycm9yLkZPUk1fRklMRV9JTlZBTElEKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvL3dlIG5lZWQgdG8gdXNlIHRoZSBjdXJyZW50IGZvcm0gcmVmXG4gICAgICAgIGN1cnJlbnRfZm9ybV9yZWYgPSBmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1fcmVmO1xuICAgICAgICBpbXBvcnRlZF9mb3JtX3JlZiA9IGZvcm0uZGF0YS5mb3JtLnJlZjtcbiAgICAgICAgcmVnZXggPSBuZXcgUmVnRXhwKGltcG9ydGVkX2Zvcm1fcmVmLCAnZycpO1xuXG4gICAgICAgIC8vcmVwbGFjZSBpbXBvcnRlZCBmb3JtIHJlZiB3aXRoIGN1cnJlbnQgZm9ybSByZWYoYWxsIG9jY3VycnJlbmNlcylcbiAgICAgICAganNvbl90ZXh0ID0ganNvbl90ZXh0LnJlcGxhY2UocmVnZXgsIGN1cnJlbnRfZm9ybV9yZWYpO1xuICAgICAgICBmb3JtID0gSlNPTi5wYXJzZShqc29uX3RleHQpO1xuXG4gICAgICAgIC8vIHRlbXBvcmFybHkgc2V0dXAgaW5wdXRzIHdpdGggdGhlIGN1cnJlbnRfZm9ybV9yZWYgaW4gZm9ybWJ1aWxkZXIgZ2xvYmFsIG9iamVjdCAoc28gaXQgY2FuIHBhc3MganVtcCBkZXN0aW5hdGlvbnMgdmFsaWRhdGlvbiB3aGVuIHBhcnNpbmcsIGFuZCBhbHNvIHRvIHJlbmRlciBqdW1wcyBwcm9wZXJseSBpbiB0aGUgZG9tKVxuICAgICAgICBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0LmZvcm1zW2Zvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleF1cbiAgICAgICAgICAgIC5pbnB1dHMgPSBmb3JtLmRhdGEuZm9ybS5pbnB1dHMuc2xpY2UoKTtcblxuICAgICAgICAvL3BhcnNlIHRoZSBmb3JtIGFuZCBhZGQgdGhlIG1hcmt1cCB0aGVuLlxuICAgICAgICB2YXIgcmVuZGVyZWRJbnB1dHMgPSBwYXJzZXIucmVuZGVySW5wdXRzKGZvcm0uZGF0YS5mb3JtLmlucHV0cyk7XG5cbiAgICAgICAgLy9yZW1vdmUgbm8gcXVlc3Rpb25zIG1lc3NhZ2UgKGlmIGFueSBpbnB1dHMpXG4gICAgICAgIGlmIChyZW5kZXJlZElucHV0cy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb24uZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX25vLXF1ZXN0aW9ucy1tZXNzYWdlJykuYWRkQ2xhc3MoJ2hpZGRlbicpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9zaG93IG5vIHRpdGxlIHdhcm5pbmcgKGlmIG5vIHRpdGxlIHNldCBmb3IgdGhlIGZpcnN0IGZvcm0pXG4gICAgICAgIGlmICh1dGlscy5nZXRUaXRsZUNvdW50KHJlbmRlcmVkSW5wdXRzKSA9PT0gMCkge1xuICAgICAgICAgICAgdWkuaW5wdXRzX2NvbGxlY3Rpb24udG9nZ2xlVGl0bGVXYXJuaW5nKDAsIGZhbHNlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vdG9nZ2xlIGZvcm0gaWNvbiB0byBhIGdyZWVuIGNoZWNrIGlmIHRoZSB0b3AgcGFyZW50IGZvcm0gaXMgdmFsaWRcbiAgICAgICAgaWYgKHZhbGlkYXRpb24uYXJlRm9ybUlucHV0c1ZhbGlkKGZvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleCkpIHtcbiAgICAgICAgICAgIHVpLmZvcm1zX3RhYnMuc2hvd0Zvcm1WYWxpZEljb24oZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4KTtcbiAgICAgICAgICAgIC8vZW5hYmxlIGRvd25sb2FkIGZvcm0gYnV0dG9uXG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25cbiAgICAgICAgICAgICAgICAuZmluZCgnLmlucHV0cy1jb2xsZWN0aW9uX19leHBvcnQtZm9ybScpLnJlbW92ZUNsYXNzKCdkaXNhYmxlZCcpO1xuXG4gICAgICAgICAgICAvL2VuYWJsZSBwcmludCBhcyBwZGYgZm9ybSBidXR0b25cbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvblxuICAgICAgICAgICAgICAgIC5maW5kKCcuaW5wdXRzLWNvbGxlY3Rpb25fX3ByaW50LWFzLXBkZicpLnJlbW92ZUNsYXNzKCdkaXNhYmxlZCcpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9yZXBsYWNlIG9iamVjdCBsaXRlcmFsIGlucHV0cyB3aXRoIG5ld2x5IGdlbmVyYXRlZCBvbmVzIHZpYSBmYWN0b3J5IChpLmUuIHVzaW5nIG5ldykgc28gdGhleSBnZXQgdGhlIHByb3RvdHlwZVxuICAgICAgICBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0LmZvcm1zW2Zvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleF0uaW5wdXRzID0gcmVuZGVyZWRJbnB1dHMuc2xpY2UoKTsvL2J5IHZhbHVlXG5cblxuICAgICAgICAvL2VuYWJsZSBzYXZlIHByb2plY3QgYnV0dG9uIGlmIGFsbCBpbnB1dHMgYXJlIHZhbGlkXG4gICAgICAgIGlmICh2YWxpZGF0aW9uLmFyZUFsbElucHV0c1ZhbGlkKGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbikpIHtcblxuICAgICAgICAgICAgLy9lbmFibGUgc2F2ZSBwcm9qZWN0IGJ1dHRvbiAoaWYgZGlzYWJsZWQpXG4gICAgICAgICAgICB1aS5uYXZiYXIudG9nZ2xlU2F2ZVByb2plY3RCdG4oY29uc3RzLkJUTl9FTkFCTEVEKTtcblxuICAgICAgICAgICAgLy9yZXNldCBzb21lIGZsYWdzXG4gICAgICAgICAgICBmb3JtYnVpbGRlci5jdXJyZW50X2lucHV0X3JlZiA9IG51bGw7IC8vbm8gaW5wdXQgaXMgc2VsZWN0ZWRcblxuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLnNhdmVfcHJvamVjdF9idG4ub2ZmKCkub24oJ2NsaWNrJywgc2F2ZV9wcm9qZWN0X2NsaWNrX2NhbGxiYWNrKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vaWYgdGhlcmUgYXJlIHRvbyBtYW55IHNlYXJjaCBpbnB1dHMsIGhpZGUgdGhlIHNlYXJjaCBpbnB1dCB0b29sIGluIHRoZSBzaWRlYmFyXG4gICAgICAgIGlmICh1dGlscy5nZXRTZWFyY2hJbnB1dHNUb3RhbCgpID49IGNvbnN0cy5MSU1JVFMuc2VhcmNoX2lucHV0c19tYXgpIHtcbiAgICAgICAgICAgIHVpLmlucHV0X3Rvb2xzLmhpZGVTZWFyY2hJbnB1dCgpO1xuXG4gICAgICAgICAgICAvL2Fsc28gc2hvdyB3YXJuaW5nXG4gICAgICAgICAgICAvL3Nob3cgd2FybmluZyB0byB1c2VyXG4gICAgICAgICAgICB0b2FzdC5zaG93V2FybmluZyhtZXNzYWdlcy53YXJuaW5nLlNFQVJDSF9JTlBVVFNfTElNSVRfUkVBQ0hFRCArICcoJyArIGNvbnN0cy5MSU1JVFMuc2VhcmNoX2lucHV0c19tYXggKyAnKScpO1xuICAgICAgICB9XG5cbiAgICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgLy9oaWRlIG92ZXJsYXlcbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5vdmVybGF5LmZhZGVPdXQoY29uc3RzLkFOSU1BVElPTl9TTE9XKTtcbiAgICAgICAgICAgIC8vc2hvdyBzdWNjZXNzIHRvYXN0XG4gICAgICAgICAgICB0b2FzdHIuc3VjY2VzcyhtZXNzYWdlcy5zdWNjZXNzLkZPUk1fSU1QT1JURUQpO1xuICAgICAgICAgICAgLy9wdXNoIHN0YXRlIGZvciB1bmRvXG4gICAgICAgICAgICB1bmRvLnB1c2hTdGF0ZSgpO1xuICAgICAgICB9LCBjb25zdHMuQU5JTUFUSU9OX1NMT1cpO1xuICAgIH07XG5cbiAgICByZWFkZXIucmVhZEFzVGV4dChmaWxlKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gY2FsbGJhY2s7XG4iLCIvKiBnbG9iYWwgJCwgdG9hc3RyKi9cbid1c2Ugc3RyaWN0JztcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgdWkgPSByZXF1aXJlKCdoZWxwZXJzL3VpJyk7XG52YXIgdXRpbHMgPSByZXF1aXJlKCdoZWxwZXJzL3V0aWxzJyk7XG52YXIgbWVzc2FnZXMgPSByZXF1aXJlKCdjb25maWcvbWVzc2FnZXMnKTtcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJ2NvbmZpZy9mb3JtYnVpbGRlcicpO1xudmFyIHNhdmUgPSByZXF1aXJlKCdhY3Rpb25zL3NhdmUnKTtcbnZhciB2YWxpZGF0aW9uID0gcmVxdWlyZSgnYWN0aW9ucy92YWxpZGF0aW9uJyk7XG52YXIgcG9zc2libGVBbnN3ZXJzU29ydGFibGUgPSByZXF1aXJlKCd1aS1oYW5kbGVycy9wb3NzaWJsZS1hbnN3ZXJzLXNvcnRhYmxlJyk7XG52YXIgcG9zc2libGVfYW5zd2Vyc19wYWdlciA9IHJlcXVpcmUoJ2FjdGlvbnMvcG9zc2libGUtYW5zd2Vycy1wYWdlcicpO1xuXG5cbnZhciBjYWxsYmFjayA9IGZ1bmN0aW9uIChlKSB7XG5cbiAgICBjb25zb2xlLmxvZygnY2FsbGVkIGJyYW5jaC1zb3J0YWJsZS1tb3VzZWRvd24nKTtcblxuICAgIHZhciBzZWxmID0gJCh0aGlzKTtcbiAgICB2YXIgcmVmID0gc2VsZi5hdHRyKCdkYXRhLWlucHV0LXJlZicpO1xuICAgIHZhciBicmFuY2hfaW5wdXQgPSB1dGlscy5nZXRCcmFuY2hJbnB1dE9iamVjdEJ5UmVmKHJlZik7XG4gICAgdmFyIHByZXZpb3VzX2JyYW5jaF9pbnB1dCA9IHV0aWxzLmdldEJyYW5jaElucHV0T2JqZWN0QnlSZWYoZm9ybWJ1aWxkZXIuYnJhbmNoLmN1cnJlbnRfaW5wdXRfcmVmKTtcbiAgICB2YXIgYnJhbmNoX2lucHV0cyA9IHV0aWxzLmdldElucHV0T2JqZWN0QnlSZWYoZm9ybWJ1aWxkZXIuY3VycmVudF9pbnB1dF9yZWYpLmJyYW5jaDtcbiAgICB2YXIgcXVlc3Rpb247XG5cbiAgICAvL2JyYW5jaF9pbnB1dC5kb20ucHJvcGVydGllc19wYW5lbCA9IGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXIuZmluZCgnZm9ybVtkYXRhLWlucHV0LXJlZj1cIicgKyByZWYgKyAnXCJdJyk7XG5cbiAgICAvKlxuICAgICBpZiBib3RoIHRoZSBlZGl0aW5nIGJyYW5jaCBmbGFnIGFuZCB0aGUgZWRpdGluZyBncm91cCBmbGFnIGFyZSBzZXQsIHdlIGFyZSBleGl0aW5nIGEgbmVzdGVkIGdyb3VwXG4gICAgICovXG4gICAgaWYgKGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfYnJhbmNoICYmIGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfZ3JvdXApIHtcbiAgICAgICAgLy93ZSBhcmUgaW4gbmVzdGVkIGdyb3VwIGVkaXQgbW9kZSwgZXhpdCBpcyB0aGUgb25seSBhY3Rpb24gd2UgbmVlZCB0byBpbnRlcmNlcHRcbiAgICAgICAgaWYgKHNlbGYuaGFzQ2xhc3MoJ2ZhLWNoZXZyb24tbGVmdCcpKSB7XG5cbiAgICAgICAgICAgIC8vZ2V0IGFjdGl2ZSBuZXN0ZWQgZ3JvdXAgd2UgYXJlIGV4aXRpbmcgZnJvbVxuICAgICAgICAgICAgdmFyIGlucHV0ID0gdXRpbHMuZ2V0QnJhbmNoSW5wdXRPYmplY3RCeVJlZihmb3JtYnVpbGRlci5icmFuY2guY3VycmVudF9pbnB1dF9yZWYpO1xuXG4gICAgICAgICAgICAvL2V4aXQgbmVzdGVkIGdyb3VwIGVkaXRpbmdcbiAgICAgICAgICAgIGlucHV0LmV4aXROZXN0ZWRHcm91cFNvcnRhYmxlKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSB7XG5cbiAgICAgICAgLy9kZWFjdGl2YXRlIGFsbCBpbnB1dHMgaW4gYWN0aXZlIGJyYW5jaCBzb3J0YWJsZSBjb2xsZWN0aW9uXG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbl9zb3J0YWJsZS5maW5kKCcuYWN0aXZlLWJyYW5jaCAuYnJhbmNoLXNvcnRhYmxlJykuZmluZCgnLmFjdGl2ZScpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcbiAgICAgICAgLy9hY3RpdmF0ZSBuZXcgY2xpY2tlZCBlbGVtZW50XG4gICAgICAgIHNlbGYuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuXG4gICAgICAgIC8vdmFsaWRhdGUgcHJldmlvdXMgaW5wdXQgKGlmIGFueSwgSSBtaWdodCBoYXZlIG9ubHkgb25lIGxlZnQpIHdoZW4gdXNlciBnb2VzIHRvIGFub3RoZXIgaW5wdXQsIGJ1dCBkbyBub3Qgc2hvdyB0b2FzdFxuICAgICAgICBpZiAocHJldmlvdXNfYnJhbmNoX2lucHV0KSB7XG4gICAgICAgICAgICB2YWxpZGF0aW9uLnBlcmZvcm1WYWxpZGF0aW9uKHByZXZpb3VzX2JyYW5jaF9pbnB1dCwgZmFsc2UpO1xuICAgICAgICB9XG5cbiAgICAgICAgLypcbiAgICAgICAgIHNob3cgcHJvcGVydGllcyBmb3IgdGhlIHNlbGVjdGVkIGlucHV0IGluIHByb3BlcnRpZXMgcGFuZWxcbiAgICAgICAgICovXG5cbiAgICAgICAgaWYgKCFicmFuY2hfaW5wdXQucXVlc3Rpb24pIHtcbiAgICAgICAgICAgIC8vZW1wdHkgcXVlc3Rpb24gdGV4dD8gc2hvdyB3YXJuaW5nXG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllcy5maW5kKCcucGFuZWwtdGl0bGUgc3Bhbi5xdWVzdGlvbi1wcmV2aWV3JykudGV4dChtZXNzYWdlcy5lcnJvci5OT19RVUVTVElPTl9URVhUX1lFVCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG5cbiAgICAgICAgICAgIC8vc3RyaXAgaHRtbCB0YWdzIGZyb20gcmVhZG1lIHR5cGUgaWYgYW55XG4gICAgICAgICAgICBpZiAoYnJhbmNoX2lucHV0LnR5cGUgPT09IGNvbnN0cy5SRUFETUVfVFlQRSkge1xuICAgICAgICAgICAgICAgIHF1ZXN0aW9uID0gdXRpbHMuZGVjb2RlSHRtbChicmFuY2hfaW5wdXQucXVlc3Rpb24pO1xuICAgICAgICAgICAgICAgIHF1ZXN0aW9uID0gcXVlc3Rpb24ucmVwbGFjZSgvKDwoW14+XSspPikvaWcsICcgJyk7XG4gICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXMuZmluZCgnLnBhbmVsLXRpdGxlIHNwYW4ucXVlc3Rpb24tcHJldmlldycpLnRleHQocXVlc3Rpb24udHJ1bmMoMjApKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzLmZpbmQoJy5wYW5lbC10aXRsZSBzcGFuLnF1ZXN0aW9uLXByZXZpZXcnKS50ZXh0KGJyYW5jaF9pbnB1dC5xdWVzdGlvbi50cnVuYygyMCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy90b2dnbGUgdGl0bGUgYmFzZSBvbiBudW1iZXIgb2YgdGl0bGVzIHNlbGVjdGVkIHdpdGhpbiB0aGlzIGJyYW5jaCAoYnV0IG9ubHkgaWYgbm90IGNoZWNrZWQpXG4gICAgICAgIGlmICh1dGlscy5pc01heFRpdGxlTGltaXRSZWFjaGVkKGJyYW5jaF9pbnB1dHMpKSB7XG4gICAgICAgICAgICBpZiAoIWJyYW5jaF9pbnB1dC5pc190aXRsZSkge1xuICAgICAgICAgICAgICAgIHVpLmlucHV0X3Byb3BlcnRpZXNfcGFuZWwudG9nZ2xlVGl0bGVDaGVja2JveChjb25zdHMuRElTQUJMRURfU1RBVEUsIHJlZik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB1aS5pbnB1dF9wcm9wZXJ0aWVzX3BhbmVsLnRvZ2dsZVRpdGxlQ2hlY2tib3goY29uc3RzLkVOQUJMRURfU1RBVEUsIHJlZik7XG5cbiAgICAgICAgfVxuXG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzLmZpbmQoJy5wYW5lbC1ib2R5IGZvcm0nKS5oaWRlKCk7XG4gICAgICAgIC8vIC8vZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXMuZmluZCgnLnBhbmVsLWJvZHkgZm9ybVtkYXRhLWlucHV0LXJlZj1cIicgKyByZWYgKyAnXCJdJyk7XG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzLmZpbmQoJy5wYW5lbC1ib2R5IGZvcm1bZGF0YS1pbnB1dC1yZWY9XCInICsgcmVmICsgJ1wiXScpLnJlbW92ZUNsYXNzKCdoaWRkZW4nKS5mYWRlSW4oY29uc3RzLkFOSU1BVElPTl9OT1JNQUwpO1xuXG4gICAgICAgIC8vaGlkZSAnbm8gaW5wdXRzIHNlbGVjdGVkIGJ1dHRvbnMnXG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXIuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX25vLWlucHV0LXNlbGVjdGVkJykuaGlkZSgpO1xuXG4gICAgICAgIC8vaWYgdGhlIGlucHV0IHR5cGUgaGFzIHBvc3NpYmxlIGFuc3dlcnMsIHNob3cgcGFnZXIgaWYgbmVlZGVkXG4gICAgICAgIGlmICgkLmluQXJyYXkoYnJhbmNoX2lucHV0LnR5cGUsIGNvbnN0cy5NVUxUSVBMRV9BTlNXRVJfVFlQRVMpID4gLTEpIHtcbiAgICAgICAgICAgIGlmIChicmFuY2hfaW5wdXQucG9zc2libGVfYW5zd2Vycy5sZW5ndGggPiBjb25zdHMuTElNSVRTLnBvc3NpYmxlX2Fuc3dlcnNfcGVyX3BhZ2UpIHtcbiAgICAgICAgICAgICAgICAvL3Nob3cgcGFnaW5hdGlvblxuICAgICAgICAgICAgICAgIHBvc3NpYmxlX2Fuc3dlcnNfcGFnZXIuaW5pdChicmFuY2hfaW5wdXQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcG9zc2libGVfYW5zd2Vyc19wYWdlci50ZWFyRG93bihicmFuY2hfaW5wdXQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy9zaG93IHNhdmUvZGVsZXRlIGJ0bnNcbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfYnV0dG9ucy5mYWRlSW4oY29uc3RzLkFOSU1BVElPTl9GQVNUKTtcbiAgICAgICAgZm9ybWJ1aWxkZXIuYnJhbmNoLmN1cnJlbnRfaW5wdXRfcmVmID0gcmVmO1xuXG4gICAgICAgIC8vZW5hYmxlIHNvcnRhYmxlIG9uIGN1cnJlbnQgaW5wdXRcbiAgICAgICAgcG9zc2libGVBbnN3ZXJzU29ydGFibGUoYnJhbmNoX2lucHV0KTtcbiAgICB9XG5cbiAgICBpZiAoYnJhbmNoX2lucHV0LnR5cGUgPT09IGNvbnN0cy5SRUFETUVfVFlQRSkge1xuICAgICAgICAkKCcuc3VtbWVybm90ZScpLnN1bW1lcm5vdGUoY29uc3RzLlNVTU1FUk5PVEVfT1BUSU9OUyk7XG4gICAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBjYWxsYmFjaztcbiIsIi8qIGdsb2JhbCAkLCB0b2FzdHIqL1xuJ3VzZSBzdHJpY3QnO1xudmFyIGNvbnN0cyA9IHJlcXVpcmUoJ2NvbmZpZy9jb25zdHMnKTtcbnZhciB1aSA9IHJlcXVpcmUoJ2hlbHBlcnMvdWknKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoJ2hlbHBlcnMvdXRpbHMnKTtcbnZhciBtZXNzYWdlcyA9IHJlcXVpcmUoJ2NvbmZpZy9tZXNzYWdlcycpO1xudmFyIGZvcm1idWlsZGVyID0gcmVxdWlyZSgnY29uZmlnL2Zvcm1idWlsZGVyJyk7XG52YXIgc2F2ZSA9IHJlcXVpcmUoJ2FjdGlvbnMvc2F2ZScpO1xudmFyIHZhbGlkYXRpb24gPSByZXF1aXJlKCdhY3Rpb25zL3ZhbGlkYXRpb24nKTtcbnZhciBwb3NzaWJsZUFuc3dlcnNTb3J0YWJsZSA9IHJlcXVpcmUoJ3VpLWhhbmRsZXJzL3Bvc3NpYmxlLWFuc3dlcnMtc29ydGFibGUnKTtcbnZhciBwb3NzaWJsZV9hbnN3ZXJzX3BhZ2VyID0gcmVxdWlyZSgnYWN0aW9ucy9wb3NzaWJsZS1hbnN3ZXJzLXBhZ2VyJyk7XG5cbnZhciBjYWxsYmFjayA9IGZ1bmN0aW9uIChlKSB7XG5cbiAgICBjb25zb2xlLmxvZygnY2FsbGVkIGdyb3VwLXNvcnRhYmxlLW1vdXNlZG93bicpO1xuXG4gICAgdmFyIHNlbGYgPSAkKHRoaXMpO1xuICAgIHZhciByZWYgPSBzZWxmLmF0dHIoJ2RhdGEtaW5wdXQtcmVmJyk7XG4gICAgdmFyIGdyb3VwX2lucHV0ID0gdXRpbHMuZ2V0R3JvdXBJbnB1dE9iamVjdEJ5UmVmKHJlZik7XG4gICAgdmFyIHByZXZpb3VzX2dyb3VwX2lucHV0ID0gdXRpbHMuZ2V0R3JvdXBJbnB1dE9iamVjdEJ5UmVmKGZvcm1idWlsZGVyLmdyb3VwLmN1cnJlbnRfaW5wdXRfcmVmKTtcbiAgICB2YXIgaW5wdXRzID0gZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uLmRhdGEucHJvamVjdC5mb3Jtc1tmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXhdLmlucHV0cztcbiAgICB2YXIgcXVlc3Rpb247XG5cbiAgICAvL2RlYWN0aXZhdGUgYWxsIGlucHV0cyBpbiBhY3RpdmUgZ3JvdXAgc29ydGFibGUgY29sbGVjdGlvblxuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbl9zb3J0YWJsZS5maW5kKCcuYWN0aXZlLWdyb3VwIC5ncm91cC1zb3J0YWJsZScpLmZpbmQoJy5hY3RpdmUnKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG4gICAgLy9hY3RpdmF0ZSBuZXcgY2xpY2tlZCBlbGVtZW50XG4gICAgc2VsZi5hZGRDbGFzcygnYWN0aXZlJyk7XG5cbiAgICAvL3ZhbGlkYXRlIHByZXZpb3VzIGlucHV0IChpZiBhbnksIEkgbWlnaHQgaGF2ZSBvbmx5IG9uZSBsZWZ0KSB3aGVuIHVzZXIgZ29lcyB0byBhbm90aGVyIGlucHV0LCBidXQgZG8gbm90IHNob3cgdG9hc3RcbiAgICBpZiAocHJldmlvdXNfZ3JvdXBfaW5wdXQpIHtcbiAgICAgICAgdmFsaWRhdGlvbi5wZXJmb3JtVmFsaWRhdGlvbihwcmV2aW91c19ncm91cF9pbnB1dCwgZmFsc2UpO1xuICAgIH1cblxuICAgIC8qXG4gICAgIHNob3cgcHJvcGVydGllcyBmb3IgdGhlIHNlbGVjdGVkIGlucHV0IGluIHByb3BlcnRpZXMgcGFuZWxcbiAgICAgKi9cbiAgICBpZiAoIWdyb3VwX2lucHV0LnF1ZXN0aW9uKSB7XG4gICAgICAgIC8vZW1wdHkgcXVlc3Rpb24gdGV4dD8gc2hvdyB3YXJuaW5nXG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzLmZpbmQoJy5wYW5lbC10aXRsZSBzcGFuLnF1ZXN0aW9uLXByZXZpZXcnKS50ZXh0KG1lc3NhZ2VzLmVycm9yLk5PX1FVRVNUSU9OX1RFWFRfWUVUKTtcbiAgICB9XG4gICAgZWxzZSB7XG5cbiAgICAgICAgLy9zdHJpcCBodG1sIHRhZ3MgZnJvbSByZWFkbWUgdHlwZSBpZiBhbnlcbiAgICAgICAgaWYgKGdyb3VwX2lucHV0LnR5cGUgPT09IGNvbnN0cy5SRUFETUVfVFlQRSkge1xuICAgICAgICAgICAgcXVlc3Rpb24gPSB1dGlscy5kZWNvZGVIdG1sKGdyb3VwX2lucHV0LnF1ZXN0aW9uKTtcbiAgICAgICAgICAgIHF1ZXN0aW9uID0gcXVlc3Rpb24ucmVwbGFjZSgvKDwoW14+XSspPikvaWcsICcgJyk7XG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllcy5maW5kKCcucGFuZWwtdGl0bGUgc3Bhbi5xdWVzdGlvbi1wcmV2aWV3JykudGV4dChxdWVzdGlvbi50cnVuYygyMCkpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXMuZmluZCgnLnBhbmVsLXRpdGxlIHNwYW4ucXVlc3Rpb24tcHJldmlldycpLnRleHQoZ3JvdXBfaW5wdXQucXVlc3Rpb24udHJ1bmMoMjApKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vdG9nZ2xlIHRpdGxlIGJhc2Ugb24gbnVtYmVyIG9mIHRpdGxlcyBzZWxlY3RlZCAoYnV0IG9ubHkgaWYgbm90IGNoZWNrZWQpXG4gICAgaWYgKHV0aWxzLmlzTWF4VGl0bGVMaW1pdFJlYWNoZWQoaW5wdXRzKSkge1xuICAgICAgICBpZiAoIWdyb3VwX2lucHV0LmlzX3RpdGxlKSB7XG4gICAgICAgICAgICB1aS5pbnB1dF9wcm9wZXJ0aWVzX3BhbmVsLnRvZ2dsZVRpdGxlQ2hlY2tib3goY29uc3RzLkRJU0FCTEVEX1NUQVRFLCByZWYpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICB1aS5pbnB1dF9wcm9wZXJ0aWVzX3BhbmVsLnRvZ2dsZVRpdGxlQ2hlY2tib3goY29uc3RzLkVOQUJMRURfU1RBVEUsIHJlZik7XG4gICAgfVxuXG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXMuZmluZCgnLnBhbmVsLWJvZHkgZm9ybScpLmhpZGUoKTtcbiAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllcy5maW5kKCcucGFuZWwtYm9keSBmb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIHJlZiArICdcIl0nKS5yZW1vdmVDbGFzcygnaGlkZGVuJykuZmFkZUluKGNvbnN0cy5BTklNQVRJT05fTk9STUFMKTtcblxuICAgIC8vaGlkZSAnbm8gaW5wdXRzIHNlbGVjdGVkIGJ1dHRvbnMnXG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlci5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fbm8taW5wdXQtc2VsZWN0ZWQnKS5oaWRlKCk7XG5cbiAgICAvL2lmIHRoZSBpbnB1dCB0eXBlIGhhcyBwb3NzaWJsZSBhbnN3ZXJzLCBzaG93IHBhZ2VyIGlmIG5lZWRlZFxuICAgIGlmICgkLmluQXJyYXkoZ3JvdXBfaW5wdXQudHlwZSwgY29uc3RzLk1VTFRJUExFX0FOU1dFUl9UWVBFUykgPiAtMSkge1xuICAgICAgICBpZiAoZ3JvdXBfaW5wdXQucG9zc2libGVfYW5zd2Vycy5sZW5ndGggPiBjb25zdHMuTElNSVRTLnBvc3NpYmxlX2Fuc3dlcnNfcGVyX3BhZ2UpIHtcbiAgICAgICAgICAgIC8vc2hvdyBwYWdpbmF0aW9uXG4gICAgICAgICAgICBwb3NzaWJsZV9hbnN3ZXJzX3BhZ2VyLmluaXQoZ3JvdXBfaW5wdXQpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcG9zc2libGVfYW5zd2Vyc19wYWdlci50ZWFyRG93bihncm91cF9pbnB1dCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvL3Nob3cgc2F2ZS9kZWxldGUgYnRuc1xuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2J1dHRvbnMuZmFkZUluKGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG4gICAgZm9ybWJ1aWxkZXIuZ3JvdXAuY3VycmVudF9pbnB1dF9yZWYgPSByZWY7XG5cbiAgICBpZiAoZ3JvdXBfaW5wdXQudHlwZSA9PT0gY29uc3RzLlJFQURNRV9UWVBFKSB7XG4gICAgICAgICQoJy5zdW1tZXJub3RlJykuc3VtbWVybm90ZShjb25zdHMuU1VNTUVSTk9URV9PUFRJT05TKTtcbiAgICB9XG4gICAgLy9lbmFibGUgc29ydGFibGUgb24gY3VycmVudCBpbnB1dFxuICAgIHBvc3NpYmxlQW5zd2Vyc1NvcnRhYmxlKGdyb3VwX2lucHV0KTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gY2FsbGJhY2s7XG4iLCIvKiBnbG9iYWwgJCwgdG9hc3RyKi9cbid1c2Ugc3RyaWN0JztcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgdWkgPSByZXF1aXJlKCdoZWxwZXJzL3VpJyk7XG52YXIgdXRpbHMgPSByZXF1aXJlKCdoZWxwZXJzL3V0aWxzJyk7XG52YXIgbWVzc2FnZXMgPSByZXF1aXJlKCdjb25maWcvbWVzc2FnZXMnKTtcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJ2NvbmZpZy9mb3JtYnVpbGRlcicpO1xudmFyIHZhbGlkYXRpb24gPSByZXF1aXJlKCdhY3Rpb25zL3ZhbGlkYXRpb24nKTtcbnZhciBwb3NzaWJsZUFuc3dlcnNTb3J0YWJsZSA9IHJlcXVpcmUoJ3VpLWhhbmRsZXJzL3Bvc3NpYmxlLWFuc3dlcnMtc29ydGFibGUnKTtcbnZhciBwb3NzaWJsZV9hbnN3ZXJzX3BhZ2VyID0gcmVxdWlyZSgnYWN0aW9ucy9wb3NzaWJsZS1hbnN3ZXJzLXBhZ2VyJyk7XG5cbnZhciBjYWxsYmFjayA9IGZ1bmN0aW9uIChlKSB7XG5cbiAgICB2YXIgc2VsZiA9ICQodGhpcyk7XG4gICAgdmFyIHJlZiA9IHNlbGYuYXR0cignZGF0YS1pbnB1dC1yZWYnKTtcbiAgICB2YXIgb3duZXJfYnJhbmNoID0gdXRpbHMuZ2V0SW5wdXRPYmplY3RCeVJlZihmb3JtYnVpbGRlci5icmFuY2guYWN0aXZlX2JyYW5jaF9yZWYpO1xuICAgIHZhciBncm91cF9pbnB1dCA9IHV0aWxzLmdldE5lc3RlZEdyb3VwSW5wdXRPYmplY3RCeVJlZihvd25lcl9icmFuY2gsIHJlZik7XG4gICAgdmFyIHByZXZpb3VzX2dyb3VwX2lucHV0ID0gdXRpbHMuZ2V0TmVzdGVkR3JvdXBJbnB1dE9iamVjdEJ5UmVmKG93bmVyX2JyYW5jaCwgZm9ybWJ1aWxkZXIuZ3JvdXAuY3VycmVudF9pbnB1dF9yZWYpO1xuICAgIHZhciBicmFuY2hfaW5wdXRzID0gdXRpbHMuZ2V0SW5wdXRPYmplY3RCeVJlZihmb3JtYnVpbGRlci5jdXJyZW50X2lucHV0X3JlZikuYnJhbmNoO1xuICAgIHZhciBxdWVzdGlvbjtcblxuICAgIC8vIGdyb3VwX2lucHV0LmRvbS5wcm9wZXJ0aWVzX3BhbmVsID0gZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlci5maW5kKCdmb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIHJlZiArICdcIl0nKTtcblxuICAgIC8vZGVhY3RpdmF0ZSBhbGwgaW5wdXRzIGluIGFjdGl2ZSBuZXN0ZWQgZ3JvdXAgc29ydGFibGUgY29sbGVjdGlvblxuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbl9zb3J0YWJsZS5maW5kKCcuYWN0aXZlLWdyb3VwIC5ncm91cC1zb3J0YWJsZScpLmZpbmQoJy5hY3RpdmUnKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG4gICAgLy9hY3RpdmF0ZSBuZXcgY2xpY2tlZCBlbGVtZW50XG4gICAgc2VsZi5hZGRDbGFzcygnYWN0aXZlJyk7XG5cbiAgICAvL3ZhbGlkYXRlIHByZXZpb3VzIGlucHV0IChpZiBhbnksIEkgbWlnaHQgaGF2ZSBvbmx5IG9uZSBsZWZ0KSB3aGVuIHVzZXIgZ29lcyB0byBhbm90aGVyIGlucHV0LCBidXQgZG8gbm90IHNob3cgdG9hc3RcbiAgICBpZiAocHJldmlvdXNfZ3JvdXBfaW5wdXQpIHtcbiAgICAgICAgdmFsaWRhdGlvbi5wZXJmb3JtVmFsaWRhdGlvbihwcmV2aW91c19ncm91cF9pbnB1dCwgZmFsc2UpO1xuICAgIH1cblxuICAgIC8qXG4gICAgIHNob3cgcHJvcGVydGllcyBmb3IgdGhlIHNlbGVjdGVkIGlucHV0IGluIHByb3BlcnRpZXMgcGFuZWxcbiAgICAgKi9cbiAgICBpZiAoIWdyb3VwX2lucHV0LnF1ZXN0aW9uKSB7XG4gICAgICAgIC8vZW1wdHkgcXVlc3Rpb24gdGV4dD8gc2hvdyB3YXJuaW5nXG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzLmZpbmQoJy5wYW5lbC10aXRsZSBzcGFuLnF1ZXN0aW9uLXByZXZpZXcnKS50ZXh0KG1lc3NhZ2VzLmVycm9yLk5PX1FVRVNUSU9OX1RFWFRfWUVUKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIC8vc3RyaXAgaHRtbCB0YWdzIGZyb20gcmVhZG1lIHR5cGUgaWYgYW55XG4gICAgICAgIGlmIChncm91cF9pbnB1dC50eXBlID09PSBjb25zdHMuUkVBRE1FX1RZUEUpIHtcbiAgICAgICAgICAgIHF1ZXN0aW9uID0gdXRpbHMuZGVjb2RlSHRtbChncm91cF9pbnB1dC5xdWVzdGlvbik7XG4gICAgICAgICAgICBxdWVzdGlvbiA9IHF1ZXN0aW9uLnJlcGxhY2UoLyg8KFtePl0rKT4pL2lnLCAnICcpO1xuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXMuZmluZCgnLnBhbmVsLXRpdGxlIHNwYW4ucXVlc3Rpb24tcHJldmlldycpLnRleHQocXVlc3Rpb24udHJ1bmMoMjApKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzLmZpbmQoJy5wYW5lbC10aXRsZSBzcGFuLnF1ZXN0aW9uLXByZXZpZXcnKS50ZXh0KGdyb3VwX2lucHV0LnF1ZXN0aW9uLnRydW5jKDIwKSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvL3RvZ2dsZSB0aXRsZSBiYXNlIG9uIG51bWJlciBvZiB0aXRsZXMgc2VsZWN0ZWQgKGJ1dCBvbmx5IGlmIG5vdCBjaGVja2VkKVxuICAgIGlmICh1dGlscy5pc01heFRpdGxlTGltaXRSZWFjaGVkKGJyYW5jaF9pbnB1dHMpKSB7XG4gICAgICAgIGlmICghZ3JvdXBfaW5wdXQuaXNfdGl0bGUpIHtcbiAgICAgICAgICAgIHVpLmlucHV0X3Byb3BlcnRpZXNfcGFuZWwudG9nZ2xlVGl0bGVDaGVja2JveChjb25zdHMuRElTQUJMRURfU1RBVEUsIHJlZik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHVpLmlucHV0X3Byb3BlcnRpZXNfcGFuZWwudG9nZ2xlVGl0bGVDaGVja2JveChjb25zdHMuRU5BQkxFRF9TVEFURSwgcmVmKTtcbiAgICB9XG5cbiAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllcy5maW5kKCcucGFuZWwtYm9keSBmb3JtJykuaGlkZSgpO1xuICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzLmZpbmQoJy5wYW5lbC1ib2R5IGZvcm1bZGF0YS1pbnB1dC1yZWY9XCInICsgcmVmICsgJ1wiXScpLnJlbW92ZUNsYXNzKCdoaWRkZW4nKS5mYWRlSW4oY29uc3RzLkFOSU1BVElPTl9OT1JNQUwpO1xuXG4gICAgLy9oaWRlICdubyBpbnB1dHMgc2VsZWN0ZWQgYnV0dG9ucydcbiAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19uby1pbnB1dC1zZWxlY3RlZCcpLmhpZGUoKTtcblxuICAgIC8vaWYgdGhlIGlucHV0IHR5cGUgaGFzIHBvc3NpYmxlIGFuc3dlcnMsIHNob3cgcGFnZXIgaWYgbmVlZGVkXG4gICAgaWYgKCQuaW5BcnJheShncm91cF9pbnB1dC50eXBlLCBjb25zdHMuTVVMVElQTEVfQU5TV0VSX1RZUEVTKSA+IC0xKSB7XG4gICAgICAgIGlmIChncm91cF9pbnB1dC5wb3NzaWJsZV9hbnN3ZXJzLmxlbmd0aCA+IGNvbnN0cy5MSU1JVFMucG9zc2libGVfYW5zd2Vyc19wZXJfcGFnZSkge1xuICAgICAgICAgICAgLy9zaG93IHBhZ2luYXRpb25cbiAgICAgICAgICAgIHBvc3NpYmxlX2Fuc3dlcnNfcGFnZXIuaW5pdChncm91cF9pbnB1dCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBwb3NzaWJsZV9hbnN3ZXJzX3BhZ2VyLnRlYXJEb3duKGdyb3VwX2lucHV0KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vc2hvdyBzYXZlL2RlbGV0ZSBidG5zXG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfYnV0dG9ucy5mYWRlSW4oY29uc3RzLkFOSU1BVElPTl9GQVNUKTtcbiAgICBmb3JtYnVpbGRlci5ncm91cC5jdXJyZW50X2lucHV0X3JlZiA9IHJlZjtcblxuICAgIGlmIChncm91cF9pbnB1dC50eXBlID09PSBjb25zdHMuUkVBRE1FX1RZUEUpIHtcbiAgICAgICAgJCgnLnN1bW1lcm5vdGUnKS5zdW1tZXJub3RlKGNvbnN0cy5TVU1NRVJOT1RFX09QVElPTlMpO1xuICAgIH1cblxuICAgIC8vZW5hYmxlIHNvcnRhYmxlIG9uIGN1cnJlbnQgaW5wdXRcbiAgICBwb3NzaWJsZUFuc3dlcnNTb3J0YWJsZShncm91cF9pbnB1dCk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGNhbGxiYWNrO1xuIiwiLyogZ2xvYmFsICQsIHRvYXN0ciovXG4ndXNlIHN0cmljdCc7XG52YXIgY29uc3RzID0gcmVxdWlyZSgnY29uZmlnL2NvbnN0cycpO1xudmFyIHVpID0gcmVxdWlyZSgnaGVscGVycy91aScpO1xudmFyIHV0aWxzID0gcmVxdWlyZSgnaGVscGVycy91dGlscycpO1xudmFyIG1lc3NhZ2VzID0gcmVxdWlyZSgnY29uZmlnL21lc3NhZ2VzJyk7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcbnZhciBzYXZlID0gcmVxdWlyZSgnYWN0aW9ucy9zYXZlJyk7XG52YXIgdmFsaWRhdGlvbiA9IHJlcXVpcmUoJ2FjdGlvbnMvdmFsaWRhdGlvbicpO1xudmFyIGlucHV0X3Byb3BlcnRpZXNfa2V5dXBfY2FsbGJhY2sgPSByZXF1aXJlKCd1aS1oYW5kbGVycy9ldmVudC1oYW5kbGVyLWNhbGxiYWNrcy9pbnB1dC1wcm9wZXJ0aWVzLWtleXVwLWNhbGxiYWNrJyk7XG52YXIganVtcHMgPSByZXF1aXJlKCdhY3Rpb25zL2p1bXBzJyk7XG52YXIgcG9zc2libGVfYW5zd2Vyc19wYWdlciA9IHJlcXVpcmUoJ2FjdGlvbnMvcG9zc2libGUtYW5zd2Vycy1wYWdlcicpO1xudmFyIHBvc3NpYmxlQW5zd2Vyc1NvcnRhYmxlID0gcmVxdWlyZSgndWktaGFuZGxlcnMvcG9zc2libGUtYW5zd2Vycy1zb3J0YWJsZScpO1xuXG5mdW5jdGlvbiBfZXhpdEJyYW5jaCh0aGVfaW5wdXQpIHtcblxuICAgIHZhciBhY3RpdmVfYnJhbmNoX2lucHV0O1xuICAgIHZhciBpbnB1dCA9IHRoZV9pbnB1dDtcbiAgICB2YXIgYnJhbmNoX3ZhbGlkYXRpb247XG5cbiAgICAvL2lmIHRoZXJlIGlzIGFueSBicmFuY2ggdG8gdmFsaWRhdGUsIGRvIGl0IGJlZm9yZSBleGl0aW5nXG4gICAgaWYgKGZvcm1idWlsZGVyLmJyYW5jaC5jdXJyZW50X2lucHV0X3JlZikge1xuICAgICAgICAvL3ZhbGlkYXRlIGN1cnJlbnRseSBhY3RpdmUgYnJhbmNoIGlucHV0IChpbiBjYXNlIHRoZSB1c2VyIGRpZCBub3QgY2xpY2sgdmFsaWRhdGUgaGltc2VsZilcbiAgICAgICAgYWN0aXZlX2JyYW5jaF9pbnB1dCA9IHV0aWxzLmdldEJyYW5jaElucHV0T2JqZWN0QnlSZWYoZm9ybWJ1aWxkZXIuYnJhbmNoLmN1cnJlbnRfaW5wdXRfcmVmKTtcbiAgICAgICAgdmFsaWRhdGlvbi5wZXJmb3JtVmFsaWRhdGlvbihhY3RpdmVfYnJhbmNoX2lucHV0LCBmYWxzZSk7XG5cbiAgICB9XG4gICAgLy9leGl0XG4gICAgaW5wdXQuZXhpdEJyYW5jaFNvcnRhYmxlKCk7XG59XG5cbmZ1bmN0aW9uIF9leGl0R3JvdXAodGhlX2lucHV0KSB7XG5cbiAgICB2YXIgYWN0aXZlX2dyb3VwX2lucHV0O1xuICAgIHZhciBpbnB1dCA9IHRoZV9pbnB1dDtcblxuICAgIC8vaWYgdGhlcmUgaXMgYW55IGdyb3VwIHRvIHZhbGlkYXRlLCBkbyBpdCBiZWZvcmUgZXhpdGluZ1xuICAgIGlmIChmb3JtYnVpbGRlci5ncm91cC5jdXJyZW50X2lucHV0X3JlZikge1xuICAgICAgICAvL3ZhbGlkYXRlIGN1cnJlbnRseSBhY3RpdmUgZ3JvdXAgaW5wdXQgKGluIGNhc2UgdGhlIHVzZXIgZGlkIG5vdCBjbGljayB2YWxpZGF0ZSBoaW1zZWxmKVxuICAgICAgICBhY3RpdmVfZ3JvdXBfaW5wdXQgPSB1dGlscy5nZXRHcm91cElucHV0T2JqZWN0QnlSZWYoZm9ybWJ1aWxkZXIuZ3JvdXAuY3VycmVudF9pbnB1dF9yZWYpO1xuICAgICAgICB2YWxpZGF0aW9uLnBlcmZvcm1WYWxpZGF0aW9uKGFjdGl2ZV9ncm91cF9pbnB1dCwgZmFsc2UpO1xuXG4gICAgICAgIC8vYnJhbmNoIGlucHV0cyBhcmUgYWxyZWFkeSBhdHRhY2hlZCB0byB0aGUgYnJhbmNoIHByb3BlcnR5IG90IHRoZSBvd25lciBpbnB1dCwganVzdCB2YWxpZGF0ZSB0aGVtXG4gICAgICAgIGlucHV0LnZhbGlkYXRlR3JvdXBJbnB1dHMoKTtcbiAgICB9XG4gICAgLy9leGl0XG4gICAgaW5wdXQuZXhpdEdyb3VwU29ydGFibGUoKTtcbn1cblxuXG52YXIgY2FsbGJhY2sgPSBmdW5jdGlvbiAoZSkge1xuXG4gICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbiAgICAvL2hhY2sgdG8gcmVtb3ZlIGZvY3VzIGZyb20ganVtcCBzZWxlY3Qgc28gaXQgZ2V0cyByZWZyZXNoZWRcbiAgICB2YXIgJGZvY3VzZWQgPSAkKCc6Zm9jdXMnKTtcbiAgICB2YXIganVtcF9zZWxlY3QgPSAkZm9jdXNlZC5hdHRyKCdkYXRhLWp1bXAtbG9naWMnKTtcbiAgICBpZiAoanVtcF9zZWxlY3QgPT09ICdnb3RvJykge1xuICAgICAgICAkZm9jdXNlZC5ibHVyKCk7XG4gICAgfVxuICAgIC8vZW5kIGhhY2tcbiAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgIHZhciBzZWxmID0gJCh0aGlzKTtcbiAgICB2YXIgcHJldmlvdXNfaW5wdXQ7XG4gICAgdmFyIHJlZjtcbiAgICB2YXIgaW5wdXQ7XG4gICAgdmFyIGlucHV0cyA9IGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbi5kYXRhLnByb2plY3QuZm9ybXNbZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4XS5pbnB1dHM7XG4gICAgdmFyIHF1ZXN0aW9uO1xuICAgIHZhciBjb3B5X2J0bl9zdGF0ZTtcbiAgICAvL3ZhciBwYWdlcjtcblxuICAgIC8qXG4gICAgIElmIHdlIGFyZSBlZGl0bmcgYSBuZXN0ZWQgYnJhbmNoICBvciBncm91cCB3ZSBhcmUganVzdCBpbnRlcmVzdGVkIG9uIGEgY2xpY2sgb24gdGhlIGV4aXQgYnV0dG9uXG4gICAgIHRvIGdvIGJhY2sgdG8gdGhlIHBhcmVudCBzb3J0YWJsZVxuICAgICAqL1xuICAgIGlmIChmb3JtYnVpbGRlci5pc19lZGl0aW5nX2JyYW5jaCB8fCBmb3JtYnVpbGRlci5pc19lZGl0aW5nX2dyb3VwKSB7XG4gICAgICAgIC8vd2UgYXJlIGluIGJyYW5jaCBlZGl0IG1vZGUsIGV4aXQgaXMgdGhlIG9ubHkgYWN0aW9uIHdlIG5lZWQgdG8gaW50ZXJjZXB0XG4gICAgICAgIGlmIChzZWxmLmhhc0NsYXNzKCdjaGV2cm9uLWxlZnQnKSkge1xuICAgICAgICAgICAgLy9nZXQgcmVmIGZyb20gcGFyZW50XG4gICAgICAgICAgICByZWYgPSBzZWxmLnBhcmVudHMoKS5lcSgxKS5hdHRyKCdkYXRhLWlucHV0LXJlZicpO1xuICAgICAgICAgICAgaW5wdXQgPSB1dGlscy5nZXRJbnB1dE9iamVjdEJ5UmVmKHJlZik7XG5cbiAgICAgICAgICAgIGlmIChmb3JtYnVpbGRlci5pc19lZGl0aW5nX2JyYW5jaCkge1xuICAgICAgICAgICAgICAgIF9leGl0QnJhbmNoKGlucHV0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIF9leGl0R3JvdXAoaW5wdXQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuXG4gICAgICAgIC8qXG4gICAgICAgICB3ZSBhcmUgZWRpdGluZyBhIHRvcCBsZXZlbCBzb3J0YWJsZVxuICAgICAgICAgKi9cbiAgICAgICAgcHJldmlvdXNfaW5wdXQgPSB1dGlscy5nZXRJbnB1dE9iamVjdEJ5UmVmKGZvcm1idWlsZGVyLmN1cnJlbnRfaW5wdXRfcmVmKTtcbiAgICAgICAgcmVmID0gc2VsZi5hdHRyKCdkYXRhLWlucHV0LXJlZicpO1xuICAgICAgICBpbnB1dCA9IHV0aWxzLmdldElucHV0T2JqZWN0QnlSZWYocmVmKTtcblxuICAgICAgICAvL2VuYWJsZSBzb3J0YWJsZSBvbiBjdXJyZW50IGlucHV0XG4gICAgICAgIHBvc3NpYmxlQW5zd2Vyc1NvcnRhYmxlKGlucHV0KTtcblxuICAgICAgICAvL3ZhbGlkYXRlIHByZXZpb3VzIGlucHV0IChpZiBhbnksIEkgbWlnaHQgaGF2ZSBvbmx5IG9uZSBsZWZ0KSB3aGVuIHVzZXIgZ29lcyB0byBhbm90aGVyIGlucHV0LCBidXQgZG8gbm90IHNob3cgdG9hc3RcbiAgICAgICAgaWYgKHByZXZpb3VzX2lucHV0KSB7XG4gICAgICAgICAgICB2YWxpZGF0aW9uLnBlcmZvcm1WYWxpZGF0aW9uKHByZXZpb3VzX2lucHV0LCBmYWxzZSk7XG4gICAgICAgIH1cblxuICAgICAgICAvL2RlYWN0aXZhdGUgYWxsIGlucHV0cyBpbiBjb2xsZWN0aW9uXG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbl9zb3J0YWJsZS5maW5kKCcuYWN0aXZlJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuXG4gICAgICAgIC8vYWN0aXZhdGUganVzdCBjdXJyZW50IGNsaWNrZWQgaW5wdXQgaW4gdGhlIGNvbGxlY3Rpb25cbiAgICAgICAgc2VsZi5hZGRDbGFzcygnYWN0aXZlJyk7XG5cbiAgICAgICAgLypcbiAgICAgICAgIHNob3cgcHJvcGVydGllcyBmb3IgdGhlIHNlbGVjdGVkIGlucHV0IGluIHByb3BlcnRpZXMgcGFuZWxcbiAgICAgICAgICovXG4gICAgICAgIGlmICghaW5wdXQucXVlc3Rpb24pIHtcbiAgICAgICAgICAgIC8vZW1wdHkgcXVlc3Rpb24gdGV4dD8gc2hvdyB3YXJuaW5nXG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllcy5maW5kKCcucGFuZWwtdGl0bGUgc3Bhbi5xdWVzdGlvbi1wcmV2aWV3JykudGV4dChtZXNzYWdlcy5lcnJvci5OT19RVUVTVElPTl9URVhUX1lFVCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG5cbiAgICAgICAgICAgIC8vc3RyaXAgaHRtbCB0YWdzIGZyb20gcmVhZG1lIHR5cGUgaWYgYW55XG4gICAgICAgICAgICBpZiAoaW5wdXQudHlwZSA9PT0gY29uc3RzLlJFQURNRV9UWVBFKSB7XG4gICAgICAgICAgICAgICAgcXVlc3Rpb24gPSB1dGlscy5kZWNvZGVIdG1sKGlucHV0LnF1ZXN0aW9uKTtcbiAgICAgICAgICAgICAgICBxdWVzdGlvbiA9IHF1ZXN0aW9uLnJlcGxhY2UoLyg8KFtePl0rKT4pL2lnLCAnICcpO1xuICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzLmZpbmQoJy5wYW5lbC10aXRsZSBzcGFuLnF1ZXN0aW9uLXByZXZpZXcnKS50ZXh0KHF1ZXN0aW9uLnRydW5jKDIwKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllcy5maW5kKCcucGFuZWwtdGl0bGUgc3Bhbi5xdWVzdGlvbi1wcmV2aWV3JykudGV4dChpbnB1dC5xdWVzdGlvbi50cnVuYygyMCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy90b2dnbGUgY2hlY2tib3ggZXZlbnRzIGZvciB1bmlxdWVuZXNzIGlmIHRoaXMgaXMgYSBjaGlsZCBmb3JtXG4gICAgLy8gaS5lLiBjaGVja2JveGVzIGJlaGF2ZSBsaWtlIHJhZGlvXG4gICAgaWYgKGZvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleCA+IDApIHtcblxuICAgICAgICAvL2RvIG5vdCBhdHRhY2ggdGhpcyBldmVudCBmb3IgYnJhbmNoZXNcbiAgICAgICAgaWYgKCFmb3JtYnVpbGRlci5pc19lZGl0aW5nX2JyYW5jaCkge1xuXG4gICAgICAgICAgICAvL2dldCBoYW5kbGUgb2YgY3VycmVudCBhY3RpdmUgcHJvcGVydGllcyBwYW5lbFxuICAgICAgICAgICAgaW5wdXQuZG9tLmFkdmFuY2VkX3Byb3BlcnRpZXNfd3JhcHBlciA9IGZvcm1idWlsZGVyXG4gICAgICAgICAgICAgICAgLmRvbVxuICAgICAgICAgICAgICAgIC5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXJcbiAgICAgICAgICAgICAgICAuZmluZCgnZm9ybVtkYXRhLWlucHV0LXJlZj1cIicgKyBpbnB1dC5yZWYgKyAnXCJdJylcbiAgICAgICAgICAgICAgICAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2FkdmFuY2VkLXByb3BlcnRpZXMnKTtcblxuICAgICAgICAgICAgLy9iaW5kIGZ1bmN0aW9uIHRvIG1ha2Ugb25seSBhIHNpbmdsZSBjaGVja2JveCBzZWxlY3RlZCBhdCBhIHRpbWVcbiAgICAgICAgICAgIGlucHV0LmRvbS5hZHZhbmNlZF9wcm9wZXJ0aWVzX3dyYXBwZXJcbiAgICAgICAgICAgICAgICAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2FkdmFuY2VkLXByb3BlcnRpZXNfX3VuaXF1ZW5lc3MgaW5wdXQnKVxuICAgICAgICAgICAgICAgIC5vZmYoKS5vbignY2hhbmdlJywgZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgLy9nZXQgdGhlIGN1cnJlbnQgY2hlY2svdW5ja2VjayBzdGF0ZSBvZiB0aGUgY2hlY2tib3ggdGhlIHVzZXIgaGFzIGNsaWNrIHRvIHJlc3RvcmUgaXRcbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudENoZWNrQm94U3RhdGUgPSAkKHRoaXMpLnByb3AoJ2NoZWNrZWQnKTtcblxuICAgICAgICAgICAgICAgIC8vdW5jaGVjayBhbGxcbiAgICAgICAgICAgICAgICAkKHRoaXMpLnBhcmVudHMoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19hZHZhbmNlZC1wcm9wZXJ0aWVzX191bmlxdWVuZXNzJylcbiAgICAgICAgICAgICAgICAgICAgLmZpbmQoJ2lucHV0W3R5cGU9XCJjaGVja2JveFwiXScpXG4gICAgICAgICAgICAgICAgICAgIC5wcm9wKCdjaGVja2VkJywgZmFsc2UpO1xuXG4gICAgICAgICAgICAgICAgLy9jaGVjay91bmNoZWNrIHRoZSBzZWxlY3RlZCBvbmUgYmFzZWQgb24gdGhlIHByZXZpb3VzIHN0YXRlXG4gICAgICAgICAgICAgICAgJCh0aGlzKS5wcm9wKCdjaGVja2VkJywgY3VycmVudENoZWNrQm94U3RhdGUpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cblxuICAgIC8vdG9nZ2xlIHRpdGxlIGJhc2Ugb24gbnVtYmVyIG9mIHRpdGxlcyBzZWxlY3RlZCAoYnV0IG9ubHkgaWYgbm90IGNoZWNrZWQpXG4gICAgaWYgKHV0aWxzLmlzTWF4VGl0bGVMaW1pdFJlYWNoZWQoaW5wdXRzKSkge1xuICAgICAgICBpZiAoIWlucHV0LmlzX3RpdGxlKSB7XG4gICAgICAgICAgICB1aS5pbnB1dF9wcm9wZXJ0aWVzX3BhbmVsLnRvZ2dsZVRpdGxlQ2hlY2tib3goY29uc3RzLkRJU0FCTEVEX1NUQVRFLCByZWYpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICB1aS5pbnB1dF9wcm9wZXJ0aWVzX3BhbmVsLnRvZ2dsZVRpdGxlQ2hlY2tib3goY29uc3RzLkVOQUJMRURfU1RBVEUsIHJlZik7XG4gICAgfVxuXG4gICAgLy8vL2lmIGFueSBqdW1wLCByZWZyZXNoIHRoZSBqdW1wcyBzZWxlY3RlZCBkZXN0aW5hdGlvbiBsYWJlbCBhcyBpdCBtaWdodCBoYXZlIGNoYW5nZWQgKGN1cnJlbnQgc2VsZWN0ZWQgaW5wdXQgb25seSlcbiAgICBpZiAoaW5wdXQuanVtcHMubGVuZ3RoID4gMCkge1xuICAgICAgICBqdW1wcy5yZWZyZXNoSW5wdXRKdW1wc0RvbShpbnB1dCwgaW5wdXRzKTtcbiAgICB9XG5cbiAgICAvL3Nob3cgY3VycmVudCBhY3RpdmUgaW5wdXQgcHJvcGVydGllcyBwYW5lbFxuICAgIC8vZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXMuZmluZCgnLnBhbmVsLWJvZHkgZm9ybScpLnJlbW92ZUNsYXNzKCdzaG93bicpLmFkZENsYXNzKCdoaWRkZW4nKTtcbiAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllcy5maW5kKCcucGFuZWwtYm9keSBmb3JtJykuY3NzKCdkaXNwbGF5JywgJ25vbmUnKTtcbiAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllcy5maW5kKCcucGFuZWwtYm9keSBmb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIHJlZiArICdcIl0nKS5yZW1vdmVDbGFzcygnaGlkZGVuJykuZmFkZUluKGNvbnN0cy5BTklNQVRJT05fTk9STUFMKTtcblxuXG4gICAgLy8gLy9pZiB0aGUgaW5wdXQgdHlwZSBoYXMgcG9zc2libGUgYW5zd2Vycywgc2hvdyBwYWdlciBpZiBuZWVkZWRcbiAgICBpZiAoJC5pbkFycmF5KGlucHV0LnR5cGUsIGNvbnN0cy5NVUxUSVBMRV9BTlNXRVJfVFlQRVMpID4gLTEpIHtcbiAgICAgICAgIC8vIHBhZ2VyID0gZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNcbiAgICAgICAgIC8vICAgIC5maW5kKCcucGFuZWwtYm9keSBmb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIGlucHV0LnJlZiArICdcIl0nKVxuICAgICAgICAgLy8gICAgLmZpbmQoJy5wb3NzaWJsZS1hbnN3ZXJzX19saXN0X3BhZ2VyJyk7XG4gICAgICAgIGlmIChpbnB1dC5wb3NzaWJsZV9hbnN3ZXJzLmxlbmd0aCA+IGNvbnN0cy5MSU1JVFMucG9zc2libGVfYW5zd2Vyc19wZXJfcGFnZSkge1xuICAgICAgICAgICAgLy9zaG93IHBhZ2luYXRpb25cbiAgICAgICAgICAgIHBvc3NpYmxlX2Fuc3dlcnNfcGFnZXIuaW5pdChpbnB1dCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBwb3NzaWJsZV9hbnN3ZXJzX3BhZ2VyLnRlYXJEb3duKGlucHV0KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vc2hvdyBzYXZlL2RlbGV0ZSBidG5zXG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfYnV0dG9ucy5mYWRlSW4oY29uc3RzLkFOSU1BVElPTl9GQVNUKTtcblxuICAgIC8vaGlkZSBtZXNzYWdlIGFib3V0IG5vIGlucHV0IHNlbGVjdGVkLCBhcyBpbnB1dCBnZXRzIGZvY3VzXG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfbm9faW5wdXRfc2VsZWN0ZWQuaGlkZSgpO1xuXG4gICAgZm9ybWJ1aWxkZXIuY3VycmVudF9pbnB1dF9yZWYgPSByZWY7XG5cbiAgICBpZiAoaW5wdXQudHlwZSA9PT0gY29uc3RzLlJFQURNRV9UWVBFKSB7XG4gICAgICAgICQoJy5zdW1tZXJub3RlJykuc3VtbWVybm90ZShjb25zdHMuU1VNTUVSTk9URV9PUFRJT05TKTtcbiAgICB9XG5cbiAgICAvL3RvZ2dsZSBjb3B5IGJ1dHRvblxuICAgIGNvcHlfYnRuX3N0YXRlID0gaW5wdXQuZG9tLmlzX3ZhbGlkID8gY29uc3RzLkJUTl9FTkFCTEVEIDogY29uc3RzLkJUTl9ESVNBQkxFRDtcbiAgICB1aS5pbnB1dF9wcm9wZXJ0aWVzX3BhbmVsLnRvZ2dsZUNvcHlJbnB1dEJ1dHRvbihpbnB1dC5yZWYsIGNvcHlfYnRuX3N0YXRlKTtcblxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBjYWxsYmFjaztcbiIsIid1c2Ugc3RyaWN0JztcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgbWVzc2FnZXMgPSByZXF1aXJlKCdjb25maWcvbWVzc2FnZXMnKTtcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJ2NvbmZpZy9mb3JtYnVpbGRlcicpO1xudmFyIHV0aWxzID0gcmVxdWlyZSgnaGVscGVycy91dGlscycpO1xuXG52YXIgY2FsbGJhY2sgPSBmdW5jdGlvbiAoZSkge1xuXG4gICAgdmFyIGlucHV0ID0gdXRpbHMuZ2V0SW5wdXRPYmplY3RCeVJlZihmb3JtYnVpbGRlci5jdXJyZW50X2lucHV0X3JlZik7XG5cbiAgICBjb25zb2xlLmxvZyhlLnRhcmdldCk7XG4gICAgY29uc29sZS5sb2coJCh0aGlzKSk7XG5cbiAgICBpbnB1dC5kb20ucHJvcGVydGllc19wYW5lbCA9IGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXIuZmluZCgnZm9ybVtkYXRhLWlucHV0LXJlZj1cIicgKyBpbnB1dC5yZWYgKyAnXCJdJyk7XG5cbiAgICAvL2dldCBzZWxlY3RlZCBpbml0aWFsIGFuc3dlclxuICAgIHZhciBpbml0aWFsX2Fuc3dlciA9IGlucHV0LmRvbS5wcm9wZXJ0aWVzX3BhbmVsXG4gICAgICAgIC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fYWR2YW5jZWQtcHJvcGVydGllcycpXG4gICAgICAgIC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fZm9ybV9fYWR2YW5jZWQtcHJvcGVydGllc19fZGVmYXVsdCcpXG4gICAgICAgIC5maW5kKCdzZWxlY3QnKS5maW5kKCc6c2VsZWN0ZWQnKTtcblxuICAgIGNvbnNvbGUubG9nKGluaXRpYWxfYW5zd2VyKTtcblxuICAgIGlmIChpbml0aWFsX2Fuc3dlci52YWwoKSA9PT0gaW5wdXQuZGVmYXVsdCAmJiBpbnB1dC5kZWZhdWx0ICE9PSAnJykge1xuICAgICAgICBpbml0aWFsX2Fuc3dlci50ZXh0KHV0aWxzLmdldFBvc3NpYmxlQW5zd2VyTGFiZWwoaW5wdXQpKTtcbiAgICB9XG5cbiAgICBjb25zb2xlLmxvZyhpbnB1dCk7XG4gICAgY29uc29sZS5sb2coJ3JlZnJlc2ggaW5pdGlhbCBhbnN3ZXInKTtcblxuXG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGNhbGxiYWNrO1xuIiwiLyogZ2xvYmFsICQsIHRvYXN0ciovXG4ndXNlIHN0cmljdCc7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcbnZhciB1aSA9IHJlcXVpcmUoJ2hlbHBlcnMvdWknKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoJ2hlbHBlcnMvdXRpbHMnKTtcblxudmFyIGNhbGxiYWNrID0gZnVuY3Rpb24gKCkge1xuXG4gICAgdmFyIGlucHV0ID0gdXRpbHMuZ2V0SW5wdXRPYmplY3RCeVJlZihmb3JtYnVpbGRlci5jdXJyZW50X2lucHV0X3JlZik7XG4gICAgdmFyIG93bmVyX2JyYW5jaDtcblxuICAgIC8vaXMgZWRpdGluZyBhIGJyYW5jaD9cbiAgICBpZiAoZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19icmFuY2gpIHtcbiAgICAgICAgLy9vdmVycmlkZSBpbnB1dCB0byBiZSB0aGUgYnJhbmNoIGlucHV0XG4gICAgICAgIGlucHV0ID0gdXRpbHMuZ2V0QnJhbmNoSW5wdXRPYmplY3RCeVJlZihmb3JtYnVpbGRlci5icmFuY2guY3VycmVudF9pbnB1dF9yZWYpO1xuXG4gICAgICAgIC8vaGFuZGxlIG5lc3RlZCBncm91cCBpbnNpZGUgYSBicmFuY2hcbiAgICAgICAgaWYgKGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfZ3JvdXApIHtcbiAgICAgICAgICAgIG93bmVyX2JyYW5jaCA9IHV0aWxzLmdldElucHV0T2JqZWN0QnlSZWYoZm9ybWJ1aWxkZXIuYnJhbmNoLmFjdGl2ZV9icmFuY2hfcmVmKTtcbiAgICAgICAgICAgIGlucHV0ID0gdXRpbHMuZ2V0TmVzdGVkR3JvdXBJbnB1dE9iamVjdEJ5UmVmKG93bmVyX2JyYW5jaCwgZm9ybWJ1aWxkZXIuZ3JvdXAuY3VycmVudF9pbnB1dF9yZWYpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICAvL2lzIGVkaXRpbmcgYSBncm91cD9cbiAgICAgICAgaWYgKGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfZ3JvdXApIHtcbiAgICAgICAgICAgIC8vb3ZlcnJpZGUgaW5wdXQgdG8gYmUgdGhlIGJyYW5jaCBpbnB1dFxuICAgICAgICAgICAgaW5wdXQgPSB1dGlscy5nZXRHcm91cElucHV0T2JqZWN0QnlSZWYoZm9ybWJ1aWxkZXIuZ3JvdXAuY3VycmVudF9pbnB1dF9yZWYpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgaWYgKCQodGhpcykuYXR0cignZGF0YS1qdW1wLWxvZ2ljJykpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ2l0IGlzIGEganVtcCcpO1xuICAgIH1cblxuICAgIGlmICgkKHRoaXMpLmF0dHIoJ2RhdGEtaW5pdGlhbC1hbnN3ZXInKSkge1xuICAgICAgICBjb25zb2xlLmxvZygnbXVsdGkgc2VsZWN0Jyk7XG4gICAgICAgIGlucHV0LnVwZGF0ZVBvc3NpYmxlSW5pdGlhbEFuc3dlcnMoKTtcbiAgICB9XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGNhbGxiYWNrO1xuIiwiLyogZ2xvYmFsICQsIHRvYXN0ciwgRmlsZSwgc2F2ZUFzKi9cbid1c2Ugc3RyaWN0JztcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgdWkgPSByZXF1aXJlKCdoZWxwZXJzL3VpJyk7XG52YXIgdXRpbHMgPSByZXF1aXJlKCdoZWxwZXJzL3V0aWxzJyk7XG52YXIgbWVzc2FnZXMgPSByZXF1aXJlKCdjb25maWcvbWVzc2FnZXMnKTtcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJ2NvbmZpZy9mb3JtYnVpbGRlcicpO1xudmFyIHZhbGlkYXRpb24gPSByZXF1aXJlKCdhY3Rpb25zL3ZhbGlkYXRpb24nKTtcbnZhciBpbnB1dF9kdXBsaWNhdG9yID0gcmVxdWlyZSgnYWN0aW9ucy9pbnB1dC1kdXBsaWNhdG9yJyk7XG52YXIgdG9hc3QgPSByZXF1aXJlKCdjb25maWcvdG9hc3QnKTtcblxuLypcbiBoYW5kbGUgY2xpY2sgYWN0aW9uIG9uIGlucHV0IHByb3BlcnRpZXMgcGFuZWwgaW4gdGhlIHJpZ2h0IHNpZGViYXIgKHVzZSBldmVudCBkZWxlZ2F0aW9uKVxuIHdlIGNoZWNrIHRoZSBjbGFzcyBvZiB0aGUgdGFyZ2V0IGVsZW1lbnQgdG8gdHJpZ2dlciB0aGUgcHJvcGVyIGFjdGlvblxuICovXG52YXIgY2FsbGJhY2sgPSBmdW5jdGlvbiAoZSkge1xuXG4gICAgY29uc29sZS5sb2coJ3Byb3BlcnRpZXMgcGFuZWwgY2xpY2tlZC4nKTtcblxuICAgIHZhciB1bmRvID0gcmVxdWlyZSgnYWN0aW9ucy91bmRvJyk7XG4gICAgdmFyIHBvc3NpYmxlX2Fuc3dlcnMgPSByZXF1aXJlKCdhY3Rpb25zL3Bvc3NpYmxlLWFuc3dlcnMnKTtcbiAgICB2YXIgaW5wdXRfZmFjdG9yeSA9IHJlcXVpcmUoJ2ZhY3RvcnkvaW5wdXQtZmFjdG9yeScpO1xuICAgIC8vZ2V0IGhvbGQgb2YgdGhlIGN1cnJlbnQgYWN0aXZlIGlucHV0IGluIHRoZSBpbnB1dCBjb2xsZWN0aW9uIChtaWRkbGUgY29sdW1uKVxuICAgIHZhciBpbnB1dCA9IHV0aWxzLmdldElucHV0T2JqZWN0QnlSZWYoZm9ybWJ1aWxkZXIuY3VycmVudF9pbnB1dF9yZWYpO1xuICAgIHZhciBmaXJzdF9pbnB1dF9yZWY7XG4gICAgdmFyIG5lc3RlZF9ncm91cDtcbiAgICB2YXIgb3duZXJfYnJhbmNoO1xuICAgIC8vZ2V0IGhvbGQgb2YgdGFwcGVkIGVsZW1lbnQgZG9tIGVsZW1lbnRcbiAgICB2YXIgdGFyZ2V0ID0gJCh0aGlzKTtcbiAgICB2YXIgY3N2O1xuICAgIHZhciBmb3JtX2luZGV4ID0gZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4O1xuICAgIHZhciBpbnB1dHMgPSBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0LmZvcm1zW2Zvcm1faW5kZXhdLmlucHV0cztcblxuICAgIGZvcm1idWlsZGVyLnJlbmRlcl9hY3Rpb24gPSBjb25zdHMuUkVOREVSX0FDVElPTl9ETztcblxuICAgIGZ1bmN0aW9uIF9nZXRJbnB1dCgpIHtcblxuICAgICAgICAvL2NoZWNrIHdoZXRoZXIgd2UgYXJlIHZhbGlkYXRpbiBhIG5lc3RlZCBpbnB1dCBpLmUuIEJPVEggYnJhbmNoIEFORCBncm91cCBlZGl0IGZsYWdzIGFyZSB0cnVlXG4gICAgICAgIGlmIChmb3JtYnVpbGRlci5pc19lZGl0aW5nX2JyYW5jaCAmJiBmb3JtYnVpbGRlci5pc19lZGl0aW5nX2dyb3VwKSB7XG4gICAgICAgICAgICAvL2dldCBuZXN0ZWQgZ3JvdXAgaW5wdXRcbiAgICAgICAgICAgIG93bmVyX2JyYW5jaCA9IHV0aWxzLmdldElucHV0T2JqZWN0QnlSZWYoZm9ybWJ1aWxkZXIuYnJhbmNoLmFjdGl2ZV9icmFuY2hfcmVmKTtcbiAgICAgICAgICAgIGlucHV0ID0gdXRpbHMuZ2V0TmVzdGVkR3JvdXBJbnB1dE9iamVjdEJ5UmVmKG93bmVyX2JyYW5jaCwgZm9ybWJ1aWxkZXIuZ3JvdXAuY3VycmVudF9pbnB1dF9yZWYpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaWYgKGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfYnJhbmNoKSB7XG4gICAgICAgICAgICAgICAgLy9nZXQgc2VsZWN0ZWQgYnJhbmNoIGlucHV0XG4gICAgICAgICAgICAgICAgaW5wdXQgPSB1dGlscy5nZXRCcmFuY2hJbnB1dE9iamVjdEJ5UmVmKGZvcm1idWlsZGVyLmJyYW5jaC5jdXJyZW50X2lucHV0X3JlZik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChmb3JtYnVpbGRlci5pc19lZGl0aW5nX2dyb3VwKSB7XG4gICAgICAgICAgICAgICAgLy9nZXQgc2VsZWN0ZWQgZ3JvdXAgaW5wdXRcbiAgICAgICAgICAgICAgICBpbnB1dCA9IHV0aWxzLmdldEdyb3VwSW5wdXRPYmplY3RCeVJlZihmb3JtYnVpbGRlci5ncm91cC5jdXJyZW50X2lucHV0X3JlZik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gaW5wdXQ7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gX3ZhbGlkYXRlQnJhbmNoKCkge1xuXG4gICAgICAgIC8vY2hlY2sgdGhlIGJyYW5jaCBoYXMgZ290IGF0IGxlYXN0IDEgaW5wdXQgbGVmdFxuXG4gICAgICAgIHZhciBhY3RpdmVfYnJhbmNoID0gdXRpbHMuZ2V0SW5wdXRPYmplY3RCeVJlZihmb3JtYnVpbGRlci5icmFuY2guYWN0aXZlX2JyYW5jaF9yZWYpO1xuXG4gICAgICAgIGlmIChhY3RpdmVfYnJhbmNoLmJyYW5jaC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB2YWxpZGF0aW9uLnBlcmZvcm1WYWxpZGF0aW9uKGFjdGl2ZV9icmFuY2guYnJhbmNoWzBdLCBmYWxzZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvL2ludmFsaWQgdGhlIGZvcm0gYXMgaXQgZG9lcyBub3QgaGF2ZSBhbnkgaW5wdXRzXG4gICAgICAgICAgICB1aS5mb3Jtc190YWJzLnNob3dGb3JtSW52YWxpZEljb24oZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4KTtcblxuICAgICAgICAgICAgLy9kaXNhYmxlIHNhdmUgcHJvamVjdCBidXR0b25cbiAgICAgICAgICAgIHVpLm5hdmJhci50b2dnbGVTYXZlUHJvamVjdEJ0bihjb25zdHMuQlROX0RJU0FCTEVEKTtcbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5zYXZlX3Byb2plY3RfYnRuLm9mZignY2xpY2snKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIF92YWxpZGF0ZUZvcm0oKSB7XG5cbiAgICAgICAgdmFyIGZvcm1faW5kZXggPSBmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXg7XG5cbiAgICAgICAgaWYgKGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbi5kYXRhLnByb2plY3QuZm9ybXNbZm9ybV9pbmRleF0uaW5wdXRzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGZpcnN0X2lucHV0X3JlZiA9IGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbi5kYXRhLnByb2plY3QuZm9ybXNbZm9ybV9pbmRleF0uaW5wdXRzWzBdLnJlZjtcbiAgICAgICAgICAgIGlmIChmaXJzdF9pbnB1dF9yZWYpIHtcbiAgICAgICAgICAgICAgICB2YWxpZGF0aW9uLnBlcmZvcm1WYWxpZGF0aW9uKHV0aWxzLmdldElucHV0T2JqZWN0QnlSZWYoZmlyc3RfaW5wdXRfcmVmKSwgZmFsc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy9pbnZhbGlkIHRoZSBmb3JtIGFzIGl0IGRvZXMgbm90IGhhdmUgYW55IGlucHV0c1xuICAgICAgICAgICAgdWkuZm9ybXNfdGFicy5zaG93Rm9ybUludmFsaWRJY29uKGZvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleCk7XG5cbiAgICAgICAgICAgIC8vZGlzYWJsZSBzYXZlIHByb2plY3QgYnV0dG9uXG4gICAgICAgICAgICB1aS5uYXZiYXIudG9nZ2xlU2F2ZVByb2plY3RCdG4oY29uc3RzLkJUTl9ESVNBQkxFRCk7XG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uc2F2ZV9wcm9qZWN0X2J0bi5vZmYoJ2NsaWNrJyk7XG5cbiAgICAgICAgICAgIC8vYWRkIG5vIHF1ZXN0aW9uIG1lc3NhZ2VcbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbi5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fbm8tcXVlc3Rpb25zLW1lc3NhZ2UnKS5yZW1vdmVDbGFzcygnaGlkZGVuJyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvL2dldCBob2xkIG9mIGFkdmFuY2VkIHByb3BlcnRpZXMgcGFuZWwgZm9yIHRoaXMgaW5wdXRcbiAgICBpbnB1dC5kb20uYWR2YW5jZWRfcHJvcGVydGllc193cmFwcGVyID0gZm9ybWJ1aWxkZXJcbiAgICAgICAgLmRvbVxuICAgICAgICAuaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyXG4gICAgICAgIC5maW5kKCdmb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIGlucHV0LnJlZiArICdcIl0nKVxuICAgICAgICAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2FkdmFuY2VkLXByb3BlcnRpZXMnKTtcblxuICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgKiBSZW1vdmUgc2VsZWN0ZWQgaW5wdXRcbiAgICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4gICAgaWYgKHRhcmdldC5oYXNDbGFzcygnaW5wdXQtcHJvcGVydGllc19fYnV0dG9ucy0tcmVtb3ZlLWlucHV0JykpIHtcblxuICAgICAgICAvL3JlLW5hYmxlIGRyYWdnYWJsZSBpZiBuZWVkZWRcbiAgICAgICAgaWYgKCQoJ3VsI2lucHV0cy10b29scy1saXN0IGxpIGRpdi5pbnB1dCcpLmhhc0NsYXNzKCdkcmFnZ2luZy1kaXNhYmxlZCcpKSB7XG4gICAgICAgICAgICB1aS5pbnB1dF90b29scy5lbmFibGUoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vZW5hYmxlIHNhdmUgcHJvamVjdCBidXR0b25cbiAgICAgICAgdWkubmF2YmFyLnRvZ2dsZVNhdmVQcm9qZWN0QnRuKGNvbnN0cy5CVE5fRU5BQkxFRCk7XG5cbiAgICAgICAgLy9jaGVjayB3aGV0aGVyIHdlIGFyZSB2YWxpZGF0aW4gYSBuZXN0ZWQgaW5wdXQgaS5lLiBCT1RIIGJyYW5jaCBBTkQgZ3JvdXAgZWRpdCBmbGFncyBhcmUgdHJ1ZVxuICAgICAgICBpZiAoZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19icmFuY2ggJiYgZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19ncm91cCkge1xuXG4gICAgICAgICAgICAvL3JlbW92ZSBuZXN0ZWQgZ3JvdXBcbiAgICAgICAgICAgIGlucHV0X2ZhY3RvcnkucmVtb3ZlTmVzdGVkR3JvdXBJbnB1dChmb3JtYnVpbGRlci5icmFuY2guYWN0aXZlX2JyYW5jaF9yZWYsIGZvcm1idWlsZGVyLmdyb3VwLmN1cnJlbnRfaW5wdXRfcmVmKTtcbiAgICAgICAgICAgIHRvYXN0ci53YXJuaW5nKG1lc3NhZ2VzLndhcm5pbmcuSU5QVVRfREVMRVRFRCk7XG4gICAgICAgICAgICBfdmFsaWRhdGVGb3JtKCk7XG4gICAgICAgICAgICAvL3B1c2ggc3RhdGUgdG8gZW5hYmxlIHVuZG9pbmcgdGhlIGFjdGlvbiAoZGVsZXRpbmcgaW5wdXQpXG4gICAgICAgICAgICB1bmRvLnB1c2hTdGF0ZSgpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuXG4gICAgICAgICAgICAvL25lc3RlZCBncm91cD9cbiAgICAgICAgICAgIGlmIChmb3JtYnVpbGRlci5pc19lZGl0aW5nX2JyYW5jaCAmJiBmb3JtYnVpbGRlci5pc19lZGl0aW5nX2dyb3VwKSB7XG4gICAgICAgICAgICAgICAgLy90byBoYW5kbGUgbmVzdGVkIGdyb3VwXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcblxuICAgICAgICAgICAgICAgIGlmIChmb3JtYnVpbGRlci5pc19lZGl0aW5nX2JyYW5jaCkge1xuICAgICAgICAgICAgICAgICAgICBpbnB1dF9mYWN0b3J5LnJlbW92ZUJyYW5jaElucHV0KGlucHV0LnJlZiwgZm9ybWJ1aWxkZXIuYnJhbmNoLmN1cnJlbnRfaW5wdXRfcmVmKTtcbiAgICAgICAgICAgICAgICAgICAgdG9hc3RyLndhcm5pbmcobWVzc2FnZXMud2FybmluZy5JTlBVVF9ERUxFVEVEKTtcblxuICAgICAgICAgICAgICAgICAgICAvL3J1biB2YWxpZGF0aW9uIGFzIEkgbWlnaHQgaGF2ZSBkZWxldGVkIHRoZSBvbmx5IGludmFsaWQgaW5wdXQgZm9yIHRoZSBicmFuY2hcbiAgICAgICAgICAgICAgICAgICAgLy9zaW5jZSB0aGVyZSBpcyBub3QgYSBwcmV2aW91cyBvbmUsIHNvIGl0IHVzZXMgdGhlIGZpcnN0IGlucHV0IG9mIHRoZSB0b3AgcGFyZW50IGZvcm0gKGlmIGFueSkganVzdCB0byB0cmlnZ2VyIHRoZSB2YWxpZGF0aW9uXG4gICAgICAgICAgICAgICAgICAgIF92YWxpZGF0ZUJyYW5jaCgpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vcHVzaCBzdGF0ZSB0byBlbmFibGUgdW5kb2luZyB0aGUgYWN0aW9uIChkZWxldGluZyBpbnB1dClcbiAgICAgICAgICAgICAgICAgICAgdW5kby5wdXNoU3RhdGUoKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChmb3JtYnVpbGRlci5pc19lZGl0aW5nX2dyb3VwKSB7XG4gICAgICAgICAgICAgICAgICAgIGlucHV0X2ZhY3RvcnkucmVtb3ZlR3JvdXBJbnB1dChpbnB1dC5yZWYsIGZvcm1idWlsZGVyLmdyb3VwLmN1cnJlbnRfaW5wdXRfcmVmKTtcbiAgICAgICAgICAgICAgICAgICAgdG9hc3RyLndhcm5pbmcobWVzc2FnZXMud2FybmluZy5JTlBVVF9ERUxFVEVEKTtcbiAgICAgICAgICAgICAgICAgICAgLy9wdXNoIHN0YXRlIHRvIGVuYWJsZSB1bmRvaW5nIHRoZSBhY3Rpb24gKGRlbGV0aW5nIGlucHV0KVxuICAgICAgICAgICAgICAgICAgICB1bmRvLnB1c2hTdGF0ZSgpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL3JlbW92ZSBpbnB1dCBmcm9tIGlucHV0IGNvbGxlY3Rpb24gKGFsc28gcmVtb3ZlIGl0cyBwcm9wZXJ0aWVzKVxuICAgICAgICAgICAgaW5wdXRfZmFjdG9yeS5yZW1vdmVJbnB1dChpbnB1dC5yZWYpO1xuICAgICAgICAgICAgdG9hc3RyLndhcm5pbmcobWVzc2FnZXMud2FybmluZy5JTlBVVF9ERUxFVEVEKTtcblxuICAgICAgICAgICAgLy90b2RvIEkgbmVlZCB0byBkbyB0aGUgc2FtZSBmb3IgYnJhbmNoZXMsIGdyb3VwcyBhbmQgbmVzdGVkIGdyb3Vwc1xuICAgICAgICAgICAgLy9ydW4gdmFsaWRhdGlvbiBhcyBJIG1pZ2h0IGhhdmUgZGVsZXRlZCB0aGUgb25seSBpbnZhbGlkIGlucHV0XG4gICAgICAgICAgICAvL3RoZXJlIGlzIG5vdCBhIHByZXZpb3VzIG9uZSwgc28gaXQgdXNlcyB0aGUgZmlyc3QgaW5wdXQgb2YgdGhlIHRvcCBwYXJlbnQgZm9ybSAoaWYgYW55KVxuICAgICAgICAgICAgX3ZhbGlkYXRlRm9ybSgpO1xuICAgICAgICAgICAgLy9wdXNoIHN0YXRlIHRvIGVuYWJsZSB1bmRvaW5nIHRoZSBhY3Rpb24gKGRlbGV0aW5nIGlucHV0KVxuICAgICAgICAgICAgdW5kby5wdXNoU3RhdGUoKTtcblxuICAgICAgICAgICAgLy9zaG93IG1lc3NhZ2UgYW5kIGltcG9ydCBidXR0b24gd2hlbiBubyBpbnB1dHMgbGVmdFxuXG4gICAgICAgICAgICAvL3JlbW92ZSBubyBxdWVzdGlvbnMgbWVzc2FnZSBhbmQgdXBsb2FkIGJ1dHRvbiwgYXMgbm93IHdlIGhhdmUgYXQgbGVhc3QgMSBpbnB1dFxuICAgICAgICAgICAgLy90b2RvIGF2b2lkIHRvIHRvIHRoaXMgYWxsIHRoZSB0aW1lP1xuICAgICAgICAgICAgaWYgKGlucHV0cy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25cbiAgICAgICAgICAgICAgICAgICAgLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19uby1xdWVzdGlvbnMtbWVzc2FnZScpXG4gICAgICAgICAgICAgICAgICAgIC5oaWRlKClcbiAgICAgICAgICAgICAgICAgICAgLnJlbW92ZUNsYXNzKCdoaWRkZW4nKVxuICAgICAgICAgICAgICAgICAgICAuZmFkZUluKCk7XG5cbiAgICAgICAgICAgICAgICAvL2hpZGUgdGl0bGUgd2FybmluZyBtZXNzYWdlLCBwYXNzaW5nIGEgY291bnQgPiAxXG4gICAgICAgICAgICAgICAgdWkuaW5wdXRzX2NvbGxlY3Rpb24udG9nZ2xlVGl0bGVXYXJuaW5nKDEsIGZhbHNlKTtcblxuICAgICAgICAgICAgICAgIC8vZGlzYWJsZSBkb3dubG9hZCBmb3JtIGJ1dHRvblxuICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvblxuICAgICAgICAgICAgICAgICAgICAuZmluZCgnLmlucHV0cy1jb2xsZWN0aW9uX19leHBvcnQtZm9ybScpLmFkZENsYXNzKCdkaXNhYmxlZCcpO1xuXG4gICAgICAgICAgICAgICAgLy9kaXNhYmxlIHByaW50IGFzIHBkZiBmb3JtIGJ1dHRvblxuICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvblxuICAgICAgICAgICAgICAgICAgICAuZmluZCgnLmlucHV0cy1jb2xsZWN0aW9uX19wcmludC1hcy1wZGYnKS5hZGRDbGFzcygnZGlzYWJsZWQnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgKiBDb3B5IHNlbGVjdGVkIGlucHV0XG4gICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuICAgIGlmICh0YXJnZXQuaGFzQ2xhc3MoJ2lucHV0LXByb3BlcnRpZXNfX2J1dHRvbnMtLWNvcHktaW5wdXQnKSkge1xuICAgICAgICBjb25zb2xlLmxvZygnY29weWluZyBpbnB1dCAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKionKTtcblxuICAgICAgICB2YXIgaW5wdXRfY29waWVkO1xuICAgICAgICB2YXIgc2VhcmNoX2lucHV0c190b3RhbCA9IHV0aWxzLmdldFNlYXJjaElucHV0c1RvdGFsKCk7XG5cbiAgICAgICAgaW5wdXQgPSBfZ2V0SW5wdXQoKTtcblxuICAgICAgICAvL2lmIHRoZSBpbnB1dCBpcyBub3QgdmFsaWQsIHJlamVjdCBjb3B5IGFjdGlvblxuICAgICAgICBpZiAoIWlucHV0LmRvbS5pc192YWxpZCkge1xuICAgICAgICAgICAgdG9hc3Quc2hvd0Vycm9yKG1lc3NhZ2VzLmVycm9yLklOUFVUX05PVF9WQUxJRCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvL2lmIHdlIHJlYWNoZWQgdGhlIG1heCBudW1iZXIgb2YgcXVlc3Rpb25zIGZvciB0aGlzIGZvcm0sIGJhaWwgb3V0XG4gICAgICAgIGlmICh1dGlscy5nZXRJbnB1dHNUb3RhbChpbnB1dHMpID49IGNvbnN0cy5JTlBVVFNfTUFYX0FMTE9XRUQpIHtcbiAgICAgICAgICAgIHRvYXN0LnNob3dFcnJvcihtZXNzYWdlcy5lcnJvci5NQVhfUVVFU1RJT05TX0xJTUlUX1JFQUNIRUQgKyAnICgnKyBjb25zdHMuSU5QVVRTX01BWF9BTExPV0VEKycpJyk7XG4gICAgICAgICAgICB1aS5pbnB1dF90b29scy5kaXNhYmxlKCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvL2lmIHRoZSBpbnB1dCBpcyBvZiB0eXBlIHNlYXJjaCBhbmQgd2UgcmVhY2hlZCB0aGUgbGltaXQgYWxyZWFkeSwgYmFpbCBvdXRcbiAgICAgICAgaWYoaW5wdXQudHlwZSA9PT0gY29uc3RzLlNFQVJDSF9TSU5HTEVfVFlQRSB8fCBpbnB1dC50eXBlID09PSBjb25zdHMuU0VBUkNIX01VTFRJUExFX1RZUEUpIHtcblxuICAgICAgICAgICAgLy93YXJuIHRoZSB1c2VyIGlmIGxpbWl0IHdhcyByZWFjaGVkXG4gICAgICAgICAgICBpZiAoc2VhcmNoX2lucHV0c190b3RhbCA9PT0gY29uc3RzLkxJTUlUUy5zZWFyY2hfaW5wdXRzX21heCkge1xuICAgICAgICAgICAgICAgIHRvYXN0LnNob3dFcnJvcihtZXNzYWdlcy53YXJuaW5nLlNFQVJDSF9JTlBVVFNfTElNSVRfUkVBQ0hFRCArICcoJyArIGNvbnN0cy5MSU1JVFMuc2VhcmNoX2lucHV0c19tYXggKyAnKScpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vaWYgd2UgYXJlIHJlYWNoaW5nIHRoZSBzZWFyY2ggaW5wdXQgbGltaXRzIHdpdGggdGhpcyBjb3B5LCBoaWRlIHNlYXJjaCBxdWVzdGlvbiB0b29sXG4gICAgICAgICAgICBpZiAoc2VhcmNoX2lucHV0c190b3RhbCA9PT0gY29uc3RzLkxJTUlUUy5zZWFyY2hfaW5wdXRzX21heCAtIDEpIHtcbiAgICAgICAgICAgICAgICAvL2hpZGUgc2VhcmNoIGlucHV0IGZyb20gcXVlc3Rpb24gbGlzdFxuICAgICAgICAgICAgICAgIHVpLmlucHV0X3Rvb2xzLmhpZGVTZWFyY2hJbnB1dCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy9zaG93IG92ZXJsYXlcbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLm92ZXJsYXkuZmFkZUluKCk7XG5cbiAgICAgICAgLy9nZXQgY29weSBpZiBvcmlnaW5hbCBpbnB1dFxuICAgICAgICBpbnB1dF9jb3BpZWQgPSBpbnB1dF9kdXBsaWNhdG9yLmNyZWF0ZUlucHV0Q29weShpbnB1dCk7XG5cbiAgICAgICAgLy9hZGQgY29waWVkIGlucHV0IHRvIHByb2plY3QgZGVmaW5pdGlvblxuICAgICAgICBpbnB1dF9kdXBsaWNhdG9yLnB1c2hJbnB1dChpbnB1dF9jb3BpZWQpO1xuXG4gICAgICAgIC8vYXBwZW5kIHRoZSBjb3BpZWQgaW5wdXQgbWFya3VwXG4gICAgICAgIGlucHV0X2R1cGxpY2F0b3IuYXBwZW5kSW5wdXRUb0RvbShpbnB1dF9jb3BpZWQpO1xuXG4gICAgICAgIC8vaGlkZSBvdmVybGF5ICh3aXRoIGRlbGF5KVxuICAgICAgICB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBmb3JtYnVpbGRlci5kb20ub3ZlcmxheS5mYWRlT3V0KGNvbnN0cy5BTklNQVRJT05fRkFTVCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHRvYXN0LnNob3dTdWNjZXNzKG1lc3NhZ2VzLnN1Y2Nlc3MuSU5QVVRfQ09QSUVEKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LCBjb25zdHMuQU5JTUFUSU9OX1NMT1cpO1xuICAgIH1cblxuICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgKiBWYWxpZGF0ZSBzZWxlY3RlZCBpbnB1dFxuICAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbiAgICBpZiAodGFyZ2V0Lmhhc0NsYXNzKCdpbnB1dC1wcm9wZXJ0aWVzX19idXR0b25zLS12YWxpZGF0ZS1pbnB1dCcpKSB7XG4gICAgICAgIHZhbGlkYXRpb24ucGVyZm9ybVZhbGlkYXRpb24oX2dldElucHV0KCksIHRydWUpO1xuICAgIH1cblxuICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgKiBBZGQgcG9zc2libGUgYW5zd2VyXG4gICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuICAgIGlmICh0YXJnZXQuaGFzQ2xhc3MoJ2lucHV0LXByb3BlcnRpZXNfX2Zvcm1fX3Bvc3NpYmxlLWFuc3dlcnNfX2FkZC1hbnN3ZXInKSkge1xuXG4gICAgICAgIHZhciBwb3NzaWJsZV9hbnN3ZXJzX21heCA9IGNvbnN0cy5MSU1JVFMucG9zc2libGVfYW5zd2Vyc19tYXg7XG5cbiAgICAgICAgaW5wdXQgPSBfZ2V0SW5wdXQoKTtcblxuICAgICAgICBpZiAoaW5wdXQudHlwZSA9PT0gY29uc3RzLlNFQVJDSF9TSU5HTEVfVFlQRSB8fCBpbnB1dC50eXBlID09PSBjb25zdHMuU0VBUkNIX01VTFRJUExFX1RZUEUpIHtcbiAgICAgICAgICAgIHBvc3NpYmxlX2Fuc3dlcnNfbWF4ID0gY29uc3RzLkxJTUlUUy5wb3NzaWJsZV9hbnN3ZXJzX21heF9zZWFyY2g7XG4gICAgICAgIH1cblxuICAgICAgICAvL2FkZCBwb3NzaWJsZSBhbnN3ZXIgKGlmIHRvdGFsIGlzIGxlc3MgdGhhbiBtYXggYWxsb3dlZClcbiAgICAgICAgaWYgKGlucHV0LnBvc3NpYmxlX2Fuc3dlcnMubGVuZ3RoIDwgcG9zc2libGVfYW5zd2Vyc19tYXgpIHtcbiAgICAgICAgICAgIGlucHV0LmFkZFBvc3NpYmxlQW5zd2VyKCk7XG4gICAgICAgICAgICB1bmRvLnB1c2hTdGF0ZSgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAqIFJlbW92ZSBwb3NzaWJsZSBhbnN3ZXJcbiAgICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4gICAgaWYgKHRhcmdldC5oYXNDbGFzcygnaW5wdXQtcHJvcGVydGllc19fZm9ybV9fcG9zc2libGUtYW5zd2Vyc19fbGlzdF9fcmVtb3ZlLWFuc3dlcicpKSB7XG5cbiAgICAgICAgaW5wdXQgPSBfZ2V0SW5wdXQoKTtcblxuICAgICAgICAvL3dlIG5lZWQgdG8gbGVhdmUgYXQgbGVhc3QgMSBwb3NzaWJsZSBhbnN3ZXJcbiAgICAgICAgaWYgKGlucHV0LnBvc3NpYmxlX2Fuc3dlcnMubGVuZ3RoID49IDIpIHtcbiAgICAgICAgICAgIGlucHV0LnJlbW92ZVBvc3NpYmxlQW5zd2VyKHRhcmdldC5jbG9zZXN0KCdsaScpLmluZGV4KCkpO1xuICAgICAgICAgICAgdW5kby5wdXNoU3RhdGUoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgKiBBZGQganVtcCB0byBzZWxlY3RlZCBpbnB1dFxuICAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbiAgICBpZiAodGFyZ2V0Lmhhc0NsYXNzKCdpbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19qdW1wc19fYWRkLWp1bXAnKSkge1xuXG4gICAgICAgIGlucHV0ID0gX2dldElucHV0KCk7XG5cbiAgICAgICAgLy9kaXNhYmxlIHNhdmUgcHJvamVjdCBidXR0b24gYXMgdGhlIG5ldyBhZGRlZCBqdW1wIG1ha2VzIHRoZSBpbnB1dCBpbnZhbGlkXG4gICAgICAgIHVpLm5hdmJhci50b2dnbGVTYXZlUHJvamVjdEJ0bihjb25zdHMuQlROX0RJU0FCTEVEKTtcblxuICAgICAgICAvL3NldCBpbnB1dCBhcyBpbnZhbGlkXG4gICAgICAgIGlucHV0LmRvbS5pc192YWxpZCA9IGZhbHNlO1xuXG4gICAgICAgIC8vZmxhZyBpbnB1dCBkb20gaW4gaW5wdXQgY29sbGVjdGlvbiBhcyBpbnZhbGlkXG4gICAgICAgIHVpLmlucHV0c19jb2xsZWN0aW9uLnNob3dJbnB1dEludmFsaWRJY29uKGlucHV0LnJlZik7XG5cbiAgICAgICAgLy9mbGFnIGN1cnJlbnQgZm9ybSBhcyBpbnZhbGlkXG4gICAgICAgIHVpLmZvcm1zX3RhYnMuc2hvd0Zvcm1JbnZhbGlkSWNvbihmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXgpO1xuXG4gICAgICAgIGlucHV0LmFkZEp1bXAoKTtcbiAgICAgICAgdW5kby5wdXNoU3RhdGUoKTtcbiAgICB9XG5cbiAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gICAgICogUmVtb3ZlIHNlbGVjdGVkIGp1bXBcbiAgICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4gICAgaWYgKHRhcmdldC5oYXNDbGFzcygnaW5wdXQtcHJvcGVydGllc19fZm9ybV9fanVtcHNfX3JlbW92ZS1qdW1wJykpIHtcblxuICAgICAgICBpbnB1dCA9IF9nZXRJbnB1dCgpO1xuXG4gICAgICAgIGlucHV0LnJlbW92ZUp1bXAodGFyZ2V0KTtcblxuICAgICAgICAvL3JldmFsaWRhdGUgaW5wdXQgYWZ0ZXIgZGVsZXRpbmcgYSBqdW1wIGFzIHRoZSBqdW1wIG1pZ2h0IGhhdmUgYmVlbiB0aGUgb25seSB0aGluZyBrZWVwaW5nIGl0IGludmFsaWRcbiAgICAgICAgdmFsaWRhdGlvbi5wZXJmb3JtVmFsaWRhdGlvbihpbnB1dCwgZmFsc2UpO1xuICAgICAgICB1bmRvLnB1c2hTdGF0ZSgpO1xuICAgIH1cblxuICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgKiBFZGl0IGJyYW5jaFxuICAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbiAgICBpZiAodGFyZ2V0Lmhhc0NsYXNzKCdpbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19lZGl0LWJyYW5jaCcpKSB7XG4gICAgICAgIHRhcmdldC5hdHRyKCdkaXNhYmxlZCcsIHRydWUpO1xuICAgICAgICBpbnB1dC5lbnRlckJyYW5jaFNvcnRhYmxlKCk7XG4gICAgfVxuICAgIGlmICh0YXJnZXQuaGFzQ2xhc3MoJ2lucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2V4aXQtYnJhbmNoLWVkaXRpbmcnKSkge1xuICAgICAgICB0YXJnZXQuYXR0cignZGlzYWJsZWQnLCB0cnVlKTtcbiAgICAgICAgdGFyZ2V0LnByZXYoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19lZGl0LWJyYW5jaCcpLmF0dHIoJ2Rpc2FibGVkJywgZmFsc2UpO1xuICAgICAgICBpbnB1dC5leGl0QnJhbmNoU29ydGFibGUoKTtcbiAgICB9XG5cbiAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gICAgICogRWRpdCBncm91cFxuICAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbiAgICBpZiAodGFyZ2V0Lmhhc0NsYXNzKCdpbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19lZGl0LWdyb3VwJykpIHtcbiAgICAgICAgdGFyZ2V0LmF0dHIoJ2Rpc2FibGVkJywgdHJ1ZSk7XG5cbiAgICAgICAgLy9jaGVjayB3aGV0aGVyIHdlIGFyZSBlZGl0aW5nIGEgZ3JvdXAgbmVzdGVkIGludG8gYSBicmFuY2hcbiAgICAgICAgaWYgKGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfYnJhbmNoKSB7XG5cbiAgICAgICAgICAgIG5lc3RlZF9ncm91cCA9IHV0aWxzLmdldEJyYW5jaElucHV0T2JqZWN0QnlSZWYoZm9ybWJ1aWxkZXIuYnJhbmNoLmN1cnJlbnRfaW5wdXRfcmVmKTtcblxuICAgICAgICAgICAgaWYgKG5lc3RlZF9ncm91cCkge1xuICAgICAgICAgICAgICAgIC8vdXNlciBjbGlja2VkIG9uIGVkaXQgbmVzdGVkIGdyb3VwIGJ1dHRvblxuICAgICAgICAgICAgICAgIGlucHV0ID0gbmVzdGVkX2dyb3VwO1xuICAgICAgICAgICAgICAgIGlucHV0LmVudGVyR3JvdXBTb3J0YWJsZSh0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlucHV0LmVudGVyR3JvdXBTb3J0YWJsZShmYWxzZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAodGFyZ2V0Lmhhc0NsYXNzKCdpbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19leGl0LWdyb3VwLWVkaXRpbmcnKSkge1xuICAgICAgICB0YXJnZXQuYXR0cignZGlzYWJsZWQnLCB0cnVlKTtcbiAgICAgICAgdGFyZ2V0LnByZXYoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19lZGl0LWJyYW5jaCcpLmF0dHIoJ2Rpc2FibGVkJywgZmFsc2UpO1xuXG4gICAgICAgIC8vY2hlY2sgd2hldGhlciB3ZSBhcmUgZWRpdGluZyBhIGdyb3VwIG5lc3RlZCBpbnRvIGEgYnJhbmNoXG4gICAgICAgIGlmIChmb3JtYnVpbGRlci5pc19lZGl0aW5nX2JyYW5jaCkge1xuICAgICAgICAgICAgbmVzdGVkX2dyb3VwID0gdXRpbHMuZ2V0QnJhbmNoSW5wdXRPYmplY3RCeVJlZihmb3JtYnVpbGRlci5icmFuY2guY3VycmVudF9pbnB1dF9yZWYpO1xuXG4gICAgICAgICAgICBpZiAobmVzdGVkX2dyb3VwKSB7XG4gICAgICAgICAgICAgICAgLy91c2VyIGNsaWNrZWQgb24gZWRpdCBuZXN0ZWQgZ3JvdXAgYnV0dG9uXG4gICAgICAgICAgICAgICAgaW5wdXQgPSBuZXN0ZWRfZ3JvdXA7XG4gICAgICAgICAgICAgICAgaW5wdXQuZXhpdEdyb3VwU29ydGFibGUodHJ1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpbnB1dC5leGl0R3JvdXBTb3J0YWJsZShmYWxzZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAodGFyZ2V0Lmhhc0NsYXNzKCdwb3NzaWJsZV9hbnN3ZXJzX19leHBvcnQtY3N2JykpIHtcblxuICAgICAgICAvL3Nob3cgb3ZlcmxheSBhbmQgY3Vyc29yXG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5vdmVybGF5LmZhZGVJbigwKTtcblxuICAgICAgICBjc3YgPSBwb3NzaWJsZV9hbnN3ZXJzLmV4cG9ydFBvc3NpYmxlQW5zd2Vyc0NTVigpO1xuXG4gICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5vdmVybGF5LmZhZGVPdXQoY29uc3RzLkFOSU1BVElPTl9GQVNUKTtcblxuICAgICAgICAgICAgaWYgKGNzdikge1xuICAgICAgICAgICAgICAgIC8vZG8gZXhwb3J0XG4gICAgICAgICAgICAgICAgdmFyIGZpbGU7XG5cbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBmaWxlID0gbmV3IEZpbGUoW2Nzdi5kYXRhXSwgY3N2LmZpbGVuYW1lLCB7IHR5cGU6ICd0ZXh0L3BsYWluOmNoYXJzZXQ9dXRmLTgnIH0pO1xuICAgICAgICAgICAgICAgICAgICBzYXZlQXMoZmlsZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAvL01pY3Jvc29mdCBicm93c2Vycz9cbiAgICAgICAgICAgICAgICAgICAgaWYgKG5hdmlnYXRvci5tc1NhdmVCbG9iKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmF2aWdhdG9yLm1zU2F2ZUJsb2IobmV3IEJsb2IoW2Nzdi5kYXRhXSwgeyB0eXBlOiAndGV4dC9wbGFpbjpjaGFyc2V0PXV0Zi04JyB9KSwgY3N2LmZpbGVuYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vYnJvd3NlciBub3Qgc3VwcG9ydGVkIHlldFxuICAgICAgICAgICAgICAgICAgICAgICAgdG9hc3Quc2hvd0Vycm9yKG1lc3NhZ2VzLmVycm9yLkJST1dTRVJfTk9UX1NVUFBPUlRFRCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAvL3Nob3cgZXJyb3JcbiAgICAgICAgICAgICAgICB0b2FzdC5zaG93RXJyb3IobWVzc2FnZXMuZXJyb3IuUE9TU0lCTEVfQU5TV0VSU19JTlZBTElEKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwgY29uc3RzLkFOSU1BVElPTl9TVVBFUl9TTE9XKTtcbiAgICB9XG5cbiAgICBpZiAodGFyZ2V0Lmhhc0NsYXNzKCdwb3NzaWJsZV9hbnN3ZXJzX19pbXBvcnQtY3N2JykpIHtcblxuICAgICAgICAvL2ltcG9ydCBmaWxlIGZpcnN0IHRoZW4gc2hvdyBtb2RhbCB0byBwaWNrIHdoaWNoIGNvbHVtbiAoaWYgbW9yZSB0aGFuIG9uZSlcbiAgICAgICAgLy90b2RvIG5vdCB1c2Ugd2luZG93LCB1c2UgZm9ybWJ1aWxkZXIgb2JqZWN0XG4gICAgICAgIGlmICghZm9ybWJ1aWxkZXIuaXNPcGVuaW5nRmlsZUJyb3dzZXIpIHtcblxuICAgICAgICAgICAgdmFyIGZpbGVfaW5wdXQgPSB0YXJnZXQuZmluZCgnLnBvc3NpYmxlX2Fuc3dlcnNfX2ltcG9ydC1jc3YtaW5wdXQtZmlsZScpO1xuXG4gICAgICAgICAgICBmb3JtYnVpbGRlci5pc09wZW5pbmdGaWxlQnJvd3NlciA9IHRydWU7XG5cbiAgICAgICAgICAgIGZpbGVfaW5wdXQub2ZmKCdjaGFuZ2UnKS5vbignY2hhbmdlJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHBvc3NpYmxlX2Fuc3dlcnMuaW1wb3J0Q1NWRmlsZSh0aGlzLmZpbGVzKTtcbiAgICAgICAgICAgICAgICAkKHRoaXMpLnZhbChudWxsKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB0YXJnZXQuZmluZCgnLnBvc3NpYmxlX2Fuc3dlcnNfX2ltcG9ydC1jc3YtaW5wdXQtZmlsZScpLnRyaWdnZXIoJ2NsaWNrJyk7XG4gICAgICAgIH1cblxuICAgICAgICAvL3RvIGF2b2lkIGEgaW5maW50ZSBsb29wIChzaW5jZSB3ZSBhcmUgdHJpZ2dlcmluZyB0aGUgY2xpY2sgZXZlbnQpXG4gICAgICAgIC8vd2UgcmVtb3ZlIHRoZSBmbGFnIGxhdGVyLCB0byBiZSBhYmxlIHRvIHVwbG9hZCBhbm90aGVyIGZpbGVcbiAgICAgICAgLy9ldmVuIGlmIHRoZSB1c2VyIHRhcHBlZCBvbiBcImNhbmNlbFwiXG4gICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmlzT3BlbmluZ0ZpbGVCcm93c2VyID0gZmFsc2U7XG4gICAgICAgIH0sIDMwMDApO1xuXG4gICAgfVxuXG4gICAgaWYgKHRhcmdldC5oYXNDbGFzcygncG9zc2libGVfYW5zd2Vyc19fZGVsZXRlLWFsbCcpKSB7XG4gICAgICAgIHBvc3NpYmxlX2Fuc3dlcnMuZGVsZXRlQWxsQW5zd2VycygpO1xuICAgIH1cblxuICAgIGlmICh0YXJnZXQuaGFzQ2xhc3MoJ3Bvc3NpYmxlX2Fuc3dlcnNfX29yZGVyLWF6JykpIHtcbiAgICAgICAgcG9zc2libGVfYW5zd2Vycy5vcmRlclBvc3NpYmxlQW5zd2Vycyhjb25zdHMuUE9TU0lCTEVfQU5TV0VSU19PUkRFUi5BWik7XG4gICAgfVxuXG4gICAgaWYgKHRhcmdldC5oYXNDbGFzcygncG9zc2libGVfYW5zd2Vyc19fb3JkZXItemEnKSkge1xuICAgICAgICBwb3NzaWJsZV9hbnN3ZXJzLm9yZGVyUG9zc2libGVBbnN3ZXJzKGNvbnN0cy5QT1NTSUJMRV9BTlNXRVJTX09SREVSLlpBKTtcbiAgICB9XG5cbiAgICBpZiAodGFyZ2V0Lmhhc0NsYXNzKCdwb3NzaWJsZV9hbnN3ZXJzX19vcmRlci1zaHVmZmxlJykpIHtcbiAgICAgICAgcG9zc2libGVfYW5zd2Vycy5vcmRlclBvc3NpYmxlQW5zd2Vycyhjb25zdHMuUE9TU0lCTEVfQU5TV0VSU19PUkRFUi5TSFVGRkxFKTtcbiAgICB9XG5cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gY2FsbGJhY2s7XG4iLCIvKiBnbG9iYWwgJCwgdG9hc3RyKi9cbid1c2Ugc3RyaWN0JztcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgdWkgPSByZXF1aXJlKCdoZWxwZXJzL3VpJyk7XG52YXIgdXRpbHMgPSByZXF1aXJlKCdoZWxwZXJzL3V0aWxzJyk7XG52YXIganVtcHMgPSByZXF1aXJlKCdhY3Rpb25zL2p1bXBzJyk7XG52YXIgbWVzc2FnZXMgPSByZXF1aXJlKCdjb25maWcvbWVzc2FnZXMnKTtcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJ2NvbmZpZy9mb3JtYnVpbGRlcicpO1xuXG52YXIgY2FsbGJhY2sgPSBmdW5jdGlvbiAoZSkge1xuXG4gICAgdmFyIGlucHV0ID0gdXRpbHMuZ2V0SW5wdXRPYmplY3RCeVJlZihmb3JtYnVpbGRlci5jdXJyZW50X2lucHV0X3JlZik7XG4gICAgdmFyIGlucHV0cyA9IGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbi5kYXRhLnByb2plY3QuZm9ybXNbZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4XS5pbnB1dHM7XG4gICAgdmFyIGp1bXBfZGVzdGluYXRpb25zO1xuICAgIHZhciBvd25lcl9icmFuY2g7XG5cbiAgICAvL2lzIGVkaXRpbmcgYSBicmFuY2g/XG4gICAgaWYgKGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfYnJhbmNoKSB7XG4gICAgICAgIC8vb3ZlcnJpZGUgaW5wdXRzLCBnZXQgYnJhbmNoIGlucHV0cyBmcm9tIG93bmVyIGlucHV0XG4gICAgICAgIGlucHV0cyA9IGlucHV0LmJyYW5jaDtcbiAgICAgICAgLy9vdmVycmlkZSBpbnB1dCB0byBiZSB0aGUgYnJhbmNoIGlucHV0XG4gICAgICAgIGlucHV0ID0gdXRpbHMuZ2V0QnJhbmNoSW5wdXRPYmplY3RCeVJlZihmb3JtYnVpbGRlci5icmFuY2guY3VycmVudF9pbnB1dF9yZWYpO1xuXG4gICAgICAgIC8vaGFuZGxlIG5lc3RlZCBncm91cCBpbnNpZGUgYSBicmFuY2hcbiAgICAgICAgaWYgKGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfZ3JvdXApIHtcbiAgICAgICAgICAgIGlucHV0cyA9IGlucHV0Lmdyb3VwO1xuICAgICAgICAgICAgb3duZXJfYnJhbmNoID0gdXRpbHMuZ2V0SW5wdXRPYmplY3RCeVJlZihmb3JtYnVpbGRlci5icmFuY2guYWN0aXZlX2JyYW5jaF9yZWYpO1xuICAgICAgICAgICAgaW5wdXQgPSB1dGlscy5nZXROZXN0ZWRHcm91cElucHV0T2JqZWN0QnlSZWYob3duZXJfYnJhbmNoLCBmb3JtYnVpbGRlci5ncm91cC5jdXJyZW50X2lucHV0X3JlZik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIC8vaXMgZWRpdGluZyBhIGdyb3VwP1xuICAgICAgICBpZiAoZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19ncm91cCkge1xuICAgICAgICAgICAgLy9vdmVycmlkZSBpbnB1dHMsIGdldCBncm91cCBpbnB1dHMgZnJvbSBvd25lciBpbnB1dFxuICAgICAgICAgICAgaW5wdXRzID0gaW5wdXQuZ3JvdXA7XG4gICAgICAgICAgICAvL292ZXJyaWRlIGlucHV0IHRvIGJlIHRoZSBicmFuY2ggaW5wdXRcbiAgICAgICAgICAgIGlucHV0ID0gdXRpbHMuZ2V0R3JvdXBJbnB1dE9iamVjdEJ5UmVmKGZvcm1idWlsZGVyLmdyb3VwLmN1cnJlbnRfaW5wdXRfcmVmKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vZ2V0IGFsbCBqdW1wcyBhdmFpbGFibGVcbiAgICBqdW1wX2Rlc3RpbmF0aW9ucyA9IHV0aWxzLmdldEp1bXBBdmFpbGFibGVEZXN0aW5hdGlvbnMoaW5wdXQsIGlucHV0cyk7XG5cbiAgICAvL2NoZWNrIGlmIHRoZSA8c2VsZWN0PiBpcyBlaXRoZXIgYSBqdW1wIGxvZ2ljIG9yIGEgbXVsdGlwbGUgY2hvaWNlIGlucHV0XG4gICAgaWYgKCQodGhpcykuYXR0cignZGF0YS1qdW1wLWxvZ2ljJykpIHtcblxuICAgICAgICB2YXIgZm9jdXNlZF9zZWxlY3QgPSAkKHRoaXMpO1xuICAgICAgICB2YXIgZm9jdXNlZF9zZWxlY3RfaWQgPSBmb2N1c2VkX3NlbGVjdC5hdHRyKCdpZCcpO1xuXG4gICAgICAgIC8vc3BsaXQgb24gdGhlIGRhc2ggdG8gcmVtb3ZlIHRoZSBmaXJzdCBwYXJ0IG9mIFwiZm9jdXNlZF9zZWxlY3RfaWRcIiBhcyBpdCBjYW5cbiAgICAgICAgLy9iZSAxLSwgMi0sIDExLSwgNDUtLi4uLiBzbzpcbiAgICAgICAgdmFyIGZvY3VzZWRfc2VsZWN0X2lkX3BhcnRzID0gZm9jdXNlZF9zZWxlY3RfaWQuc3BsaXQoJy0nKTtcbiAgICAgICAgZm9jdXNlZF9zZWxlY3RfaWRfcGFydHMuc2hpZnQoKTtcbiAgICAgICAgZm9jdXNlZF9zZWxlY3RfaWQgPSBmb2N1c2VkX3NlbGVjdF9pZF9wYXJ0cy5qb2luKCctJyk7XG4gICAgICAgIC8vdG9kbyB0aGUgYWJvdmUgaXMgZmFzdGVyIHdpdGggYSByZWdleCwgd2hlbiB0aGVyZSBpcyB0aW1lLi4uXG5cbiAgICAgICAgc3dpdGNoIChmb2N1c2VkX3NlbGVjdF9pZCkge1xuXG4gICAgICAgICAgICAvL2ZvciBvcGVuIGFuc3dlciBpbnB1dCB0eXBlIGxpa2UgICd0ZXh0JywgdGhpcyB3aWxsIGJlIHNldCB0byAnYWx3YXlzJ1xuICAgICAgICAgICAgY2FzZSBpbnB1dC5yZWYgKyAnLWxvZ2ljLXdoZW4nOlxuICAgICAgICAgICAgICAgIC8vbGlzdCBhbCB0aGUgYXZhaWxhYmxlIGNvbmRpdGlvbnNcbiAgICAgICAgICAgICAgICBqdW1wcy5saXN0SnVtcENvbmRpdGlvbnMoZm9jdXNlZF9zZWxlY3QpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgLypcbiAgICAgICAgICAgICBnZXQgYWxsIHBvc3NpYmxlIGFuc3dlcnMgZm9yIGN1cnJlbnQgaW5wdXQgYW5kIGxpc3QgdGhlbSBhcyBvcHRpb25zXG4gICAgICAgICAgICAgKGZvciBvcGVuIGFuc3dlciBpbnB1dCB0eXBlIGxpa2UgICd0ZXh0JywgdGhpcyB3aWxsIGJlIGhpZGRlbilcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgY2FzZSBpbnB1dC5yZWYgKyAnLWxvZ2ljLWFuc3dlcic6XG4gICAgICAgICAgICAgICAganVtcHMubGlzdEp1bXBQb3NzaWJsZUFuc3dlcnMoZm9jdXNlZF9zZWxlY3QsIGlucHV0KTtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgLy9nZXQgYWxsIHBvc3NpYmxlIGp1bXAgZGVzdGluYXRpb25zIGZvciBjdXJyZW50IGlucHV0IGFuZCBsaXN0IHRoZW0gYXMgb3B0aW9uc1xuICAgICAgICAgICAgY2FzZSBpbnB1dC5yZWYgKyAnLWxvZ2ljLWdvdG8nOlxuICAgICAgICAgICAgICAgIGp1bXBzLmxpc3RKdW1wRGVzdGluYXRpb25zKGZvY3VzZWRfc2VsZWN0LCBqdW1wX2Rlc3RpbmF0aW9ucyk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGlucHV0Lmxpc3RQb3NzaWJsZUluaXRpYWxBbnN3ZXJzKCk7XG4gICAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBjYWxsYmFjaztcbiIsIi8qIGdsb2JhbCAkLCB0b2FzdHIqL1xuJ3VzZSBzdHJpY3QnO1xudmFyIGNvbnN0cyA9IHJlcXVpcmUoJ2NvbmZpZy9jb25zdHMnKTtcbnZhciB1aSA9IHJlcXVpcmUoJ2hlbHBlcnMvdWknKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoJ2hlbHBlcnMvdXRpbHMnKTtcbnZhciBqdW1wcyA9IHJlcXVpcmUoJ2FjdGlvbnMvanVtcHMnKTtcbnZhciBtZXNzYWdlcyA9IHJlcXVpcmUoJ2NvbmZpZy9tZXNzYWdlcycpO1xudmFyIGZvcm1idWlsZGVyID0gcmVxdWlyZSgnY29uZmlnL2Zvcm1idWlsZGVyJyk7XG52YXIgdmFsaWRhdGlvbiA9IHJlcXVpcmUoJ2FjdGlvbnMvdmFsaWRhdGlvbicpO1xuXG52YXIgY2FsbGJhY2sgPSBmdW5jdGlvbiAoZSkge1xuXG4gICAgLy9pZ25vcmUgbGVmdCBhbmQgcmlnaHQgYXJyb3cga2V5Ym9hcmQga2V5cyAob3RoZXJ3aXNlIHRoZSB1c2VyIGNhbm5vdCBlZGl0IGEgc3RyaW5nKVxuICAgIC8vZnJvbSB0aGUgZG9jczpcbiAgICAvLyBUaGUgZXZlbnQud2hpY2ggcHJvcGVydHkgbm9ybWFsaXplcyBldmVudC5rZXlDb2RlIGFuZCBldmVudC5jaGFyQ29kZS5cbiAgICAvLyBJdCBpcyByZWNvbW1lbmRlZCB0byB3YXRjaCBldmVudC53aGljaCBmb3Iga2V5Ym9hcmQga2V5IGlucHV0LlxuICAgIGlmIChlLndoaWNoID09PSAzNyB8fCBlLndoaWNoID09PSAzOSkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdmFyIGlucHV0O1xuICAgIHZhciBpbnB1dF9xdWVzdGlvbl92YWxpZGF0aW9uO1xuICAgIHZhciBwb3NzaWJsZV9hbnN3ZXJfdmFsaWRhdGlvbjtcbiAgICB2YXIgdGFyZ2V0ID0gJCh0aGlzKTtcbiAgICB2YXIgdW5kbyA9IHJlcXVpcmUoJ2FjdGlvbnMvdW5kbycpOy8vaXQgaXMgaGVyZSBvdGhlcndpc2UgaXQgYnJlYWtzIHdoZW4gY29tcGlsaW5nLi4uZ28gZmlndXJlPz9cbiAgICAvLyBDYXB0dXJlIGluaXRpYWwgY3Vyc29yIHBvc2l0aW9uLCBhcyB3ZSBhcmUgcmVwbGFjaW5nIHRoZSBpbnB1dCB2YWx1ZSBvbiBrZXl1cCwgdG8gYXZvaWQgdGhlIGN1cnNvciBnbyB0byB0aGUgZW5kIG9mIHRoZSBzdHJpbmdcbiAgICB2YXIgcG9zaXRpb24gPSB0YXJnZXRbMF0uc2VsZWN0aW9uU3RhcnQ7XG5cbiAgICBmdW5jdGlvbiBfaW5wdXRJc1ZhbGlkKCkge1xuXG4gICAgICAgIGlucHV0LmRvbS5pc192YWxpZCA9IHRydWU7XG5cbiAgICAgICAgLy92YWxpZGF0ZSBpbnB1dCB0byByZWZyZXNoIGRvbVxuICAgICAgICB2YWxpZGF0aW9uLnBlcmZvcm1WYWxpZGF0aW9uKGlucHV0LCBmYWxzZSk7XG5cbiAgICAgICAgdGFyZ2V0WzBdLnNlbGVjdGlvbkVuZCA9IHBvc2l0aW9uOyAgICAvLyBTZXQgdGhlIGN1cnNvciBiYWNrIHRvIHRoZSBpbml0aWFsIHBvc2l0aW9uLlxuICAgIH1cblxuICAgIGZ1bmN0aW9uIF9nZXRJbnB1dCgpIHtcblxuICAgICAgICB2YXIgaW5wdXQgPSB1dGlscy5nZXRJbnB1dE9iamVjdEJ5UmVmKGZvcm1idWlsZGVyLmN1cnJlbnRfaW5wdXRfcmVmKTtcbiAgICAgICAgdmFyIGN1cnJlbnRfYnJhbmNoO1xuXG4gICAgICAgIC8vY2hlY2sgd2hldGhlciB3ZSBhcmUgdmFsaWRhdGluIGEgbmVzdGVkIGlucHV0IGkuZS4gQk9USCBicmFuY2ggQU5EIGdyb3VwIGVkaXQgZmxhZ3MgYXJlIHRydWVcbiAgICAgICAgaWYgKGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfYnJhbmNoICYmIGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfZ3JvdXApIHtcblxuICAgICAgICAgICAgLy9nZXQgb3duZXIgYnJhbmNoXG4gICAgICAgICAgICBjdXJyZW50X2JyYW5jaCA9IHV0aWxzLmdldElucHV0T2JqZWN0QnlSZWYoZm9ybWJ1aWxkZXIuYnJhbmNoLmFjdGl2ZV9icmFuY2hfcmVmKTtcblxuICAgICAgICAgICAgLy9nZXQgbmVzdGVkIGdyb3VwIGlucHV0XG4gICAgICAgICAgICBpbnB1dCA9IHV0aWxzLmdldE5lc3RlZEdyb3VwSW5wdXRPYmplY3RCeVJlZihjdXJyZW50X2JyYW5jaCwgZm9ybWJ1aWxkZXIuZ3JvdXAuY3VycmVudF9pbnB1dF9yZWYpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaWYgKGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfYnJhbmNoKSB7XG4gICAgICAgICAgICAgICAgLy9nZXQgc2VsZWN0ZWQgYnJhbmNoIGlucHV0XG4gICAgICAgICAgICAgICAgaW5wdXQgPSB1dGlscy5nZXRCcmFuY2hJbnB1dE9iamVjdEJ5UmVmKGZvcm1idWlsZGVyLmJyYW5jaC5jdXJyZW50X2lucHV0X3JlZik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChmb3JtYnVpbGRlci5pc19lZGl0aW5nX2dyb3VwKSB7XG4gICAgICAgICAgICAgICAgLy9nZXQgc2VsZWN0ZWQgZ3JvdXAgaW5wdXRcbiAgICAgICAgICAgICAgICBpbnB1dCA9IHV0aWxzLmdldEdyb3VwSW5wdXRPYmplY3RCeVJlZihmb3JtYnVpbGRlci5ncm91cC5jdXJyZW50X2lucHV0X3JlZik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gaW5wdXQ7XG4gICAgfVxuXG4gICAgaW5wdXQgPSBfZ2V0SW5wdXQoKTtcbiAgICAvL2dldCBoYW5kbGUgb2YgaW5wdXQgcHJvcGVydGllcyBwYW5lbFxuICAgIGlucHV0LmRvbS5wcm9wZXJ0aWVzX3BhbmVsID0gZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlci5maW5kKCdmb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIGlucHV0LnJlZiArICdcIl0nKTtcblxuICAgIC8vaGlkZSBlcnJvcnNcbiAgICBpbnB1dC5oaWRlUXVlc3Rpb25FcnJvcnMoKTtcblxuICAgIGlmICh0YXJnZXQucGFyZW50KCkuaGFzQ2xhc3MoJ2lucHV0LXByb3BlcnRpZXNfX2Zvcm1fX3F1ZXN0aW9uJykpIHtcbiAgICAgICAgLy9nZXQgcXVlc3Rpb25cbiAgICAgICAgaW5wdXQucXVlc3Rpb24gPSAkKHRoaXMpLnZhbCgpO1xuXG4gICAgICAgIC8vdmFsaWRhdGUgcXVlc3Rpb24gb3IgaGVhZGVyXG4gICAgICAgIGlmIChpbnB1dC50eXBlID09PSBjb25zdHMuQlJBTkNIX1RZUEUgfHwgaW5wdXQudHlwZSA9PT0gY29uc3RzLkdST1VQX1RZUEUpIHtcbiAgICAgICAgICAgIGlucHV0X3F1ZXN0aW9uX3ZhbGlkYXRpb24gPSBpbnB1dC5pc0hlYWRlclRleHRWYWxpZCgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaW5wdXRfcXVlc3Rpb25fdmFsaWRhdGlvbiA9IGlucHV0LmlzUXVlc3Rpb25UZXh0VmFsaWQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghaW5wdXRfcXVlc3Rpb25fdmFsaWRhdGlvbi5pc192YWxpZCkge1xuICAgICAgICAgICAgLy8gd2FybiB1c2VyIHF1ZXN0aW9uIHRleHQgaXMgd3JvbmdcbiAgICAgICAgICAgIGlucHV0LmRvbS5pc192YWxpZCA9IGZhbHNlO1xuXG4gICAgICAgICAgICAvL2hpZ2hsaWdodCB3cm9uZyBpbnB1dCBhbmQgc2hvdyBlcnJvciBtZXNzYWdlXG4gICAgICAgICAgICBpbnB1dC5zaG93UXVlc3Rpb25FcnJvcnMoaW5wdXRfcXVlc3Rpb25fdmFsaWRhdGlvbi5lcnJvci5tZXNzYWdlKTtcblxuICAgICAgICAgICAgLy9kaXNhYmxlIGVkaXQgYnRuIGZvciBncm91cHMgb3IgYnJhbmNoZXNcbiAgICAgICAgICAgIGlmIChpbnB1dC50eXBlID09PSBjb25zdHMuQlJBTkNIX1RZUEUgfHwgaW5wdXQudHlwZSA9PT0gY29uc3RzLkdST1VQX1RZUEUpIHtcbiAgICAgICAgICAgICAgICBpbnB1dC50b2dnbGVFZGl0QnV0dG9uKGZhbHNlKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy92YWxpZGF0ZSBhbGwgaW5wdXRzICh0byB0b2dnbGUgc2F2ZSBwcm9qZWN0IGJ1dHRvbiBvbiBrZXl1cClcbiAgICAgICAgICAgIHZhbGlkYXRpb24ucGVyZm9ybVZhbGlkYXRpb24oaW5wdXQsIGZhbHNlKTtcbiAgICAgICAgICAgIHRhcmdldFswXS5zZWxlY3Rpb25FbmQgPSBwb3NpdGlvbjsgICAgLy8gU2V0IHRoZSBjdXJzb3IgYmFjayB0byB0aGUgaW5pdGlhbCBwb3NpdGlvbi5cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcblxuICAgICAgICAgICAgLy9icmFuY2ggYW5kIGdyb3VwIGlucHV0cyBhcmUgaW52YWxpZCBpZiB0aGV5IGRvIG5vdCBoYXZlIGFueSBpbnB1dHNcbiAgICAgICAgICAgIGlmIChpbnB1dC50eXBlID09PSBjb25zdHMuQlJBTkNIX1RZUEUgfHwgaW5wdXQudHlwZSA9PT0gY29uc3RzLkdST1VQX1RZUEUpIHtcblxuICAgICAgICAgICAgICAgIC8vZW5hYmxlIGVkaXQgYnRuIGZvciBncm91cHMgb3IgYnJhbmNoZXNcbiAgICAgICAgICAgICAgICBpbnB1dC50b2dnbGVFZGl0QnV0dG9uKHRydWUpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGlucHV0LnR5cGUgPT09IGNvbnN0cy5CUkFOQ0hfVFlQRSAmJiBpbnB1dC5icmFuY2gubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGlucHV0LmRvbS5pc192YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudHlwZSA9PT0gY29uc3RzLkdST1VQX1RZUEUgJiYgaW5wdXQuZ3JvdXAubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGlucHV0LmRvbS5pc192YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuZG9tLmlzX3ZhbGlkKSB7XG4gICAgICAgICAgICAgICAgICAgIF9pbnB1dElzVmFsaWQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBfaW5wdXRJc1ZhbGlkKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAodGFyZ2V0LnBhcmVudCgpLmhhc0NsYXNzKCdpbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19wb3NzaWJsZS1hbnN3ZXJzX19saXN0X19wb3NzaWJsZV9hbnN3ZXJfaXRlbScpKSB7XG5cbiAgICAgICAgcG9zc2libGVfYW5zd2VyX3ZhbGlkYXRpb24gPSB2YWxpZGF0aW9uLmlzUG9zc2libGVBbnN3ZXJWYWxpZCh0YXJnZXQudmFsKCkpO1xuXG4gICAgICAgIC8vdmFsaWRhdGUgZWFjaCBwb3NzaWJsZSBhbnN3ZXIgYW5kIHNob3cgZW1iZWRkZWQgZXJyb3JzIGlmIGFueVxuICAgICAgICBpZiAoIXBvc3NpYmxlX2Fuc3dlcl92YWxpZGF0aW9uLmlzX3ZhbGlkKSB7XG4gICAgICAgICAgICAvLyB3YXJuIHVzZXIgcXVlc3Rpb24gdGV4dCBpcyB3cm9uZ1xuICAgICAgICAgICAgaW5wdXQuZG9tLmlzX3ZhbGlkID0gZmFsc2U7XG5cbiAgICAgICAgICAgIC8vaGlnaGxpZ2h0IHdyb25nIGFuc3dlciBhbmQgc2hvdyBlcnJvciBtZXNzYWdlXG4gICAgICAgICAgICBpbnB1dC5zaG93UG9zc2libGVBbnN3ZXJFcnJvcnModGFyZ2V0LnBhcmVudCgpLnBhcmVudCgpLCBwb3NzaWJsZV9hbnN3ZXJfdmFsaWRhdGlvbi5lcnJvci5tZXNzYWdlKTtcblxuICAgICAgICAgICAgdmFsaWRhdGlvbi5wZXJmb3JtVmFsaWRhdGlvbihpbnB1dCwgZmFsc2UpO1xuICAgICAgICAgICAgdGFyZ2V0WzBdLnNlbGVjdGlvbkVuZCA9IHBvc2l0aW9uOyAgICAvLyBTZXQgdGhlIGN1cnNvciBiYWNrIHRvIHRoZSBpbml0aWFsIHBvc2l0aW9uLlxuXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBfaW5wdXRJc1ZhbGlkKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvL3B1c2ggc3RhdGUgdG8gZW5hYmxlIHVuZG9pbmcgdGhlIGFjdGlvbiAodHlwaW5nKSBwYXNzaW5nIFwidHJ1ZVwiIHNvIGl0IGdldHMgYSBiaXQgb2YgdGhyb3R0bGluZ1xuICAgIHVuZG8ucHVzaFN0YXRlKHRydWUpO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBjYWxsYmFjaztcbiIsIi8qIGdsb2JhbCAkLCBGdG9hc3RyKi9cbid1c2Ugc3RyaWN0JztcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJ2NvbmZpZy9mb3JtYnVpbGRlcicpO1xudmFyIHVpID0gcmVxdWlyZSgnaGVscGVycy91aScpO1xudmFyIHV0aWxzID0gcmVxdWlyZSgnaGVscGVycy91dGlscycpO1xudmFyIHNhdmUgPSByZXF1aXJlKCdhY3Rpb25zL3NhdmUnKTtcblxudmFyIGNhbGxiYWNrID0gZnVuY3Rpb24gKCkge1xuXG4gICAgdmFyIGNvdW50O1xuICAgIHZhciBpbnB1dHMgPSBbXTtcbiAgICB2YXIgYWN0aXZlX2lucHV0O1xuICAgIHZhciBhY3RpdmVfYnJhbmNoO1xuXG4gICAgaWYgKGZvcm1idWlsZGVyLmlzX2VkaXRpbmdfYnJhbmNoKSB7XG5cbiAgICAgICAgYWN0aXZlX2JyYW5jaCA9IHV0aWxzLmdldElucHV0T2JqZWN0QnlSZWYoZm9ybWJ1aWxkZXIuYnJhbmNoLmFjdGl2ZV9icmFuY2hfcmVmKTtcblxuICAgICAgICAvL2dyb3VwIGluIGEgYnJhbmNoP1xuICAgICAgICBpZiAoZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19ncm91cCkge1xuICAgICAgICAgICAgLy9zZXQgYWN0aXZlIGlucHV0IHRvIGJlIHRoZSBhY3RpdmUgZ3JvdXAgaW5wdXRcbiAgICAgICAgICAgIGFjdGl2ZV9pbnB1dCA9IHV0aWxzLmdldE5lc3RlZEdyb3VwSW5wdXRPYmplY3RCeVJlZihhY3RpdmVfYnJhbmNoLCBmb3JtYnVpbGRlci5ncm91cC5jdXJyZW50X2lucHV0X3JlZik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBhY3RpdmVfaW5wdXQgPSB1dGlscy5nZXRCcmFuY2hJbnB1dE9iamVjdEJ5UmVmKGZvcm1idWlsZGVyLmJyYW5jaC5jdXJyZW50X2lucHV0X3JlZik7XG4gICAgICAgIH1cblxuICAgICAgICAvL3NhdmUgY3VycmVudCBpbnB1dFxuICAgICAgICBzYXZlLnNhdmVQcm9wZXJ0aWVzKGFjdGl2ZV9pbnB1dCk7XG5cbiAgICAgICAgaW5wdXRzID0gYWN0aXZlX2JyYW5jaC5icmFuY2g7XG4gICAgICAgIGNvdW50ID0gdXRpbHMuZ2V0VGl0bGVDb3VudChpbnB1dHMpO1xuICAgICAgICB1aS5pbnB1dHNfY29sbGVjdGlvbi50b2dnbGVUaXRsZVdhcm5pbmcoY291bnQsIHRydWUpO1xuXG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICAvL2lzIGl0IGEgZ3JvdXA/XG4gICAgICAgIGlmIChmb3JtYnVpbGRlci5pc19lZGl0aW5nX2dyb3VwKSB7XG4gICAgICAgICAgICAvL3NldCBhY3RpdmUgaW5wdXQgdG8gYmUgdGhlIGFjdGl2ZSBncm91cCBpbnB1dFxuICAgICAgICAgICAgYWN0aXZlX2lucHV0ID0gdXRpbHMuZ2V0R3JvdXBJbnB1dE9iamVjdEJ5UmVmKGZvcm1idWlsZGVyLmdyb3VwLmN1cnJlbnRfaW5wdXRfcmVmKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIC8vZm9ybSBsZXZlbCBpbnB1dFxuICAgICAgICAgICAgYWN0aXZlX2lucHV0ID0gdXRpbHMuZ2V0SW5wdXRPYmplY3RCeVJlZihmb3JtYnVpbGRlci5jdXJyZW50X2lucHV0X3JlZik7XG4gICAgICAgIH1cbiAgICAgICAgLy9zYXZlIGN1cnJlbnQgaW5wdXRcbiAgICAgICAgc2F2ZS5zYXZlUHJvcGVydGllcyhhY3RpdmVfaW5wdXQpO1xuXG4gICAgICAgIGlucHV0cyA9IGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbi5kYXRhLnByb2plY3QuZm9ybXNbZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4XS5pbnB1dHM7XG4gICAgICAgIGNvdW50ID0gdXRpbHMuZ2V0VGl0bGVDb3VudChpbnB1dHMpO1xuICAgICAgICAvL2lmIHRoZXJlIGlzIG5vdCBhbnkgdGl0bGUgc2V0IGZvcm0gdGhlIGZvcm0sIHNob3cgd2FybmluZ1xuICAgICAgICB1aS5pbnB1dHNfY29sbGVjdGlvbi50b2dnbGVUaXRsZVdhcm5pbmcoY291bnQsIGZhbHNlKTtcbiAgICB9XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGNhbGxiYWNrO1xuIiwiLyogZ2xvYmFsICQsIHRvYXN0ciovXG4ndXNlIHN0cmljdCc7XG52YXIgbWVzc2FnZXMgPSByZXF1aXJlKCdjb25maWcvbWVzc2FnZXMnKTtcbnZhciB2YWxpZGF0aW9uID0gcmVxdWlyZSgnYWN0aW9ucy92YWxpZGF0aW9uJyk7XG52YXIgZXJyb3JzID0gcmVxdWlyZSgnYWN0aW9ucy9lcnJvcnMnKTtcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJ2NvbmZpZy9mb3JtYnVpbGRlcicpO1xudmFyIGNvbnN0cyA9IHJlcXVpcmUoJ2NvbmZpZy9jb25zdHMnKTtcbnZhciB1aSA9IHJlcXVpcmUoJ2hlbHBlcnMvdWknKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoJ2hlbHBlcnMvdXRpbHMnKTtcbnZhciBmb3JtX2ZhY3RvcnkgPSByZXF1aXJlKCdmYWN0b3J5L2Zvcm0tZmFjdG9yeScpO1xudmFyIHNhdmVfcHJvamVjdF9jbGlja19jYWxsYmFjayA9IHJlcXVpcmUoJ3VpLWhhbmRsZXJzL2V2ZW50LWhhbmRsZXItY2FsbGJhY2tzL3NhdmUtcHJvamVjdC1jbGljay1jYWxsYmFjaycpO1xudmFyIHVuZG8gPSByZXF1aXJlKCdhY3Rpb25zL3VuZG8nKTtcblxudmFyIGNhbGxiYWNrID0gZnVuY3Rpb24gKGV2dCkge1xuXG4gICAgdmFyIHRhcmdldCA9ICQoZXZ0LnJlbGF0ZWRUYXJnZXQpOy8vIEJ1dHRvbiB0aGF0IHRyaWdnZXJlZCB0aGUgbW9kYWxcbiAgICB2YXIgbW9kYWwgPSAkKHRoaXMpO1xuICAgIHZhciBmb3JtX25hbWVfaW5wdXQ7XG4gICAgdmFyIGZvcm1fcmVmO1xuICAgIHZhciBpc19hZGRpbmdfbmV3X2Zvcm0gPSBmYWxzZTtcbiAgICB2YXIgZm9ybSA9IHt9O1xuICAgIHZhciBuZXh0X2Zvcm1faW5kZXg7XG5cbiAgICAvL2dldCBwYXJ0aWFsXG4gICAgbW9kYWwuaHRtbChmb3JtYnVpbGRlci5kb20ucGFydGlhbHMubW9kYWxfZWRpdF9mb3JtX25hbWUpO1xuICAgIGZvcm1fbmFtZV9pbnB1dCA9IG1vZGFsLmZpbmQoJy5tb2RhbC1ib2R5IGlucHV0Jyk7XG5cbiAgICAvL3ZhbGlkYXRlIG9uIGtleXVwIGZvciBiZXR0ZXIgVVggdG9kb1xuICAgIGZvcm1fbmFtZV9pbnB1dC5vbigna2V5dXAnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdhY3RpdmF0ZWQnKTtcbiAgICB9KTtcblxuICAgIGlmICh0YXJnZXQuaGFzQ2xhc3MoJ21haW5fX3RhYnNfYWRkLWZvcm0nKSkge1xuICAgICAgICBjb25zb2xlLmxvZygnKioqKioqKioqKioqIC0gYWRkIG5ldyBmb3JtIC0gKioqKioqKioqKioqKionKTtcbiAgICAgICAgLy90b2RvXG4gICAgICAgIGlzX2FkZGluZ19uZXdfZm9ybSA9IHRydWU7XG4gICAgICAgIGZvcm1fcmVmID0gdXRpbHMuZ2VuZXJhdGVGb3JtUmVmKCk7XG4gICAgICAgIG5leHRfZm9ybV9pbmRleCA9IGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbi5kYXRhLnByb2plY3QuZm9ybXMubGVuZ3RoO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgLy9zZXQgY3VycmVudCBmb3JtIG5hbWUgaW4gbW9kYWxcbiAgICAgICAgZm9ybV9uYW1lX2lucHV0LnZhbChmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0LmZvcm1zW2Zvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleF0ubmFtZSk7XG4gICAgICAgIGZvcm1fcmVmID0gZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX3JlZjtcbiAgICB9XG5cbiAgICAvL2JpbmQgc2F2ZSBjaGFuZ2VzIGJ1dHRvblxuICAgICQoJy5tYWluX19tb2RhbC0tZWRpdC1mb3JtLW5hbWVfX3NhdmUtYnRuJykub2ZmKCkub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuXG4gICAgICAgIC8vZ2V0IHVwZGF0ZWQgdmFsdWVcbiAgICAgICAgdmFyIG5hbWUgPSBmb3JtX25hbWVfaW5wdXQudmFsKCk7XG4gICAgICAgIHZhciBpc19mb3JtX25hbWVfdmFsaWQ7XG4gICAgICAgIHZhciBmb3JtX2luZGV4ID0gZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4O1xuICAgICAgICB2YXIgZm9ybXMgPSBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0LmZvcm1zO1xuXG4gICAgICAgIC8vaGlkZSBlcnJvcnNcbiAgICAgICAgZXJyb3JzLmhpZGVGb3JtTmFtZUVycm9ycyhtb2RhbCk7XG5cbiAgICAgICAgLy92YWxpZGF0ZSBmb3JtIG5hbWVcbiAgICAgICAgaXNfZm9ybV9uYW1lX3ZhbGlkID0gdmFsaWRhdGlvbi5pc0Zvcm1OYW1lVmFsaWQobmFtZSwgaXNfYWRkaW5nX25ld19mb3JtKTtcblxuICAgICAgICBpZiAoIWlzX2Zvcm1fbmFtZV92YWxpZC5pc192YWxpZCkge1xuICAgICAgICAgICAgLy9zaG93IGVycm9yc1xuICAgICAgICAgICAgZXJyb3JzLnNob3dGb3JtTmFtZUVycm9ycyhtb2RhbCwgaXNfZm9ybV9uYW1lX3ZhbGlkLmVycm9yLm1lc3NhZ2UpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuXG4gICAgICAgICAgICAvL2Rpc2FibGUgYnV0dG9uIHRvIGF2b2lkIGRvdWJsZSBjbGlja3NcbiAgICAgICAgICAgICQodGhpcykub2ZmKCkuYXR0cignZGlzYWJsZWQnLCB0cnVlKTtcblxuICAgICAgICAgICAgaWYgKGlzX2FkZGluZ19uZXdfZm9ybSkge1xuXG4gICAgICAgICAgICAgICAgLy9hZGQgY2hpbGQgZm9ybVxuICAgICAgICAgICAgICAgIGZvcm1fZmFjdG9yeS5jcmVhdGVDaGlsZEZvcm0obmFtZSwgZm9ybV9yZWYsIG5leHRfZm9ybV9pbmRleCwgdHJ1ZSk7XG5cbiAgICAgICAgICAgICAgICAvL2Rpc2FibGUgc2F2ZSBwcm9qZWN0IGJ1dHRvbiBhcyB3ZSBkbyBub3QgYWNjZXB0IGVtcHR5IGZvcm1zXG4gICAgICAgICAgICAgICAgdWkubmF2YmFyLnRvZ2dsZVNhdmVQcm9qZWN0QnRuKGNvbnN0cy5CVE5fRElTQUJMRUQpO1xuXG4gICAgICAgICAgICAgICAgdW5kby5wdXNoU3RhdGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vdXBkYXRlIG5hbWUgZm9yIGN1cnJlbnQgZm9ybVxuICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbi5kYXRhLnByb2plY3QuZm9ybXNbZm9ybV9pbmRleF0ubmFtZSA9IG5hbWU7XG4gICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uLmRhdGEucHJvamVjdC5mb3Jtc1tmb3JtX2luZGV4XS5zbHVnID0gdXRpbHMuc2x1Z2lmeShuYW1lKTtcblxuICAgICAgICAgICAgICAgIC8vc2hvdyBuYW1lIG9mIGZvcm0gaW4gdGFiIGFuZCBpbnB1dHMgY29sbGVjdGlvbiBjb250YWluZXIsIHRydW5jYXRpbmcgZm9ybSBuYW1lICg+MTApIGZvciBVSSBwdXJwb3Nlc1xuICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvbi5maW5kKCcuaW5wdXRzLWNvbGxlY3Rpb25fX2hlYWRlcl9fZWxlbWVudC1uYW1lJylcbiAgICAgICAgICAgICAgICAgICAgLnRleHQobmFtZS50cnVuYyhjb25zdHMuVEFCX0ZPUk1fTkFNRV9NQVhfRElTUExBWV9MRU5HSFQgLSAoZm9ybXMubGVuZ3RoICogMikpKTtcblxuICAgICAgICAgICAgICAgIC8vdGFiLCB0YXJnZXQgdGhlIGFjdGl2ZSBvbmVcbiAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uZm9ybXNfdGFicy5maW5kKCcuYWN0aXZlIGEnKVxuICAgICAgICAgICAgICAgICAgICAudGV4dChuYW1lLnRydW5jKGNvbnN0cy5UQUJfRk9STV9OQU1FX01BWF9ESVNQTEFZX0xFTkdIVCAtIChmb3Jtcy5sZW5ndGggKiAyKSkpXG4gICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJyZuYnNwOzxpIGNsYXNzPVwiZm9ybS1zdGF0ZSBmYSBmYS1jaGVja1wiPjwvaT4nKTtcblxuICAgICAgICAgICAgICAgIC8vZW5hYmxlIHNhdmUgcHJvamVjdCBidXR0b25cbiAgICAgICAgICAgICAgICB1aS5uYXZiYXIudG9nZ2xlU2F2ZVByb2plY3RCdG4oY29uc3RzLkJUTl9FTkFCTEVEKTtcbiAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uc2F2ZV9wcm9qZWN0X2J0bi5vZmYoKS5vbignY2xpY2snLCBzYXZlX3Byb2plY3RfY2xpY2tfY2FsbGJhY2spO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL2hpZGUgYWRkIGNoaWxkIGZvcm0gYnV0dG9uIGlmIHRoZSBmb3JtIHRvdGFsIGlzIE1BWF9OVU1CRVJfT0ZfTkVTVEVEX0NISUxEX0ZPUk1TXG4gICAgICAgICAgICBpZiAoZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uLmRhdGEucHJvamVjdC5mb3Jtcy5sZW5ndGggPT09IGNvbnN0cy5NQVhfTlVNQkVSX09GX05FU1RFRF9DSElMRF9GT1JNUykge1xuICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5mb3Jtc190YWJzLmZpbmQoJy5tYWluX190YWJzX2FkZC1mb3JtJykucGFyZW50KCkuaGlkZSgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL3Jlc2l6ZSBmb3JtIHRhYnNcbiAgICAgICAgICAgIHVpLmZvcm1zX3RhYnMucmVzaXplRm9ybVRhYnMoKTtcblxuICAgICAgICAgICAgLy9jbG9zZSBtb2RhbCAod2l0aCBhIGxpdHRsZSBkZWxheSBmb3IgYmV0dGVyIFVYLCBubyBGT1VDKVxuICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIG1vZGFsLm1vZGFsKCdoaWRlJyk7XG4gICAgICAgICAgICAgICAgLy9mb3JjZSBhIGJhY2tkcm9wIHJlbW92YWwgYXMgc29tZXRpbWVzIGl0IGlzIHRyaWdnZXJlZCB0d2ljZVxuICAgICAgICAgICAgICAgICQoJy5tb2RhbC1iYWNrZHJvcCcpLnJlbW92ZSgpO1xuICAgICAgICAgICAgfSwgMTAwKTtcbiAgICAgICAgfVxuICAgIH0pO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBjYWxsYmFjaztcblxuXG4iLCIvKiBnbG9iYWwgJCwgdG9hc3RyKi9cbid1c2Ugc3RyaWN0JztcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJ2NvbmZpZy9mb3JtYnVpbGRlcicpO1xudmFyIGNvbnN0cyA9IHJlcXVpcmUoJ2NvbmZpZy9jb25zdHMnKTtcblxuLy90b2RvIG1heWJlIHRoaXMgY2FsbGJhY2sgaXMgbm90IG5lZWRlZCBhbnltb3JlXG52YXIgY2FsbGJhY2sgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICAvL2dldCBob2xkIG9mIG1vZGFsO1xuICAgIHZhciBtb2RhbCA9ICQodGhpcyk7XG5cbiAgICAvL2JpbmQgYnV0dG9uc1xuICAgICQoJy50YWJsZScpLm9uKCdjbGljaycsICcuYnRuJywgZnVuY3Rpb24gKCkge1xuXG4gICAgICAgIHZhciBidXR0b24gPSAkKHRoaXMpO1xuICAgICAgICB2YXIgY3VycmVudF9pbnB1dF9yZWdleF9wcm9wZXJ0eSA9IGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXJcbiAgICAgICAgICAgIC5maW5kKCdmb3JtW2RhdGEtaW5wdXQtcmVmPVwiJyArIGZvcm1idWlsZGVyLmN1cnJlbnRfaW5wdXRfcmVmICsgJ1wiXScpXG4gICAgICAgICAgICAuZmluZCgnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX2FkdmFuY2VkLXByb3BlcnRpZXNfX3JlZ2V4IGlucHV0Jyk7XG5cbiAgICAgICAgLy9hcHBseSB0aGUgc2VsZWN0ZWQgcmVnZXhcbiAgICAgICAgY3VycmVudF9pbnB1dF9yZWdleF9wcm9wZXJ0eS52YWwoY29uc3RzLlJFR0VYW2J1dHRvbi5hdHRyKCdkYXRhLWFwcGx5LXJlZ2V4JyldKTtcblxuICAgICAgICBtb2RhbC5tb2RhbCgnaGlkZScpO1xuICAgIH0pO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBjYWxsYmFjaztcbiIsIi8qIGdsb2JhbCAkLCB0b2FzdHIqL1xuJ3VzZSBzdHJpY3QnO1xudmFyIGNvbnN0cyA9IHJlcXVpcmUoJ2NvbmZpZy9jb25zdHMnKTtcbnZhciBtZXNzYWdlcyA9IHJlcXVpcmUoJ2NvbmZpZy9tZXNzYWdlcycpO1xudmFyIGZvcm1idWlsZGVyID0gcmVxdWlyZSgnY29uZmlnL2Zvcm1idWlsZGVyJyk7XG52YXIgdWkgPSByZXF1aXJlKCdoZWxwZXJzL3VpJyk7XG52YXIgdXRpbHMgPSByZXF1aXJlKCdoZWxwZXJzL3V0aWxzJyk7XG52YXIgdmFsaWRhdGlvbiA9IHJlcXVpcmUoJ2FjdGlvbnMvdmFsaWRhdGlvbicpO1xudmFyIHRvYXN0ID0gcmVxdWlyZSgnY29uZmlnL3RvYXN0Jyk7XG5cbnZhciBjYWxsYmFjayA9IGZ1bmN0aW9uIChlKSB7XG5cbiAgICBmdW5jdGlvbiBfcmVuZGVyUXVlc3Rpb24oaW5wdXQpIHtcblxuICAgICAgICAvL3N0cmlwIGh0bWwgdGFncyBmcm9tIHJlYWRtZSB0eXBlIGlmIGFueVxuICAgICAgICBpZiAoaW5wdXQudHlwZSA9PT0gY29uc3RzLlJFQURNRV9UWVBFKSB7XG4gICAgICAgICAgICBpbnB1dC5xdWVzdGlvbiA9IHV0aWxzLmRlY29kZUh0bWwoaW5wdXQucXVlc3Rpb24pO1xuICAgICAgICAgICAgaW5wdXQucXVlc3Rpb24gPSBpbnB1dC5xdWVzdGlvbi5yZXBsYWNlKC8oPChbXj5dKyk+KS9pZywgJyAnKTtcbiAgICAgICAgICAgIGh0bWwgKz0gJzxoci8+JztcbiAgICAgICAgfVxuXG4gICAgICAgIGh0bWwgKz0gJzxoNCBjbGFzcz1cInF1ZXN0aW9uXCI+JyArIGlucHV0LnF1ZXN0aW9uICsgJzwvaDQ+JztcblxuICAgICAgICBpZiAoaW5wdXQudHlwZSA9PT0gY29uc3RzLlRFWFRBUkVBX1RZUEUpIHtcbiAgICAgICAgICAgIGh0bWwgKz0gJzx0YWJsZSBib3JkZXI9XCIxXCIgd2lkdGg9XCIxMDAlXCI+JztcbiAgICAgICAgICAgIGh0bWwgKz0gJzx0cj48dGQ+PC90ZD48L3RkPjwvdHI+JztcbiAgICAgICAgICAgIGh0bWwgKz0gJzx0cj48dGQ+PC90ZD48L3RkPjwvdHI+JztcbiAgICAgICAgICAgIGh0bWwgKz0gJzx0cj48dGQ+PC90ZD48L3RkPjwvdHI+JztcbiAgICAgICAgICAgIGh0bWwgKz0gJzx0cj48dGQ+PC90ZD48L3RkPjwvdHI+JztcbiAgICAgICAgICAgIGh0bWwgKz0gJzwvdGFibGU+JztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmIChpbnB1dC50eXBlICE9PSBjb25zdHMuUkVBRE1FX1RZUEUpIHtcbiAgICAgICAgICAgICAgICBodG1sICs9ICc8dGFibGUgYm9yZGVyPVwiMVwiIHdpZHRoPVwiMTAwJVwiPic7XG4gICAgICAgICAgICAgICAgaHRtbCArPSAnPHRyPjx0ZD48L3RkPjwvdGQ+PC90cj4nO1xuICAgICAgICAgICAgICAgIGh0bWwgKz0gJzwvdGFibGU+JztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2V7XG4gICAgICAgICAgICAgICAgaHRtbCArPSAnPGhyLz4nO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gX3JlbmRlclBvc3NpYmxlQW5zd2VycyhpbnB1dCkge1xuICAgICAgICAkLmVhY2goaW5wdXQucG9zc2libGVfYW5zd2VycywgZnVuY3Rpb24gKGluZGV4LCBwb3NzaWJsZV9hbnN3ZXIpIHtcblxuICAgICAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSBjb25zdHMuU0VBUkNIX1NJTkdMRV9UWVBFOlxuICAgICAgICAgICAgICAgIGNhc2UgY29uc3RzLlNFQVJDSF9NVUxUSVBMRV9UWVBFOlxuXG4gICAgICAgICAgICAgICAgICAgIGlmIChpbmRleCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaHRtbCArPSAnPHVsIGNsYXNzPVwicG9zc2libGUtYW5zd2Vycy1saXN0XCI+JztcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGh0bWwgKz0gJzxsaT48aDU+JyArIHBvc3NpYmxlX2Fuc3dlci5hbnN3ZXIgKyAnPC9oNT48L2xpPic7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGluZGV4ID09PSBpbnB1dC5wb3NzaWJsZV9hbnN3ZXJzLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWwgKz0gJzwvdWw+JztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAvL3JlbmRlciBkcm9wZG93biBhbmQgcmFkaW8gYXMgcmFkaW8gYnV0dG9ucyAoc2luZ2xlIGNob2ljZSlcbiAgICAgICAgICAgICAgICBjYXNlIGNvbnN0cy5EUk9QRE9XTl9UWVBFOlxuICAgICAgICAgICAgICAgIGNhc2UgY29uc3RzLlJBRElPX1RZUEU6XG4gICAgICAgICAgICAgICAgICAgIGh0bWwgKz0gJzxkaXYgY2xhc3M9XCJyYWRpby10eXBlXCI+PGg1Pic7XG4gICAgICAgICAgICAgICAgICAgIGh0bWwgKz0gJzxpbnB1dCB0eXBlPVwicmFkaW9cIiAgdmFsdWU9XCInICsgcG9zc2libGVfYW5zd2VyLmFuc3dlciArICdcIj4nO1xuICAgICAgICAgICAgICAgICAgICBodG1sICs9ICc8bGFiZWwgZm9yPVwiJyArIHBvc3NpYmxlX2Fuc3dlci5hbnN3ZXIgKyAnXCI+JyArIHBvc3NpYmxlX2Fuc3dlci5hbnN3ZXIgKyAnPC9sYWJlbD4nO1xuICAgICAgICAgICAgICAgICAgICBodG1sICs9ICc8L2g1PjwvZGl2Pic7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgY29uc3RzLkNIRUNLQk9YX1RZUEU6XG4gICAgICAgICAgICAgICAgICAgIGh0bWwgKz0gJzxkaXYgY2xhc3M9XCJjaGVja2JveC10eXBlXCI+PGg1Pic7XG4gICAgICAgICAgICAgICAgICAgIGh0bWwgKz0gJzxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIiAgdmFsdWU9XCInICsgcG9zc2libGVfYW5zd2VyLmFuc3dlciArICdcIj4nO1xuICAgICAgICAgICAgICAgICAgICBodG1sICs9ICc8bGFiZWwgZm9yPVwiJyArIHBvc3NpYmxlX2Fuc3dlci5hbnN3ZXIgKyAnXCI+JyArIHBvc3NpYmxlX2Fuc3dlci5hbnN3ZXIgKyAnPC9sYWJlbD4nO1xuICAgICAgICAgICAgICAgICAgICBodG1sICs9ICc8L2g1PjwvZGl2Pic7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgLy9kbyBub3RoaW5nXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuXG4gICAgdmFyIGh0bWwgPSAnJztcblxuICAgIC8vYWRkIGZvcm0gdGl0bGVcbiAgICBodG1sICs9ICcnO1xuICAgIHZhciBpbmRleCA9IGZvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleDtcblxuICAgIC8vY3JlYXRlIGEgZGVlcCBjb3B5IG9mIHRoZSBwcm9qZWN0IG9iamVjdCBwcm9wZXJ0aWVzXG4gICAgdmFyIHByb2plY3RfZGVmaW5pdGlvbl9qc29uID0gQ2lyY3VsYXJKU09OLnBhcnNlKENpcmN1bGFySlNPTi5zdHJpbmdpZnkoZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uKSk7XG4gICAgdmFyIGlzX3ZhbGlkX2Zvcm0gPSB0cnVlO1xuICAgIHZhciBwcm9qZWN0X3NsdWcgPSBwcm9qZWN0X2RlZmluaXRpb25fanNvbi5kYXRhLnByb2plY3Quc2x1ZztcbiAgICB2YXIgZm9ybSA9IHByb2plY3RfZGVmaW5pdGlvbl9qc29uLmRhdGEucHJvamVjdC5mb3Jtc1tpbmRleF07XG5cbiAgICBpZiAoZm9ybS5pbnB1dHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHRvYXN0LnNob3dFcnJvcihtZXNzYWdlcy5lcnJvci5GT1JNX0lTX0lOVkFMSUQpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy9wcmludCBwcm9qZWN0IG5hbWUgYXMgaGVhZGVyXG4gICAgaHRtbCArPSAnPGgyPicgKyBwcm9qZWN0X2RlZmluaXRpb25fanNvbi5kYXRhLnByb2plY3QubmFtZSArICc8L2gyPic7XG5cbiAgICAvL3ByaW50IGZvcm0gbmFtZSBhcyBoZWFkZXJcbiAgICBodG1sICs9ICc8aDM+JyArIGZvcm0ubmFtZSArICc8L2gzPic7XG5cbiAgICAkKGZvcm0uaW5wdXRzKS5lYWNoKGZ1bmN0aW9uIChpbnB1dEluZGV4LCBpbnB1dCkge1xuXG4gICAgICAgIC8vZ2V0IHZhbGlkIGp1bXAgZGVzdGluYXRpb25zXG4gICAgICAgIHZhciBqdW1wX2Rlc3RpbmF0aW9ucyA9IHV0aWxzLmdldEp1bXBBdmFpbGFibGVEZXN0aW5hdGlvbnNBc0tleXMoaW5wdXRJbmRleCwgaW5wdXQsIGZvcm0uaW5wdXRzLCBmYWxzZSk7XG5cbiAgICAgICAgLy9leHRyYSB2YWxpZGF0aW9uIGZvciBqdW1wcywgY2hlY2sgaWYgdGhlIGRlc3RpbmF0aW9uIHN0aWxsIGV4aXN0cyBhbmQgaXQgaXMgdmFsaWRcbiAgICAgICAgJChpbnB1dC5qdW1wcykuZWFjaChmdW5jdGlvbiAoanVtcEluZGV4LCBqdW1wKSB7XG4gICAgICAgICAgICAvL2RvZXMgdGhlIGp1bXAgXCJ0b1wiIHByb3BlcnR5IHJlZmVyZW5jZSBhIHZhbGlkIGRlc3RpbmF0aW9uIGlucHV0P1xuICAgICAgICAgICAgaWYgKCFqdW1wX2Rlc3RpbmF0aW9uc1tqdW1wLnRvXSkge1xuICAgICAgICAgICAgICAgIC8vaW52YWxpZCBkZXN0aW5hdGlvbiBmb3VuZFxuICAgICAgICAgICAgICAgIGlzX3ZhbGlkX2Zvcm0gPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7XG5cbiAgICAgICAgICAgIGNhc2UgY29uc3RzLkJSQU5DSF9UWVBFOlxuICAgICAgICAgICAgICAgIGh0bWwgKz0gJzxoNCBjbGFzcz1cImJyYW5jaC1oZWFkZXJcIj4nICsgaW5wdXQucXVlc3Rpb24gKyAnPC9oND4nO1xuXG4gICAgICAgICAgICAgICAgaHRtbCArPSAnPHRhYmxlIGJvcmRlcj1cIjFcIiBjZWxscGFkZGluZz1cIjEwXCIgY2VsbHNwYWNpbmc9XCIxMFwiPic7XG4gICAgICAgICAgICAgICAgaHRtbCArPSAnPHRyPic7XG4gICAgICAgICAgICAgICAgaHRtbCArPSAnPHRkPic7XG5cbiAgICAgICAgICAgICAgICAkKGlucHV0LmJyYW5jaCkuZWFjaChmdW5jdGlvbiAoYnJhbmNoSW5wdXRJbmRleCwgYnJhbmNoX2lucHV0KSB7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCFicmFuY2hfaW5wdXQuZG9tLmlzX3ZhbGlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpc192YWxpZF9mb3JtID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBkZWxldGUgYnJhbmNoX2lucHV0LmRvbTtcblxuICAgICAgICAgICAgICAgICAgICAvL3RvZG8gdmFsaWRhdGUgYnJhbmNoIGp1bXBzXG4gICAgICAgICAgICAgICAgICAgIGp1bXBfZGVzdGluYXRpb25zID0gdXRpbHMuZ2V0SnVtcEF2YWlsYWJsZURlc3RpbmF0aW9uc0FzS2V5cyhicmFuY2hJbnB1dEluZGV4LCBicmFuY2hfaW5wdXQsIGlucHV0LmJyYW5jaCwgdHJ1ZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy9leHRyYSB2YWxpZGF0aW9uIGZvciBqdW1wcywgY2hlY2sgaWYgdGhlIGRlc3RpbmF0aW9uIHN0aWxsIGV4aXN0cyBhbmQgaXQgaXMgdmFsaWRcbiAgICAgICAgICAgICAgICAgICAgJChicmFuY2hfaW5wdXQuanVtcHMpLmVhY2goZnVuY3Rpb24gKGJyYW5jaEp1bXBJbmRleCwgYnJhbmNoSnVtcCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9kb2VzIHRoZSBqdW1wIFwidG9cIiBwcm9wZXJ0eSByZWZlcmVuY2UgYSB2YWxpZCBkZXN0aW5hdGlvbiBpbnB1dD9cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghanVtcF9kZXN0aW5hdGlvbnNbYnJhbmNoSnVtcC50b10pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2ludmFsaWQgZGVzdGluYXRpb24gZm91bmRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc192YWxpZF9mb3JtID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vbXVsdGlwbGUgY2hvaWNlIHF1ZXN0aW9uP1xuICAgICAgICAgICAgICAgICAgICBpZiAoJC5pbkFycmF5KGJyYW5jaF9pbnB1dC50eXBlLCBjb25zdHMuTVVMVElQTEVfQU5TV0VSX1RZUEVTKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWwgKz0gJzxoNCBjbGFzcz1cInF1ZXN0aW9uXCI+JyArIGJyYW5jaF9pbnB1dC5xdWVzdGlvbiArICc8L2g0Pic7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL3JlbmRlciBwb3NzaWJsZSBhbnN3ZXJzXG4gICAgICAgICAgICAgICAgICAgICAgICBfcmVuZGVyUG9zc2libGVBbnN3ZXJzKGJyYW5jaF9pbnB1dCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgIF9yZW5kZXJRdWVzdGlvbihicmFuY2hfaW5wdXQpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgJChicmFuY2hfaW5wdXQuZ3JvdXApLmVhY2goZnVuY3Rpb24gKGluZGV4LCBncm91cF9pbnB1dCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWdyb3VwX2lucHV0LmRvbS5pc192YWxpZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzX3ZhbGlkX2Zvcm0gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBncm91cF9pbnB1dC5kb207XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vbXVsdGlwbGUgY2hvaWNlIHF1ZXN0aW9uP1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCQuaW5BcnJheShncm91cF9pbnB1dC50eXBlLCBjb25zdHMuTVVMVElQTEVfQU5TV0VSX1RZUEVTKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sICs9ICc8aDQgY2xhc3M9XCJxdWVzdGlvblwiPicgKyBncm91cF9pbnB1dC5xdWVzdGlvbiArICc8L2g0Pic7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9yZW5kZXIgcG9zc2libGUgYW5zd2Vyc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9yZW5kZXJQb3NzaWJsZUFuc3dlcnMoZ3JvdXBfaW5wdXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3JlbmRlclF1ZXN0aW9uKGdyb3VwX2lucHV0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBodG1sICs9ICc8L3RkPic7XG4gICAgICAgICAgICAgICAgaHRtbCArPSAnPC90cj4nO1xuICAgICAgICAgICAgICAgIGh0bWwgKz0gJzwvdGFibGU+JztcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSBjb25zdHMuR1JPVVBfVFlQRTpcbiAgICAgICAgICAgICAgICBodG1sICs9ICc8aDQgY2xhc3M9XCJncm91cC1oZWFkZXJcIj4nICsgaW5wdXQucXVlc3Rpb24gKyAnPC9oND4nO1xuXG4gICAgICAgICAgICAgICAgaHRtbCArPSAnPHRhYmxlIGJvcmRlcj1cIjFcIiBjZWxscGFkZGluZz1cIjEwXCIgY2VsbHNwYWNpbmc9XCIxMFwiPic7XG4gICAgICAgICAgICAgICAgaHRtbCArPSAnPHRyPic7XG4gICAgICAgICAgICAgICAgaHRtbCArPSAnPHRkPic7XG5cblxuICAgICAgICAgICAgICAgICQoaW5wdXQuZ3JvdXApLmVhY2goZnVuY3Rpb24gKGluZGV4LCBncm91cF9pbnB1dCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWdyb3VwX2lucHV0LmRvbS5pc192YWxpZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaXNfdmFsaWRfZm9ybSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBncm91cF9pbnB1dC5kb207XG5cbiAgICAgICAgICAgICAgICAgICAgLy9tdWx0aXBsZSBjaG9pY2UgcXVlc3Rpb24/XG4gICAgICAgICAgICAgICAgICAgIGlmICgkLmluQXJyYXkoZ3JvdXBfaW5wdXQudHlwZSwgY29uc3RzLk1VTFRJUExFX0FOU1dFUl9UWVBFUykgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBodG1sICs9ICc8aDQgY2xhc3M9XCJxdWVzdGlvblwiPicgKyBncm91cF9pbnB1dC5xdWVzdGlvbiArICc8L2g0Pic7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL3JlbmRlciBwb3NzaWJsZSBhbnN3ZXJzXG4gICAgICAgICAgICAgICAgICAgICAgICBfcmVuZGVyUG9zc2libGVBbnN3ZXJzKGdyb3VwX2lucHV0KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgX3JlbmRlclF1ZXN0aW9uKGdyb3VwX2lucHV0KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgaHRtbCArPSAnPC90ZD4nO1xuICAgICAgICAgICAgICAgIGh0bWwgKz0gJzwvdHI+JztcbiAgICAgICAgICAgICAgICBodG1sICs9ICc8L3RhYmxlPic7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgLy9tdWx0aXBsZSBjaG9pY2UgcXVlc3Rpb24/XG4gICAgICAgICAgICAgICAgaWYgKCQuaW5BcnJheShpbnB1dC50eXBlLCBjb25zdHMuTVVMVElQTEVfQU5TV0VSX1RZUEVTKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgaHRtbCArPSAnPGg0IGNsYXNzPVwicXVlc3Rpb25cIj4nICsgaW5wdXQucXVlc3Rpb24gKyAnPC9oND4nO1xuICAgICAgICAgICAgICAgICAgICAvL3JlbmRlciBwb3NzaWJsZSBhbnN3ZXJzXG4gICAgICAgICAgICAgICAgICAgIF9yZW5kZXJQb3NzaWJsZUFuc3dlcnMoaW5wdXQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy9vcGVuIGFuc3dlciBxdWVzdGlvblxuICAgICAgICAgICAgICAgICAgICBfcmVuZGVyUXVlc3Rpb24oaW5wdXQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghaW5wdXQuZG9tLmlzX3ZhbGlkKSB7XG4gICAgICAgICAgICBpc192YWxpZF9mb3JtID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgZGVsZXRlIGlucHV0LmRvbTtcbiAgICB9KTtcblxuICAgIGlmIChpc192YWxpZF9mb3JtKSB7XG4gICAgICAgIC8vZG8gcHJpbnRcbiAgICAgICAgJCgnLnByaW50LXByZXZpZXctd3JhcHBlcicpLmVtcHR5KCkuYXBwZW5kKGh0bWwpO1xuICAgICAgICB3aW5kb3cucHJpbnQoKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHRvYXN0LnNob3dFcnJvcihtZXNzYWdlcy5lcnJvci5GT1JNX0lTX0lOVkFMSUQpO1xuICAgIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gY2FsbGJhY2s7XG4iLCIvKiBnbG9iYWwgJCwgdG9hc3RyLCBGbGF0dGVkLCByZXF1aXJlICovXG4ndXNlIHN0cmljdCc7XG52YXIgY29uc3RzID0gcmVxdWlyZSgnY29uZmlnL2NvbnN0cycpO1xudmFyIHVpID0gcmVxdWlyZSgnaGVscGVycy91aScpO1xudmFyIHV0aWxzID0gcmVxdWlyZSgnaGVscGVycy91dGlscycpO1xudmFyIG1lc3NhZ2VzID0gcmVxdWlyZSgnY29uZmlnL21lc3NhZ2VzJyk7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcbnZhciBqdW1wcyA9IHJlcXVpcmUoJ2FjdGlvbnMvanVtcHMnKTtcbnZhciBzYXZlID0gcmVxdWlyZSgnYWN0aW9ucy9zYXZlJyk7XG52YXIgdG9hc3QgPSByZXF1aXJlKCdjb25maWcvdG9hc3QnKTtcblxuXG4vKlxuIGhhbmRsZSBjbGljayBhY3Rpb24gb24gc2F2ZSBwcm9qZWN0IGJ1dHRvblxuICovXG52YXIgY2FsbGJhY2sgPSBmdW5jdGlvbiAoZSkge1xuXG4gICAgLy9mb3IgdGVzdGluZ1xuICAgIHZhciB1cmwgPSAnLi4vcG9zdGR1bXAvaW5kZXgucGhwJztcbiAgICB2YXIgdmFsaWRhdGlvbiA9IHJlcXVpcmUoJ2FjdGlvbnMvdmFsaWRhdGlvbicpO1xuICAgIHZhciBjdXJyZW50X2lucHV0ID0gdXRpbHMuZ2V0Q3VycmVudGx5U2VsZWN0ZWRJbnB1dCgpO1xuXG4gICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAqIFNhdmUgcHJvamVjdFxuICAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgIC8vc2F2ZSB0aGUgY3VycmVudGx5IHNlbGVjdGVkIGlucHV0IGp1c3QgaW4gY2FzZVxuICAgIGlmIChjdXJyZW50X2lucHV0KSB7XG4gICAgICAgIHZhbGlkYXRpb24ucGVyZm9ybVZhbGlkYXRpb24odXRpbHMuZ2V0Q3VycmVudGx5U2VsZWN0ZWRJbnB1dCgpLCBmYWxzZSk7XG4gICAgfVxuXG5cblxuICAgIC8vY3JlYXRlIGEgZGVlcCBjb3B5IG9mIHRoZSBwcm9qZWN0IG9iamVjdCBwcm9wZXJ0aWVzXG4gICAgdmFyIHByb2plY3RfZGVmaW5pdGlvbl9qc29uID0gRmxhdHRlZC5wYXJzZShGbGF0dGVkLnN0cmluZ2lmeShmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24pKTtcbiAgICAvL2NsZWFuIHVwIGZvcm1zIGZyb20gZXh0cmEgcHJvcGVydGllc1xuXG4gICAgdmFyIGNsZWFuZWRGb3JtcyA9IHNhdmUuZG9DbGVhbmluZ0JlZm9yZVNhdmluZyhwcm9qZWN0X2RlZmluaXRpb25fanNvbi5kYXRhLnByb2plY3QuZm9ybXMpO1xuXG4gICAgaWYgKGNsZWFuZWRGb3Jtcy5hbGxfanVtcHNfdmFsaWQgJiYgY2xlYW5lZEZvcm1zLmludmFsaWRfanVtcHNfcXVlc3Rpb24gPT09ICcnKSB7XG5cbiAgICAgICAgLy8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAgICAvL2FmdGVyIGNsZWFuaW5nLCBkbyBleHRyYSB2YWxpZGF0aW9uLCB0aGUgc2FtZSBvbmUgdGhhdCBydW5zIHdoZW4gaW1wb3J0aW5nIGEgZm9ybSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgIHZhciByZXN1bHQgPSB7XG4gICAgICAgICAgICBpc192YWxpZDogdHJ1ZSxcbiAgICAgICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgICAgICAgbWVzc2FnZTogbnVsbFxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgICQocHJvamVjdF9kZWZpbml0aW9uX2pzb24uZGF0YS5wcm9qZWN0LmZvcm1zKS5lYWNoKGZ1bmN0aW9uIChmb3JtSW5kZXgsIGZvcm0pIHtcblxuICAgICAgICAgICAgdmFyIHZhbGlkYXRlQmVmb3JlU2F2aW5nID0gcmVxdWlyZSgnYWN0aW9ucy92YWxpZGF0aW9uJykudmFsaWRhdGVCZWZvcmVTYXZpbmc7XG5cbiAgICAgICAgICAgIHJlc3VsdCA9IHZhbGlkYXRlQmVmb3JlU2F2aW5nKGZvcm0ucmVmLCBmb3JtLmlucHV0cyk7XG5cbiAgICAgICAgICAgIGlmICghcmVzdWx0LmlzX3ZhbGlkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOy8vZXhpdCBsb29wXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vY2F0Y2ggZm9ybXMgaW52YWxpZCBoZXJlXG4gICAgICAgIGlmICghcmVzdWx0LmlzX3ZhbGlkKSB7XG4gICAgICAgICAgICB0b2FzdC5zaG93RXJyb3IocmVzdWx0LmVycm9yLm1lc3NhZ2UpO1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgICAgLy9hbGwgdmFsaWQsIHN0YXJ0IHNhdmluZyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgICAgICAvL3Nob3cgb3ZlcmxheSBhbmQgY3Vyc29yXG4gICAgICAgIGZvcm1idWlsZGVyLmRvbS5vdmVybGF5LmZhZGVJbihjb25zdHMuQU5JTUFUSU9OX0ZBU1QpO1xuXG4gICAgICAgIC8vZm9yIGxvY2FsIHRlc3Rpbmcgb25seVxuICAgICAgICBpZiAod2luZG93LmxvY2F0aW9uLmhyZWYuaW5kZXhPZignbG9jYWxob3N0LycpICE9PSAtMSAmJiB3aW5kb3cubG9jYXRpb24uaHJlZi5pbmRleE9mKCdlcGljb2xsZWN0NS1mb3JtYnVpbGRlci8nKSAhPT0gLTEpIHtcbiAgICAgICAgICAgIGNvbnN0cy5QUk9KRUNUX1VSTCA9IHVybDtcbiAgICAgICAgfVxuXG4gICAgICAgICQuYWpheCh7XG4gICAgICAgICAgICB1cmw6IGNvbnN0cy5QUk9KRUNUX1VSTCxcbiAgICAgICAgICAgIC8vICBjb250ZW50VHlwZTogJ2FwcGxpY2F0aW9uL3ZuZC5hcGkranNvbicsXG4gICAgICAgICAgICBkYXRhOiB3aW5kb3cuYnRvYShwYWtvLmd6aXAoSlNPTi5zdHJpbmdpZnkocHJvamVjdF9kZWZpbml0aW9uX2pzb24pLCB7XG4gICAgICAgICAgICAgICAgJ3RvJzogJ3N0cmluZydcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICkpLFxuICAgICAgICAgICAgLy8gIGRhdGE6IEpTT04uc3RyaW5naWZ5KHByb2plY3RfZGVmaW5pdGlvbl9qc29uKSxcbiAgICAgICAgICAgIC8vICAgZGF0YVR5cGU6ICdqc29uJyxcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgY3Jvc3NEb21haW46IHRydWUsXG4gICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLm92ZXJsYXkuZmFkZU91dChjb25zdHMuQU5JTUFUSU9OX0ZBU1QsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvYXN0LnNob3dTdWNjZXNzKG1lc3NhZ2VzLnN1Y2Nlc3MuUFJPSkVDVF9TQVZFRCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgfSwgY29uc3RzLkFOSU1BVElPTl9TTE9XKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygncG9zdGVkIHN1Y2Nlc3NmdWxseScpO1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uICh4aHIsIGVycm9yLCByZXNwb25zZSkge1xuXG4gICAgICAgICAgICAgICAgdmFyIGVycm9yX29iajtcbiAgICAgICAgICAgICAgICB2YXIgdGl0bGVzID0gJyc7XG5cbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBlcnJvcl9vYmogPSBKU09OLnBhcnNlKHhoci5yZXNwb25zZVRleHQpO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyh4aHIucmVzcG9uc2VUZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coeGhyLCBlcnJvciwgcmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgICAgICAvL2dldCBzZXJ2ZXIgZXJyb3JzXG4gICAgICAgICAgICAgICAgICAgICQoZXJyb3Jfb2JqLmVycm9ycykuZWFjaChmdW5jdGlvbiAoaW5kZXgsIGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aXRsZXMgKz0gJzxici8+JyArIGVycm9yLnRpdGxlO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5vdmVybGF5LmZhZGVPdXQoY29uc3RzLkFOSU1BVElPTl9GQVNUKTtcbiAgICAgICAgICAgICAgICB0b2FzdC5zaG93RXJyb3IobWVzc2FnZXMuZXJyb3IuUFJPSkVDVF9OT1RfU0FWRUQgKyB0aXRsZXMsIDMwMDApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgICk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICB0b2FzdC5zaG93RXJyb3IobWVzc2FnZXMuZXJyb3IuSlVNUF9JTlZBTElEICsgY2xlYW5lZEZvcm1zLmludmFsaWRfanVtcHNfcXVlc3Rpb24pO1xuICAgIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gY2FsbGJhY2s7XG4iLCIndXNlIHN0cmljdCc7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcbnZhciBtZXNzYWdlcyA9IHJlcXVpcmUoJ2NvbmZpZy9tZXNzYWdlcycpO1xudmFyIHZhbGlkYXRpb24gPSByZXF1aXJlKCdhY3Rpb25zL3ZhbGlkYXRpb24nKTtcbnZhciB1aSA9IHJlcXVpcmUoJ2hlbHBlcnMvdWknKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoJ2hlbHBlcnMvdXRpbHMnKTtcbnZhciBjb25zdHMgPSByZXF1aXJlKCdjb25maWcvY29uc3RzJyk7XG52YXIgaW5wdXRfcHJvcGVydGllc19rZXl1cF9jYWxsYmFjayA9IHJlcXVpcmUoJ3VpLWhhbmRsZXJzL2V2ZW50LWhhbmRsZXItY2FsbGJhY2tzL2lucHV0LXByb3BlcnRpZXMta2V5dXAtY2FsbGJhY2snKTtcbnZhciB0ZW1wbGF0ZSA9IHJlcXVpcmUoJ3RlbXBsYXRlJyk7XG52YXIgdG9hc3QgPSByZXF1aXJlKCdjb25maWcvdG9hc3QnKTtcbnZhciBwb3NzaWJsZUFuc3dlcnNTb3J0YWJsZSA9IHJlcXVpcmUoJ3VpLWhhbmRsZXJzL3Bvc3NpYmxlLWFuc3dlcnMtc29ydGFibGUnKTtcblxudmFyIGdyb3VwX3NvcnRhYmxlID0gZnVuY3Rpb24gKCkge1xuXG4gICAgdmFyIGdyb3VwX2lucHV0O1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgY3Vyc29yOiAnbW92ZScsXG4gICAgICAgIGl0ZW1zOiAnLmlucHV0JyxcbiAgICAgICAgcmV2ZXJ0OiAxMDAsXG4gICAgICAgIC8vYXhpczogJ3knLC8vIGl0IGNhdXNlcyB0aGUgcGxhY2Vob2xkZXIgdG8gYmUgYWx3YXlzIGFjdGl2ZVxuICAgICAgICBjb250YWlubWVudDogJ3BhcmVudCcsXG4gICAgICAgIHRvbGVyYW5jZTogJ3BvaW50ZXInLFxuICAgICAgICAvLyBmb3JjZVBsYWNlaG9sZGVyU2l6ZTogdHJ1ZSxcbiAgICAgICAgcGxhY2Vob2xkZXI6ICdpbnB1dC1jb2xsZWN0aW9uLWRyb3AtcGxhY2Vob2xkZXInLFxuXG4gICAgICAgIC8vdHJpZ2dlcmVkIHdoZW4gYSBuZXcgaW5wdXQgaXMgZHJvcHBlZCBvdmVyIHRoZSBzb3J0YWJsZVxuICAgICAgICByZWNlaXZlOiBmdW5jdGlvbiAoZSwganF1ZXJ5X3VpKSB7XG5cbiAgICAgICAgICAgIHZhciBmb3JtX2luZGV4ID0gZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4O1xuICAgICAgICAgICAgdmFyIHByZXZpb3VzX2dyb3VwX2lucHV0X3JlZiA9IGZvcm1idWlsZGVyLmdyb3VwLmN1cnJlbnRfaW5wdXRfcmVmO1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRfZWxlbWVudDtcbiAgICAgICAgICAgIHZhciBncm91cF9pbnB1dHMgPSB1dGlscy5nZXRJbnB1dE9iamVjdEJ5UmVmKGZvcm1idWlsZGVyLmN1cnJlbnRfaW5wdXRfcmVmKS5ncm91cDtcbiAgICAgICAgICAgIHZhciBncm91cF9pbnB1dF9yZWYgPSB1dGlscy5nZW5lcmF0ZUJyYW5jaEdyb3VwSW5wdXRSZWYoZm9ybWJ1aWxkZXIuY3VycmVudF9pbnB1dF9yZWYpO1xuICAgICAgICAgICAgdmFyIGdyb3VwX2lucHV0X2luZGV4ID0gZ3JvdXBfaW5wdXRzLmxlbmd0aDtcbiAgICAgICAgICAgIHZhciBncm91cF9pbnB1dF90eXBlID0ganF1ZXJ5X3VpLml0ZW0uYXR0cignZGF0YS10eXBlJyk7XG4gICAgICAgICAgICB2YXIgaW5wdXRfZmFjdG9yeSA9IHJlcXVpcmUoJ2ZhY3RvcnkvaW5wdXQtZmFjdG9yeScpO1xuICAgICAgICAgICAgdmFyIG93bmVyX2JyYW5jaDtcblxuICAgICAgICAgICAgLy9pZiB3ZSBhcmUgZWRpdGluZyBhIGJyYW5jaCwgaXQgbWVhbnMgdGhpcyBpcyBhIG5lc3RlZCBncm91cCwgdXBkYXRlIHJlZmVyZW5jZXMgYWNjb3JkaW5nbHlcbiAgICAgICAgICAgIGlmIChmb3JtYnVpbGRlci5pc19lZGl0aW5nX2JyYW5jaCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCd3ZSBhcmUgZWRpdGluZyBhIG5lc3RlZCBncm91cCcpO1xuXG4gICAgICAgICAgICAgICAgZ3JvdXBfaW5wdXRzID0gdXRpbHMuZ2V0QnJhbmNoSW5wdXRPYmplY3RCeVJlZihmb3JtYnVpbGRlci5icmFuY2guY3VycmVudF9pbnB1dF9yZWYpLmdyb3VwO1xuICAgICAgICAgICAgICAgIGdyb3VwX2lucHV0X3JlZiA9IHV0aWxzLmdlbmVyYXRlQnJhbmNoR3JvdXBJbnB1dFJlZihmb3JtYnVpbGRlci5icmFuY2guY3VycmVudF9pbnB1dF9yZWYpO1xuICAgICAgICAgICAgICAgIGdyb3VwX2lucHV0X2luZGV4ID0gZ3JvdXBfaW5wdXRzLmxlbmd0aDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy9kbyBub3QgY29uc2lkZXIgZ3JvdXAvYnJhbmNoIGlucHV0cyB3aXRoaW4gYSBncm91cFxuICAgICAgICAgICAgaWYgKGdyb3VwX2lucHV0X3R5cGUgPT09IGNvbnN0cy5CUkFOQ0hfVFlQRSB8fCBncm91cF9pbnB1dF90eXBlID09PSBjb25zdHMuR1JPVVBfVFlQRSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZ3JvdXAuY3VycmVudF9pbnB1dF9yZWYgPSBncm91cF9pbnB1dF9yZWY7XG5cbiAgICAgICAgICAgICAgICAvL3ZhbGlkYXRlIHByZXZpb3VzIGlucHV0IChpZiBhbnkpIHRvIHNob3cgZW1iZWRkZWQgZXJyb3JzIChpbiBjYXNlIHRoZSB1c2VyIGRpZCBub3QgcHJlc3MgdmFsaWRhdGUgYnV0dG9uKVxuICAgICAgICAgICAgICAgIC8vdG9kbyBpcyB0aGlzIGFuIG92ZXJraWxsP1xuICAgICAgICAgICAgICAgIGlmIChwcmV2aW91c19ncm91cF9pbnB1dF9yZWYpIHtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19icmFuY2gpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vdGhpcyBpcyBhIG5lc3RlZCBncm91cCxnZXQgb3duZXIgYnJhbmNoXG4gICAgICAgICAgICAgICAgICAgICAgICBvd25lcl9icmFuY2ggPSB1dGlscy5nZXRJbnB1dE9iamVjdEJ5UmVmKGZvcm1idWlsZGVyLmJyYW5jaC5hY3RpdmVfYnJhbmNoX3JlZik7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbGlkYXRpb24ucGVyZm9ybVZhbGlkYXRpb24odXRpbHMuZ2V0TmVzdGVkR3JvdXBJbnB1dE9iamVjdEJ5UmVmKG93bmVyX2JyYW5jaCwgcHJldmlvdXNfZ3JvdXBfaW5wdXRfcmVmKSwgZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsaWRhdGlvbi5wZXJmb3JtVmFsaWRhdGlvbih1dGlscy5nZXRHcm91cElucHV0T2JqZWN0QnlSZWYocHJldmlvdXNfZ3JvdXBfaW5wdXRfcmVmKSwgZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnZ3JvdXAgc29ydGFibGUgcmVjZWl2ZScpO1xuXG4gICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZ3JvdXAuY29sbGVjdGlvbl9pc19iZWluZ19zb3J0ZWQgPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgIC8vZ2VuZXJhdGUgaW5wdXQgb2JqZWN0IGJhc2VkIG9uIHR5cGUgYW5kIHNldCBpbmRleCBpbmNyZW1lbnRhbGx5XG4gICAgICAgICAgICAgICAgZ3JvdXBfaW5wdXQgPSBpbnB1dF9mYWN0b3J5LmNyZWF0ZUlucHV0KGdyb3VwX2lucHV0X3R5cGUsIGdyb3VwX2lucHV0X3JlZik7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZ3JvdXBfaW5wdXQpO1xuXG4gICAgICAgICAgICAgICAgLy9kaXNhYmxlIGN1cnJlbnQgYWN0aXZlIGVsZW1lbnRcbiAgICAgICAgICAgICAgICBjdXJyZW50X2VsZW1lbnQgPSBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25fc29ydGFibGUuZmluZCgnLmFjdGl2ZScpO1xuICAgICAgICAgICAgICAgIGN1cnJlbnRfZWxlbWVudC5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG5cbiAgICAgICAgICAgICAgICAvL2FkZCBpbnB1dCB0byBjb2xsZWN0aW9uIGFzIHRoZSBsYXN0IG9uZVxuICAgICAgICAgICAgICAgIGdyb3VwX2lucHV0cy5wdXNoKGdyb3VwX2lucHV0KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy9kaXNhYmxlIHNhdmUgcHJvamVjdCBidXR0b24gYXMgYnkgZGVmYXVsdCBhbiBpbnB1dCBpcyBpbnZhbGlkIHdoZW4gaXQgaXMgY3JlYXRlZFxuICAgICAgICAgICAgdWkubmF2YmFyLnRvZ2dsZVNhdmVQcm9qZWN0QnRuKGNvbnN0cy5CVE5fRElTQUJMRUQpO1xuICAgICAgICB9LFxuICAgICAgICBzdG9wOiBmdW5jdGlvbiAoZSwganF1ZXJ5X3VpKSB7XG5cbiAgICAgICAgICAgIHZhciB1bmRvID0gcmVxdWlyZSgnYWN0aW9ucy91bmRvJyk7XG4gICAgICAgICAgICB2YXIgZm9ybV9pbmRleCA9IGZvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleDtcbiAgICAgICAgICAgIHZhciBncm91cF9pbnB1dF9yZWYgPSBmb3JtYnVpbGRlci5ncm91cC5jdXJyZW50X2lucHV0X3JlZjtcbiAgICAgICAgICAgIHZhciBvd25lcl9pbnB1dF9yZWYgPSBmb3JtYnVpbGRlci5jdXJyZW50X2lucHV0X3JlZjtcbiAgICAgICAgICAgIHZhciBvd25lcl9pbnB1dF9pbmRleCA9IHV0aWxzLmdldElucHV0Q3VycmVudEluZGV4QnlSZWYob3duZXJfaW5wdXRfcmVmKTtcbiAgICAgICAgICAgIHZhciBpbnB1dHMgPSBmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24uZGF0YS5wcm9qZWN0LmZvcm1zW2Zvcm1faW5kZXhdLmlucHV0cztcbiAgICAgICAgICAgIHZhciBncm91cF9pbnB1dHMgPSBpbnB1dHNbb3duZXJfaW5wdXRfaW5kZXhdLmdyb3VwO1xuICAgICAgICAgICAgdmFyIHBsYWNlaG9sZGVyX3RleHQgPSBtZXNzYWdlcy5lcnJvci5OT19RVUVTVElPTl9URVhUX1lFVDtcbiAgICAgICAgICAgIHZhciBpbnB1dF90eXBlID0ganF1ZXJ5X3VpLml0ZW0uYXR0cignZGF0YS10eXBlJyk7XG4gICAgICAgICAgICB2YXIgcHJvcGVydGllc19wYW5lbF9odG1sO1xuXG4gICAgICAgICAgICAvL2Rpc2FibGUgZHJhZ2dhYmxlIGlmIHdlIGhpdCB0aGUgbWF4IGFtb3VudCBvZiBpbnB1dHMgYWxsb3dlZFxuICAgICAgICAgICAgaWYgKHV0aWxzLmdldElucHV0c1RvdGFsKGlucHV0cykgPj0gY29uc3RzLklOUFVUU19NQVhfQUxMT1dFRCkge1xuICAgICAgICAgICAgICAgIHVpLmlucHV0X3Rvb2xzLmRpc2FibGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vcmVqZWN0IGdyb3VwL2JyYW5jaCBpbnB1dHMgaGVyZVxuICAgICAgICAgICAgaWYgKGlucHV0X3R5cGUgPT09IGNvbnN0cy5CUkFOQ0hfVFlQRSB8fCBpbnB1dF90eXBlID09PSBjb25zdHMuR1JPVVBfVFlQRSkge1xuICAgICAgICAgICAgICAgIGpxdWVyeV91aS5pdGVtLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgIC8vaWYgZ3JvdXAgaW5wdXRzIGxlbmd0aCBpcyB6ZXJvLCBzaG93IGhlbHAgdGV4dCBwbGFjZWhvbGRlclxuICAgICAgICAgICAgICAgIC8vdG9kb1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgLy9jb3VudCBzZWFyY2ggaW5wdXRzXG4gICAgICAgICAgICAgICAgaWYoaW5wdXRfdHlwZSA9PT0gY29uc3RzLlNFQVJDSF9TSU5HTEVfVFlQRSAmJiAhZm9ybWJ1aWxkZXIuZ3JvdXAuY29sbGVjdGlvbl9pc19iZWluZ19zb3J0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9pZiB0aGUgbGltaXQgaXMgcmVhY2hlZCwgaGlkZSBzZWFyY2ggZnJvbSBpbnB1dCB0b29sc1xuICAgICAgICAgICAgICAgICAgICBpZiAodXRpbHMuZ2V0U2VhcmNoSW5wdXRzVG90YWwoKSA+PSBjb25zdHMuTElNSVRTLnNlYXJjaF9pbnB1dHNfbWF4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB1aS5pbnB1dF90b29scy5oaWRlU2VhcmNoSW5wdXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vc2hvdyB3YXJuaW5nIHRvIHVzZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvYXN0LnNob3dXYXJuaW5nKG1lc3NhZ2VzLndhcm5pbmcuU0VBUkNIX0lOUFVUU19MSU1JVF9SRUFDSEVEICsgJygnICsgY29uc3RzLkxJTUlUUy5zZWFyY2hfaW5wdXRzX21heCArICcpJylcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vaWYgd2UgYXJlIGVkaXRpbmcgYSBicmFuY2gsIGl0IG1lYW5zIHRoaXMgaXMgYSBuZXN0ZWQgZ3JvdXBcbiAgICAgICAgICAgICAgICBpZiAoZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19icmFuY2gpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3dlIGFyZSBlZGl0aW5nIGEgbmVzdGVkIGdyb3VwJyk7XG4gICAgICAgICAgICAgICAgICAgIG93bmVyX2lucHV0X3JlZiA9IGZvcm1idWlsZGVyLmJyYW5jaC5jdXJyZW50X2lucHV0X3JlZjtcbiAgICAgICAgICAgICAgICAgICAgZ3JvdXBfaW5wdXRzID0gdXRpbHMuZ2V0QnJhbmNoSW5wdXRPYmplY3RCeVJlZihvd25lcl9pbnB1dF9yZWYpLmdyb3VwO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGpxdWVyeV91aS5pdGVtLnJlbW92ZUF0dHIoJ3N0eWxlJyk7IC8vIHVuZG8gc3R5bGluZyBzZXQgYnkganF1ZXJ5VUkgKGh0dHA6Ly9nb28uZ2wvRUt6OHRDKVxuXG4gICAgICAgICAgICAgICAgLy9nZXQgdGhlIGluZGV4IHdoZXJlIHRoZSBpbnB1dCB3YXMgZHJvcHBlZCAoc2tpcCB3aGVuIGxpc3QgaXMgZW1wdHkpXG4gICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZ3JvdXAudG9faW5kZXggPSBqcXVlcnlfdWkuaXRlbS5pbmRleCgpID09PSAwID8ganF1ZXJ5X3VpLml0ZW0uaW5kZXgoKSA6IGpxdWVyeV91aS5pdGVtLmluZGV4KCkgLSAxO1xuXG4gICAgICAgICAgICAgICAgLy9oaWRlIG1lc3NhZ2UgYWJvdXQgbm8gaW5wdXQgc2VsZWN0ZWQsIGFzIGRyb3BwZWQgaW5wdXQgZ2V0cyBmb2N1c1xuICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX25vX2lucHV0X3NlbGVjdGVkLmhpZGUoKTtcblxuXG4gICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgaWYgdGhlIHVzZXIgaXMgZHJhZ2dpbmcgYSBuZXcgaW5wdXQgb3ZlciwgaXQgd2FzIGFkZGVkIGFzIHRoZSBsYXN0IGVsZW1lbnQgb2YgdGhlIGFycmF5XG4gICAgICAgICAgICAgICAgIG90aGVyd2lzZSB0aGUgY3VycmVudCBpbnB1dCBwb3NpdGlvbiBpcyBzZXQgaW4gdGhlIHN0YXJ0IGV2ZW50XG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgaWYgKCFmb3JtYnVpbGRlci5ncm91cC5jb2xsZWN0aW9uX2lzX2JlaW5nX3NvcnRlZCkge1xuXG4gICAgICAgICAgICAgICAgICAgIC8vb3ZlcnJpZGUgJ2Zyb21faW5kZXgnIGFzIHdlIGFyZSBkcm9wcGluZyBhIG5ldyBlbGVtZW50IChtaW4gdmFsdWUgZm9yIGxlbmd0aCBpcyAxLCBhcyB3ZSBhZGQgdGhlIGlucHV0IGluIHRoZSBgcmVjZWl2ZWAgZnVuY3Rpb24pXG4gICAgICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLmdyb3VwLmZyb21faW5kZXggPSBncm91cF9pbnB1dHMubGVuZ3RoIC0gMTtcblxuICAgICAgICAgICAgICAgICAgICAvL21vdmUgaW5wdXRzIHRvIGtlZXAgdGhlIGFycmF5IHNlcXVlbmNlIGxpa2UgdGhlIGlucHV0IHNlcXVlbmNlIG9uIHNjcmVlblxuICAgICAgICAgICAgICAgICAgICBncm91cF9pbnB1dHMubW92ZShmb3JtYnVpbGRlci5ncm91cC5mcm9tX2luZGV4LCBmb3JtYnVpbGRlci5ncm91cC50b19pbmRleCk7XG5cbiAgICAgICAgICAgICAgICAgICAganF1ZXJ5X3VpLml0ZW0uYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICAgICAgICAgICAgICBqcXVlcnlfdWkuaXRlbS5hdHRyKCdkYXRhLWlucHV0LXJlZicsIGdyb3VwX2lucHV0X3JlZik7XG5cbiAgICAgICAgICAgICAgICAgICAgLy9hcHBlbmQgaW5wdXQgaWQgYW5kIGEgd2FybmluZyBpY29uLCBhcyBieSBkZWZhdWx0IHRoZSBxdWVzdGlvbiBkb2VzIG5vdCBoYXZlIGFueSB0ZXh0XG4gICAgICAgICAgICAgICAgICAgIGpxdWVyeV91aS5pdGVtLmZpbmQoJy5pbnB1dC1pbm5lcicpLmFwcGVuZCh1aS5pbnB1dHNfY29sbGVjdGlvbi5nZXRJbnB1dFN0YXRlSWNvbnNIVE1MKCkpO1xuICAgICAgICAgICAgICAgICAgICBqcXVlcnlfdWkuaXRlbS5maW5kKCdzcGFuLnF1ZXN0aW9uLXByZXZpZXcnKS50ZXh0KHBsYWNlaG9sZGVyX3RleHQpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vc2hvdyBpbnB1dCBwcm9wZXJ0aWVzIGZvciB0aGUgbmV3IGRyb3BwZWQgaW5wdXRcbiAgICAgICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXMuZmluZCgnLnBhbmVsLWJvZHkgZm9ybScpLmhpZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXMuZmluZCgnLnBhbmVsLXRpdGxlIHNwYW4nKS50ZXh0KHBsYWNlaG9sZGVyX3RleHQpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vY3JlYXRlIHByb3BlcnRpZXMgcGFuZWwgaW4gcmlnaHQgc2lkZWJhciBmb3IgdGhpcyBpbnB1dCAoY29tbW9uIHByb3BlcnRpZXMpXG4gICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXNfcGFuZWxfaHRtbCA9IHRlbXBsYXRlLmdldElucHV0UHJvcGVydGllc1BhbmVsSFRNTChncm91cF9pbnB1dCk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy9hcHBlbmQgaW5wdXQgYW5kIHNob3cgaXQgYXMgaXQgZ2V0cyBzZWxlY3RlZCBieSBkZWZhdWx0XG4gICAgICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXIuaGlkZSgpO1xuICAgICAgICAgICAgICAgICAgICAkKHByb3BlcnRpZXNfcGFuZWxfaHRtbCkucmVtb3ZlQ2xhc3MoJ2hpZGRlbicpLmFwcGVuZFRvKGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXIpO1xuXG4gICAgICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXIuZmFkZUluKGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy9zaG93IGFjdGlvbiBidXR0b25zIGZvciBpbnB1dFxuICAgICAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc19idXR0b25zLmZhZGVJbihjb25zdHMuQU5JTUFUSU9OX0ZBU1QpO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICghZm9ybWJ1aWxkZXIuaXNfZWRpdGluZ19icmFuY2gpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy9mb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllcy5vZmYoJ2tleXVwJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vdGhpcyBpcyBOT1QgbmVzdGVkIGdyb3VwXG4gICAgICAgICAgICAgICAgICAgICAgICAvL3RyaWdnZXJlZCB3aGVuIHVzZXJzIHR5cGUgaW4gdGhlIGhlYWRlciBpbnB1dCBmaWVsZCBmb3IgYnJhbmNoZXMgb3IgZ3JvdXBzXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ3JvdXBfaW5wdXQudHlwZSA9PT0gY29uc3RzLkdST1VQX1RZUEUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllcy5vbigna2V5dXAnLCAnaW5wdXQnLCBpbnB1dF9wcm9wZXJ0aWVzX2tleXVwX2NhbGxiYWNrKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8vZW5hYmxlIHNvcnRhYmxlIG9uIGN1cnJlbnQgaW5wdXRcbiAgICAgICAgICAgICAgICAgICAgcG9zc2libGVBbnN3ZXJzU29ydGFibGUoZ3JvdXBfaW5wdXQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8nZnJvbV9pbmRleCBpcyBzZXQgaW4gc3RhcnQgZXZlbnQgb2Ygc29ydGFibGUnXG4gICAgICAgICAgICAgICAgICAgIC8vbW92ZSBpbnB1dHMgdG8ga2VlcCB0aGUgYXJyYXkgc2VxdWVuY2UgbGlrZSB0aGUgaW5wdXQgc2VxdWVuY2Ugb24gc2NyZWVuXG4gICAgICAgICAgICAgICAgICAgIGdyb3VwX2lucHV0cy5tb3ZlKGZvcm1idWlsZGVyLmdyb3VwLmZyb21faW5kZXgsIGZvcm1idWlsZGVyLmdyb3VwLnRvX2luZGV4KTtcblxuICAgICAgICAgICAgICAgICAgICAvL3J1biB0aGUgdmFsaWRhdGlvbiBvbiBhbGwgZ3JvdXAganVtcHMsIGFzIHdlIG1pZ2h0IGhhdmUgc29tZSBpbnZhbGlkIGRlc3RpbmF0aW9ucyBhZnRlciByZS1vcmRlcmluZ1xuICAgICAgICAgICAgICAgICAgICAvL0kgYW0gZm9yY2VkIHRvIGRvIHRoaXMgYWdhaW5zdCBhbGwgdGhlIGJyYW5jaCBpbnB1dHNcbiAgICAgICAgICAgICAgICAgICAgdmFsaWRhdGlvbi52YWxpZGF0ZUp1bXBzQWZ0ZXJTb3J0aW5nKGdyb3VwX2lucHV0cyk7XG5cbiAgICAgICAgICAgICAgICAgICAganF1ZXJ5X3VpLml0ZW0uYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy9hZGQgdGhpcyBzdGF0ZSBmb3IgdW5kb2luZywgc28gaXQgaXMgZWFzaWVyIHRvIHJlYmluZCBldmVyeXRoaW5nXG4gICAgICAgICAgICBmb3JtYnVpbGRlci5yZW5kZXJfYWN0aW9uID0gY29uc3RzLlJFTkRFUl9BQ1RJT05fRE87XG4gICAgICAgICAgICB1bmRvLnB1c2hTdGF0ZSgpO1xuXG4gICAgICAgICAgICBpZiAoaW5wdXRfdHlwZSA9PT0gY29uc3RzLlJFQURNRV9UWVBFKSB7XG4gICAgICAgICAgICAgICAgJCgnLnN1bW1lcm5vdGUnKS5zdW1tZXJub3RlKGNvbnN0cy5TVU1NRVJOT1RFX09QVElPTlMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICAvL3RoaXMgY2FsbGJhY2sgaXMgdHJpZ2dlcmVkIHdoZW4gdGhlIHVzZXIgc3RhcnQgZHJhZ2dpbmcgYW4gZXhpc3RpbmcgaW5wdXQgZnJvbSB0aGUgc29ydGFibGVcbiAgICAgICAgc3RhcnQ6IGZ1bmN0aW9uIChlLCBqcXVlcnlfdWkpIHtcblxuICAgICAgICAgICAgLy9nZXQgY3VycmVudCBpbnB1dCBwb3NpdGlvbiwgYXMgd2UgbmVlZCB0byBtb3ZlIGZyb20gaGVyZVxuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZ3JvdXAuY29sbGVjdGlvbl9pc19iZWluZ19zb3J0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZ3JvdXAuZnJvbV9pbmRleCA9IGpxdWVyeV91aS5pdGVtLmluZGV4KCkgPT09IDAgPyAwIDoganF1ZXJ5X3VpLml0ZW0uaW5kZXgoKSAtIDE7XG4gICAgICAgICAgICAvL2RlLWFjdGl2YXRlIGFsbCBpbnB1dHMgaW4gY29sbGVjdGlvblxuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uX3NvcnRhYmxlLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcblxuICAgICAgICB9LFxuICAgICAgICBzY3JvbGw6IHRydWUsXG4gICAgICAgIHNuYXA6IGZhbHNlLFxuICAgICAgICBvdmVyOiBmdW5jdGlvbiAoZSwganF1ZXJ5X3VpKSB7XG5cbiAgICAgICAgICAgIHZhciBvd25lcl9pbnB1dF9yZWYgPSBmb3JtYnVpbGRlci5ncm91cC5hY3RpdmVfZ3JvdXBfcmVmO1xuICAgICAgICAgICAgdmFyIG93bmVyX2lucHV0ID0gdXRpbHMuZ2V0SW5wdXRPYmplY3RCeVJlZihvd25lcl9pbnB1dF9yZWYpO1xuXG4gICAgICAgICAgICAvL2lmIHdlIGFyZSBlZGl0aW5nIGEgbmVzdGVkIGdyb3VwLCBncmFiIHRoZSBuZXN0ZWQgZ3JvdXBcbiAgICAgICAgICAgIGlmIChmb3JtYnVpbGRlci5pc19lZGl0aW5nX2JyYW5jaCkge1xuICAgICAgICAgICAgICAgIG93bmVyX2lucHV0ID0gdXRpbHMuZ2V0QnJhbmNoSW5wdXRPYmplY3RCeVJlZihvd25lcl9pbnB1dF9yZWYpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL2hpZGUgaGVscCB0ZXh0IGlmIHRoZSBsaXN0IGlzIGVtcHR5IGFuZCB3ZSBhcmUgaG92ZXJpbmcgd2l0aCBhbiBpbnB1dFxuICAgICAgICAgICAgaWYgKG93bmVyX2lucHV0Lmdyb3VwLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIC8vcmVtb3ZlIGlucHV0IGZyb20gZG9tIGNvbGxlY3Rpb24gKG1pZGRsZSBjb2x1bW4pXG4gICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uX3NvcnRhYmxlXG4gICAgICAgICAgICAgICAgICAgIC5maW5kKCdkaXYuaW5wdXRbZGF0YS1pbnB1dC1yZWY9XCInICsgb3duZXJfaW5wdXRfcmVmICsgJ1wiXScpXG4gICAgICAgICAgICAgICAgICAgIC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fbm8tZ3JvdXAtcXVlc3Rpb25zLW1lc3NhZ2UnKVxuICAgICAgICAgICAgICAgICAgICAuaGlkZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gZ3JvdXBfc29ydGFibGUoKTtcbiIsIid1c2Ugc3RyaWN0JztcbnZhciBmb3JtYnVpbGRlciA9IHJlcXVpcmUoJ2NvbmZpZy9mb3JtYnVpbGRlcicpO1xudmFyIGNvbnN0cyA9IHJlcXVpcmUoJ2NvbmZpZy9jb25zdHMnKTtcbnZhciB1aSA9IHJlcXVpcmUoJ2hlbHBlcnMvdWknKTtcbnZhciBzYXZlX3Byb2plY3RfY2xpY2tfY2FsbGJhY2sgPSByZXF1aXJlKCd1aS1oYW5kbGVycy9ldmVudC1oYW5kbGVyLWNhbGxiYWNrcy9zYXZlLXByb2plY3QtY2xpY2stY2FsbGJhY2snKTtcblxudmFyIHBvc3NpYmxlQW5zd2Vyc1NvcnRhYmxlID0gZnVuY3Rpb24gKGlucHV0KSB7XG5cbiAgICB2YXIgdmFsaWRhdGlvbiA9IHJlcXVpcmUoJ2FjdGlvbnMvdmFsaWRhdGlvbicpO1xuXG4gICAgLy9pZiBub3QgbXVsdGlwbGUgY2hvaWNlIHR5cGUsIHJldHVyblxuICAgIGlmICgkLmluQXJyYXkoaW5wdXQudHlwZSwgY29uc3RzLk1VTFRJUExFX0FOU1dFUl9UWVBFUykgPT09IC0xKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvL2F0dGFjaCBzb3J0YWJsZSBvbmx5IG9uY2UgcGVyIGVhY2ggaW5wdXQgdG8ga2VlcCBsb3cgbWVtb3J5IHVzYWdlXG4gICAgaWYgKCQuaW5BcnJheShpbnB1dC5yZWYsIGZvcm1idWlsZGVyLnBvc3NpYmxlX2Fuc3dlcnMuZW5hYmxlZF9zb3J0YWJsZSkgPT09IC0xKSB7XG5cbiAgICAgICAgLy9lbmFibGUgc29ydGFibGUgZm9yIHRoaXMgaW5wdXRcbiAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlclxuICAgICAgICAgICAgLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19wb3NzaWJsZS1hbnN3ZXJzX19saXN0Jykuc29ydGFibGUoe1xuICAgICAgICAgICAgYXhpczogJ3knLFxuICAgICAgICAgICAgY29udGFpbm1lbnQ6ICdwYXJlbnQnLFxuICAgICAgICAgICAgaGFuZGxlOiAnLmlucHV0LXByb3BlcnRpZXNfX2Zvcm1fX3Bvc3NpYmxlLWFuc3dlcnNfX2xpc3RfX2RyYWctYW5zd2VyJyxcbiAgICAgICAgICAgIGNhbmNlbDogJycsXG4gICAgICAgICAgICBoZWxwZXI6ICdjbG9uZScsXG4gICAgICAgICAgICB0b2xlcmFuY2U6ICdwb2ludGVyJyxcbiAgICAgICAgICAgIHBsYWNlaG9sZGVyOiAncG9zc2libGUtYW5zd2Vycy1kcm9wLXBsYWNlaG9sZGVyJyxcbiAgICAgICAgICAgIHN0b3A6IGZ1bmN0aW9uIChlLCBqcXVlcnlfdWkpIHtcbiAgICAgICAgICAgICAgICAvLydmcm9tX2luZGV4IGlzIHNldCBpbiBzdGFydCBldmVudCBvZiBzb3J0YWJsZSdcbiAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5wb3NzaWJsZV9hbnN3ZXJzLnRvX2luZGV4ID0ganF1ZXJ5X3VpLml0ZW0uaW5kZXgoJycpID09PSAwID8ganF1ZXJ5X3VpLml0ZW0uaW5kZXgoKSA6IGpxdWVyeV91aS5pdGVtLmluZGV4KCk7XG5cbiAgICAgICAgICAgICAgICAvL21vdmUgaW5wdXRzIHRvIGtlZXAgdGhlIHBvc3NpYmxlIGFuc3dlcnMgc2VxdWVuY2UgbGlrZSB0aGUgc2VxdWVuY2Ugb24gc2NyZWVuIChkb20pXG4gICAgICAgICAgICAgICAgaW5wdXQucG9zc2libGVfYW5zd2Vycy5tb3ZlKGZvcm1idWlsZGVyLnBvc3NpYmxlX2Fuc3dlcnMuZnJvbV9pbmRleCwgZm9ybWJ1aWxkZXIucG9zc2libGVfYW5zd2Vycy50b19pbmRleCk7XG5cbiAgICAgICAgICAgICAgICAvL3NhdmUgcG9zc2libGUgYW5zd2Vyc1xuICAgICAgICAgICAgICAgIGlucHV0LnNhdmVQb3NzaWJsZUFuc3dlcnMoKTtcbiAgICAgICAgICAgICAgICAvL3ZhbGlkYXRlIGlucHV0XG4gICAgICAgICAgICAgICAgdmFsaWRhdGlvbi5wZXJmb3JtVmFsaWRhdGlvbihpbnB1dCwgZmFsc2UpO1xuXG4gICAgICAgICAgICAgICAgLy9lbmFibGUgc2F2ZSBwcm9qZWN0IGJ1dHRvbiBhcyB1c2VyIG1hZGUgYSBjaGFuZ2VcbiAgICAgICAgICAgICAgICAvL2FuZCBBTEwgdGhlIGlucHV0cyBhcmUgdmFsaWRcblxuICAgICAgICAgICAgICAgIC8vZW5hYmxlIHNhdmUgcHJvamVjdCBidXR0b24gaWYgYWxsIGlucHV0cyBhcmUgdmFsaWRcbiAgICAgICAgICAgICAgICBpZiAodmFsaWRhdGlvbi5hcmVBbGxJbnB1dHNWYWxpZChmb3JtYnVpbGRlci5wcm9qZWN0X2RlZmluaXRpb24pKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vZW5hYmxlIHNhdmUgcHJvamVjdCBidXR0b24gKGlmIGRpc2FibGVkKVxuICAgICAgICAgICAgICAgICAgICB1aS5uYXZiYXIudG9nZ2xlU2F2ZVByb2plY3RCdG4oY29uc3RzLkJUTl9FTkFCTEVEKTtcbiAgICAgICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLnNhdmVfcHJvamVjdF9idG4ub2ZmKCkub24oJ2NsaWNrJywgc2F2ZV9wcm9qZWN0X2NsaWNrX2NhbGxiYWNrKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc3RhcnQ6IGZ1bmN0aW9uKGUsIGpxdWVyeV91aSl7XG4gICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIucG9zc2libGVfYW5zd2Vycy5mcm9tX2luZGV4ID0ganF1ZXJ5X3VpLml0ZW0uaW5kZXgoKSA9PT0gMCA/IDAgOiBqcXVlcnlfdWkuaXRlbS5pbmRleCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KS5kaXNhYmxlU2VsZWN0aW9uKCk7XG5cbiAgICAgICAgLy9rZWVwIHRyYWNrIG9mIHRoZSBjdXJyZW50IGlucHVvdCBzbyB3ZSBkbyBub3QgYXR0YWNoIHRoZSBldmVudCBtb3JlIHRoYW4gb25jZVxuICAgICAgICBmb3JtYnVpbGRlci5wb3NzaWJsZV9hbnN3ZXJzLmVuYWJsZWRfc29ydGFibGUucHVzaChpbnB1dC5yZWYpO1xuICAgIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gcG9zc2libGVBbnN3ZXJzU29ydGFibGU7XG4iLCIndXNlIHN0cmljdCc7XG52YXIgZm9ybWJ1aWxkZXIgPSByZXF1aXJlKCdjb25maWcvZm9ybWJ1aWxkZXInKTtcbnZhciBpbnB1dF9mYWN0b3J5ID0gcmVxdWlyZSgnZmFjdG9yeS9pbnB1dC1mYWN0b3J5Jyk7XG52YXIgdWkgPSByZXF1aXJlKCdoZWxwZXJzL3VpJyk7XG52YXIgdXRpbHMgPSByZXF1aXJlKCdoZWxwZXJzL3V0aWxzJyk7XG52YXIgY29uc3RzID0gcmVxdWlyZSgnY29uZmlnL2NvbnN0cycpO1xudmFyIG1lc3NhZ2VzID0gcmVxdWlyZSgnY29uZmlnL21lc3NhZ2VzJyk7XG52YXIgdmFsaWRhdGlvbiA9IHJlcXVpcmUoJ2FjdGlvbnMvdmFsaWRhdGlvbicpO1xudmFyIHRlbXBsYXRlID0gcmVxdWlyZSgndGVtcGxhdGUnKTtcbnZhciB1bmRvID0gcmVxdWlyZSgnYWN0aW9ucy91bmRvJyk7XG52YXIgdG9hc3QgPSByZXF1aXJlKCdjb25maWcvdG9hc3QnKTtcbnZhciBwb3NzaWJsZUFuc3dlcnNTb3J0YWJsZSA9IHJlcXVpcmUoJ3VpLWhhbmRsZXJzL3Bvc3NpYmxlLWFuc3dlcnMtc29ydGFibGUnKTtcblxudmFyIHNvcnRhYmxlID0gZnVuY3Rpb24gKCkge1xuXG4gICAgdmFyIGlucHV0O1xuXG4gICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uX3NvcnRhYmxlLnNvcnRhYmxlKHtcbiAgICAgICAgekluZGV4OiA5OTk5LFxuICAgICAgICBjdXJzb3I6ICdtb3ZlJyxcbiAgICAgICAgaXRlbXM6ICc+IGRpdi5pbnB1dCcsXG4gICAgICAgIHJldmVydDogMTAwLFxuICAgICAgICAvL2F4aXM6ICd5JywvLyBpdCBjYXVzZXMgdGhlIHBsYWNlaG9sZGVyIHRvIGJlIGFsd2F5cyBhY3RpdmVcbiAgICAgICAgY29udGFpbm1lbnQ6ICdwYXJlbnQnLFxuICAgICAgICAvLyBjb250YWlubWVudDogJ2RvY3VtZW50Jywgbm8hXG4gICAgICAgIHRvbGVyYW5jZTogJ3BvaW50ZXInLFxuICAgICAgICAvLyBmb3JjZVBsYWNlaG9sZGVyU2l6ZTogdHJ1ZSxcbiAgICAgICAgcGxhY2Vob2xkZXI6ICdpbnB1dC1jb2xsZWN0aW9uLWRyb3AtcGxhY2Vob2xkZXInLFxuXG4gICAgICAgIC8vdHJpZ2dlcmVkIHdoZW4gYSBuZXcgaW5wdXQgaXMgZHJvcHBlZCBvdmVyIHRoZSBzb3J0YWJsZVxuICAgICAgICByZWNlaXZlOiBmdW5jdGlvbiAoZSwganF1ZXJ5X3VpKSB7XG5cbiAgICAgICAgICAgIHZhciBpbnB1dF9mYWN0b3J5ID0gcmVxdWlyZSgnZmFjdG9yeS9pbnB1dC1mYWN0b3J5Jyk7XG4gICAgICAgICAgICB2YXIgZm9ybV9pbmRleCA9IGZvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleDtcbiAgICAgICAgICAgIHZhciBmb3JtX3JlZiA9IGZvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9yZWY7XG4gICAgICAgICAgICB2YXIgaW5wdXRzID0gZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uLmRhdGEucHJvamVjdC5mb3Jtc1tmb3JtX2luZGV4XS5pbnB1dHM7XG4gICAgICAgICAgICB2YXIgcHJldmlvdXNfaW5wdXRfcmVmID0gZm9ybWJ1aWxkZXIuY3VycmVudF9pbnB1dF9yZWY7XG4gICAgICAgICAgICB2YXIgaW5wdXRfdHlwZSA9IGpxdWVyeV91aS5pdGVtLmF0dHIoJ2RhdGEtdHlwZScpO1xuICAgICAgICAgICAgdmFyIGlucHV0X2luZGV4ID0gaW5wdXRzLmxlbmd0aDtcbiAgICAgICAgICAgIHZhciBpbnB1dF9yZWYgPSB1dGlscy5nZW5lcmF0ZUlucHV0UmVmKGZvcm1fcmVmKTtcblxuICAgICAgICAgICAgLy92YWxpZGF0ZSBwcmV2aW91cyBpbnB1dCAoaWYgYW55KSB0byBzaG93IGVtYmVkZGVkIGVycm9ycyAoaW4gY2FzZSB0aGUgdXNlciBkaWQgbm90IHByZXNzIHZhbGlkYXRlIGJ1dHRvbilcbiAgICAgICAgICAgIGlmIChwcmV2aW91c19pbnB1dF9yZWYgJiYgaW5wdXRfaW5kZXggPiAwKSB7XG4gICAgICAgICAgICAgICAgdmFsaWRhdGlvbi5wZXJmb3JtVmFsaWRhdGlvbih1dGlscy5nZXRJbnB1dE9iamVjdEJ5UmVmKHByZXZpb3VzX2lucHV0X3JlZiksIGZhbHNlKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnc29ydGFibGUgcmVjZWl2ZScpO1xuICAgICAgICAgICAganF1ZXJ5X3VpLml0ZW0ucmVtb3ZlQXR0cignc3R5bGUnKTsgLy8gdW5kbyBzdHlsaW5nIHNldCBieSBqcXVlcnlVSSAoaHR0cDovL2dvby5nbC9FS3o4dEMpXG5cbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmNvbGxlY3Rpb25faXNfYmVpbmdfc29ydGVkID0gZmFsc2U7XG4gICAgICAgICAgICAvL2dlbmVyYXRlIGlucHV0IG9iamVjdCBiYXNlZCBvbiB0eXBlIGFuZCBzZXQgaW5kZXggaW5jcmVtZW50YWxseVxuICAgICAgICAgICAgaW5wdXQgPSBpbnB1dF9mYWN0b3J5LmNyZWF0ZUlucHV0KGlucHV0X3R5cGUsIGlucHV0X3JlZik7XG4gICAgICAgICAgICBmb3JtYnVpbGRlci5jdXJyZW50X2lucHV0X3JlZiA9IGlucHV0LnJlZjtcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGlucHV0KTtcblxuICAgICAgICAgICAgLy9kaXNhYmxlIGN1cnJlbnQgYWN0aXZlIGVsZW1lbnRcbiAgICAgICAgICAgIHZhciBjdXJyZW50X2VsZW1lbnQgPSBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25fc29ydGFibGUuZmluZCgnLmFjdGl2ZScpO1xuICAgICAgICAgICAgY3VycmVudF9lbGVtZW50LnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcblxuICAgICAgICAgICAgLy9hZGQgaW5wdXQgdG8gY29sbGVjdGlvbiBhcyB0aGUgbGFzdCBvbmVcbiAgICAgICAgICAgIGlucHV0cy5wdXNoKGlucHV0KTtcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coaW5wdXRzKTtcblxuICAgICAgICAgICAgLy9oaWRlIG1lc3NhZ2UgYWJvdXQgbm8gaW5wdXQgc2VsZWN0ZWQsIGFzIGRyb3BwZWQgaW5wdXQgZ2V0cyBmb2N1c1xuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfbm9faW5wdXRfc2VsZWN0ZWQuaGlkZSgpO1xuXG4gICAgICAgICAgICAvL2dldCBob2xkIG9mIGFkdmFuY2VkIHByb3BlcnRpZXMgcGFuZWwgZm9yIHRoaXMgaW5wdXRcbiAgICAgICAgICAgIGlucHV0LmRvbS5hZHZhbmNlZF9wcm9wZXJ0aWVzX3dyYXBwZXIgPSBmb3JtYnVpbGRlclxuICAgICAgICAgICAgICAgIC5kb21cbiAgICAgICAgICAgICAgICAuaW5wdXRfcHJvcGVydGllc19mb3Jtc193cmFwcGVyXG4gICAgICAgICAgICAgICAgLmZpbmQoJ2Zvcm1bZGF0YS1pbnB1dC1yZWY9XCInICsgaW5wdXQucmVmICsgJ1wiXScpXG4gICAgICAgICAgICAgICAgLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19mb3JtX19hZHZhbmNlZC1wcm9wZXJ0aWVzJyk7XG5cbiAgICAgICAgICAgIC8vZGlzYWJsZSBzYXZlIHByb2plY3QgYnV0dG9uIGFzIGJ5IGRlZmF1bHQgYW4gaW5wdXQgaXMgaW52YWxpZCB3aGVuIGl0IGlzIGNyZWF0ZWRcbiAgICAgICAgICAgIHVpLm5hdmJhci50b2dnbGVTYXZlUHJvamVjdEJ0bihjb25zdHMuQlROX0RJU0FCTEVEKTtcblxuICAgICAgICAgICAgLy9zZXQgZm9ybSB0YWIgYXMgaW52YWxpZCwgYXMgdGhlIG5ldyBpbnB1dCB3aWxsIGJlIGludmFsaWQgYnkgZGVmYXVsdFxuICAgICAgICAgICAgdWkuZm9ybXNfdGFicy5zaG93Rm9ybUludmFsaWRJY29uKGZvcm1idWlsZGVyLmN1cnJlbnRfZm9ybV9pbmRleCk7XG5cblxuXG4gICAgICAgIH0sXG4gICAgICAgIHN0b3A6IGZ1bmN0aW9uIChlLCBqcXVlcnlfdWkpIHtcblxuICAgICAgICAgICAgdmFyIGZvcm1faW5kZXggPSBmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXg7XG4gICAgICAgICAgICB2YXIgaW5wdXRzID0gZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uLmRhdGEucHJvamVjdC5mb3Jtc1tmb3JtX2luZGV4XS5pbnB1dHM7XG4gICAgICAgICAgICB2YXIgcGxhY2Vob2xkZXJfdGV4dCA9IG1lc3NhZ2VzLmVycm9yLk5PX1FVRVNUSU9OX1RFWFRfWUVUO1xuICAgICAgICAgICAgdmFyIGlucHV0X3R5cGUgPSBqcXVlcnlfdWkuaXRlbS5hdHRyKCdkYXRhLXR5cGUnKTtcbiAgICAgICAgICAgIHZhciBwcm9wZXJ0aWVzX3BhbmVsX2h0bWw7XG5cbiAgICAgICAgICAgIC8vZGlzYWJsZSBkcmFnZ2FibGUgaWYgd2UgaGl0IHRoZSBtYXggYW1vdW50IG9mIGlucHV0cyBhbGxvd2VkXG4gICAgICAgICAgICBpZiAodXRpbHMuZ2V0SW5wdXRzVG90YWwoaW5wdXRzKSA+PSBjb25zdHMuSU5QVVRTX01BWF9BTExPV0VEKSB7XG4gICAgICAgICAgICAgICAgdWkuaW5wdXRfdG9vbHMuZGlzYWJsZSgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL2hpZGUgc2VhcmNoIGlucHV0IGlmIHdlIGhpdCB0aGUgbWF4IChnbG9iYWxseSkgYnV0IG9ubHkgd2hlbiBhZGRpbmcgbmV3IGlucHV0c1xuICAgICAgICAgICAgaWYgKGlucHV0X3R5cGUgPT09IGNvbnN0cy5TRUFSQ0hfU0lOR0xFX1RZUEUgJiYgIWZvcm1idWlsZGVyLmNvbGxlY3Rpb25faXNfYmVpbmdfc29ydGVkKSB7XG4gICAgICAgICAgICAgICAgaWYgKHV0aWxzLmdldFNlYXJjaElucHV0c1RvdGFsKCkgPj0gY29uc3RzLkxJTUlUUy5zZWFyY2hfaW5wdXRzX21heCkge1xuICAgICAgICAgICAgICAgICAgICB1aS5pbnB1dF90b29scy5oaWRlU2VhcmNoSW5wdXQoKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3NlYXJjaCBsaW1pdCByZWFjaGVkJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy9zaG93IHdhcm5pbmcgdG8gdXNlclxuICAgICAgICAgICAgICAgICAgICB0b2FzdC5zaG93V2FybmluZyhtZXNzYWdlcy53YXJuaW5nLlNFQVJDSF9JTlBVVFNfTElNSVRfUkVBQ0hFRCArICcoJyArIGNvbnN0cy5MSU1JVFMuc2VhcmNoX2lucHV0c19tYXggKyAnKScpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnc29ydGFibGUgc3RvcCcpO1xuICAgICAgICAgICAganF1ZXJ5X3VpLml0ZW0ucmVtb3ZlQXR0cignc3R5bGUnKTsgLy8gdW5kbyBzdHlsaW5nIHNldCBieSBqcXVlcnlVSSAoaHR0cDovL2dvby5nbC9FS3o4dEMpXG5cbiAgICAgICAgICAgIHZhciBpbnB1dF9yZWYgPSBmb3JtYnVpbGRlci5jdXJyZW50X2lucHV0X3JlZjtcblxuICAgICAgICAgICAgLy9nZXQgdGhlIGluZGV4IHdoZXJlIHRoZSBpbnB1dCB3YXMgZHJvcHBlZCAoc2tpcCB3aGVuIGxpc3QgaXMgZW1wdHkpXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhqcXVlcnlfdWkuaXRlbS5pbmRleCgpKTtcbiAgICAgICAgICAgIC8vaGVyZSBmcm9tX2luZGV4IGlzIGJhc2VkIG9uIHRoZSBzaWJsaW5ncywgc28gd2UgbmVlZCB0byByZW1vdmUgdGhlIGluZGV4ZXMgZm9yIHRoZSB3YXJuaW5nIG1lc3NhZ2VzIDxkaXY+XG4gICAgICAgICAgICAvL3dlIGhhdmUgMiA8ZGl2Piwgc28gcmVtb3ZlIDJcbiAgICAgICAgICAgIGZvcm1idWlsZGVyLnRvX2luZGV4ID0ganF1ZXJ5X3VpLml0ZW0uaW5kZXgoJycpID09PSAwID8ganF1ZXJ5X3VpLml0ZW0uaW5kZXgoKSA6IGpxdWVyeV91aS5pdGVtLmluZGV4KCkgLSAyO1xuXG4gICAgICAgICAgICAvKlxuICAgICAgICAgICAgIGlmIHRoZSB1c2VyIGlzIGRyYWdnaW5nIGEgbmV3IGlucHV0IG92ZXIsIGl0IHdhcyBhZGRlZCBhcyB0aGUgbGFzdCBlbGVtZW50IG9mIHRoZSBhcnJheVxuICAgICAgICAgICAgIG90aGVyd2lzZSB0aGUgY3VycmVudCBpbnB1dCBwb3NpdGlvbiBpcyBzZXQgaW4gdGhlIHN0YXJ0IGV2ZW50XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGlmICghZm9ybWJ1aWxkZXIuY29sbGVjdGlvbl9pc19iZWluZ19zb3J0ZWQpIHtcblxuICAgICAgICAgICAgICAgIC8vb3ZlcnJpZGUgJ2Zyb21faW5kZXgnIGFzIHdlIGFyZSBkcm9wcGluZyBhIG5ldyBlbGVtZW50XG4gICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZnJvbV9pbmRleCA9IGlucHV0cy5sZW5ndGggLSAxO1xuXG4gICAgICAgICAgICAgICAgLy9tb3ZlIGlucHV0cyB0byBrZWVwIHRoZSBhcnJheSBzZXF1ZW5jZSBsaWtlIHRoZSBpbnB1dCBzZXF1ZW5jZSBvbiBzY3JlZW5cbiAgICAgICAgICAgICAgICBpbnB1dHMubW92ZShmb3JtYnVpbGRlci5mcm9tX2luZGV4LCBmb3JtYnVpbGRlci50b19pbmRleCk7XG5cbiAgICAgICAgICAgICAgICBqcXVlcnlfdWkuaXRlbS5hZGRDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgICAgICAgICAganF1ZXJ5X3VpLml0ZW0uYXR0cignZGF0YS1pbnB1dC1yZWYnLCBpbnB1dF9yZWYpO1xuXG4gICAgICAgICAgICAgICAgLy9hcHBlbmQgaW5wdXQgaWQgYW5kIGEgd2FybmluZyBpY29uLCBhcyBieSBkZWZhdWx0IHRoZSBxdWVzdGlvbiBkb2VzIG5vdCBoYXZlIGFueSB0ZXh0XG4gICAgICAgICAgICAgICAganF1ZXJ5X3VpLml0ZW0uZmluZCgnLmlucHV0LWlubmVyJykuYXBwZW5kKHVpLmlucHV0c19jb2xsZWN0aW9uLmdldElucHV0U3RhdGVJY29uc0hUTUwoKSk7XG5cbiAgICAgICAgICAgICAgICAvL2FkZCBwbGFjZWhvbGRlciB0ZXh0IG9uIGN1cnJlbnQgaW5wdXQgKGJhc2VkIG9uIGlucHV0IHR5cGUpXG4gICAgICAgICAgICAgICAgaWYgKGlucHV0X3R5cGUgPT09IGNvbnN0cy5CUkFOQ0hfVFlQRSkge1xuICAgICAgICAgICAgICAgICAgICAvL2l0IGlzIGEgYnJhbmNoLCBhZGQgYnJhbmNoIHBsYWNlaG9sZGVyXG4gICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyX3RleHQgPSBtZXNzYWdlcy5lcnJvci5OT19CUkFOQ0hfSEVBREVSX1lFVDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoaW5wdXRfdHlwZSA9PT0gY29uc3RzLkdST1VQX1RZUEUpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9pdCBpcyBhIGdyb3VwLCBhZGQgZ3JvdXAgcGxhY2Vob2xkZXJcbiAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXJfdGV4dCA9IG1lc3NhZ2VzLmVycm9yLk5PX0dST1VQX0hFQURFUl9ZRVQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAganF1ZXJ5X3VpLml0ZW0uZmluZCgnc3Bhbi5xdWVzdGlvbi1wcmV2aWV3JykudGV4dChwbGFjZWhvbGRlcl90ZXh0KTtcblxuICAgICAgICAgICAgICAgIC8vc2hvdyBpbnB1dCBwcm9wZXJ0aWVzIGZvciB0aGUgbmV3IGRyb3BwZWQgaW5wdXRcbiAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllcy5maW5kKCcucGFuZWwtYm9keSBmb3JtJykuaGlkZSgpO1xuICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzLmZpbmQoJy5wYW5lbC10aXRsZSBzcGFuJykudGV4dChwbGFjZWhvbGRlcl90ZXh0KTtcblxuICAgICAgICAgICAgICAgIC8vY3JlYXRlIHByb3BlcnRpZXMgcGFuZWwgaW4gcmlnaHQgc2lkZWJhciBmb3IgdGhpcyBpbnB1dCAoY29tbW9uIHByb3BlcnRpZXMpXG4gICAgICAgICAgICAgICAgcHJvcGVydGllc19wYW5lbF9odG1sID0gdGVtcGxhdGUuZ2V0SW5wdXRQcm9wZXJ0aWVzUGFuZWxIVE1MKGlucHV0KTtcblxuICAgICAgICAgICAgICAgIC8vYXBwZW5kIGlucHV0IGFuZCBzaG93IGl0IGFzIGl0IGdldHMgc2VsZWN0ZWQgYnkgZGVmYXVsdFxuICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dF9wcm9wZXJ0aWVzX2Zvcm1zX3dyYXBwZXIuaGlkZSgpO1xuICAgICAgICAgICAgICAgICQocHJvcGVydGllc19wYW5lbF9odG1sKS5yZW1vdmVDbGFzcygnaGlkZGVuJykuYXBwZW5kVG8oZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlcik7XG4gICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0X3Byb3BlcnRpZXNfZm9ybXNfd3JhcHBlci5mYWRlSW4oY29uc3RzLkFOSU1BVElPTl9GQVNUKTtcblxuICAgICAgICAgICAgICAgIC8vc2hvdyBhY3Rpb24gYnV0dG9ucyBmb3IgaW5wdXRcbiAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllc19idXR0b25zLmZhZGVJbihjb25zdHMuQU5JTUFUSU9OX0ZBU1QpO1xuXG4gICAgICAgICAgICAgICAgLy9mb3IgYnJhbmNoZXMsIGVuYWJsZSBrZXl1cCB0byBjaGVjayBmb3IgdmFsaWRhdGlvbiBvZiBoZWFkZXIgdGV4dFxuICAgICAgICAgICAgICAgIC8vdHJpZ2dlcmVkIHdoZW4gdXNlcnMgdHlwZSBpbiB0aGUgaGVhZGVyIGlucHV0IGZpZWxkIGZvciBicmFuY2hlcyBvciBncm91cHNcblxuICAgICAgICAgICAgICAgIGlmIChpbnB1dC50eXBlID09PSBjb25zdHMuQlJBTkNIX1RZUEUgfHwgaW5wdXQudHlwZSA9PT0gY29uc3RzLkdST1VQX1RZUEUpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9mb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllcy5vZmYoJ2tleXVwJykub24oJ2tleXVwJywgJ2lucHV0JywgaW5wdXRfcHJvcGVydGllc19rZXl1cF9jYWxsYmFjayk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyBmb3JtYnVpbGRlci5kb20uaW5wdXRfcHJvcGVydGllcy5vZmYoJ2tleXVwJyk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy9lbmFibGUgc29ydGFibGUgb24gY3VycmVudCBpbnB1dCAob25seSB3aGVuIGl0IGdldHMgY3JlYXRlZClcbiAgICAgICAgICAgICAgICBwb3NzaWJsZUFuc3dlcnNTb3J0YWJsZShpbnB1dCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcblxuICAgICAgICAgICAgICAgIC8vdG9kbyBkbyBJIG5lZWQgdG8gYmluZCBrZXl1cCBmb3IgYnJhbmNoZXMgYW5kIGdyb3VwcyBoZXJlP1xuXG4gICAgICAgICAgICAgICAgLy8nZnJvbV9pbmRleCBpcyBzZXQgaW4gc3RhcnQgZXZlbnQgb2Ygc29ydGFibGUnXG4gICAgICAgICAgICAgICAgLy9tb3ZlIGlucHV0cyB0byBrZWVwIHRoZSBhcnJheSBzZXF1ZW5jZSBsaWtlIHRoZSBpbnB1dCBzZXF1ZW5jZSBvbiBzY3JlZW5cbiAgICAgICAgICAgICAgICBpbnB1dHMubW92ZShmb3JtYnVpbGRlci5mcm9tX2luZGV4LCBmb3JtYnVpbGRlci50b19pbmRleCk7XG5cbiAgICAgICAgICAgICAgICAvL3J1biB0aGUgdmFsaWRhdGlvbiBvbiBhbGwganVtcHMsIGFzIHdlIG1pZ2h0IGhhdmUgc29tZSBpbnZhbGlkIGRlc3RpbmF0aW9ucyBhZnRlciByZS1vcmRlcmluZ1xuICAgICAgICAgICAgICAgIC8vSSBhbSBmb3JjZWQgdG8gZG8gdGhpcyBhZ2FpbnN0IGFsbCB0aGUgaW5wdXRzXG4gICAgICAgICAgICAgICAgdmFsaWRhdGlvbi52YWxpZGF0ZUp1bXBzQWZ0ZXJTb3J0aW5nKGlucHV0cyk7XG5cbiAgICAgICAgICAgICAgICBqcXVlcnlfdWkuaXRlbS5hZGRDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgLy9wdXNoIHN0YXRlIHRvIGVuYWJsZSB1bmRvaW5nIHRoZSBhY3Rpb24gKGFkZGluZy9kcmFnZ2luZyBpbnB1dClcbiAgICAgICAgICAgIGZvcm1idWlsZGVyLnJlbmRlcl9hY3Rpb24gPSBjb25zdHMuUkVOREVSX0FDVElPTl9ETztcbiAgICAgICAgICAgIHVuZG8ucHVzaFN0YXRlKCk7XG5cbiAgICAgICAgICAgIGlmIChpbnB1dF90eXBlID09PSBjb25zdHMuUkVBRE1FX1RZUEUpIHtcbiAgICAgICAgICAgICAgICAkKCcuc3VtbWVybm90ZScpLnN1bW1lcm5vdGUoY29uc3RzLlNVTU1FUk5PVEVfT1BUSU9OUyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vaWYgdGhlcmUgaXMgbm90IGFueSB0aXRsZSBzZXQsIHNob3cgd2FybmluZ1xuICAgICAgICAgICAgLy9idXQgb25seSBpZiB0aGVyZSBhcmUgYW55IGlucHV0c1xuICAgICAgICAgICAgaWYgKGlucHV0cy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgdWkuaW5wdXRzX2NvbGxlY3Rpb24udG9nZ2xlVGl0bGVXYXJuaW5nKHV0aWxzLmdldFRpdGxlQ291bnQoaW5wdXRzKSwgZmFsc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgLy9oaWRlIGl0LCBwYXNzaW5nIGEgY291bnQgPiAxXG4gICAgICAgICAgICAgICAgdWkuaW5wdXRzX2NvbGxlY3Rpb24udG9nZ2xlVGl0bGVXYXJuaW5nKDEsIGZhbHNlKTtcblxuICAgICAgICAgICAgICAgIC8vZGlzYWJsZSBkb3dubG9hZCBmb3JtIGJ1dHRvblxuICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvblxuICAgICAgICAgICAgICAgICAgICAuZmluZCgnLmlucHV0cy1jb2xsZWN0aW9uX19leHBvcnQtZm9ybScpLmFkZENsYXNzKCdkaXNhYmxlZCcpO1xuXG4gICAgICAgICAgICAgICAgLy9kaXNhYmxlIHByaW50IGFzIHBkZiBmb3JtIGJ1dHRvblxuICAgICAgICAgICAgICAgIGZvcm1idWlsZGVyLmRvbS5pbnB1dHNfY29sbGVjdGlvblxuICAgICAgICAgICAgICAgICAgICAuZmluZCgnLmlucHV0cy1jb2xsZWN0aW9uX19wcmludC1hcy1wZGYnKS5hZGRDbGFzcygnZGlzYWJsZWQnKTtcbiAgICAgICAgICAgIH1cblxuXG5cbiAgICAgICAgfSxcbiAgICAgICAgLy90aGlzIGNhbGxiYWNrIGlzIHRyaWdnZXJlZCB3aGVuIHRoZSB1c2VyIHN0YXJ0IGRyYWdnaW5nIGFuIGV4aXN0aW5nIGlucHV0IGZyb20gdGhlIHNvcnRhYmxlXG4gICAgICAgIHN0YXJ0OiBmdW5jdGlvbiAoZSwganF1ZXJ5X3VpKSB7XG5cbiAgICAgICAgICAgIC8vZ2V0IGN1cnJlbnQgaW5wdXQgcG9zaXRpb24sIGFzIHdlIG5lZWQgdG8gbW92ZSBmcm9tIGhlcmUgKGlmIHRoZXJlIGlzIGFueSBpbnB1dClcbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmNvbGxlY3Rpb25faXNfYmVpbmdfc29ydGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIC8vaGVyZSBmcm9tX2luZGV4IGlzIGJhc2VkIG9uIHRoZSBzaWJsaW5ncywgc28gd2UgbmVlZCB0byByZW1vdmUgdGhlIGluZGV4ZXMgZm9yIHRoZSB3YXJuaW5nIG1lc3NhZ2VzIDxkaXY+XG4gICAgICAgICAgICAvL3dlIGhhdmUgMiA8ZGl2Piwgc28gcmVtb3ZlIDJcbiAgICAgICAgICAgIGZvcm1idWlsZGVyLmZyb21faW5kZXggPSBqcXVlcnlfdWkuaXRlbS5pbmRleCgpID09PSAwID8gMCA6IGpxdWVyeV91aS5pdGVtLmluZGV4KCkgLSAyO1xuXG4gICAgICAgICAgICAvL2RlLWFjdGl2YXRlIGFsbCBpbnB1dHMgaW4gY29sbGVjdGlvblxuICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uX3NvcnRhYmxlLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcbiAgICAgICAgfSxcbiAgICAgICAgb3ZlcjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGZvcm1faW5kZXggPSBmb3JtYnVpbGRlci5jdXJyZW50X2Zvcm1faW5kZXg7XG4gICAgICAgICAgICB2YXIgaW5wdXRzID0gZm9ybWJ1aWxkZXIucHJvamVjdF9kZWZpbml0aW9uLmRhdGEucHJvamVjdC5mb3Jtc1tmb3JtX2luZGV4XS5pbnB1dHM7XG4gICAgICAgICAgICAvL3JlbW92ZSBubyBxdWVzdGlvbnMgbWVzc2FnZSBhbmQgdXBsb2FkIGJ1dHRvbiBpZiBubyBpbnB1dHNcbiAgICAgICAgICAgIGlmIChpbnB1dHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgZm9ybWJ1aWxkZXIuZG9tLmlucHV0c19jb2xsZWN0aW9uXG4gICAgICAgICAgICAgICAgICAgIC5maW5kKCcuaW5wdXQtcHJvcGVydGllc19fbm8tcXVlc3Rpb25zLW1lc3NhZ2UnKVxuICAgICAgICAgICAgICAgICAgICAuYWRkQ2xhc3MoJ2hpZGRlbicpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBvdXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBmb3JtX2luZGV4ID0gZm9ybWJ1aWxkZXIuY3VycmVudF9mb3JtX2luZGV4O1xuICAgICAgICAgICAgdmFyIGlucHV0cyA9IGZvcm1idWlsZGVyLnByb2plY3RfZGVmaW5pdGlvbi5kYXRhLnByb2plY3QuZm9ybXNbZm9ybV9pbmRleF0uaW5wdXRzO1xuICAgICAgICAgICAgLy9zaG93IG5vIHF1ZXN0aW9ucyBtZXNzYWdlIGFuZCB1cGxvYWQgYnV0dG9uIGlmIG5vIGlucHV0c1xuICAgICAgICAgICAgaWYgKGlucHV0cy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICBmb3JtYnVpbGRlci5kb20uaW5wdXRzX2NvbGxlY3Rpb25cbiAgICAgICAgICAgICAgICAgICAgLmZpbmQoJy5pbnB1dC1wcm9wZXJ0aWVzX19uby1xdWVzdGlvbnMtbWVzc2FnZScpXG4gICAgICAgICAgICAgICAgICAgIC5oaWRlKClcbiAgICAgICAgICAgICAgICAgICAgLnJlbW92ZUNsYXNzKCdoaWRkZW4nKVxuICAgICAgICAgICAgICAgICAgICAuZmFkZUluKGNvbnN0cy5BTklNQVRJT05fRkFTVCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHNjcm9sbDogdHJ1ZVxuICAgIH0pLmRpc2FibGVTZWxlY3Rpb24oKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gc29ydGFibGU7XG4iXX0="}