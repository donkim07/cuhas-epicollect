"use strict";window.EC5=window.EC5||{},$(document).ready(function(){var t=$(".page-forgot");if(0===t.length)return!1;var n=$(".gcaptcha"),e=n.text();n.remove(),grecaptcha.ready(function(){var n,o=function(o){function i(){window.EC5.overlay.fadeIn(),grecaptcha.execute(e,{action:"forgot"}).then(function(t){a.prepend('<input type="hidden" name="g-recaptcha-response" value="'+t+'">').submit(),window.setTimeout(window.EC5.overlay.fadeOut(),1e4)})}var a=t.find("form#page-forgot__form");o.preventDefault(),"function"==typeof a.get(0).reportValidity?a.get(0).reportValidity()&&i():i(),window.clearTimeout(n)};$("#send").on("click",function(t){n||(n=window.setTimeout(o(t),1e3))})})}),window.EC5=window.EC5||{},$(document).ready(function(){var t=$(".page-login");if(0===t.length)return!1;var n=t.find(".btn-login-apple"),e=$(".gcaptcha");if(e.length>0){var o=e.text().trim();e.remove(),window.grecaptcha.ready(function(){var n,e=function(n){function e(){window.EC5.overlay.fadeIn(),window.grecaptcha.execute(o,{action:"passwordless"}).then(function(t){i.prepend('<input type="hidden" name="g-recaptcha-response" value="'+t+'">').submit(),window.setTimeout(window.EC5.overlay.fadeOut(),1e4)})}var i=t.find("form#page-login__passwordless");n.preventDefault(),"function"==typeof i.get(0).reportValidity?i.get(0).reportValidity()&&e():e()};$("#passwordless").on("click",function(t){window.clearTimeout(n),n=window.setTimeout(e(t),1e3)})}),t.find(".show-password-control").on("click",function(){$(this).prop("checked")?t.find("input.password-input").each(function(){$(this).attr("type","text")}):t.find("input.password-input").each(function(t){$(this).attr("type","password")})})}n.on("click",function(t){var n=$("meta[name=appleid-signin-client-id]").attr("content"),e=$("meta[name=appleid-signin-scope]").attr("content"),o=$("meta[name=appleid-signin-redirect-uri]").attr("content"),i=($("meta[name=appleid-signin-state]").attr("content"),$("meta[name=appleid-signin-nonce]").attr("content"));window.AppleID.auth.init({clientId:n,scope:e,redirectURI:o,nonce:i,usePopup:!1}),window.AppleID.auth.signIn()})}),window.EC5=window.EC5||{},$(document).ready(function(){var t=$(".page-profile");if(0===t.length)return!1;var n=t.find(".btn-connect-apple"),e=t.find(".btn-confirm-account-deletion"),o=t.find(".checkbox-confirm-account-deletion"),i=t.find("#modal__account-deletion");i.on("show.bs.modal",function(){e.attr("disabled",!0),o.prop("checked",!1)}),o.on("change",function(){$(this).is(":checked")?e.attr("disabled",!1):e.attr("disabled",!0)}),e.on("click",function(t){if(!o.prop("checked"))return!1;window.EC5.overlay.fadeIn();var n=window.EC5.SITE_URL+"/api/internal/profile/account-deletion-request";$.ajax({url:n,type:"POST"}).done(function(t){return console.log(t),t.data.accepted===!0?void window.EC5.toast.showSuccess("Account deletion request sent."):t.data.deleted===!0?(window.EC5.toast.showSuccess("Account deleted."),void window.setTimeout(function(){window.location.reload()},100)):void window.EC5.toast.showError("Something went wrong")}).fail(function(t){if(t.responseJSON.errors&&t.responseJSON.errors.length>0)for(var n=0;n<t.responseJSON.errors.length;n++)window.EC5.toast.showError(t.responseJSON.errors[n].title)}).always(function(){window.EC5.overlay.fadeOut(),i.modal("hide")})}),n.on("click",function(t){var n=$("meta[name=appleid-signin-client-id]").attr("content"),e=$("meta[name=appleid-signin-scope]").attr("content"),o=$("meta[name=appleid-signin-redirect-uri]").attr("content"),i=$("meta[name=appleid-signin-nonce]").attr("content");AppleID.auth.init({clientId:n,scope:e,redirectURI:o,nonce:i,usePopup:!1}),AppleID.auth.signIn();try{window.EC5.overlay.fadeIn(),AppleID.auth.signIn().then(function(t){t.authorization.state===state?$.ajax({url:o,type:"POST",dataType:"json",data:t,success:function(t){t.data.authorized?window.location.href=window.EC5.SITE_URL+"/myprojects":(window.EC5.toast.showError("User not authorized"),window.EC5.overlay.fadeOut())},error:function(t){window.EC5.overlay.fadeOut(),window.EC5.toast.showError(t.errors[0].title)}}):(window.EC5.overlay.fadeOut(),window.EC5.toast.showError("Invalid state"))},function(t){window.EC5.overlay.fadeOut(),t.error&&window.EC5.toast.showError(t.error)})}catch(a){window.EC5.overlay.fadeOut(),a.error&&window.EC5.toast.showError(a.error)}})}),window.EC5=window.EC5||{},$(document).ready(function(){var t=$(".page-staff-reset");return 0!==t.length&&void t.find(".show-password-control").on("click",function(){$(this).prop("checked")?t.find("input.password-input").each(function(){$(this).attr("type","text")}):t.find("input.password-input").each(function(t){$(this).attr("type","password")})})}),window.EC5=window.EC5||{},$(document).ready(function(){var t=$(".page-signup");if(0===t.length)return!1;var n=$(".gcaptcha"),e=n.text();n.remove(),grecaptcha.ready(function(){var n,o=function(n){function o(){window.EC5.overlay.fadeIn(),grecaptcha.execute(e,{action:"signup"}).then(function(t){i.prepend('<input type="hidden" name="g-recaptcha-response" value="'+t+'">').submit(),window.setTimeout(window.EC5.overlay.fadeOut(),1e4)})}var i=t.find("form#page-signup__form");n.preventDefault(),"function"==typeof i.get(0).reportValidity?i.get(0).reportValidity()&&o():o()};$("#signup").on("click",function(t){window.clearTimeout(n),n=window.setTimeout(o(t),1e3)})}),t.find(".show-password-control").on("click",function(){$(this).prop("checked")?t.find("input.password-input").each(function(){$(this).attr("type","text")}):t.find("input.password-input").each(function(t){$(this).attr("type","password")})})});